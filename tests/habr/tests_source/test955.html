<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Какой здесь this? Внутренняя работа объектов JavaScript / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/452192\/"},"headline":"Какой здесь this? Внутренняя работа объектов JavaScript","datePublished":"2019-05-17T12:41:11+03:00","dateModified":"2019-05-18T00:16:29+03:00","author":{"@type":"Person","name":"Кирилл Матросов"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Фотография: &quot;Любопытный&quot; Liliana Saeb (CC BY 2.0) JavaScript &ndash; это мультипарадигмальный язык, который поддерживает объектно-ориентированное программирование и д...","url":"https:\/\/habr.com\/ru\/post\/452192\/#post-content-body","about":["h_javascript","f_develop"],"image":["https:\/\/habrastorage.org\/getpro\/habr\/post_images\/e7b\/99c\/5ab\/e7b99c5ab4652dbe38cb0e5b6fa0da90.jpg"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Какой здесь this? Внутренняя работа объектов JavaScript" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Какой здесь this? Внутренняя работа объектов JavaScript" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Какой здесь this? Внутренняя работа объектов JavaScript" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Фотография: &amp;quot;Любопытный&amp;quot; Liliana Saeb (CC BY 2.0)
JavaScript – это мультипарадигмальный язык, который поддерживает объектно-ориентированное программирование и динамическое связывание. Динамическое..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Фотография: &amp;quot;Любопытный&amp;quot; Liliana Saeb (CC BY 2.0)
JavaScript – это мультипарадигмальный язык, который поддерживает объектно-ориентированное программирование и динамическое связывание. Динамическое..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Фотография: &amp;quot;Любопытный&amp;quot; Liliana Saeb (CC BY 2.0)
JavaScript – это мультипарадигмальный язык, который поддерживает объектно-ориентированное программирование и динамическое связывание. Динамическое..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Фотография: &amp;quot;Любопытный&amp;quot; Liliana Saeb (CC BY 2.0)
JavaScript – это мультипарадигмальный язык, который поддерживает объектно-ориентированное программирование и динамическое связывание. Динамическое..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Фотография: &amp;quot;Любопытный&amp;quot; Liliana Saeb (CC BY 2.0)
JavaScript – это мультипарадигмальный язык, который поддерживает объектно-ориентированное программирование и динамическое связывание. Динамическое..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/452192/520ce0ba0b27e99eb3214b05d908bb11/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/452192/520ce0ba0b27e99eb3214b05d908bb11/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/452192/520ce0ba0b27e99eb3214b05d908bb11/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/452192/520ce0ba0b27e99eb3214b05d908bb11/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/452192/520ce0ba0b27e99eb3214b05d908bb11/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="452192" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2019-05-17T09:41:11.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/452192/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/452192/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/452192/520ce0ba0b27e99eb3214b05d908bb11/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/sharpfellow/" title="sharpfellow" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" loading="lazy" src="//habrastorage.org/r/w32/getpro/habr/avatars/d3f/fcd/711/d3ffcd711cd1629a4b4bdcaceb08abdc.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/sharpfellow/" class="tm-user-info__username">
      sharpfellow
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2019-05-17T09:41:11.000Z" title="2019-05-17, 12:41">17  мая  2019 в 12:41</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Какой здесь this? Внутренняя работа объектов JavaScript</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/javascript/" class="tm-article-snippet__hubs-item-link"><span>JavaScript</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <div class="tm-article-snippet__labels"><div class="tm-article-snippet__label"><span>
        Перевод
      </span></div></div> <!----> <!----></div></div> <div class="tm-article-presenter__origin"><a href="https://medium.com/javascript-scene/what-is-this-the-inner-workings-of-javascript-objects-d397bfa0708a" target="_blank" class="tm-article-presenter__origin-link">
                Автор оригинала:
                <span>
                  Eric Elliott
                </span></a></div> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml"><p><img src="https://habrastorage.org/r/w780q1/getpro/habr/post_images/e7b/99c/5ab/e7b99c5ab4652dbe38cb0e5b6fa0da90.jpg" data-src="https://habrastorage.org/getpro/habr/post_images/e7b/99c/5ab/e7b99c5ab4652dbe38cb0e5b6fa0da90.jpg" data-blurred="true"/><br/>
<em>Фотография: "Любопытный" Liliana Saeb (CC BY 2.0)</em></p><br/>
<p>JavaScript – это мультипарадигмальный язык, который поддерживает объектно-ориентированное программирование и динамическое связывание. Динамическое связывание — это мощная концепция, которая позволяет изменять структуру JavaScript кода во время выполнения, но эти дополнительные мощность и гибкость достигаются ценой некоторой путаницы, большая часть которой связана с поведением <code>this</code> в JavaScript.</p><br/>
<h1 id="dinamicheskoe-svyazyvanie">Динамическое связывание</h1><br/>
<p>При динамическом связывании определение метода для вызова происходит во время выполнения, а не во время компиляции. JavaScript выполняет это с помощью <code>this</code> и цепочки прототипов. В частности, внутри метода <code>this</code> определяется во время вызова, и значение <code>this</code> будет разным в зависимости от того, как метод был определен.</p><br/>
<p>Давайте сыграем в игру. Я называю её "Какой здесь <code>this</code>?"<a name="habracut"></a></p><br/>
<pre><code class="javascript">const a = {
  a: 'a'
};
const obj = {
  getThis: () => this,
  getThis2 () {
    return this;
  }
};
obj.getThis3 = obj.getThis.bind(obj);
obj.getThis4 = obj.getThis2.bind(obj);
const answers = [
  obj.getThis(),
  obj.getThis.call(a),
  obj.getThis2(),
  obj.getThis2.call(a),
  obj.getThis3(),
  obj.getThis3.call(a),
  obj.getThis4(),
  obj.getThis4.call(a)
];</code></pre><br/>
<p>Подумайте, какими будут значения в массиве <code>answers</code> и проверьте свои ответы с помощью <code>console.log()</code>. Угадали?</p><br/>
<p>Начнем с первого случая и продолжим по порядку. <code>obj.getThis()</code> возвращает <code>undefined</code>, но почему? У стрелочных функций никогда не бывает своего <code>this</code>. Вместо этого они всегда берут <code>this</code> из лексической области видимости (<em>прим. <a href="https://github.com/azat-io/you-dont-know-js-ru/blob/master/this%20%26%20object%20prototypes/ch2.md#%D0%BB%D0%B5%D0%BA%D1%81%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9-this">лексический this</a></em>). Для корня модуля ES6 лексическая область будет иметь неопределенное (<code>undefined</code>) значение <code>this</code>. <code>obj.getThis.call(a)</code> также не определен по той же причине. Для стрелочной функций <code>this</code> не может быть переопределён, даже с <code>.call()</code> или <code>.bind()</code>. <code>this</code> всегда будет браться из лексической области.</p><br/>
<p><code>obj.getThis2()</code> получает привязку в процессе вызова метода. Если до этого привязки <code>this</code> для этой функции не было, то ей можно привязать <code>this</code> (так как это не стрелочная функция). В данном случае <code>this</code> является объект <code>obj</code>, привязываемый в момент вызова метода с помощью <code>.</code> или <code>[squareBracket]</code> синтаксиса доступа к свойству. (<em>прим. <a href="https://github.com/azat-io/you-dont-know-js-ru/blob/master/this%20%26%20object%20prototypes/ch2.md#%D0%BD%D0%B5%D1%8F%D0%B2%D0%BD%D0%B0%D1%8F-%D0%BF%D1%80%D0%B8%D0%B2%D1%8F%D0%B7%D0%BA%D0%B0">неявная привязка</a></em>)</p><br/>
<p><code>obj.getThis2.call(a)</code> немного сложнее. Метод <code>call()</code> вызывает функцию с заданным значением this и необязательными аргументами. Другими словами, метод получает привязку <code>this</code> из параметра <code>.call()</code>, поэтому <code>obj.getThis2.call(a)</code> возвращает объект <code>a</code>. (<em>прим. <a href="https://github.com/azat-io/you-dont-know-js-ru/blob/master/this%20%26%20object%20prototypes/ch2.md#%D1%8F%D0%B2%D0%BD%D0%B0%D1%8F-%D0%BF%D1%80%D0%B8%D0%B2%D1%8F%D0%B7%D0%BA%D0%B0">явная привязка</a></em>)</p><br/>
<p>В случае <code>obj.getThis3 = obj.getThis.bind(obj);</code> мы пытаемся получить стрелочную функцию с привязанным <code>this</code>, что, как мы уже выяснили, не будет работать, поэтому мы получим <code>undefined</code> для <code>obj.getThis3()</code> и <code>obj.getThis3.call(a)</code> соответственно.</p><br/>
<p>Для обычных методов вы можете делать привязку, поэтому <code>obj.getThis4()</code> возвращает <code>obj</code>, как и ожидалось. Он уже получил свою привязку здесь <code>obj.getThis4 = obj.getThis2.bind(obj);</code>, а <code>obj.getThis4.call(a)</code> учитывает первую привязку и возвращает <code>obj</code> вместо <code>a</code>.</p><br/>
<h1 id="kruchenyy-myach">Крученый мяч</h1><br/>
<p>Решим ту же задачу, но на этот раз для описания объекта используем <code>class</code> с публичными полями (<a href="https://github.com/tc39/proposal-class-fields">нововведения Stage 3</a> на момент написания этой статьи доступны в Chrome по умолчанию и с <code>@babel/plugin-offer-class-properties</code>):</p><br/>
<pre><code class="javascript">class Obj {
  getThis = () => this
  getThis2 () {
    return this;
  }
}
const obj2 = new Obj();
obj2.getThis3 = obj2.getThis.bind(obj2);
obj2.getThis4 = obj2.getThis2.bind(obj2);
const answers2 = [
  obj2.getThis(),
  obj2.getThis.call(a),
  obj2.getThis2(),
  obj2.getThis2.call(a),
  obj2.getThis3(),
  obj2.getThis3.call(a),
  obj2.getThis4(),
  obj2.getThis4.call(a)
];</code></pre><br/>
<p>Подумайте над ответами, прежде чем продолжить.</p><br/>
<p>Готовы?</p><br/>
<p>Все вызовы, кроме <code>obj2.getThis2.call(a)</code>, возвращают экземпляр объекта. <code>obj2.getThis2.call(a)</code> возвращает <code>a</code>. Стрелочные функции всё так же получают <code>this</code> из лексического окружения. Существует разница в том, как <code>this</code> из лексического окружения определяется для свойств класса. Внутри инициализация свойств класса выглядит примерно так:</p><br/>
<pre><code class="javascript">class Obj {
  constructor() {
    this.getThis = () => this;
  }
...</code></pre><br/>
<p>Другими словами, стрелочная функция определяется внутри контекста конструктора. Так как это класс, то единственный способ создать экземпляр – это использовать ключевое слово <code>new</code> (опущение <code>new</code> приведет к ошибке). Одна из самых важных вещей, которые делает ключевое слово <code>new</code>, – это создание нового экземпляра объекта и привязка <code>this</code> к нему в конструкторе. Это поведение в сочетании с другими поведениями, которые мы уже упоминали выше, должно объяснить остальное.</p><br/>
<h1 id="zaklyuchenie">Заключение</h1><br/>
<p>У вас всё получилось? Хорошее понимание того, как <code>this</code> ведёт себя в JavaScript, сэкономит вам много времени на отладку сложных проблем. Если вы ошиблись в ответах, это значит, что вам нужно немного попрактиковаться. Потренируйтесь с примерами, затем вернитесь и проверьте себя снова, пока вы не сможете выполнить тест и объяснить кому-то ещё, почему методы возвращают то, что возвращают.</p><br/>
<p>Если это было сложнее, чем вы ожидали, то вы не одиноки. Я спрашивал достаточно много разработчиков на эту тему и думаю, что пока только один из них справился с данной задачей.</p><br/>
<p>То, что начиналось как поиск динамических методов, которые вы могли перенаправить с помощью <code>.call()</code>, <code>.bind()</code> или <code>.apply()</code>, стало значительно сложнее с добавлением методов класса и стрелочных функций. Возможно, вам стоит ещё раз заострить на этом внимание. Помните, что стрелочные функции всегда берут <code>this</code> из лексической области видимости, и <code>class</code> <code>this</code> на самом деле лексически ограничен конструктором класса под капотом. Если вы когда-либо засомневаетесь в <code>this</code>, то помните, что можно использовать отладчик (debugger), чтобы проверить его значение.</p><br/>
<p>Помните, что в решении многих задач на JavaScript можно обойтись без <code>this</code>. По моему опыту, почти всё может быть переопределено в терминах <a href="https://medium.com/javascript-scene/master-the-javascript-interview-what-is-a-pure-function-d1c076bec976">чистых функций</a>, которые принимают все используемые аргументы как явные параметры (<code>this</code> можно представить себе как неявную переменную). Логика, описанная через чистые функции, является детерминированной, что делает ее более тестируемой. Также при таком подходе нет побочных эффектов, поэтому, в отличие от моментов манипуляции с <code>this</code>, вы вряд ли что-то сломаете. Каждый раз, когда <code>this</code> устанавливается, что-то зависящее от его значения может сломаться.</p><br/>
<p>Тем не менее, иногда <code>this</code> полезен. Например, для обмена методами между большим количеством объектов. Даже в функциональном программировании <code>this</code> можно использовать для доступа к другим методам объекта, чтобы реализовать алгебраические преобразования, необходимые для построения новых алгебр поверх существующих. Так, универсальный <code>.flatMap()</code> может быть получен с помощью <code>this.map()</code> и <code>this.constructor.of()</code>.</p><br/>
<hr/><br/>
<p>Спасибо за помощь с переводом <a href="https://habr.com/ru/users/wksmirnowa/" class="user_link">wksmirnowa</a> и <a href="https://habr.com/ru/users/vibah_dev/" class="user_link">VIBaH_dev</a></p></div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bjavascript%5D" class="tm-tags-list__link">javascript</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hub/javascript/" class="tm-hubs-list__link">
    JavaScript
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 14: ↑10 и ↓4</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 14: ↑10 и ↓4" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+6</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">8.3K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    97
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/sharpfellow/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/d3f/fcd/711/d3ffcd711cd1629a4b4bdcaceb08abdc.jpg" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 31 голос " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    31
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><span class="tm-user-card__name tm-user-card__name_variant-article">Кирилл Матросов</span> <a href="/ru/users/sharpfellow/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @sharpfellow
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">Разработчик</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/452192/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 3 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <!----> <!----> <!----> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/452192/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/452192/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"452192":{"id":"452192","timePublished":"2019-05-17T09:41:11+00:00","isCorporative":false,"lang":"ru","titleHtml":"Какой здесь this? Внутренняя работа объектов JavaScript","leadData":{"textHtml":"\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fe7b\u002F99c\u002F5ab\u002Fe7b99c5ab4652dbe38cb0e5b6fa0da90.jpg\"\u003E\u003Cbr\u003E\r\n\u003Cem\u003EФотография: \"Любопытный\" Liliana Saeb (CC BY 2.0)\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003EJavaScript – это мультипарадигмальный язык, который поддерживает объектно-ориентированное программирование и динамическое связывание. Динамическое связывание — это мощная концепция, которая позволяет изменять структуру JavaScript кода во время выполнения, но эти дополнительные мощность и гибкость достигаются ценой некоторой путаницы, большая часть которой связана с поведением \u003Ccode\u003Ethis\u003C\u002Fcode\u003E в JavaScript.\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Ch1 id=\"dinamicheskoe-svyazyvanie\"\u003EДинамическое связывание\u003C\u002Fh1\u003E\u003Cbr\u003E\r\n\u003Cp\u003EПри динамическом связывании определение метода для вызова происходит во время выполнения, а не во время компиляции. JavaScript выполняет это с помощью \u003Ccode\u003Ethis\u003C\u002Fcode\u003E и цепочки прототипов. В частности, внутри метода \u003Ccode\u003Ethis\u003C\u002Fcode\u003E определяется во время вызова, и значение \u003Ccode\u003Ethis\u003C\u002Fcode\u003E будет разным в зависимости от того, как метод был определен.\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003EДавайте сыграем в игру. Я называю её \"Какой здесь \u003Ccode\u003Ethis\u003C\u002Fcode\u003E?\"\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше →","image":null},"editorVersion":"1.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Eric Elliott","originalUrl":"https:\u002F\u002Fmedium.com\u002Fjavascript-scene\u002Fwhat-is-this-the-inner-workings-of-javascript-objects-d397bfa0708a"}}],"author":{"scoreStats":{"score":31,"votesCount":31},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"890849","alias":"sharpfellow","fullname":"Кирилл Матросов","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Fd3f\u002Ffcd\u002F711\u002Fd3ffcd711cd1629a4b4bdcaceb08abdc.jpg","speciality":"Разработчик"},"statistics":{"commentsCount":3,"favoritesCount":97,"readingCount":8283,"score":6,"votesCount":14},"hubs":[{"relatedData":null,"id":"357","alias":"javascript","type":"collective","title":"JavaScript","titleHtml":"JavaScript","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fe7b\u002F99c\u002F5ab\u002Fe7b99c5ab4652dbe38cb0e5b6fa0da90.jpg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fe7b\u002F99c\u002F5ab\u002Fe7b99c5ab4652dbe38cb0e5b6fa0da90.jpg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cem\u003EФотография: \"Любопытный\" Liliana Saeb (CC BY 2.0)\u003C\u002Fem\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EJavaScript – это мультипарадигмальный язык, который поддерживает объектно-ориентированное программирование и динамическое связывание. Динамическое связывание — это мощная концепция, которая позволяет изменять структуру JavaScript кода во время выполнения, но эти дополнительные мощность и гибкость достигаются ценой некоторой путаницы, большая часть которой связана с поведением \u003Ccode\u003Ethis\u003C\u002Fcode\u003E в JavaScript.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch1 id=\"dinamicheskoe-svyazyvanie\"\u003EДинамическое связывание\u003C\u002Fh1\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПри динамическом связывании определение метода для вызова происходит во время выполнения, а не во время компиляции. JavaScript выполняет это с помощью \u003Ccode\u003Ethis\u003C\u002Fcode\u003E и цепочки прототипов. В частности, внутри метода \u003Ccode\u003Ethis\u003C\u002Fcode\u003E определяется во время вызова, и значение \u003Ccode\u003Ethis\u003C\u002Fcode\u003E будет разным в зависимости от того, как метод был определен.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EДавайте сыграем в игру. Я называю её \"Какой здесь \u003Ccode\u003Ethis\u003C\u002Fcode\u003E?\"\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003Econst a = {\n  a: 'a'\n};\nconst obj = {\n  getThis: () =\u003E this,\n  getThis2 () {\n    return this;\n  }\n};\nobj.getThis3 = obj.getThis.bind(obj);\nobj.getThis4 = obj.getThis2.bind(obj);\nconst answers = [\n  obj.getThis(),\n  obj.getThis.call(a),\n  obj.getThis2(),\n  obj.getThis2.call(a),\n  obj.getThis3(),\n  obj.getThis3.call(a),\n  obj.getThis4(),\n  obj.getThis4.call(a)\n];\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПодумайте, какими будут значения в массиве \u003Ccode\u003Eanswers\u003C\u002Fcode\u003E и проверьте свои ответы с помощью \u003Ccode\u003Econsole.log()\u003C\u002Fcode\u003E. Угадали?\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EНачнем с первого случая и продолжим по порядку. \u003Ccode\u003Eobj.getThis()\u003C\u002Fcode\u003E возвращает \u003Ccode\u003Eundefined\u003C\u002Fcode\u003E, но почему? У стрелочных функций никогда не бывает своего \u003Ccode\u003Ethis\u003C\u002Fcode\u003E. Вместо этого они всегда берут \u003Ccode\u003Ethis\u003C\u002Fcode\u003E из лексической области видимости (\u003Cem\u003Eприм. \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fazat-io\u002Fyou-dont-know-js-ru\u002Fblob\u002Fmaster\u002Fthis%20%26%20object%20prototypes\u002Fch2.md#%D0%BB%D0%B5%D0%BA%D1%81%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9-this\"\u003Eлексический this\u003C\u002Fa\u003E\u003C\u002Fem\u003E). Для корня модуля ES6 лексическая область будет иметь неопределенное (\u003Ccode\u003Eundefined\u003C\u002Fcode\u003E) значение \u003Ccode\u003Ethis\u003C\u002Fcode\u003E. \u003Ccode\u003Eobj.getThis.call(a)\u003C\u002Fcode\u003E также не определен по той же причине. Для стрелочной функций \u003Ccode\u003Ethis\u003C\u002Fcode\u003E не может быть переопределён, даже с \u003Ccode\u003E.call()\u003C\u002Fcode\u003E или \u003Ccode\u003E.bind()\u003C\u002Fcode\u003E. \u003Ccode\u003Ethis\u003C\u002Fcode\u003E всегда будет браться из лексической области.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003Ccode\u003Eobj.getThis2()\u003C\u002Fcode\u003E получает привязку в процессе вызова метода. Если до этого привязки \u003Ccode\u003Ethis\u003C\u002Fcode\u003E для этой функции не было, то ей можно привязать \u003Ccode\u003Ethis\u003C\u002Fcode\u003E (так как это не стрелочная функция). В данном случае \u003Ccode\u003Ethis\u003C\u002Fcode\u003E является объект \u003Ccode\u003Eobj\u003C\u002Fcode\u003E, привязываемый в момент вызова метода с помощью \u003Ccode\u003E.\u003C\u002Fcode\u003E или \u003Ccode\u003E[squareBracket]\u003C\u002Fcode\u003E синтаксиса доступа к свойству. (\u003Cem\u003Eприм. \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fazat-io\u002Fyou-dont-know-js-ru\u002Fblob\u002Fmaster\u002Fthis%20%26%20object%20prototypes\u002Fch2.md#%D0%BD%D0%B5%D1%8F%D0%B2%D0%BD%D0%B0%D1%8F-%D0%BF%D1%80%D0%B8%D0%B2%D1%8F%D0%B7%D0%BA%D0%B0\"\u003Eнеявная привязка\u003C\u002Fa\u003E\u003C\u002Fem\u003E)\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003Ccode\u003Eobj.getThis2.call(a)\u003C\u002Fcode\u003E немного сложнее. Метод \u003Ccode\u003Ecall()\u003C\u002Fcode\u003E вызывает функцию с заданным значением this и необязательными аргументами. Другими словами, метод получает привязку \u003Ccode\u003Ethis\u003C\u002Fcode\u003E из параметра \u003Ccode\u003E.call()\u003C\u002Fcode\u003E, поэтому \u003Ccode\u003Eobj.getThis2.call(a)\u003C\u002Fcode\u003E возвращает объект \u003Ccode\u003Ea\u003C\u002Fcode\u003E. (\u003Cem\u003Eприм. \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fazat-io\u002Fyou-dont-know-js-ru\u002Fblob\u002Fmaster\u002Fthis%20%26%20object%20prototypes\u002Fch2.md#%D1%8F%D0%B2%D0%BD%D0%B0%D1%8F-%D0%BF%D1%80%D0%B8%D0%B2%D1%8F%D0%B7%D0%BA%D0%B0\"\u003Eявная привязка\u003C\u002Fa\u003E\u003C\u002Fem\u003E)\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EВ случае \u003Ccode\u003Eobj.getThis3 = obj.getThis.bind(obj);\u003C\u002Fcode\u003E мы пытаемся получить стрелочную функцию с привязанным \u003Ccode\u003Ethis\u003C\u002Fcode\u003E, что, как мы уже выяснили, не будет работать, поэтому мы получим \u003Ccode\u003Eundefined\u003C\u002Fcode\u003E для \u003Ccode\u003Eobj.getThis3()\u003C\u002Fcode\u003E и \u003Ccode\u003Eobj.getThis3.call(a)\u003C\u002Fcode\u003E соответственно.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EДля обычных методов вы можете делать привязку, поэтому \u003Ccode\u003Eobj.getThis4()\u003C\u002Fcode\u003E возвращает \u003Ccode\u003Eobj\u003C\u002Fcode\u003E, как и ожидалось. Он уже получил свою привязку здесь \u003Ccode\u003Eobj.getThis4 = obj.getThis2.bind(obj);\u003C\u002Fcode\u003E, а \u003Ccode\u003Eobj.getThis4.call(a)\u003C\u002Fcode\u003E учитывает первую привязку и возвращает \u003Ccode\u003Eobj\u003C\u002Fcode\u003E вместо \u003Ccode\u003Ea\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch1 id=\"kruchenyy-myach\"\u003EКрученый мяч\u003C\u002Fh1\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EРешим ту же задачу, но на этот раз для описания объекта используем \u003Ccode\u003Eclass\u003C\u002Fcode\u003E с публичными полями (\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ftc39\u002Fproposal-class-fields\"\u003Eнововведения Stage 3\u003C\u002Fa\u003E на момент написания этой статьи доступны в Chrome по умолчанию и с \u003Ccode\u003E@babel\u002Fplugin-offer-class-properties\u003C\u002Fcode\u003E):\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003Eclass Obj {\n  getThis = () =\u003E this\n  getThis2 () {\n    return this;\n  }\n}\nconst obj2 = new Obj();\nobj2.getThis3 = obj2.getThis.bind(obj2);\nobj2.getThis4 = obj2.getThis2.bind(obj2);\nconst answers2 = [\n  obj2.getThis(),\n  obj2.getThis.call(a),\n  obj2.getThis2(),\n  obj2.getThis2.call(a),\n  obj2.getThis3(),\n  obj2.getThis3.call(a),\n  obj2.getThis4(),\n  obj2.getThis4.call(a)\n];\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПодумайте над ответами, прежде чем продолжить.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EГотовы?\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EВсе вызовы, кроме \u003Ccode\u003Eobj2.getThis2.call(a)\u003C\u002Fcode\u003E, возвращают экземпляр объекта. \u003Ccode\u003Eobj2.getThis2.call(a)\u003C\u002Fcode\u003E возвращает \u003Ccode\u003Ea\u003C\u002Fcode\u003E. Стрелочные функции всё так же получают \u003Ccode\u003Ethis\u003C\u002Fcode\u003E из лексического окружения. Существует разница в том, как \u003Ccode\u003Ethis\u003C\u002Fcode\u003E из лексического окружения определяется для свойств класса. Внутри инициализация свойств класса выглядит примерно так:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003Eclass Obj {\n  constructor() {\n    this.getThis = () =\u003E this;\n  }\n...\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EДругими словами, стрелочная функция определяется внутри контекста конструктора. Так как это класс, то единственный способ создать экземпляр – это использовать ключевое слово \u003Ccode\u003Enew\u003C\u002Fcode\u003E (опущение \u003Ccode\u003Enew\u003C\u002Fcode\u003E приведет к ошибке). Одна из самых важных вещей, которые делает ключевое слово \u003Ccode\u003Enew\u003C\u002Fcode\u003E, – это создание нового экземпляра объекта и привязка \u003Ccode\u003Ethis\u003C\u002Fcode\u003E к нему в конструкторе. Это поведение в сочетании с другими поведениями, которые мы уже упоминали выше, должно объяснить остальное.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch1 id=\"zaklyuchenie\"\u003EЗаключение\u003C\u002Fh1\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EУ вас всё получилось? Хорошее понимание того, как \u003Ccode\u003Ethis\u003C\u002Fcode\u003E ведёт себя в JavaScript, сэкономит вам много времени на отладку сложных проблем. Если вы ошиблись в ответах, это значит, что вам нужно немного попрактиковаться. Потренируйтесь с примерами, затем вернитесь и проверьте себя снова, пока вы не сможете выполнить тест и объяснить кому-то ещё, почему методы возвращают то, что возвращают.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЕсли это было сложнее, чем вы ожидали, то вы не одиноки. Я спрашивал достаточно много разработчиков на эту тему и думаю, что пока только один из них справился с данной задачей.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EТо, что начиналось как поиск динамических методов, которые вы могли перенаправить с помощью \u003Ccode\u003E.call()\u003C\u002Fcode\u003E, \u003Ccode\u003E.bind()\u003C\u002Fcode\u003E или \u003Ccode\u003E.apply()\u003C\u002Fcode\u003E, стало значительно сложнее с добавлением методов класса и стрелочных функций. Возможно, вам стоит ещё раз заострить на этом внимание. Помните, что стрелочные функции всегда берут \u003Ccode\u003Ethis\u003C\u002Fcode\u003E из лексической области видимости, и \u003Ccode\u003Eclass\u003C\u002Fcode\u003E \u003Ccode\u003Ethis\u003C\u002Fcode\u003E на самом деле лексически ограничен конструктором класса под капотом. Если вы когда-либо засомневаетесь в \u003Ccode\u003Ethis\u003C\u002Fcode\u003E, то помните, что можно использовать отладчик (debugger), чтобы проверить его значение.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПомните, что в решении многих задач на JavaScript можно обойтись без \u003Ccode\u003Ethis\u003C\u002Fcode\u003E. По моему опыту, почти всё может быть переопределено в терминах \u003Ca href=\"https:\u002F\u002Fmedium.com\u002Fjavascript-scene\u002Fmaster-the-javascript-interview-what-is-a-pure-function-d1c076bec976\"\u003Eчистых функций\u003C\u002Fa\u003E, которые принимают все используемые аргументы как явные параметры (\u003Ccode\u003Ethis\u003C\u002Fcode\u003E можно представить себе как неявную переменную). Логика, описанная через чистые функции, является детерминированной, что делает ее более тестируемой. Также при таком подходе нет побочных эффектов, поэтому, в отличие от моментов манипуляции с \u003Ccode\u003Ethis\u003C\u002Fcode\u003E, вы вряд ли что-то сломаете. Каждый раз, когда \u003Ccode\u003Ethis\u003C\u002Fcode\u003E устанавливается, что-то зависящее от его значения может сломаться.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EТем не менее, иногда \u003Ccode\u003Ethis\u003C\u002Fcode\u003E полезен. Например, для обмена методами между большим количеством объектов. Даже в функциональном программировании \u003Ccode\u003Ethis\u003C\u002Fcode\u003E можно использовать для доступа к другим методам объекта, чтобы реализовать алгебраические преобразования, необходимые для построения новых алгебр поверх существующих. Так, универсальный \u003Ccode\u003E.flatMap()\u003C\u002Fcode\u003E может быть получен с помощью \u003Ccode\u003Ethis.map()\u003C\u002Fcode\u003E и \u003Ccode\u003Ethis.constructor.of()\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Chr\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EСпасибо за помощь с переводом \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fusers\u002Fwksmirnowa\u002F\" class=\"user_link\"\u003Ewksmirnowa\u003C\u002Fa\u003E и \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fusers\u002Fvibah_dev\u002F\" class=\"user_link\"\u003EVIBaH_dev\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"javascript"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F452192\u002F520ce0ba0b27e99eb3214b05d908bb11\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F452192\u002F520ce0ba0b27e99eb3214b05d908bb11\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F452192\\\u002F\"},\"headline\":\"Какой здесь this? Внутренняя работа объектов JavaScript\",\"datePublished\":\"2019-05-17T12:41:11+03:00\",\"dateModified\":\"2019-05-18T00:16:29+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Кирилл Матросов\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Фотография: &quot;Любопытный&quot; Liliana Saeb (CC BY 2.0) JavaScript &ndash; это мультипарадигмальный язык, который поддерживает объектно-ориентированное программирование и д...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F452192\\\u002F#post-content-body\",\"about\":[\"h_javascript\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fe7b\\\u002F99c\\\u002F5ab\\\u002Fe7b99c5ab4652dbe38cb0e5b6fa0da90.jpg\"]}","metaDescription":"Фотография: &quot;Любопытный&quot; Liliana Saeb (CC BY 2.0)\r\nJavaScript – это мультипарадигмальный язык, который поддерживает объектно-ориентированное программирование и динамическое связывание. Динамическое...","mainImageUrl":null,"amp":false},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":"javascript"},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
