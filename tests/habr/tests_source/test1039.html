<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Решето Эратосфена за O(n). Доказательство / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/452388\/"},"headline":"Решето Эратосфена за O(n). Доказательство","datePublished":"2019-05-18T18:26:04+03:00","dateModified":"2019-05-19T09:39:57+03:00","author":{"@type":"Person","name":"Илья"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"В комментариях к одному из прошлых постов о решете Эратосфена был упомянут этот короткий алгоритм из Википедии:  Алгоритм 1:  1: для i := 2, 3, 4, ..., до n:  2:...","url":"https:\/\/habr.com\/ru\/post\/452388\/#post-content-body","about":["h_algorithms","h_maths","f_develop"],"image":["https:\/\/habrastorage.org\/getpro\/habr\/formulas\/02b\/dfc\/375\/02bdfc3750046889d15b3f933014870b.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/e81\/05d\/645\/e8105d6450fa00dea7268194bbe06f73.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/d13\/8e2\/791\/d138e279182c2dcc08e8cfdeaa830b3c.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/977\/f77\/6ba\/977f776ba8d8613d5e7ea1e55032b98b.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/060\/3bf\/7c8\/0603bf7c8b26a4e9be3cca2090c2c2b9.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/a59\/fe7\/393\/a59fe7393705abb887943a6b0ec857f1.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/fcd\/95b\/733\/fcd95b733d8b0645f163bed9d9d1a626.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/5c0\/cc4\/159\/5c0cc41597d610d0db1298a731c73a52.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/560\/a32\/7a8\/560a327a85cd15cd5587eb69b602d69d.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/2bf\/c1d\/137\/2bfc1d137c3fb56e53eefe664353856b.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/817\/b92\/407\/817b92407f764f57af9226e50cc788fd.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/eac\/a7c\/240\/eaca7c240004f77c414c5b14cffd187e.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/3a3\/086\/d5b\/3a3086d5be532b93301afea91574367d.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/44b\/ef8\/f19\/44bef8f19a206ae65b72550770098b72.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/3e7\/3d6\/ca2\/3e73d6ca2dc6a37c4f0968fdca7a364f.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/2ef\/c54\/d10\/2efc54d10946611d6d325aae6ae54c78.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/d4f\/55a\/37f\/d4f55a37fb733b176d0ef014591e1b35.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/801\/347\/180\/8013471806cae0425b5b7024ac6a62b7.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/586\/33b\/b64\/58633bb64cd4723dbb2aa5632b677b3d.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/a65\/3e7\/3a5\/a653e73a542d1c7f56a8d74552d5738a.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/7f8\/e7f\/333\/7f8e7f3332a123755040c13e771d0ff0.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/06a\/20b\/48c\/06a20b48ca6eaecce1d81f4a689d2703.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/8ab\/d56\/6f8\/8abd566f810f859542c697c0dd74a668.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/dd7\/1b5\/8a8\/dd71b58a833ce5d26aac3a7754586480.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/eaa\/348\/f7f\/eaa348f7f6abc4d3b3906a0c96c47ba9.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/516\/e64\/e1a\/516e64e1a440ed1640f060ef05b5f0fd.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/d62\/28d\/34e\/d6228d34e6c3f712b156d35c0802dce3.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/349\/849\/b50\/349849b50425d998c3dc1aadd37c2b93.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/efc\/828\/247\/efc828247eb0679d26aa0e5a01632a00.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/0a9\/e7b\/f4e\/0a9e7bf4e6559b7e9352fda6a7b7bafe.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/0ca\/361\/aa4\/0ca361aa48d4799fb7686af7579dc796.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/418\/b2d\/8d9\/418b2d8d9230e4f1f3df61bd3ceb86cd.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/ff6\/04a\/b65\/ff604ab6579f6cf7daabaa1cdff777c8.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/dbd\/5ea\/703\/dbd5ea7032f99fbdecf33b3a21617b5b.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/b27\/d74\/77e\/b27d7477eeda2812746ab4d729077d5f.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/e07\/a70\/b2e\/e07a70b2e81c7d4f8df415f4b415fba9.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/372\/e18\/546\/372e18546a3b7abb94c2672708bc5dfe.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/280\/5e8\/92e\/2805e892eebbdf5c39bcb426884209d0.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/244\/374\/3b1\/2443743b138792126e9b9277fbb8c2d3.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/ddc\/2ca\/e36\/ddc2cae36c09b90b6c8b91b29068bdd2.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/733\/25d\/085\/73325d085bc9659eabf0b8804bf6796c.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/dd8\/d63\/095\/dd8d630951e6ff67fbbb16ade3f02497.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/4eb\/bf4\/c94\/4ebbf4c940a0375af2698eafc467e9a0.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/894\/07f\/4f7\/89407f4f7addfcad6ad85de37a39aea7.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/066\/939\/a33\/066939a33475dd671b845469b6526972.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/839\/f25\/c27\/839f25c2746382debd4f08ea25ad5ecf.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/7ec\/b89\/eb5\/7ecb89eb5acb1c60dfb7bf6aa9eaa1dc.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/bc1\/6b1\/ad3\/bc16b1ad37ecec8c13baaf5609147dfe.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/815\/2c1\/5d1\/8152c15d125c2926c5a5c5f1d0da83a5.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/140\/ee9\/c3a\/140ee9c3a7374f861ed4893cb2c31187.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/889\/6d0\/813\/8896d08134e06ca8bc28a70c87939430.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/51b\/950\/bdd\/51b950bddf86a5dc8bbb5a0279eb6669.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/01b\/908\/b14\/01b908b14dd83417aaa7f68e6ebc0807.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/f52\/1e2\/ce7\/f521e2ce7660cbc4a288c72ed888cede.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/c92\/b75\/6e0\/c92b756e0ca91fa6abbd3eae84028dde.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/528\/93d\/a51\/52893da514fda59ff70f659d44aef0ea.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/7a6\/be0\/b10\/7a6be0b10afeba54f9b8dd92b01a1e69.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/de4\/d0b\/31c\/de4d0b31c7b88f130e69ce5ef3a4c11c.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/533\/68f\/2c3\/53368f2c381e8ba223a39bc53492a57f.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/733\/6e5\/3cc\/7336e53cce90a4b1aa66034a9bb44f3e.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/008\/cb1\/58f\/008cb158fcd62476e06e59ed734581a4.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/a83\/775\/df8\/a83775df86617bd50c82503d962c0929.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/542\/de2\/b2a\/542de2b2ab7769a6998435cf5f80bb02.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/f11\/ac4\/8c1\/f11ac48c1bfa053016ab1f5581768c6c.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/724\/ac7\/1c7\/724ac71c77b2d7e8968d6c76096eb3e3.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/e9c\/691\/44a\/e9c69144ab9c51491136a1ddd92b78a7.svg"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Решето Эратосфена за O(n). Доказательство" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Решето Эратосфена за O(n). Доказательство" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Решето Эратосфена за O(n). Доказательство" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="В комментариях к одному из прошлых постов о решете Эратосфена был упомянут этот короткий алгоритм из Википедии:

Алгоритм 1:

1: для i := 2, 3, 4, ..., до n: 
2:  если lp[i] = 0:
3:       lp[i] :=..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="В комментариях к одному из прошлых постов о решете Эратосфена был упомянут этот короткий алгоритм из Википедии:

Алгоритм 1:

1: для i := 2, 3, 4, ..., до n: 
2:  если lp[i] = 0:
3:       lp[i] :=..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="В комментариях к одному из прошлых постов о решете Эратосфена был упомянут этот короткий алгоритм из Википедии:

Алгоритм 1:

1: для i := 2, 3, 4, ..., до n: 
2:  если lp[i] = 0:
3:       lp[i] :=..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="В комментариях к одному из прошлых постов о решете Эратосфена был упомянут этот короткий алгоритм из Википедии:

Алгоритм 1:

1: для i := 2, 3, 4, ..., до n: 
2:  если lp[i] = 0:
3:       lp[i] :=..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="В комментариях к одному из прошлых постов о решете Эратосфена был упомянут этот короткий алгоритм из Википедии:

Алгоритм 1:

1: для i := 2, 3, 4, ..., до n: 
2:  если lp[i] = 0:
3:       lp[i] :=..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/452388/822bc37d61becbc0f80c5ab92ab63d88/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/452388/822bc37d61becbc0f80c5ab92ab63d88/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/452388/822bc37d61becbc0f80c5ab92ab63d88/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/452388/822bc37d61becbc0f80c5ab92ab63d88/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/452388/822bc37d61becbc0f80c5ab92ab63d88/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="452388" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2019-05-18T15:26:04.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/452388/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/452388/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/452388/822bc37d61becbc0f80c5ab92ab63d88/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/wataru/" title="wataru" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" loading="lazy" src="//habrastorage.org/r/w32/getpro/habr/avatars/67f/de9/0ed/67fde90edd570521bf200be0295497d9.png" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/wataru/" class="tm-user-info__username">
      wataru
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2019-05-18T15:26:04.000Z" title="2019-05-18, 18:26">18  мая  2019 в 18:26</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Решето Эратосфена за O(n). Доказательство</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/algorithms/" class="tm-article-snippet__hubs-item-link"><span>Алгоритмы</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/maths/" class="tm-article-snippet__hubs-item-link"><span>Математика</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <!----> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml">В комментариях к одному из прошлых <a href="https://habr.com/ru/post/450604/">постов</a> о решете Эратосфена был упомянут этот короткий алгоритм из <a href="https://ru.wikipedia.org/wiki/%D0%A0%D0%B5%D1%88%D0%B5%D1%82%D0%BE_%D0%AD%D1%80%D0%B0%D1%82%D0%BE%D1%81%D1%84%D0%B5%D0%BD%D0%B0#%D0%A0%D0%B5%D1%88%D0%B5%D1%82%D0%BE_%D0%AD%D1%80%D0%B0%D1%82%D0%BE%D1%81%D1%84%D0%B5%D0%BD%D0%B0_%D1%81_%D0%BB%D0%B8%D0%BD%D0%B5%D0%B9%D0%BD%D1%8B%D0%BC_%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B5%D0%BC_%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B">Википедии</a>:<br/>
<br/>
<b>Алгоритм 1:</b><br/>
<br/>
<pre><code class="cpp">1: для i := 2, 3, 4, ..., до n: 
2:  если lp[i] = 0:
3:       lp[i] := i
4:       pr[] += {i}
5:   для p из pr пока p ≤ lp[i] и p*i ≤ n:
6:       lp[p*i] := p
Результат:
 lp - минимальный простой делитель для кажого числа до n
 pr - список всех простых до n.
</code></pre><br/>
Алгоритм простой, но не всем он показался очевидным. Главная же проблема в том, что на Википедии нет доказательства, а <a href="https://ru.wikipedia.org/wiki/%D0%A0%D0%B5%D1%88%D0%B5%D1%82%D0%BE_%D0%AD%D1%80%D0%B0%D1%82%D0%BE%D1%81%D1%84%D0%B5%D0%BD%D0%B0#cite_note-13">ссылка </a>на первоисточник (<a href="https://www.cs.utexas.edu/users/misra/scannedPdf.dir/linearSieve.pdf">pdf</a>) содержит довольно сильно отличающийся от приведенного выше алгоритм.<br/>
<br/>
В этом посте я попытаюсь, надеюсь, доступно доказать, что этот алгоритм не только работает, но и делает это за линейную сложность.<br/>
<a name="habracut"></a><br/>
<div class="spoiler"><b class="spoiler_title">Примечание о сложности алгоритма</b><div class="spoiler_text">Хоть этот алгоритм и асимптотически быстрее стандартного <a href="https://ru.wikipedia.org/wiki/%D0%A0%D0%B5%D1%88%D0%B5%D1%82%D0%BE_%D0%AD%D1%80%D0%B0%D1%82%D0%BE%D1%81%D1%84%D0%B5%D0%BD%D0%B0#%D0%9F%D1%81%D0%B5%D0%B2%D0%B4%D0%BE%D0%BA%D0%BE%D0%B4">решета</a> Эратосфена за O(n log log n), ему требуется гораздо больше памяти. Поэтому для по-настоящему больших n, где бы этот алгоритм засиял во всей красе, он не применим. Однако, он очень полезен даже для небольших n, если вам надо не только найти все простые числа, но и быстро раскладывать на множители все числа до n.<br/>
</div></div><br/>
<h3>Определения</h3><br/>
<img src="https://habrastorage.org/getpro/habr/formulas/02b/dfc/375/02bdfc3750046889d15b3f933014870b.svg" alt="$\mathcal{P}$" data-tex="inline"/> — множество простых чисел.<br/>
<img src="https://habrastorage.org/getpro/habr/formulas/e81/05d/645/e8105d6450fa00dea7268194bbe06f73.svg" alt="$lp(x)$" data-tex="inline"/> — минимальный простой делитель числа: <img src="https://habrastorage.org/getpro/habr/formulas/d13/8e2/791/d138e279182c2dcc08e8cfdeaa830b3c.svg" alt="$lp(x) = min \{p \in \mathcal{P}\ \vert\ p\vert x \}$" data-tex="inline"/><br/>
<img src="https://habrastorage.org/getpro/habr/formulas/977/f77/6ba/977f776ba8d8613d5e7ea1e55032b98b.svg" alt="$rd(x)$" data-tex="inline"/> — остальные множители: <img src="https://habrastorage.org/getpro/habr/formulas/060/3bf/7c8/0603bf7c8b26a4e9be3cca2090c2c2b9.svg" alt="$rd(x) = x / lp(x)$" data-tex="inline"/><br/>
<br/>
Обратите внимание, все определения выше даны для <img src="https://habrastorage.org/getpro/habr/formulas/a59/fe7/393/a59fe7393705abb887943a6b0ec857f1.svg" alt="$x \ge 2$" data-tex="inline"/>.<br/>
<br/>
Некоторые очевидные свойства введенных выше функций, которые будут использоваться дальше:<br/>
<img src="https://habrastorage.org/getpro/habr/formulas/fcd/95b/733/fcd95b733d8b0645f163bed9d9d1a626.svg" alt="$lp(a\times b) = min(lp(a), lp(b))$" data-tex="inline"/><br/>
<img src="https://habrastorage.org/getpro/habr/formulas/5c0/cc4/159/5c0cc41597d610d0db1298a731c73a52.svg" alt="$rd(x) &lt; x$" data-tex="inline"/><br/>
<img src="https://habrastorage.org/getpro/habr/formulas/560/a32/7a8/560a327a85cd15cd5587eb69b602d69d.svg" alt="$p \in \mathcal{P} => lp(p) = p$" data-tex="inline"/><br/>
<br/>
<h3>Доказательство</h3><br/>
<b>Лемма 1</b>: <img src="https://habrastorage.org/getpro/habr/formulas/2bf/c1d/137/2bfc1d137c3fb56e53eefe664353856b.svg" alt="$lp(x) \le lp(rd(x)), \forall x \notin \mathcal{P}, x>1$" data-tex="inline"/><br/>
<b>Доказательство</b>: Т.к. любой делитель <img src="https://habrastorage.org/getpro/habr/formulas/977/f77/6ba/977f776ba8d8613d5e7ea1e55032b98b.svg" alt="$rd(x)$" data-tex="inline"/> также является делителем <img src="https://habrastorage.org/getpro/habr/formulas/817/b92/407/817b92407f764f57af9226e50cc788fd.svg" alt="$x$" data-tex="inline"/>, а <img src="https://habrastorage.org/getpro/habr/formulas/e81/05d/645/e8105d6450fa00dea7268194bbe06f73.svg" alt="$lp(x)$" data-tex="inline"/> не превосходит любой делитель <img src="https://habrastorage.org/getpro/habr/formulas/817/b92/407/817b92407f764f57af9226e50cc788fd.svg" alt="$x$" data-tex="inline"/>, то <img src="https://habrastorage.org/getpro/habr/formulas/e81/05d/645/e8105d6450fa00dea7268194bbe06f73.svg" alt="$lp(x)$" data-tex="inline"/> не превосходит и любой делитель <img src="https://habrastorage.org/getpro/habr/formulas/977/f77/6ba/977f776ba8d8613d5e7ea1e55032b98b.svg" alt="$rd(x)$" data-tex="inline"/>, включая наименьший из них. Единственная проблема в этом утверждении, если <img src="https://habrastorage.org/getpro/habr/formulas/977/f77/6ba/977f776ba8d8613d5e7ea1e55032b98b.svg" alt="$rd(x)$" data-tex="inline"/> не имеет простых делителей, но это возможно только в случае <img src="https://habrastorage.org/getpro/habr/formulas/eac/a7c/240/eaca7c240004f77c414c5b14cffd187e.svg" alt="$x \in \mathcal{P}$" data-tex="inline"/>, который исключен в условии леммы. <br/>
<img src="https://habrastorage.org/getpro/habr/formulas/3a3/086/d5b/3a3086d5be532b93301afea91574367d.svg" alt="$\square$" data-tex="inline"/><br/>
<br/>
Пусть <img src="https://habrastorage.org/getpro/habr/formulas/44b/ef8/f19/44bef8f19a206ae65b72550770098b72.svg" alt="$E = \{(lp(x), rd(x)) \vert \forall x \notin \mathcal{P}, 2\le x \le n\}$" data-tex="inline"/><br/>
<br/>
Т.к. <img src="https://habrastorage.org/getpro/habr/formulas/3e7/3d6/ca2/3e73d6ca2dc6a37c4f0968fdca7a364f.svg" alt="$lp(x)\times rd(x) = x$" data-tex="inline"/> (по определению <img src="https://habrastorage.org/getpro/habr/formulas/2ef/c54/d10/2efc54d10946611d6d325aae6ae54c78.svg" alt="$rd()$" data-tex="inline"/>), если бы нам было дано множество <img src="https://habrastorage.org/getpro/habr/formulas/d4f/55a/37f/d4f55a37fb733b176d0ef014591e1b35.svg" alt="$E$" data-tex="inline"/>, то мы смогли бы вычислить <img src="https://habrastorage.org/getpro/habr/formulas/801/347/180/8013471806cae0425b5b7024ac6a62b7.svg" alt="$lp()$" data-tex="inline"/> для всех составных чисел до n. Это делает, например, следующий алгоритм:<br/>
<br/>
<b>Алгоритм 2:</b><br/>
<br/>
<pre><code class="cpp">1: Для всех (l,r) из E:
2:    lp[l*r] := l;
</code></pre><br/>
Заметим, что <img src="https://habrastorage.org/getpro/habr/formulas/586/33b/b64/58633bb64cd4723dbb2aa5632b677b3d.svg" alt="$\vert E \vert \le n$" data-tex="inline"/>, поэтому алгоритм 2 выше работает за линейную сложность.<br/>
<br/>
Далее я докажу, что алгоритм 1 из Википедии на самом деле просто перебирает все элементы этого множества, ведь его можно параметризовать и по-другому.<br/>
<br/>
Пусть <img src="https://habrastorage.org/getpro/habr/formulas/a65/3e7/3a5/a653e73a542d1c7f56a8d74552d5738a.svg" alt="$E' = \{(p, r) \vert p \in \mathcal{P}, 2\le r &lt; n, p \le lp(r), p \times r \le n\}$" data-tex="inline"/><br/>
<br/>
<b>Лемма 2</b>: <img src="https://habrastorage.org/getpro/habr/formulas/7f8/e7f/333/7f8e7f3332a123755040c13e771d0ff0.svg" alt="$E = E'$" data-tex="inline"/><br/>
<b>Доказательство</b>: <br/>
<br/>
Пусть <img src="https://habrastorage.org/getpro/habr/formulas/06a/20b/48c/06a20b48ca6eaecce1d81f4a689d2703.svg" alt="$(a,b)\in E$" data-tex="inline"/> => <img src="https://habrastorage.org/getpro/habr/formulas/8ab/d56/6f8/8abd566f810f859542c697c0dd74a668.svg" alt="$\exists x \notin \mathcal{P},\ 2\le x\le n \mid a=lp(x), b=rd(x)$" data-tex="inline"/>. <br/>
<br/>
По определению <img src="https://habrastorage.org/getpro/habr/formulas/dd7/1b5/8a8/dd71b58a833ce5d26aac3a7754586480.svg" alt="$lp(), rd()$" data-tex="inline"/>: <img src="https://habrastorage.org/getpro/habr/formulas/eaa/348/f7f/eaa348f7f6abc4d3b3906a0c96c47ba9.svg" alt="$a \in \mathcal{P}$" data-tex="inline"/>, <img src="https://habrastorage.org/getpro/habr/formulas/516/e64/e1a/516e64e1a440ed1640f060ef05b5f0fd.svg" alt="$a\times b = x$" data-tex="inline"/>. По лемме 1, <img src="https://habrastorage.org/getpro/habr/formulas/d62/28d/34e/d6228d34e6c3f712b156d35c0802dce3.svg" alt="$a \le lp(b)$" data-tex="inline"/>. <br/>
т.к. <img src="https://habrastorage.org/getpro/habr/formulas/5c0/cc4/159/5c0cc41597d610d0db1298a731c73a52.svg" alt="$rd(x) &lt; x$" data-tex="inline"/>, то <img src="https://habrastorage.org/getpro/habr/formulas/349/849/b50/349849b50425d998c3dc1aadd37c2b93.svg" alt="$b &lt; n$" data-tex="inline"/>.<br/>
Поскольку <img src="https://habrastorage.org/getpro/habr/formulas/efc/828/247/efc828247eb0679d26aa0e5a01632a00.svg" alt="$x \notin \mathcal{P}$" data-tex="inline"/>, <img src="https://habrastorage.org/getpro/habr/formulas/0a9/e7b/f4e/0a9e7bf4e6559b7e9352fda6a7b7bafe.svg" alt="$b \ge 2$" data-tex="inline"/>. <br/>
Так же, по определению <img src="https://habrastorage.org/getpro/habr/formulas/d4f/55a/37f/d4f55a37fb733b176d0ef014591e1b35.svg" alt="$E$" data-tex="inline"/>, <img src="https://habrastorage.org/getpro/habr/formulas/0ca/361/aa4/0ca361aa48d4799fb7686af7579dc796.svg" alt="$x \le n$" data-tex="inline"/>, следовательно, <img src="https://habrastorage.org/getpro/habr/formulas/418/b2d/8d9/418b2d8d9230e4f1f3df61bd3ceb86cd.svg" alt="$a \times b \le n$" data-tex="inline"/>.<br/>
Все 4 условия <img src="https://habrastorage.org/getpro/habr/formulas/ff6/04a/b65/ff604ab6579f6cf7daabaa1cdff777c8.svg" alt="$E'$" data-tex="inline"/> выполнены, значит, <img src="https://habrastorage.org/getpro/habr/formulas/dbd/5ea/703/dbd5ea7032f99fbdecf33b3a21617b5b.svg" alt="$(a,b) \in E'$" data-tex="inline"/> => <img src="https://habrastorage.org/getpro/habr/formulas/b27/d74/77e/b27d7477eeda2812746ab4d729077d5f.svg" alt="$E \subset E'$" data-tex="inline"/>.<br/>
<br/>
Пусть <img src="https://habrastorage.org/getpro/habr/formulas/dbd/5ea/703/dbd5ea7032f99fbdecf33b3a21617b5b.svg" alt="$(a,b)\in E'$" data-tex="inline"/>. Пусть <img src="https://habrastorage.org/getpro/habr/formulas/e07/a70/b2e/e07a70b2e81c7d4f8df415f4b415fba9.svg" alt="$x = a \times b$" data-tex="inline"/>. <br/>
По определению <img src="https://habrastorage.org/getpro/habr/formulas/ff6/04a/b65/ff604ab6579f6cf7daabaa1cdff777c8.svg" alt="$E'$" data-tex="inline"/>, <img src="https://habrastorage.org/getpro/habr/formulas/eaa/348/f7f/eaa348f7f6abc4d3b3906a0c96c47ba9.svg" alt="$a \in \mathcal{P}$" data-tex="inline"/>. Значит, <img src="https://habrastorage.org/getpro/habr/formulas/372/e18/546/372e18546a3b7abb94c2672708bc5dfe.svg" alt="$a$" data-tex="inline"/> — простой делитеть <img src="https://habrastorage.org/getpro/habr/formulas/817/b92/407/817b92407f764f57af9226e50cc788fd.svg" alt="$x$" data-tex="inline"/>. <br/>
<img src="https://habrastorage.org/getpro/habr/formulas/280/5e8/92e/2805e892eebbdf5c39bcb426884209d0.svg" alt="$lp(x) = lp(a\times b) = min(lp(a), lp(b)) = min(a, lp(b)).$" data-tex="inline"/> <br/>
Т.к <img src="https://habrastorage.org/getpro/habr/formulas/d62/28d/34e/d6228d34e6c3f712b156d35c0802dce3.svg" alt="$a \le lp(b)$" data-tex="inline"/>, то <img src="https://habrastorage.org/getpro/habr/formulas/244/374/3b1/2443743b138792126e9b9277fbb8c2d3.svg" alt="$lp(x) = a.$" data-tex="inline"/> Значит, <img src="https://habrastorage.org/getpro/habr/formulas/ddc/2ca/e36/ddc2cae36c09b90b6c8b91b29068bdd2.svg" alt="$b = rd(x).$" data-tex="inline"/> <br/>
По определению, <img src="https://habrastorage.org/getpro/habr/formulas/733/25d/085/73325d085bc9659eabf0b8804bf6796c.svg" alt="$x = a \times b \le n.$" data-tex="inline"/> Также, очевидно, <img src="https://habrastorage.org/getpro/habr/formulas/dd8/d63/095/dd8d630951e6ff67fbbb16ade3f02497.svg" alt="$x = a \times b \ge 2.$" data-tex="inline"/><br/>
Все условия для <img src="https://habrastorage.org/getpro/habr/formulas/d4f/55a/37f/d4f55a37fb733b176d0ef014591e1b35.svg" alt="$E$" data-tex="inline"/> выполнены => <img src="https://habrastorage.org/getpro/habr/formulas/4eb/bf4/c94/4ebbf4c940a0375af2698eafc467e9a0.svg" alt="$E' \subset E.$" data-tex="inline"/><br/>
<br/>
Следовательно, <img src="https://habrastorage.org/getpro/habr/formulas/894/07f/4f7/89407f4f7addfcad6ad85de37a39aea7.svg" alt="$E = E'.$" data-tex="inline"/><br/>
<img src="https://habrastorage.org/getpro/habr/formulas/3a3/086/d5b/3a3086d5be532b93301afea91574367d.svg" alt="$\square$" data-tex="inline"/><br/>
<br/>
Теперь осталось перебрать правильные <img src="https://habrastorage.org/getpro/habr/formulas/066/939/a33/066939a33475dd671b845469b6526972.svg" alt="$r$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/839/f25/c27/839f25c2746382debd4f08ea25ad5ecf.svg" alt="$p$" data-tex="inline"/> из определения множества <img src="https://habrastorage.org/getpro/habr/formulas/ff6/04a/b65/ff604ab6579f6cf7daabaa1cdff777c8.svg" alt="$E'$" data-tex="inline"/> и применить алгоритм 2. Именно это и делает Алгоритм 1 (только вместо r используется переменная i). Но есть проблема! Что бы перебрать все элементы множества <img src="https://habrastorage.org/getpro/habr/formulas/ff6/04a/b65/ff604ab6579f6cf7daabaa1cdff777c8.svg" alt="$E'$" data-tex="inline"/> для вычисления <img src="https://habrastorage.org/getpro/habr/formulas/7ec/b89/eb5/7ecb89eb5acb1c60dfb7bf6aa9eaa1dc.svg" alt="$lp,$" data-tex="inline"/> нам надо знать <img src="https://habrastorage.org/getpro/habr/formulas/7ec/b89/eb5/7ecb89eb5acb1c60dfb7bf6aa9eaa1dc.svg" alt="$lp,$" data-tex="inline"/> ведь в определении есть условие <img src="https://habrastorage.org/getpro/habr/formulas/bc1/6b1/ad3/bc16b1ad37ecec8c13baaf5609147dfe.svg" alt="$p \le lp(r)$" data-tex="inline"/>. <br/>
<br/>
К счастью, эта проблема обходится правильным порядком перебора. Надо перебирать <img src="https://habrastorage.org/getpro/habr/formulas/066/939/a33/066939a33475dd671b845469b6526972.svg" alt="$r$" data-tex="inline"/> во внешнем цикле, а <img src="https://habrastorage.org/getpro/habr/formulas/839/f25/c27/839f25c2746382debd4f08ea25ad5ecf.svg" alt="$p$" data-tex="inline"/> — во внутреннем. Тогда <img src="https://habrastorage.org/getpro/habr/formulas/815/2c1/5d1/8152c15d125c2926c5a5c5f1d0da83a5.svg" alt="$lp(r)$" data-tex="inline"/> уже будет вычислено. Этот факт доказывает следующая теорема.<br/>
<br/>
<b>Теорема 1:</b><br/>
Алгоритм 1 поддерживает следующий инвариант: После выполнения итерации внешнего цикла при i=k, все простые числа до k включительно будут выделены в список pr. Также будет подсчитано <img src="https://habrastorage.org/getpro/habr/formulas/801/347/180/8013471806cae0425b5b7024ac6a62b7.svg" alt="$lp()$" data-tex="inline"/> для всех <img src="https://habrastorage.org/getpro/habr/formulas/140/ee9/c3a/140ee9c3a7374f861ed4893cb2c31187.svg" alt="$x \notin \mathcal{P} \mid x\le n,\ rd(x) \le k$" data-tex="inline"/> в массиве lp.<br/>
<br/>
<b>Доказательство</b>:<br/>
Докажем по индукции. Для k=2 инвариант проверяется вручную. Единственное простое число 2 будет добавлено в список pr, потому что массив lp[] изначально заполнен нулями. Также, единственное составное число у которого <img src="https://habrastorage.org/getpro/habr/formulas/889/6d0/813/8896d08134e06ca8bc28a70c87939430.svg" alt="$rd(x) \le 2$" data-tex="inline"/> — это 4. Несложно убедиться, что внутренний цикл выполнится ровно один раз (при n>3) и правильно выполнит lp[4] := 2.<br/>
<br/>
Теперь допустим, что инвариант выполняется для итерации i=k-1. Докажем, что он будет выполнятся и для итерации i=k.<br/>
<br/>
Для этого достаточно проверить что число i, если оно простое, будет добавлено в список pr и что <img src="https://habrastorage.org/getpro/habr/formulas/801/347/180/8013471806cae0425b5b7024ac6a62b7.svg" alt="$lp()$" data-tex="inline"/> будет подсчитано для всех составных чисел <img src="https://habrastorage.org/getpro/habr/formulas/51b/950/bdd/51b950bddf86a5dc8bbb5a0279eb6669.svg" alt="$x \le n,$" data-tex="inline"/> т.ч. <img src="https://habrastorage.org/getpro/habr/formulas/01b/908/b14/01b908b14dd83417aaa7f68e6ebc0807.svg" alt="$rd(x) = i.$" data-tex="inline"/> Именно эти числа из инварианта для k не покрыты уже инвариантом для k-1.<br/>
<br/>
Если i простое, то lp[i] будет равно 0, ведь единственная операция записи в массив lp, которая теоретически могла бы подсчитать lp[i] (в строке 6), всегда пишет в составные индексы, ведь p*i (для i > 1) — всегда составное. Поэтому число i будет добавлено в список простых. Также, в строке 3 будет подсчитано lp[i].<br/>
<br/>
Если же i составное, то на начало итерации lp[i] уже будет подсчитано по инварианту для i=k-1, ведь <img src="https://habrastorage.org/getpro/habr/formulas/f52/1e2/ce7/f521e2ce7660cbc4a288c72ed888cede.svg" alt="$rd(i) &lt; i$" data-tex="inline"/> или <img src="https://habrastorage.org/getpro/habr/formulas/c92/b75/6e0/c92b756e0ca91fa6abbd3eae84028dde.svg" alt="$rd(i) \le i-1,$" data-tex="inline"/> следовательно i попадает под условие инварианта в предыдущей итерации. Поэтому составное число i не будет добавлено в список простых чисел.<br/>
<br/>
Далее, имея корректное lp[i] и все простые числа до i включительно цикл в строках 5-6 переберет все элементы <img src="https://habrastorage.org/getpro/habr/formulas/528/93d/a51/52893da514fda59ff70f659d44aef0ea.svg" alt="$(p, i) \in E'$" data-tex="inline"/>, у которых вторая часть равна i:<br/>
<br/>
<ul>
<li><img src="https://habrastorage.org/getpro/habr/formulas/7a6/be0/b10/7a6be0b10afeba54f9b8dd92b01a1e69.svg" alt="$p \in P,$" data-tex="inline"/> потому что оно из списка pr</li>
<li><img src="https://habrastorage.org/getpro/habr/formulas/de4/d0b/31c/de4d0b31c7b88f130e69ce5ef3a4c11c.svg" alt="$p \le lp(i),$" data-tex="inline"/> по условию останова цикла </li>
<li><img src="https://habrastorage.org/getpro/habr/formulas/533/68f/2c3/53368f2c381e8ba223a39bc53492a57f.svg" alt="$p\times i \le n,$" data-tex="inline"/> по условию останова цикла </li>
<li><img src="https://habrastorage.org/getpro/habr/formulas/733/6e5/3cc/7336e53cce90a4b1aa66034a9bb44f3e.svg" alt="$i &lt; n,$" data-tex="inline"/> следует из <img src="https://habrastorage.org/getpro/habr/formulas/008/cb1/58f/008cb158fcd62476e06e59ed734581a4.svg" alt="$p\times i \le n,\ p > 1$" data-tex="inline"/></li>
</ul><br/>
Все нужные простые числа в списке pr есть, т.к. нужны только числа до <img src="https://habrastorage.org/getpro/habr/formulas/a83/775/df8/a83775df86617bd50c82503d962c0929.svg" alt="$lp(i) \le i$" data-tex="inline"/>. Поэтому будут подсчитаны значения lp[] для всех составных чисел <img src="https://habrastorage.org/getpro/habr/formulas/817/b92/407/817b92407f764f57af9226e50cc788fd.svg" alt="$x$" data-tex="inline"/>, у которых <img src="https://habrastorage.org/getpro/habr/formulas/542/de2/b2a/542de2b2ab7769a6998435cf5f80bb02.svg" alt="$rd(x)=i$" data-tex="inline"/>. Это ровно все те числа, которых не хватало при переходе от инварианта для k-1 к инварианту для k.<br/>
<br/>
Следовательно, инавриант выполняется для любых i = 2..n.<br/>
<br/>
<img src="https://habrastorage.org/getpro/habr/formulas/3a3/086/d5b/3a3086d5be532b93301afea91574367d.svg" alt="$\square$" data-tex="inline"/><br/>
<br/>
По инварианту из Теоремы 1 для i=n получается, что все простые числа до n и все lp[] будут подсчитаны алгоритмом 1. <br/>
<br/>
Более того, поскольку в строках 5-6 перебираются различные элементы множества <img src="https://habrastorage.org/getpro/habr/formulas/d4f/55a/37f/d4f55a37fb733b176d0ef014591e1b35.svg" alt="$E$" data-tex="inline"/>, то суммарно внутренний цикл выполнит не более <img src="https://habrastorage.org/getpro/habr/formulas/f11/ac4/8c1/f11ac48c1bfa053016ab1f5581768c6c.svg" alt="$\vert E \vert &lt; n$" data-tex="inline"/> операций. Операция проверки в цикле выполнится ровно <img src="https://habrastorage.org/getpro/habr/formulas/724/ac7/1c7/724ac71c77b2d7e8968d6c76096eb3e3.svg" alt="$\vert E \vert + n - 1 &lt; 2n$" data-tex="inline"/> раз (<img src="https://habrastorage.org/getpro/habr/formulas/e9c/691/44a/e9c69144ab9c51491136a1ddd92b78a7.svg" alt="$\vert E \vert$" data-tex="inline"/> раз вернет true и n-1 раз, для каждого i, вернет false). Все оставшиеся операции вложены в один цикл по i от 2 до n. <br/>
Отсюда следует, что сложность алгоритма 1 — O(n).</div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%80%D0%B5%D1%88%D0%B5%D1%82%D0%BE%20%D1%8D%D1%80%D0%B0%D1%82%D0%BE%D1%81%D1%84%D0%B5%D0%BD%D0%B0%5D" class="tm-tags-list__link">решето эратосфена</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC%D1%8B%5D" class="tm-tags-list__link">алгоритмы</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B0%D1%81%D1%81%D0%B8%D0%BC%D0%BF%D1%82%D0%BE%D1%82%D0%B8%D0%BA%D0%B0%5D" class="tm-tags-list__link">ассимптотика</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%81%D0%BB%D0%BE%D0%B6%D0%BD%D0%BE%D1%81%D1%82%D1%8C%20%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC%D0%B0%5D" class="tm-tags-list__link">сложность алгоритма</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hub/algorithms/" class="tm-hubs-list__link">
    Алгоритмы
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/maths/" class="tm-hubs-list__link">
    Математика
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 29: ↑28 и ↓1</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 29: ↑28 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+27</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">12K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    85
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/wataru/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/67f/de9/0ed/67fde90edd570521bf200be0295497d9.png" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 182 голоса " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    42
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">1.8</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><span class="tm-user-card__name tm-user-card__name_variant-article">Илья</span> <a href="/ru/users/wataru/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @wataru
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">C++ разработчик.</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/452388/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 43 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <!----> <!----> <!----> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/452388/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/452388/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"452388":{"id":"452388","timePublished":"2019-05-18T15:26:04+00:00","isCorporative":false,"lang":"ru","titleHtml":"Решето Эратосфена за O(n). Доказательство","leadData":{"textHtml":"В комментариях к одному из прошлых \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F450604\u002F\"\u003Eпостов\u003C\u002Fa\u003E о решете Эратосфена был упомянут этот короткий алгоритм из \u003Ca href=\"https:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002F%D0%A0%D0%B5%D1%88%D0%B5%D1%82%D0%BE_%D0%AD%D1%80%D0%B0%D1%82%D0%BE%D1%81%D1%84%D0%B5%D0%BD%D0%B0#%D0%A0%D0%B5%D1%88%D0%B5%D1%82%D0%BE_%D0%AD%D1%80%D0%B0%D1%82%D0%BE%D1%81%D1%84%D0%B5%D0%BD%D0%B0_%D1%81_%D0%BB%D0%B8%D0%BD%D0%B5%D0%B9%D0%BD%D1%8B%D0%BC_%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B5%D0%BC_%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B\"\u003EВикипедии\u003C\u002Fa\u003E:\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cb\u003EАлгоритм 1:\u003C\u002Fb\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"cpp\"\u003E1: для i := 2, 3, 4, ..., до n: \n2:  если lp[i] = 0:\n3:       lp[i] := i\n4:       pr[] += {i}\n5:   для p из pr пока p ≤ lp[i] и p*i ≤ n:\n6:       lp[p*i] := p\nРезультат:\n lp - минимальный простой делитель для кажого числа до n\n pr - список всех простых до n.\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u003E\r\nАлгоритм простой, но не всем он показался очевидным. Главная же проблема в том, что на Википедии нет доказательства, а \u003Ca href=\"https:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002F%D0%A0%D0%B5%D1%88%D0%B5%D1%82%D0%BE_%D0%AD%D1%80%D0%B0%D1%82%D0%BE%D1%81%D1%84%D0%B5%D0%BD%D0%B0#cite_note-13\"\u003Eссылка \u003C\u002Fa\u003Eна первоисточник (\u003Ca href=\"https:\u002F\u002Fwww.cs.utexas.edu\u002Fusers\u002Fmisra\u002FscannedPdf.dir\u002FlinearSieve.pdf\"\u003Epdf\u003C\u002Fa\u003E) содержит довольно сильно отличающийся от приведенного выше алгоритм.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nВ этом посте я попытаюсь, надеюсь, доступно доказать, что этот алгоритм не только работает, но и делает это за линейную сложность.\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше →","image":null},"editorVersion":"1.0","postType":"article","postLabels":[],"author":{"scoreStats":{"score":42,"votesCount":182},"rating":1.8,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"68334","alias":"wataru","fullname":"Илья","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F67f\u002Fde9\u002F0ed\u002F67fde90edd570521bf200be0295497d9.png","speciality":"C++ разработчик."},"statistics":{"commentsCount":43,"favoritesCount":85,"readingCount":12374,"score":27,"votesCount":29},"hubs":[{"relatedData":null,"id":"8000","alias":"algorithms","type":"collective","title":"Алгоритмы","titleHtml":"Алгоритмы","isProfiled":true},{"relatedData":null,"id":"17812","alias":"maths","type":"collective","title":"Математика","titleHtml":"Математика","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EВ комментариях к одному из прошлых \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F450604\u002F\"\u003Eпостов\u003C\u002Fa\u003E о решете Эратосфена был упомянут этот короткий алгоритм из \u003Ca href=\"https:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002F%D0%A0%D0%B5%D1%88%D0%B5%D1%82%D0%BE_%D0%AD%D1%80%D0%B0%D1%82%D0%BE%D1%81%D1%84%D0%B5%D0%BD%D0%B0#%D0%A0%D0%B5%D1%88%D0%B5%D1%82%D0%BE_%D0%AD%D1%80%D0%B0%D1%82%D0%BE%D1%81%D1%84%D0%B5%D0%BD%D0%B0_%D1%81_%D0%BB%D0%B8%D0%BD%D0%B5%D0%B9%D0%BD%D1%8B%D0%BC_%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B5%D0%BC_%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B\"\u003EВикипедии\u003C\u002Fa\u003E:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EАлгоритм 1:\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"cpp\"\u003E1: для i := 2, 3, 4, ..., до n: \n2:  если lp[i] = 0:\n3:       lp[i] := i\n4:       pr[] += {i}\n5:   для p из pr пока p ≤ lp[i] и p*i ≤ n:\n6:       lp[p*i] := p\nРезультат:\n lp - минимальный простой делитель для кажого числа до n\n pr - список всех простых до n.\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nАлгоритм простой, но не всем он показался очевидным. Главная же проблема в том, что на Википедии нет доказательства, а \u003Ca href=\"https:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002F%D0%A0%D0%B5%D1%88%D0%B5%D1%82%D0%BE_%D0%AD%D1%80%D0%B0%D1%82%D0%BE%D1%81%D1%84%D0%B5%D0%BD%D0%B0#cite_note-13\"\u003Eссылка \u003C\u002Fa\u003Eна первоисточник (\u003Ca href=\"https:\u002F\u002Fwww.cs.utexas.edu\u002Fusers\u002Fmisra\u002FscannedPdf.dir\u002FlinearSieve.pdf\"\u003Epdf\u003C\u002Fa\u003E) содержит довольно сильно отличающийся от приведенного выше алгоритм.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ этом посте я попытаюсь, надеюсь, доступно доказать, что этот алгоритм не только работает, но и делает это за линейную сложность.\u003Cbr\u002F\u003E\r\n\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EПримечание о сложности алгоритма\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003EХоть этот алгоритм и асимптотически быстрее стандартного \u003Ca href=\"https:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002F%D0%A0%D0%B5%D1%88%D0%B5%D1%82%D0%BE_%D0%AD%D1%80%D0%B0%D1%82%D0%BE%D1%81%D1%84%D0%B5%D0%BD%D0%B0#%D0%9F%D1%81%D0%B5%D0%B2%D0%B4%D0%BE%D0%BA%D0%BE%D0%B4\"\u003Eрешета\u003C\u002Fa\u003E Эратосфена за O(n log log n), ему требуется гораздо больше памяти. Поэтому для по-настоящему больших n, где бы этот алгоритм засиял во всей красе, он не применим. Однако, он очень полезен даже для небольших n, если вам надо не только найти все простые числа, но и быстро раскладывать на множители все числа до n.\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EОпределения\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F02b\u002Fdfc\u002F375\u002F02bdfc3750046889d15b3f933014870b.svg\" alt=\"$\\mathcal{P}$\" data-tex=\"inline\"\u002F\u003E — множество простых чисел.\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fe81\u002F05d\u002F645\u002Fe8105d6450fa00dea7268194bbe06f73.svg\" alt=\"$lp(x)$\" data-tex=\"inline\"\u002F\u003E — минимальный простой делитель числа: \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd13\u002F8e2\u002F791\u002Fd138e279182c2dcc08e8cfdeaa830b3c.svg\" alt=\"$lp(x) = min \\{p \\in \\mathcal{P}\\ \\vert\\ p\\vert x \\}$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F977\u002Ff77\u002F6ba\u002F977f776ba8d8613d5e7ea1e55032b98b.svg\" alt=\"$rd(x)$\" data-tex=\"inline\"\u002F\u003E — остальные множители: \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F060\u002F3bf\u002F7c8\u002F0603bf7c8b26a4e9be3cca2090c2c2b9.svg\" alt=\"$rd(x) = x \u002F lp(x)$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОбратите внимание, все определения выше даны для \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fa59\u002Ffe7\u002F393\u002Fa59fe7393705abb887943a6b0ec857f1.svg\" alt=\"$x \\ge 2$\" data-tex=\"inline\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНекоторые очевидные свойства введенных выше функций, которые будут использоваться дальше:\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ffcd\u002F95b\u002F733\u002Ffcd95b733d8b0645f163bed9d9d1a626.svg\" alt=\"$lp(a\\times b) = min(lp(a), lp(b))$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F5c0\u002Fcc4\u002F159\u002F5c0cc41597d610d0db1298a731c73a52.svg\" alt=\"$rd(x) &lt; x$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F560\u002Fa32\u002F7a8\u002F560a327a85cd15cd5587eb69b602d69d.svg\" alt=\"$p \\in \\mathcal{P} =\u003E lp(p) = p$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EДоказательство\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cb\u003EЛемма 1\u003C\u002Fb\u003E: \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F2bf\u002Fc1d\u002F137\u002F2bfc1d137c3fb56e53eefe664353856b.svg\" alt=\"$lp(x) \\le lp(rd(x)), \\forall x \\notin \\mathcal{P}, x\u003E1$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cb\u003EДоказательство\u003C\u002Fb\u003E: Т.к. любой делитель \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F977\u002Ff77\u002F6ba\u002F977f776ba8d8613d5e7ea1e55032b98b.svg\" alt=\"$rd(x)$\" data-tex=\"inline\"\u002F\u003E также является делителем \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F817\u002Fb92\u002F407\u002F817b92407f764f57af9226e50cc788fd.svg\" alt=\"$x$\" data-tex=\"inline\"\u002F\u003E, а \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fe81\u002F05d\u002F645\u002Fe8105d6450fa00dea7268194bbe06f73.svg\" alt=\"$lp(x)$\" data-tex=\"inline\"\u002F\u003E не превосходит любой делитель \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F817\u002Fb92\u002F407\u002F817b92407f764f57af9226e50cc788fd.svg\" alt=\"$x$\" data-tex=\"inline\"\u002F\u003E, то \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fe81\u002F05d\u002F645\u002Fe8105d6450fa00dea7268194bbe06f73.svg\" alt=\"$lp(x)$\" data-tex=\"inline\"\u002F\u003E не превосходит и любой делитель \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F977\u002Ff77\u002F6ba\u002F977f776ba8d8613d5e7ea1e55032b98b.svg\" alt=\"$rd(x)$\" data-tex=\"inline\"\u002F\u003E, включая наименьший из них. Единственная проблема в этом утверждении, если \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F977\u002Ff77\u002F6ba\u002F977f776ba8d8613d5e7ea1e55032b98b.svg\" alt=\"$rd(x)$\" data-tex=\"inline\"\u002F\u003E не имеет простых делителей, но это возможно только в случае \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Feac\u002Fa7c\u002F240\u002Feaca7c240004f77c414c5b14cffd187e.svg\" alt=\"$x \\in \\mathcal{P}$\" data-tex=\"inline\"\u002F\u003E, который исключен в условии леммы. \u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F3a3\u002F086\u002Fd5b\u002F3a3086d5be532b93301afea91574367d.svg\" alt=\"$\\square$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПусть \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F44b\u002Fef8\u002Ff19\u002F44bef8f19a206ae65b72550770098b72.svg\" alt=\"$E = \\{(lp(x), rd(x)) \\vert \\forall x \\notin \\mathcal{P}, 2\\le x \\le n\\}$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТ.к. \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F3e7\u002F3d6\u002Fca2\u002F3e73d6ca2dc6a37c4f0968fdca7a364f.svg\" alt=\"$lp(x)\\times rd(x) = x$\" data-tex=\"inline\"\u002F\u003E (по определению \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F2ef\u002Fc54\u002Fd10\u002F2efc54d10946611d6d325aae6ae54c78.svg\" alt=\"$rd()$\" data-tex=\"inline\"\u002F\u003E), если бы нам было дано множество \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd4f\u002F55a\u002F37f\u002Fd4f55a37fb733b176d0ef014591e1b35.svg\" alt=\"$E$\" data-tex=\"inline\"\u002F\u003E, то мы смогли бы вычислить \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F801\u002F347\u002F180\u002F8013471806cae0425b5b7024ac6a62b7.svg\" alt=\"$lp()$\" data-tex=\"inline\"\u002F\u003E для всех составных чисел до n. Это делает, например, следующий алгоритм:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EАлгоритм 2:\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"cpp\"\u003E1: Для всех (l,r) из E:\n2:    lp[l*r] := l;\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nЗаметим, что \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F586\u002F33b\u002Fb64\u002F58633bb64cd4723dbb2aa5632b677b3d.svg\" alt=\"$\\vert E \\vert \\le n$\" data-tex=\"inline\"\u002F\u003E, поэтому алгоритм 2 выше работает за линейную сложность.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДалее я докажу, что алгоритм 1 из Википедии на самом деле просто перебирает все элементы этого множества, ведь его можно параметризовать и по-другому.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПусть \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fa65\u002F3e7\u002F3a5\u002Fa653e73a542d1c7f56a8d74552d5738a.svg\" alt=\"$E' = \\{(p, r) \\vert p \\in \\mathcal{P}, 2\\le r &lt; n, p \\le lp(r), p \\times r \\le n\\}$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EЛемма 2\u003C\u002Fb\u003E: \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F7f8\u002Fe7f\u002F333\u002F7f8e7f3332a123755040c13e771d0ff0.svg\" alt=\"$E = E'$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cb\u003EДоказательство\u003C\u002Fb\u003E: \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПусть \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F06a\u002F20b\u002F48c\u002F06a20b48ca6eaecce1d81f4a689d2703.svg\" alt=\"$(a,b)\\in E$\" data-tex=\"inline\"\u002F\u003E =\u003E \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F8ab\u002Fd56\u002F6f8\u002F8abd566f810f859542c697c0dd74a668.svg\" alt=\"$\\exists x \\notin \\mathcal{P},\\ 2\\le x\\le n \\mid a=lp(x), b=rd(x)$\" data-tex=\"inline\"\u002F\u003E. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПо определению \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fdd7\u002F1b5\u002F8a8\u002Fdd71b58a833ce5d26aac3a7754586480.svg\" alt=\"$lp(), rd()$\" data-tex=\"inline\"\u002F\u003E: \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Feaa\u002F348\u002Ff7f\u002Feaa348f7f6abc4d3b3906a0c96c47ba9.svg\" alt=\"$a \\in \\mathcal{P}$\" data-tex=\"inline\"\u002F\u003E, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F516\u002Fe64\u002Fe1a\u002F516e64e1a440ed1640f060ef05b5f0fd.svg\" alt=\"$a\\times b = x$\" data-tex=\"inline\"\u002F\u003E. По лемме 1, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd62\u002F28d\u002F34e\u002Fd6228d34e6c3f712b156d35c0802dce3.svg\" alt=\"$a \\le lp(b)$\" data-tex=\"inline\"\u002F\u003E. \u003Cbr\u002F\u003E\r\nт.к. \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F5c0\u002Fcc4\u002F159\u002F5c0cc41597d610d0db1298a731c73a52.svg\" alt=\"$rd(x) &lt; x$\" data-tex=\"inline\"\u002F\u003E, то \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F349\u002F849\u002Fb50\u002F349849b50425d998c3dc1aadd37c2b93.svg\" alt=\"$b &lt; n$\" data-tex=\"inline\"\u002F\u003E.\u003Cbr\u002F\u003E\r\nПоскольку \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fefc\u002F828\u002F247\u002Fefc828247eb0679d26aa0e5a01632a00.svg\" alt=\"$x \\notin \\mathcal{P}$\" data-tex=\"inline\"\u002F\u003E, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F0a9\u002Fe7b\u002Ff4e\u002F0a9e7bf4e6559b7e9352fda6a7b7bafe.svg\" alt=\"$b \\ge 2$\" data-tex=\"inline\"\u002F\u003E. \u003Cbr\u002F\u003E\r\nТак же, по определению \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd4f\u002F55a\u002F37f\u002Fd4f55a37fb733b176d0ef014591e1b35.svg\" alt=\"$E$\" data-tex=\"inline\"\u002F\u003E, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F0ca\u002F361\u002Faa4\u002F0ca361aa48d4799fb7686af7579dc796.svg\" alt=\"$x \\le n$\" data-tex=\"inline\"\u002F\u003E, следовательно, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F418\u002Fb2d\u002F8d9\u002F418b2d8d9230e4f1f3df61bd3ceb86cd.svg\" alt=\"$a \\times b \\le n$\" data-tex=\"inline\"\u002F\u003E.\u003Cbr\u002F\u003E\r\nВсе 4 условия \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fff6\u002F04a\u002Fb65\u002Fff604ab6579f6cf7daabaa1cdff777c8.svg\" alt=\"$E'$\" data-tex=\"inline\"\u002F\u003E выполнены, значит, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fdbd\u002F5ea\u002F703\u002Fdbd5ea7032f99fbdecf33b3a21617b5b.svg\" alt=\"$(a,b) \\in E'$\" data-tex=\"inline\"\u002F\u003E =\u003E \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fb27\u002Fd74\u002F77e\u002Fb27d7477eeda2812746ab4d729077d5f.svg\" alt=\"$E \\subset E'$\" data-tex=\"inline\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПусть \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fdbd\u002F5ea\u002F703\u002Fdbd5ea7032f99fbdecf33b3a21617b5b.svg\" alt=\"$(a,b)\\in E'$\" data-tex=\"inline\"\u002F\u003E. Пусть \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fe07\u002Fa70\u002Fb2e\u002Fe07a70b2e81c7d4f8df415f4b415fba9.svg\" alt=\"$x = a \\times b$\" data-tex=\"inline\"\u002F\u003E. \u003Cbr\u002F\u003E\r\nПо определению \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fff6\u002F04a\u002Fb65\u002Fff604ab6579f6cf7daabaa1cdff777c8.svg\" alt=\"$E'$\" data-tex=\"inline\"\u002F\u003E, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Feaa\u002F348\u002Ff7f\u002Feaa348f7f6abc4d3b3906a0c96c47ba9.svg\" alt=\"$a \\in \\mathcal{P}$\" data-tex=\"inline\"\u002F\u003E. Значит, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F372\u002Fe18\u002F546\u002F372e18546a3b7abb94c2672708bc5dfe.svg\" alt=\"$a$\" data-tex=\"inline\"\u002F\u003E — простой делитеть \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F817\u002Fb92\u002F407\u002F817b92407f764f57af9226e50cc788fd.svg\" alt=\"$x$\" data-tex=\"inline\"\u002F\u003E. \u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F280\u002F5e8\u002F92e\u002F2805e892eebbdf5c39bcb426884209d0.svg\" alt=\"$lp(x) = lp(a\\times b) = min(lp(a), lp(b)) = min(a, lp(b)).$\" data-tex=\"inline\"\u002F\u003E \u003Cbr\u002F\u003E\r\nТ.к \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd62\u002F28d\u002F34e\u002Fd6228d34e6c3f712b156d35c0802dce3.svg\" alt=\"$a \\le lp(b)$\" data-tex=\"inline\"\u002F\u003E, то \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F244\u002F374\u002F3b1\u002F2443743b138792126e9b9277fbb8c2d3.svg\" alt=\"$lp(x) = a.$\" data-tex=\"inline\"\u002F\u003E Значит, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fddc\u002F2ca\u002Fe36\u002Fddc2cae36c09b90b6c8b91b29068bdd2.svg\" alt=\"$b = rd(x).$\" data-tex=\"inline\"\u002F\u003E \u003Cbr\u002F\u003E\r\nПо определению, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F733\u002F25d\u002F085\u002F73325d085bc9659eabf0b8804bf6796c.svg\" alt=\"$x = a \\times b \\le n.$\" data-tex=\"inline\"\u002F\u003E Также, очевидно, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fdd8\u002Fd63\u002F095\u002Fdd8d630951e6ff67fbbb16ade3f02497.svg\" alt=\"$x = a \\times b \\ge 2.$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\nВсе условия для \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd4f\u002F55a\u002F37f\u002Fd4f55a37fb733b176d0ef014591e1b35.svg\" alt=\"$E$\" data-tex=\"inline\"\u002F\u003E выполнены =\u003E \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F4eb\u002Fbf4\u002Fc94\u002F4ebbf4c940a0375af2698eafc467e9a0.svg\" alt=\"$E' \\subset E.$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСледовательно, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F894\u002F07f\u002F4f7\u002F89407f4f7addfcad6ad85de37a39aea7.svg\" alt=\"$E = E'.$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F3a3\u002F086\u002Fd5b\u002F3a3086d5be532b93301afea91574367d.svg\" alt=\"$\\square$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТеперь осталось перебрать правильные \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F066\u002F939\u002Fa33\u002F066939a33475dd671b845469b6526972.svg\" alt=\"$r$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F839\u002Ff25\u002Fc27\u002F839f25c2746382debd4f08ea25ad5ecf.svg\" alt=\"$p$\" data-tex=\"inline\"\u002F\u003E из определения множества \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fff6\u002F04a\u002Fb65\u002Fff604ab6579f6cf7daabaa1cdff777c8.svg\" alt=\"$E'$\" data-tex=\"inline\"\u002F\u003E и применить алгоритм 2. Именно это и делает Алгоритм 1 (только вместо r используется переменная i). Но есть проблема! Что бы перебрать все элементы множества \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fff6\u002F04a\u002Fb65\u002Fff604ab6579f6cf7daabaa1cdff777c8.svg\" alt=\"$E'$\" data-tex=\"inline\"\u002F\u003E для вычисления \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F7ec\u002Fb89\u002Feb5\u002F7ecb89eb5acb1c60dfb7bf6aa9eaa1dc.svg\" alt=\"$lp,$\" data-tex=\"inline\"\u002F\u003E нам надо знать \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F7ec\u002Fb89\u002Feb5\u002F7ecb89eb5acb1c60dfb7bf6aa9eaa1dc.svg\" alt=\"$lp,$\" data-tex=\"inline\"\u002F\u003E ведь в определении есть условие \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fbc1\u002F6b1\u002Fad3\u002Fbc16b1ad37ecec8c13baaf5609147dfe.svg\" alt=\"$p \\le lp(r)$\" data-tex=\"inline\"\u002F\u003E. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nК счастью, эта проблема обходится правильным порядком перебора. Надо перебирать \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F066\u002F939\u002Fa33\u002F066939a33475dd671b845469b6526972.svg\" alt=\"$r$\" data-tex=\"inline\"\u002F\u003E во внешнем цикле, а \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F839\u002Ff25\u002Fc27\u002F839f25c2746382debd4f08ea25ad5ecf.svg\" alt=\"$p$\" data-tex=\"inline\"\u002F\u003E — во внутреннем. Тогда \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F815\u002F2c1\u002F5d1\u002F8152c15d125c2926c5a5c5f1d0da83a5.svg\" alt=\"$lp(r)$\" data-tex=\"inline\"\u002F\u003E уже будет вычислено. Этот факт доказывает следующая теорема.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EТеорема 1:\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\nАлгоритм 1 поддерживает следующий инвариант: После выполнения итерации внешнего цикла при i=k, все простые числа до k включительно будут выделены в список pr. Также будет подсчитано \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F801\u002F347\u002F180\u002F8013471806cae0425b5b7024ac6a62b7.svg\" alt=\"$lp()$\" data-tex=\"inline\"\u002F\u003E для всех \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F140\u002Fee9\u002Fc3a\u002F140ee9c3a7374f861ed4893cb2c31187.svg\" alt=\"$x \\notin \\mathcal{P} \\mid x\\le n,\\ rd(x) \\le k$\" data-tex=\"inline\"\u002F\u003E в массиве lp.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EДоказательство\u003C\u002Fb\u003E:\u003Cbr\u002F\u003E\r\nДокажем по индукции. Для k=2 инвариант проверяется вручную. Единственное простое число 2 будет добавлено в список pr, потому что массив lp[] изначально заполнен нулями. Также, единственное составное число у которого \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F889\u002F6d0\u002F813\u002F8896d08134e06ca8bc28a70c87939430.svg\" alt=\"$rd(x) \\le 2$\" data-tex=\"inline\"\u002F\u003E — это 4. Несложно убедиться, что внутренний цикл выполнится ровно один раз (при n\u003E3) и правильно выполнит lp[4] := 2.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТеперь допустим, что инвариант выполняется для итерации i=k-1. Докажем, что он будет выполнятся и для итерации i=k.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля этого достаточно проверить что число i, если оно простое, будет добавлено в список pr и что \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F801\u002F347\u002F180\u002F8013471806cae0425b5b7024ac6a62b7.svg\" alt=\"$lp()$\" data-tex=\"inline\"\u002F\u003E будет подсчитано для всех составных чисел \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F51b\u002F950\u002Fbdd\u002F51b950bddf86a5dc8bbb5a0279eb6669.svg\" alt=\"$x \\le n,$\" data-tex=\"inline\"\u002F\u003E т.ч. \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F01b\u002F908\u002Fb14\u002F01b908b14dd83417aaa7f68e6ebc0807.svg\" alt=\"$rd(x) = i.$\" data-tex=\"inline\"\u002F\u003E Именно эти числа из инварианта для k не покрыты уже инвариантом для k-1.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли i простое, то lp[i] будет равно 0, ведь единственная операция записи в массив lp, которая теоретически могла бы подсчитать lp[i] (в строке 6), всегда пишет в составные индексы, ведь p*i (для i \u003E 1) — всегда составное. Поэтому число i будет добавлено в список простых. Также, в строке 3 будет подсчитано lp[i].\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли же i составное, то на начало итерации lp[i] уже будет подсчитано по инварианту для i=k-1, ведь \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff52\u002F1e2\u002Fce7\u002Ff521e2ce7660cbc4a288c72ed888cede.svg\" alt=\"$rd(i) &lt; i$\" data-tex=\"inline\"\u002F\u003E или \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fc92\u002Fb75\u002F6e0\u002Fc92b756e0ca91fa6abbd3eae84028dde.svg\" alt=\"$rd(i) \\le i-1,$\" data-tex=\"inline\"\u002F\u003E следовательно i попадает под условие инварианта в предыдущей итерации. Поэтому составное число i не будет добавлено в список простых чисел.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДалее, имея корректное lp[i] и все простые числа до i включительно цикл в строках 5-6 переберет все элементы \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F528\u002F93d\u002Fa51\u002F52893da514fda59ff70f659d44aef0ea.svg\" alt=\"$(p, i) \\in E'$\" data-tex=\"inline\"\u002F\u003E, у которых вторая часть равна i:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F7a6\u002Fbe0\u002Fb10\u002F7a6be0b10afeba54f9b8dd92b01a1e69.svg\" alt=\"$p \\in P,$\" data-tex=\"inline\"\u002F\u003E потому что оно из списка pr\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fde4\u002Fd0b\u002F31c\u002Fde4d0b31c7b88f130e69ce5ef3a4c11c.svg\" alt=\"$p \\le lp(i),$\" data-tex=\"inline\"\u002F\u003E по условию останова цикла \u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F533\u002F68f\u002F2c3\u002F53368f2c381e8ba223a39bc53492a57f.svg\" alt=\"$p\\times i \\le n,$\" data-tex=\"inline\"\u002F\u003E по условию останова цикла \u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F733\u002F6e5\u002F3cc\u002F7336e53cce90a4b1aa66034a9bb44f3e.svg\" alt=\"$i &lt; n,$\" data-tex=\"inline\"\u002F\u003E следует из \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F008\u002Fcb1\u002F58f\u002F008cb158fcd62476e06e59ed734581a4.svg\" alt=\"$p\\times i \\le n,\\ p \u003E 1$\" data-tex=\"inline\"\u002F\u003E\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\nВсе нужные простые числа в списке pr есть, т.к. нужны только числа до \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fa83\u002F775\u002Fdf8\u002Fa83775df86617bd50c82503d962c0929.svg\" alt=\"$lp(i) \\le i$\" data-tex=\"inline\"\u002F\u003E. Поэтому будут подсчитаны значения lp[] для всех составных чисел \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F817\u002Fb92\u002F407\u002F817b92407f764f57af9226e50cc788fd.svg\" alt=\"$x$\" data-tex=\"inline\"\u002F\u003E, у которых \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F542\u002Fde2\u002Fb2a\u002F542de2b2ab7769a6998435cf5f80bb02.svg\" alt=\"$rd(x)=i$\" data-tex=\"inline\"\u002F\u003E. Это ровно все те числа, которых не хватало при переходе от инварианта для k-1 к инварианту для k.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСледовательно, инавриант выполняется для любых i = 2..n.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F3a3\u002F086\u002Fd5b\u002F3a3086d5be532b93301afea91574367d.svg\" alt=\"$\\square$\" data-tex=\"inline\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПо инварианту из Теоремы 1 для i=n получается, что все простые числа до n и все lp[] будут подсчитаны алгоритмом 1. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nБолее того, поскольку в строках 5-6 перебираются различные элементы множества \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd4f\u002F55a\u002F37f\u002Fd4f55a37fb733b176d0ef014591e1b35.svg\" alt=\"$E$\" data-tex=\"inline\"\u002F\u003E, то суммарно внутренний цикл выполнит не более \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff11\u002Fac4\u002F8c1\u002Ff11ac48c1bfa053016ab1f5581768c6c.svg\" alt=\"$\\vert E \\vert &lt; n$\" data-tex=\"inline\"\u002F\u003E операций. Операция проверки в цикле выполнится ровно \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F724\u002Fac7\u002F1c7\u002F724ac71c77b2d7e8968d6c76096eb3e3.svg\" alt=\"$\\vert E \\vert + n - 1 &lt; 2n$\" data-tex=\"inline\"\u002F\u003E раз (\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fe9c\u002F691\u002F44a\u002Fe9c69144ab9c51491136a1ddd92b78a7.svg\" alt=\"$\\vert E \\vert$\" data-tex=\"inline\"\u002F\u003E раз вернет true и n-1 раз, для каждого i, вернет false). Все оставшиеся операции вложены в один цикл по i от 2 до n. \u003Cbr\u002F\u003E\r\nОтсюда следует, что сложность алгоритма 1 — O(n).\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"решето эратосфена"},{"titleHtml":"алгоритмы"},{"titleHtml":"ассимптотика"},{"titleHtml":"сложность алгоритма"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F452388\u002F822bc37d61becbc0f80c5ab92ab63d88\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F452388\u002F822bc37d61becbc0f80c5ab92ab63d88\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F452388\\\u002F\"},\"headline\":\"Решето Эратосфена за O(n). Доказательство\",\"datePublished\":\"2019-05-18T18:26:04+03:00\",\"dateModified\":\"2019-05-19T09:39:57+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Илья\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"В комментариях к одному из прошлых постов о решете Эратосфена был упомянут этот короткий алгоритм из Википедии:  Алгоритм 1:  1: для i := 2, 3, 4, ..., до n:  2:...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F452388\\\u002F#post-content-body\",\"about\":[\"h_algorithms\",\"h_maths\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F02b\\\u002Fdfc\\\u002F375\\\u002F02bdfc3750046889d15b3f933014870b.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fe81\\\u002F05d\\\u002F645\\\u002Fe8105d6450fa00dea7268194bbe06f73.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fd13\\\u002F8e2\\\u002F791\\\u002Fd138e279182c2dcc08e8cfdeaa830b3c.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F977\\\u002Ff77\\\u002F6ba\\\u002F977f776ba8d8613d5e7ea1e55032b98b.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F060\\\u002F3bf\\\u002F7c8\\\u002F0603bf7c8b26a4e9be3cca2090c2c2b9.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fa59\\\u002Ffe7\\\u002F393\\\u002Fa59fe7393705abb887943a6b0ec857f1.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Ffcd\\\u002F95b\\\u002F733\\\u002Ffcd95b733d8b0645f163bed9d9d1a626.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F5c0\\\u002Fcc4\\\u002F159\\\u002F5c0cc41597d610d0db1298a731c73a52.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F560\\\u002Fa32\\\u002F7a8\\\u002F560a327a85cd15cd5587eb69b602d69d.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F2bf\\\u002Fc1d\\\u002F137\\\u002F2bfc1d137c3fb56e53eefe664353856b.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F817\\\u002Fb92\\\u002F407\\\u002F817b92407f764f57af9226e50cc788fd.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Feac\\\u002Fa7c\\\u002F240\\\u002Feaca7c240004f77c414c5b14cffd187e.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F3a3\\\u002F086\\\u002Fd5b\\\u002F3a3086d5be532b93301afea91574367d.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F44b\\\u002Fef8\\\u002Ff19\\\u002F44bef8f19a206ae65b72550770098b72.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F3e7\\\u002F3d6\\\u002Fca2\\\u002F3e73d6ca2dc6a37c4f0968fdca7a364f.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F2ef\\\u002Fc54\\\u002Fd10\\\u002F2efc54d10946611d6d325aae6ae54c78.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fd4f\\\u002F55a\\\u002F37f\\\u002Fd4f55a37fb733b176d0ef014591e1b35.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F801\\\u002F347\\\u002F180\\\u002F8013471806cae0425b5b7024ac6a62b7.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F586\\\u002F33b\\\u002Fb64\\\u002F58633bb64cd4723dbb2aa5632b677b3d.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fa65\\\u002F3e7\\\u002F3a5\\\u002Fa653e73a542d1c7f56a8d74552d5738a.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F7f8\\\u002Fe7f\\\u002F333\\\u002F7f8e7f3332a123755040c13e771d0ff0.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F06a\\\u002F20b\\\u002F48c\\\u002F06a20b48ca6eaecce1d81f4a689d2703.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F8ab\\\u002Fd56\\\u002F6f8\\\u002F8abd566f810f859542c697c0dd74a668.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fdd7\\\u002F1b5\\\u002F8a8\\\u002Fdd71b58a833ce5d26aac3a7754586480.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Feaa\\\u002F348\\\u002Ff7f\\\u002Feaa348f7f6abc4d3b3906a0c96c47ba9.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F516\\\u002Fe64\\\u002Fe1a\\\u002F516e64e1a440ed1640f060ef05b5f0fd.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fd62\\\u002F28d\\\u002F34e\\\u002Fd6228d34e6c3f712b156d35c0802dce3.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F349\\\u002F849\\\u002Fb50\\\u002F349849b50425d998c3dc1aadd37c2b93.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fefc\\\u002F828\\\u002F247\\\u002Fefc828247eb0679d26aa0e5a01632a00.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F0a9\\\u002Fe7b\\\u002Ff4e\\\u002F0a9e7bf4e6559b7e9352fda6a7b7bafe.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F0ca\\\u002F361\\\u002Faa4\\\u002F0ca361aa48d4799fb7686af7579dc796.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F418\\\u002Fb2d\\\u002F8d9\\\u002F418b2d8d9230e4f1f3df61bd3ceb86cd.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fff6\\\u002F04a\\\u002Fb65\\\u002Fff604ab6579f6cf7daabaa1cdff777c8.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fdbd\\\u002F5ea\\\u002F703\\\u002Fdbd5ea7032f99fbdecf33b3a21617b5b.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fb27\\\u002Fd74\\\u002F77e\\\u002Fb27d7477eeda2812746ab4d729077d5f.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fe07\\\u002Fa70\\\u002Fb2e\\\u002Fe07a70b2e81c7d4f8df415f4b415fba9.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F372\\\u002Fe18\\\u002F546\\\u002F372e18546a3b7abb94c2672708bc5dfe.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F280\\\u002F5e8\\\u002F92e\\\u002F2805e892eebbdf5c39bcb426884209d0.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F244\\\u002F374\\\u002F3b1\\\u002F2443743b138792126e9b9277fbb8c2d3.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fddc\\\u002F2ca\\\u002Fe36\\\u002Fddc2cae36c09b90b6c8b91b29068bdd2.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F733\\\u002F25d\\\u002F085\\\u002F73325d085bc9659eabf0b8804bf6796c.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fdd8\\\u002Fd63\\\u002F095\\\u002Fdd8d630951e6ff67fbbb16ade3f02497.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F4eb\\\u002Fbf4\\\u002Fc94\\\u002F4ebbf4c940a0375af2698eafc467e9a0.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F894\\\u002F07f\\\u002F4f7\\\u002F89407f4f7addfcad6ad85de37a39aea7.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F066\\\u002F939\\\u002Fa33\\\u002F066939a33475dd671b845469b6526972.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F839\\\u002Ff25\\\u002Fc27\\\u002F839f25c2746382debd4f08ea25ad5ecf.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F7ec\\\u002Fb89\\\u002Feb5\\\u002F7ecb89eb5acb1c60dfb7bf6aa9eaa1dc.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fbc1\\\u002F6b1\\\u002Fad3\\\u002Fbc16b1ad37ecec8c13baaf5609147dfe.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F815\\\u002F2c1\\\u002F5d1\\\u002F8152c15d125c2926c5a5c5f1d0da83a5.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F140\\\u002Fee9\\\u002Fc3a\\\u002F140ee9c3a7374f861ed4893cb2c31187.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F889\\\u002F6d0\\\u002F813\\\u002F8896d08134e06ca8bc28a70c87939430.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F51b\\\u002F950\\\u002Fbdd\\\u002F51b950bddf86a5dc8bbb5a0279eb6669.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F01b\\\u002F908\\\u002Fb14\\\u002F01b908b14dd83417aaa7f68e6ebc0807.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Ff52\\\u002F1e2\\\u002Fce7\\\u002Ff521e2ce7660cbc4a288c72ed888cede.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fc92\\\u002Fb75\\\u002F6e0\\\u002Fc92b756e0ca91fa6abbd3eae84028dde.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F528\\\u002F93d\\\u002Fa51\\\u002F52893da514fda59ff70f659d44aef0ea.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F7a6\\\u002Fbe0\\\u002Fb10\\\u002F7a6be0b10afeba54f9b8dd92b01a1e69.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fde4\\\u002Fd0b\\\u002F31c\\\u002Fde4d0b31c7b88f130e69ce5ef3a4c11c.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F533\\\u002F68f\\\u002F2c3\\\u002F53368f2c381e8ba223a39bc53492a57f.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F733\\\u002F6e5\\\u002F3cc\\\u002F7336e53cce90a4b1aa66034a9bb44f3e.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F008\\\u002Fcb1\\\u002F58f\\\u002F008cb158fcd62476e06e59ed734581a4.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fa83\\\u002F775\\\u002Fdf8\\\u002Fa83775df86617bd50c82503d962c0929.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F542\\\u002Fde2\\\u002Fb2a\\\u002F542de2b2ab7769a6998435cf5f80bb02.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Ff11\\\u002Fac4\\\u002F8c1\\\u002Ff11ac48c1bfa053016ab1f5581768c6c.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F724\\\u002Fac7\\\u002F1c7\\\u002F724ac71c77b2d7e8968d6c76096eb3e3.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fe9c\\\u002F691\\\u002F44a\\\u002Fe9c69144ab9c51491136a1ddd92b78a7.svg\"]}","metaDescription":"В комментариях к одному из прошлых постов о решете Эратосфена был упомянут этот короткий алгоритм из Википедии:\r\n\r\nАлгоритм 1:\r\n\r\n1: для i := 2, 3, 4, ..., до n: \n2:  если lp[i] = 0:\n3:       lp[i] :=...","mainImageUrl":null,"amp":false},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":"algorithms,maths"},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
