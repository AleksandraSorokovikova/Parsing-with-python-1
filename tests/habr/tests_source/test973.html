<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Термометр &amp; гигрометр на ATMEGA 328P-MU — Поднимаем уровень ардуино разработок / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/452234\/"},"headline":"Термометр &amp; гигрометр на ATMEGA 328P-MU — Поднимаем уровень ардуино разработок","datePublished":"2019-05-17T00:44:18+03:00","dateModified":"2019-05-17T09:56:25+03:00","author":{"@type":"Person","name":"Berkseo"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Сегодня хочу поделиться одним из своих Ардуино проектов. Когда-то, не очень что бы давно я где-то на просторах интернета узнал об Ардуино. Влился я в это дело до...","url":"https:\/\/habr.com\/ru\/post\/452234\/#post-content-body","about":["h_DIY","f_popsci"],"image":["https:\/\/habrastorage.org\/webt\/mt\/3r\/ci\/mt3rci4yk0yasyrccfbqe_ii3uw.jpeg","https:\/\/habrastorage.org\/webt\/g8\/vt\/89\/g8vt89xocfduchhvirqldwcurh4.png","https:\/\/habrastorage.org\/webt\/zu\/wm\/zs\/zuwmzsu8ervyhmnbxzdfprmdbcu.jpeg","https:\/\/habrastorage.org\/webt\/q2\/a8\/yz\/q2a8yzmu0x8pzg6qtxs9nf4d0sc.jpeg","https:\/\/habrastorage.org\/webt\/12\/2j\/pk\/122jpkp-anp4zxqhshi7wp5bbga.jpeg","https:\/\/habrastorage.org\/webt\/er\/il\/ak\/erilakhq5uhxtx09ab54rn5brao.jpeg","https:\/\/habrastorage.org\/webt\/d3\/pa\/fh\/d3pafhom0t6ydozgxjgm_o0g9eo.jpeg","https:\/\/habrastorage.org\/webt\/k-\/2i\/yj\/k-2iyjlk9snioo4vktlengxti_g.jpeg","https:\/\/habrastorage.org\/webt\/cc\/du\/yy\/ccduyyya0_8awrvrplyrt4q3qze.jpeg","https:\/\/habrastorage.org\/webt\/et\/nf\/5w\/etnf5wimx4pwsf6k76uh5gobk3e.jpeg","https:\/\/habrastorage.org\/webt\/re\/g8\/z9\/reg8z9zer-swbz32kn5afhkvwsq.jpeg","https:\/\/habrastorage.org\/webt\/_i\/et\/hu\/_iethu6tktjfhc85y3ulrh5xf8m.jpeg","https:\/\/habrastorage.org\/webt\/ow\/6s\/fh\/ow6sfhpdvcmxy2lz0jemul6o0-i.jpeg","https:\/\/habrastorage.org\/webt\/pl\/-l\/48\/pl-l48rq33glvskysput8i6gu7y.jpeg","https:\/\/habrastorage.org\/webt\/8x\/6i\/ie\/8x6iie5r4kpdwjan5kqdkvq337c.png"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Термометр &amp;amp; гигрометр на ATMEGA 328P-MU — Поднимаем уровень ардуино разработок" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Термометр &amp;amp; гигрометр на ATMEGA 328P-MU — Поднимаем уровень ардуино разработок" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Термометр &amp;amp; гигрометр на ATMEGA 328P-MU — Поднимаем уровень ардуино разработок" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Сегодня хочу поделиться одним из своих Ардуино проектов. Когда-то, не очень что бы давно я где-то на просторах интернета узнал об Ардуино. Влился я в это дело довольно быстро, уровень вхождения там не..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Сегодня хочу поделиться одним из своих Ардуино проектов. Когда-то, не очень что бы давно я где-то на просторах интернета узнал об Ардуино. Влился я в это дело довольно быстро, уровень вхождения там не..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Сегодня хочу поделиться одним из своих Ардуино проектов. Когда-то, не очень что бы давно я где-то на просторах интернета узнал об Ардуино. Влился я в это дело довольно быстро, уровень вхождения там не..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Сегодня хочу поделиться одним из своих Ардуино проектов. Когда-то, не очень что бы давно я где-то на просторах интернета узнал об Ардуино. Влился я в это дело довольно быстро, уровень вхождения там не..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Сегодня хочу поделиться одним из своих Ардуино проектов. Когда-то, не очень что бы давно я где-то на просторах интернета узнал об Ардуино. Влился я в это дело довольно быстро, уровень вхождения там не..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/452234/3b558880ff7fc77ff74b5669544cdcfa/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/452234/3b558880ff7fc77ff74b5669544cdcfa/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/452234/3b558880ff7fc77ff74b5669544cdcfa/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/452234/3b558880ff7fc77ff74b5669544cdcfa/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/452234/3b558880ff7fc77ff74b5669544cdcfa/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="452234" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2019-05-16T21:44:18.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/452234/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/452234/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/452234/3b558880ff7fc77ff74b5669544cdcfa/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/Berkseo/" title="Berkseo" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" loading="lazy" src="//habrastorage.org/r/w32/getpro/habr/avatars/61e/efa/39e/61eefa39e0d79dcc9ca5f38ca3dcbb3d.png" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/Berkseo/" class="tm-user-info__username">
      Berkseo
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2019-05-16T21:44:18.000Z" title="2019-05-17, 00:44">17  мая  2019 в 00:44</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Термометр &amp; гигрометр на ATMEGA 328P-MU — Поднимаем уровень ардуино разработок</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/DIY/" class="tm-article-snippet__hubs-item-link"><span>DIY или Сделай сам</span> <!----></a></span></div> <!----> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml">Сегодня хочу поделиться одним из своих Ардуино проектов. Когда-то, не очень что бы давно я где-то на просторах интернета узнал об Ардуино. Влился я в это дело довольно быстро, уровень вхождения там не высокий. Через некоторое время уже собрав кучу датчиков, сенсоров для умного дома стал ловить себя на мысли что как то это все не по уму. <a name="habracut"></a>Модули, большие незамысловатые коробки, куча проводов и термоклея :). Смотря на свою коробку с датчиком темературы и например на датчик температуры того же Сяоми, понимал что хочется что бы выглядел как у Сяоми но в тоже время что бы его можно было как хочешь перепрограмировать как мой в коробке размерами 10см на 6см с проводами и термоклеем. И наверное тогда и было положено начало моим DIY ардуино проектам на PCB платах.<br/>
<br/>
В сегодняшней статье речь пойдет о датчике температуры и влажности на базе процессора atmega328p-mu. Это более «мелкая» версия(абсолютный аналог) изветного всем ардуинщикам процессора atmega328p-au (Arduino Uno, Pro Mini, Nano). Если кто то ранее читал мои статьи то знает что я предпочитаю Mysensors. Что это? Это очень простая и хорошо проработанная и что немаловажно отлично описанная библиотека под Ардуино ИДЕ (и не только) для создания IOT радиосетей на частотах 2.4Ггц, 915, 868, 433 Мгц, а так же проводных сетей на интерфейсе 485, возможно не все упомянул, тк протокол постоянно развивается, все время что то добавляется. <br/>
<br/>
Первое что было сделано, это собственно сам датчик на PCB плате. Делал без оглядки на корпус, по принципу, главное сделать датчик а уж корпус как нибудь да напечатаю,… да уж, не делайте так :). По сути сам датчик это та же ардуинка Про Мини, радиомодуль nRF24l01, датчик температуры и влажности SHT20, только без проводов и термоклея. Из «прибамбасов» это внешняя SPI флешка для прошивки по воздуху(для работы требуется бутлоадер ДуалОптибут, в последствии я перестал их(флешки) ставить на платы, тк пара прошивок по воздуху и полбатарейки нет) и «крипто микра» ATSHA204A так сказать для полного железного комплекта(в Mysensors для активации подписей, шифрования и тп достаточно просто указатать в начале скетча нужные #def).<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/mt/3r/ci/mt3rci4yk0yasyrccfbqe_ii3uw.jpeg" data-src="https://habrastorage.org/webt/mt/3r/ci/mt3rci4yk0yasyrccfbqe_ii3uw.jpeg" data-blurred="true"/><br/>
<br/>
Саму плату делал в программе Диптрейс, посмотрев видеоуроки на Ютубе, вначале показалось это чем то «адским», но на самом деле все оказалось не так уж и сложно. Платы заказывал в Китае на сайте jlcpcb.com, 2 бакса, любой цвет, и через 2 недели вы уже получаете на руки 10 штук «своего творения» :). <br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/g8/vt/89/g8vt89xocfduchhvirqldwcurh4.png"/><br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/zu/wm/zs/zuwmzsu8ervyhmnbxzdfprmdbcu.jpeg" data-src="https://habrastorage.org/webt/zu/wm/zs/zuwmzsu8ervyhmnbxzdfprmdbcu.jpeg" data-blurred="true"/><br/>
<br/>
Следующим этапом была разработка корпуса. О, это как оказалось еще та проблемка. Вообщем легких путей не искал, решил осваивать Солид Воркс. Как оказалось это совсем не как с Диптрейс. Тем не менее все же рекомендую именно этот редактор к изучению. Процесс обучения растянулся на месяц неспешного просмотра видеоуроков на Ютубе и повторения материалов урока в редакторе. В процессе разработки корпуса стало понятно что делать плату устройства без учета параметров будующего корпуса это плохое решение, из сериии вставляем палки в свои же колеса. По итогу версий плат вышло три с учетом установки платы в корпус, и думаю и это не последний вариант.<br/>
<br/>
В начале разработки корпуса идея была печатать его на FDM 3D принтере, но чем дальше в лес тем становилось понятнее что все мои хотелки оно не способно воспроизвести. К моменту как это понимание пришло уже узнал о другой технологии 3D печати — SLA. Недолго думая и впечатлившись качеством печати была оформлена хотелка на Али — <a href="https://ru.aliexpress.com/item/ANYCUBIC-SLA-3d-UV-lcd-2-K-Off/32846794715.html">ANYCUBIC Фотон</a>. (Ссылк ана Али, не рекламная, не партнерская,… просто ссылка).<br/>
<br/>
Напишу сразу, сейчас, на основе моего опыта на момент написания этой статьи,… ох уж и крутяцкая эта чудо штуковина!!! Корпус который был спроектирован в редакторе конечно и напечатался не с первого раза и доработок была куча. Ну по другому наверное и не бывает. В итоге получил тот результат который хотел. Довольно миниатюрное устройство, хороший DIY корпус с очень точной детализацией, кнпочки, шрифты, все как предствалял в голове. В заднюю крышку добавил магнитик, теперь можно легко крепить и на железные поверхности.<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/q2/a8/yz/q2a8yzmu0x8pzg6qtxs9nf4d0sc.jpeg" data-src="https://habrastorage.org/webt/q2/a8/yz/q2a8yzmu0x8pzg6qtxs9nf4d0sc.jpeg" data-blurred="true"/><br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/12/2j/pk/122jpkp-anp4zxqhshi7wp5bbga.jpeg" data-src="https://habrastorage.org/webt/12/2j/pk/122jpkp-anp4zxqhshi7wp5bbga.jpeg" data-blurred="true"/><br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/er/il/ak/erilakhq5uhxtx09ab54rn5brao.jpeg" data-src="https://habrastorage.org/webt/er/il/ak/erilakhq5uhxtx09ab54rn5brao.jpeg" data-blurred="true"/><br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/d3/pa/fh/d3pafhom0t6ydozgxjgm_o0g9eo.jpeg" data-src="https://habrastorage.org/webt/d3/pa/fh/d3pafhom0t6ydozgxjgm_o0g9eo.jpeg" data-blurred="true"/><br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/k-/2i/yj/k-2iyjlk9snioo4vktlengxti_g.jpeg" data-src="https://habrastorage.org/webt/k-/2i/yj/k-2iyjlk9snioo4vktlengxti_g.jpeg" data-blurred="true"/><br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/cc/du/yy/ccduyyya0_8awrvrplyrt4q3qze.jpeg" data-src="https://habrastorage.org/webt/cc/du/yy/ccduyyya0_8awrvrplyrt4q3qze.jpeg" data-blurred="true"/><br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/et/nf/5w/etnf5wimx4pwsf6k76uh5gobk3e.jpeg" data-src="https://habrastorage.org/webt/et/nf/5w/etnf5wimx4pwsf6k76uh5gobk3e.jpeg" data-blurred="true"/><br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/re/g8/z9/reg8z9zer-swbz32kn5afhkvwsq.jpeg" data-src="https://habrastorage.org/webt/re/g8/z9/reg8z9zer-swbz32kn5afhkvwsq.jpeg" data-blurred="true"/><br/>
<br/>
Это попытки напечатать туже модель на FDM принтере:<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/_i/et/hu/_iethu6tktjfhc85y3ulrh5xf8m.jpeg" data-src="https://habrastorage.org/webt/_i/et/hu/_iethu6tktjfhc85y3ulrh5xf8m.jpeg" data-blurred="true"/><br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/ow/6s/fh/ow6sfhpdvcmxy2lz0jemul6o0-i.jpeg" data-src="https://habrastorage.org/webt/ow/6s/fh/ow6sfhpdvcmxy2lz0jemul6o0-i.jpeg" data-blurred="true"/><br/>
<br/>
Так как девайс получился небольшой, но это все же ардуинка, то озадачился выводом миниатюрных разьемов для программирования. И соответственно к разьемам был сделан небольшой переходничек для удобного соединения с програматором и TTL конвертером.<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/pl/-l/48/pl-l48rq33glvskysput8i6gu7y.jpeg" data-src="https://habrastorage.org/webt/pl/-l/48/pl-l48rq33glvskysput8i6gu7y.jpeg" data-blurred="true"/><br/>
<br/>
Все закупалось на Али (да, там полно оказывается не только ардуино модулей)<br/>
<br/>
SMD tantalum capacitor 4.7uF — 4.7uF | 10v | 10% — C1<br/>
SMD ceramic capacitor 100nF | Y5V — 100nF | 50v | +80-20% — C2, C3, C4, C5, C6, C7<br/>
LED — LED SIDE — D1<br/>
Pin Header Female — 2x3P | 6pin | 1.27mm — J1, J2<br/>
SMD resistor 20K Ohm — 20K | 5% — R1<br/>
SMD resistor 4.7K Ohm — 4.7K | 5% — R2, R3, R4<br/>
SMD resistor 470K Ohm — 470 | 1% — R5<br/>
SMD resistor 1M Ohm — 1M | 1% — R6<br/>
SMD resistor 18K Ohm — 18K | 5% — R7<br/>
SMD resistor 10K Ohm — 10K | 5% — R8<br/>
4-pin SMD side button — SW1, SW2<br/>
512-Kbit, 1.65V SPI Serial Flash Memory — AT25DF512C-SSHN-B — U1<br/>
Mini NRF24L01 + 2.4GHz 1.27MM RF — nRF24l01 1.27 SMD — U2<br/>
ATMEGA328P-MU QFN32 — U3<br/>
CRYPTO AUTHENTICATION, 1 WIRE — ATSHA204A-STUCZ-T — U4<br/>
Humidity and Temperature Sensor IC — SHT20 — U5<br/>
BATTERY HOLDER FOR CR2477-1 — L-KLS5-CR2477-1 — U6<br/>
<br/>
Код программы достаточно прост. Для работы с датчиком SHT20 был использован пример библиотеки DFRobot. Впринципе любой скетч, для любого датчика можно за 5 минут преватить в скетч для работы в сети Mysensors.<br/>
<br/>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">Листинг кода</b>
                        <div class="spoiler_text"><pre><code class="cpp">#include &lt;Wire.h>
#include "DFRobot_SHT20.h"
DFRobot_SHT20    sht20; // https://github.com/DFRobot/DFRobot_SHT20

#define MY_DEBUG
//#define MY_DISABLED_SERIAL
#define MY_RADIO_RF24
#define MY_PASSIVE_NODE
#define MY_NODE_ID 200
#define MY_PARENT_NODE_ID 0
#define MY_PARENT_NODE_IS_STATIC
#define MY_TRANSPORT_UPLINK_CHECK_DISABLED
//#define MY_OTA_FIRMWARE_FEATURE
//#define MY_SIGNING_ATSHA204
//#define MY_SIGNING_ATSHA204_PIN A3
//#define MY_SIGNING_REQUEST_SIGNATURES

#define TEMP_SENS_ID 1
#define HUM_SENS_ID 2
#define SETTING_LED_SENS_ID 100
#define DELAY_TIME_SENS_ID 101
#define BATTARY_SEND_SENS_ID 102
#define BATTARY_DATA_SENS_ID 103

#define BAT_COOF 3.04
#define BAT_MIN 195
#define BAT_MAX 295
#define ON 1
#define OFF 0

float humd;
float temp;
float oldhumd;
float oldtemp;
float tempThreshold = 0.5;
float humThreshold = 10.0;
static uint32_t lightMillis;
static uint32_t previousMillis;
uint32_t send_batteryTime;
uint32_t w_battetyTime = 0;
static uint8_t led_pin = 4;
static uint8_t mode_pin = 2; // interrupt
uint32_t delayTime;
int8_t battery;
int8_t old_battery;
uint8_t set_led;
boolean sleep_mode;
boolean configMode = 0;
int8_t timer_status = 0;
bool flag_mode_button = 0;
bool sleep_flag = 0;
bool listen_flag = 0;

#include &lt;MySensors.h>

MyMessage msg_temp(TEMP_SENS_ID, V_TEMP);
MyMessage msg_hum(HUM_SENS_ID, V_HUM);
MyMessage msg_setting_led(SETTING_LED_SENS_ID, V_VAR1);
MyMessage msg_delay_time(DELAY_TIME_SENS_ID, V_VAR1);
MyMessage msg_battary_send(BATTARY_SEND_SENS_ID, V_VAR1);
MyMessage powerMsg(BATTARY_DATA_SENS_ID, V_VAR1);

void preHwInit()
{
  pinMode(led_pin, OUTPUT);
  digitalWrite(led_pin, OFF);
  pinMode(mode_pin, INPUT_PULLUP);
}

void before()
{
  set_led = loadState(100);
  if (set_led > 1) {
    set_led = 1;
    saveState(100, set_led);
  }
  delayTime = loadState(101);
  if (delayTime > 60) {
    delayTime = 3;
    saveState(101, delayTime);
  }
  send_batteryTime = loadState(102);
  if (send_batteryTime > 48) {
    send_batteryTime = 6;
    saveState(102, send_batteryTime);
  }


  digitalWrite(led_pin, ON);
}


void presentation()
{
  sendSketchInfo("Temp &amp; Hum Sensor CR2477", "1.0");
  wait(100);
  present(TEMP_SENS_ID, S_TEMP, "TEMPERATURE DATA");
  wait(100);
  present(HUM_SENS_ID, S_HUM, "HUMIDITY DATA");
  wait(100);
  present(SETTING_LED_SENS_ID, S_CUSTOM, "LED MODE");
  wait(100);
  present(DELAY_TIME_SENS_ID, S_CUSTOM, "DELAY TIME/MIN");
  wait(100);
  present(BATTARY_SEND_SENS_ID, S_CUSTOM, "BATTERY SEND TIME/H");
  wait(100);
  present(BATTARY_DATA_SENS_ID, S_CUSTOM, "BATTERY DATA");
}

void setup()
{
  //attachInterrupt(0, configListener, RISING);
  digitalWrite(led_pin, OFF);
  wait(500);
  digitalWrite(led_pin, ON);
  wait(75);
  digitalWrite(led_pin, OFF);
  wait(50);
  digitalWrite(led_pin, ON);
  wait(75);
  digitalWrite(led_pin, OFF);
  wait(50);
  digitalWrite(led_pin, ON);
  wait(75);
  digitalWrite(led_pin, OFF);
  TRANSPORT_DEBUG(PSTR("MyS: OPERATING MODE\n"));
  wait(100);
  readBatLev();
  wait(100);
  sht20.initSHT20();
  wait(100);
  send_data();
  wait(100);
  send(msg_delay_time.set(delayTime));
  wait(100);
  send(msg_setting_led.set(set_led));
  wait(100);
  send(msg_battary_send.set(send_batteryTime));
}

void loop()
{
  if (configMode == 0) {



    if (sleep_flag == 0) {
      timer_status = sleep(digitalPinToInterrupt(mode_pin), FALLING, delayTime * 60 * 1000, false);
      //timer_status = sleep(digitalPinToInterrupt(mode_pin), RISING, delayTime * 60 * 1000, false);
      sleep_flag = 1;
    }
    if (timer_status == -1) {

      w_battetyTime = w_battetyTime + (delayTime * 60 * 1000);

      if (w_battetyTime >= send_batteryTime * 60 * 60 * 1000) {
        readBatLev();
        w_battetyTime = 0;
      }
      send_data();
      sleep_flag = 0;
    }
    if (timer_status == 0) {
      if (digitalRead(2) == LOW &amp;&amp; flag_mode_button == 0) //если кнопка нажата
      {
        flag_mode_button = 1;
        previousMillis = millis();
        wait(50);
      }
      if (digitalRead(2) == LOW &amp;&amp; flag_mode_button == 1) {
        if ((millis() - previousMillis > 0) &amp;&amp; (millis() - previousMillis &lt;= 2000)) {
          if (millis() - lightMillis > 50)    {
            lightMillis = millis();
            digitalWrite(led_pin, !digitalRead(led_pin));
          }
        }
        if ((millis() - previousMillis > 2000) &amp;&amp; (millis() - previousMillis &lt;= 2500)) {
          digitalWrite(led_pin, OFF);
        }
        if ((millis() - previousMillis > 2500) &amp;&amp; (millis() - previousMillis &lt;= 4500)) {
          if (millis() - lightMillis > 25)    {
            lightMillis = millis();
            digitalWrite(led_pin, !digitalRead(led_pin));
          }
        }
        if (millis() - previousMillis > 4500) {
          digitalWrite(led_pin, OFF);
        }
      }
      if (digitalRead(2) == HIGH &amp;&amp; flag_mode_button == 1) //если кнопка НЕ нажата
      {
        if ((millis() - previousMillis > 0) &amp;&amp; (millis() - previousMillis &lt;= 2000)) {
          configMode = !configMode;
          flag_mode_button = 0;
          TRANSPORT_DEBUG(PSTR("MyS: CONFIGURATION MODE\n"));
          sleep_flag = 0;
          digitalWrite(led_pin, OFF);
        }
        if ((millis() - previousMillis > 2000) &amp;&amp; (millis() - previousMillis &lt;= 2500)) {
          flag_mode_button = 0;
          sleep_flag = 0;
        }
        if ((millis() - previousMillis > 2500) &amp;&amp; (millis() - previousMillis &lt;= 4500))
        {
          flag_mode_button = 0;
          sleep_flag = 0;
          digitalWrite(led_pin, OFF);
        }
        if (millis() - previousMillis > 4500) {
          flag_mode_button = 0;
          sleep_flag = 0;
          wait(50);
        }
      }
    }
  } else {
    if (listen_flag == 0) {
      RF24_startListening();
      listen_flag = 1;
    }
    if (millis() - lightMillis > 1000) {
      lightMillis = millis();
      digitalWrite(led_pin, !digitalRead(led_pin));
    }
    if (digitalRead(2) == LOW &amp;&amp; flag_mode_button == 0) //если кнопка нажата
    {
      flag_mode_button = 1;
      //previousMillis = millis();
      wait(50);
    }
    if (digitalRead(2) == LOW &amp;&amp; flag_mode_button == 1) {
      
    }
    if (digitalRead(2) == HIGH &amp;&amp; flag_mode_button == 1) //если кнопка НЕ нажата
    {
       
      configMode = !configMode;
      listen_flag = 0;
      flag_mode_button = 0;
      TRANSPORT_DEBUG(PSTR("MyS: OPERATING MODE\n"));
      digitalWrite(led_pin, OFF);
      wait(50);
    }
  }
}



void receive(const MyMessage &amp; message)
{
  if (message.sensor == SETTING_LED_SENS_ID) {
    if (message.type == V_VAR1) {
      if (message.getByte() &lt;= 1) {
        set_led = message.getBool();
        saveState(100, set_led);
        send(msg_setting_led.set(set_led));
        if (set_led == 0) {
          TRANSPORT_DEBUG(PSTR("MyS: STATUS LED: OFF\n"));
        }
        if (set_led == 1) {
          TRANSPORT_DEBUG(PSTR("MyS: STATUS LED: ON\n"));
          if (set_led == 1) {
            digitalWrite(led_pin, ON);
            wait(50);
            digitalWrite(led_pin, OFF);
          }
        }
      }
    }
  }
  if (message.sensor == DELAY_TIME_SENS_ID) {
    if (message.type == V_VAR1) {
      if (message.getULong() &lt;= 60 &amp;&amp; message.getULong() != 0) {
        delayTime = message.getULong();
        saveState(101, delayTime);
        send(msg_delay_time.set(delayTime));
        TRANSPORT_DEBUG(PSTR("MyS: THE NEW INTERVAL TEMP&amp;HUM SEND VALUE IS SET: %d MIN.\n"), delayTime);
        if (set_led == 1) {
          digitalWrite(led_pin, ON);
          wait(50);
          digitalWrite(led_pin, OFF);
        }
      } else if (message.getULong() > 60) {
        delayTime = 60;
        saveState(101, delayTime);
        send(msg_delay_time.set(delayTime));
        TRANSPORT_DEBUG(PSTR("MyS: THE NEW INTERVAL TEMP&amp;HUM SEND VALUE IS SET: %d MIN.\n"), delayTime);
        if (set_led == 1) {
          digitalWrite(led_pin, ON);
          wait(50);
          digitalWrite(led_pin, OFF);
        }
      } else if (message.getULong() == 0) {
        delayTime = 1;
        saveState(101, delayTime);
        send(msg_delay_time.set(delayTime));
        TRANSPORT_DEBUG(PSTR("MyS: THE NEW INTERVAL TEMP&amp;HUM SEND VALUE IS SET: %d MIN.\n"), delayTime);
        if (set_led == 1) {
          digitalWrite(led_pin, ON);
          wait(50);
          digitalWrite(led_pin, OFF);
        }
      }
    }
  }
  if (message.sensor == BATTARY_SEND_SENS_ID) {
    if (message.type == V_VAR1) {
      if (message.getULong() &lt;= 168) {
        send_batteryTime = message.getULong();
        saveState(102, send_batteryTime);
        send(msg_battary_send.set(send_batteryTime));
        TRANSPORT_DEBUG(PSTR("MyS: THE NEW INTERVAL BATTERY SEND IS SET: %d HOUR\n"), send_batteryTime);
        if (set_led == 1) {
          digitalWrite(led_pin, ON);
          wait(50);
          digitalWrite(led_pin, OFF);
        }
      }
    }
  }
}

void send_data()
{
  humd = sht20.readHumidity();
  temp = sht20.readTemperature();
  int t_humd = (int)humd;
  int t_temp = (int)temp;
  if (abs(temp - oldtemp) >= tempThreshold) {
    send(msg_temp.set(temp, 1));
    oldtemp = temp;
    if (set_led == 1) {
      digitalWrite(led_pin, ON);
      wait(50);
      digitalWrite(led_pin, OFF);
    }
  }
  wait(100);
  if (abs(humd - oldhumd) >= humThreshold) {
    send(msg_hum.set(humd, 1));
    oldhumd = humd;
    if (set_led == 1) {
      digitalWrite(led_pin, ON);
      wait(50);
      digitalWrite(led_pin, OFF);
    }
  }
  TRANSPORT_DEBUG(PSTR("MyS: DATA - TEMPERATURE: %d, HUMIDITY %d\n"), t_temp, t_humd);
}


void readBatLev() {
  ADMUX = _BV(REFS1) | _BV(REFS0) | _BV(MUX0);
  wait(100);
  RF24_startListening();
  wait(200);
  ADCSRA |= _BV(ADSC);
  while (bit_is_set(ADCSRA, ADSC));
  uint8_t low  = ADCL;
  uint8_t high = ADCH;
  long temp = (high &lt;&lt; 8) | low;
  float vcc = temp * 1.1 / 1023 * BAT_COOF * 100;
  battery = map((int)vcc, BAT_MIN, BAT_MAX, 0, 100);
  if (battery &lt; 0) {
    battery = 0;
  }
  if (battery > 100) {
    battery = 100;
  }
  TRANSPORT_DEBUG(PSTR("MyS: BATTERY LEVEL: %d, PREVIUS BATTERY LEVEL: %d\n"), battery, old_battery);
  TRANSPORT_DEBUG(PSTR("MyS: BATTERY LEVEL ADC: %d\n"), temp);

  /*
    if (old_battery != battery) {
      if (battery &lt; old_battery) {
        old_battery = battery;
        wait(100);
        sendBatteryLevel(battery);
        wait(100);
        send(powerMsg.set(temp));
        TRANSPORT_DEBUG(PSTR("MyS: SEND BATTERY LEVEL\n"));
      } else {
        battery = old_battery;
      }
    }
  */
  wait(100);
  sendBatteryLevel(battery);
  wait(100);
  send(powerMsg.set(temp));
  TRANSPORT_DEBUG(PSTR("MyS: SEND BATTERY LEVEL\n"));
}
</code></pre><br/>
</div>
                    </div><br/>
На видео показан тест работы датчика:<br/>
<br/>
<div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.2493%;"><div class="tm-iframe_temp" data-src="https://www.youtube.com/embed/XWu5sogiiQg?rel=0&amp;showinfo=1&amp;hl=en-US" data-style="border: 0; top: 0; left: 0; width: 100%; height: 100%; position: absolute;" id="" width=""></div></div></div></div><br/>
Работа датчика с Мажордомо:<br/>
<br/>
<div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.2493%;"><div class="tm-iframe_temp" data-src="https://www.youtube.com/embed/juQU4pSIvPg?rel=0&amp;showinfo=1&amp;hl=en-US" data-style="border: 0; top: 0; left: 0; width: 100%; height: 100%; position: absolute;" id="" width=""></div></div></div></div><br/>
Контролером умного дома является Мажордомо(думаю многим известная система), написан модуль Mysensors(пожалуй одна из лучших реализаций поддержки протокола Mysensors в контролерах)<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/8x/6i/ie/8x6iie5r4kpdwjan5kqdkvq337c.png"/><br/>
<br/>
Проект естественно открытый и рекомендованный к повторению. Все детали разработки, файлы плат, прошивка, 3d модели корпуса выложены на сайте <a href="http://www.openhardware.io">www.openhardware.io</a>. На вопросы по данной разработке, по трудностям в ваших разработках на ардуинках и Mysensors всегда придут на помощь в нашем телеграмм чате — <b><a href="https://t.me/mysensors_rus">t.me/mysensors_rus</a></b>.</div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Barduino%5D" class="tm-tags-list__link">arduino</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Batmega328p%5D" class="tm-tags-list__link">atmega328p</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bsht20%5D" class="tm-tags-list__link">sht20</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bnrf24l01%2B%5D" class="tm-tags-list__link">nrf24l01+</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bmysensors%5D" class="tm-tags-list__link">mysensors</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hub/DIY/" class="tm-hubs-list__link">
    DIY или Сделай сам
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 34: ↑32 и ↓2</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 34: ↑32 и ↓2" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+30</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">13K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    102
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/Berkseo/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/61e/efa/39e/61eefa39e0d79dcc9ca5f38ca3dcbb3d.png" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 116 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    77
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><!----> <a href="/ru/users/Berkseo/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @Berkseo
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">Пользователь</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <button type="submit" class="tm-user-card__button btn btn_transparent btn_small">
      Задонатить
    </button> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/452234/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 159 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <!----> <!----> <!----> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/452234/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/452234/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"452234":{"id":"452234","timePublished":"2019-05-16T21:44:18+00:00","isCorporative":false,"lang":"ru","titleHtml":"Термометр &amp; гигрометр на ATMEGA 328P-MU — Поднимаем уровень ардуино разработок","leadData":{"textHtml":"Сегодня хочу поделиться одним из своих Ардуино проектов. Когда-то, не очень что бы давно я где-то на просторах интернета узнал об Ардуино. Влился я в это дело довольно быстро, уровень вхождения там не высокий. Через некоторое время уже собрав кучу датчиков, сенсоров для умного дома стал ловить себя на мысли что как то это все не по уму. ","imageUrl":null,"buttonTextHtml":null,"image":null},"editorVersion":"1.0","postType":"article","postLabels":[],"author":{"scoreStats":{"score":77,"votesCount":116},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":"4100140180242","paymentPayPalMe":"efektalab","paymentWebmoney":"876077872834"},"id":"1474317","alias":"Berkseo","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F61e\u002Fefa\u002F39e\u002F61eefa39e0d79dcc9ca5f38ca3dcbb3d.png","speciality":"Пользователь"},"statistics":{"commentsCount":159,"favoritesCount":102,"readingCount":13399,"score":30,"votesCount":34},"hubs":[{"relatedData":null,"id":"21976","alias":"DIY","type":"collective","title":"DIY или Сделай сам","titleHtml":"DIY или Сделай сам","isProfiled":false}],"flows":[{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EСегодня хочу поделиться одним из своих Ардуино проектов. Когда-то, не очень что бы давно я где-то на просторах интернета узнал об Ардуино. Влился я в это дело довольно быстро, уровень вхождения там не высокий. Через некоторое время уже собрав кучу датчиков, сенсоров для умного дома стал ловить себя на мысли что как то это все не по уму. \u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003EМодули, большие незамысловатые коробки, куча проводов и термоклея :). Смотря на свою коробку с датчиком темературы и например на датчик температуры того же Сяоми, понимал что хочется что бы выглядел как у Сяоми но в тоже время что бы его можно было как хочешь перепрограмировать как мой в коробке размерами 10см на 6см с проводами и термоклеем. И наверное тогда и было положено начало моим DIY ардуино проектам на PCB платах.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ сегодняшней статье речь пойдет о датчике температуры и влажности на базе процессора atmega328p-mu. Это более «мелкая» версия(абсолютный аналог) изветного всем ардуинщикам процессора atmega328p-au (Arduino Uno, Pro Mini, Nano). Если кто то ранее читал мои статьи то знает что я предпочитаю Mysensors. Что это? Это очень простая и хорошо проработанная и что немаловажно отлично описанная библиотека под Ардуино ИДЕ (и не только) для создания IOT радиосетей на частотах 2.4Ггц, 915, 868, 433 Мгц, а так же проводных сетей на интерфейсе 485, возможно не все упомянул, тк протокол постоянно развивается, все время что то добавляется. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПервое что было сделано, это собственно сам датчик на PCB плате. Делал без оглядки на корпус, по принципу, главное сделать датчик а уж корпус как нибудь да напечатаю,… да уж, не делайте так :). По сути сам датчик это та же ардуинка Про Мини, радиомодуль nRF24l01, датчик температуры и влажности SHT20, только без проводов и термоклея. Из «прибамбасов» это внешняя SPI флешка для прошивки по воздуху(для работы требуется бутлоадер ДуалОптибут, в последствии я перестал их(флешки) ставить на платы, тк пара прошивок по воздуху и полбатарейки нет) и «крипто микра» ATSHA204A так сказать для полного железного комплекта(в Mysensors для активации подписей, шифрования и тп достаточно просто указатать в начале скетча нужные #def).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fmt\u002F3r\u002Fci\u002Fmt3rci4yk0yasyrccfbqe_ii3uw.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fmt\u002F3r\u002Fci\u002Fmt3rci4yk0yasyrccfbqe_ii3uw.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСаму плату делал в программе Диптрейс, посмотрев видеоуроки на Ютубе, вначале показалось это чем то «адским», но на самом деле все оказалось не так уж и сложно. Платы заказывал в Китае на сайте jlcpcb.com, 2 бакса, любой цвет, и через 2 недели вы уже получаете на руки 10 штук «своего творения» :). \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fg8\u002Fvt\u002F89\u002Fg8vt89xocfduchhvirqldwcurh4.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fzu\u002Fwm\u002Fzs\u002Fzuwmzsu8ervyhmnbxzdfprmdbcu.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fzu\u002Fwm\u002Fzs\u002Fzuwmzsu8ervyhmnbxzdfprmdbcu.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСледующим этапом была разработка корпуса. О, это как оказалось еще та проблемка. Вообщем легких путей не искал, решил осваивать Солид Воркс. Как оказалось это совсем не как с Диптрейс. Тем не менее все же рекомендую именно этот редактор к изучению. Процесс обучения растянулся на месяц неспешного просмотра видеоуроков на Ютубе и повторения материалов урока в редакторе. В процессе разработки корпуса стало понятно что делать плату устройства без учета параметров будующего корпуса это плохое решение, из сериии вставляем палки в свои же колеса. По итогу версий плат вышло три с учетом установки платы в корпус, и думаю и это не последний вариант.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ начале разработки корпуса идея была печатать его на FDM 3D принтере, но чем дальше в лес тем становилось понятнее что все мои хотелки оно не способно воспроизвести. К моменту как это понимание пришло уже узнал о другой технологии 3D печати — SLA. Недолго думая и впечатлившись качеством печати была оформлена хотелка на Али — \u003Ca href=\"https:\u002F\u002Fru.aliexpress.com\u002Fitem\u002FANYCUBIC-SLA-3d-UV-lcd-2-K-Off\u002F32846794715.html\"\u003EANYCUBIC Фотон\u003C\u002Fa\u003E. (Ссылк ана Али, не рекламная, не партнерская,… просто ссылка).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНапишу сразу, сейчас, на основе моего опыта на момент написания этой статьи,… ох уж и крутяцкая эта чудо штуковина!!! Корпус который был спроектирован в редакторе конечно и напечатался не с первого раза и доработок была куча. Ну по другому наверное и не бывает. В итоге получил тот результат который хотел. Довольно миниатюрное устройство, хороший DIY корпус с очень точной детализацией, кнпочки, шрифты, все как предствалял в голове. В заднюю крышку добавил магнитик, теперь можно легко крепить и на железные поверхности.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fq2\u002Fa8\u002Fyz\u002Fq2a8yzmu0x8pzg6qtxs9nf4d0sc.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fq2\u002Fa8\u002Fyz\u002Fq2a8yzmu0x8pzg6qtxs9nf4d0sc.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002F12\u002F2j\u002Fpk\u002F122jpkp-anp4zxqhshi7wp5bbga.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F12\u002F2j\u002Fpk\u002F122jpkp-anp4zxqhshi7wp5bbga.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fer\u002Fil\u002Fak\u002Ferilakhq5uhxtx09ab54rn5brao.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fer\u002Fil\u002Fak\u002Ferilakhq5uhxtx09ab54rn5brao.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fd3\u002Fpa\u002Ffh\u002Fd3pafhom0t6ydozgxjgm_o0g9eo.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fd3\u002Fpa\u002Ffh\u002Fd3pafhom0t6ydozgxjgm_o0g9eo.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fk-\u002F2i\u002Fyj\u002Fk-2iyjlk9snioo4vktlengxti_g.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fk-\u002F2i\u002Fyj\u002Fk-2iyjlk9snioo4vktlengxti_g.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fcc\u002Fdu\u002Fyy\u002Fccduyyya0_8awrvrplyrt4q3qze.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fcc\u002Fdu\u002Fyy\u002Fccduyyya0_8awrvrplyrt4q3qze.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fet\u002Fnf\u002F5w\u002Fetnf5wimx4pwsf6k76uh5gobk3e.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fet\u002Fnf\u002F5w\u002Fetnf5wimx4pwsf6k76uh5gobk3e.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fre\u002Fg8\u002Fz9\u002Freg8z9zer-swbz32kn5afhkvwsq.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fre\u002Fg8\u002Fz9\u002Freg8z9zer-swbz32kn5afhkvwsq.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЭто попытки напечатать туже модель на FDM принтере:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002F_i\u002Fet\u002Fhu\u002F_iethu6tktjfhc85y3ulrh5xf8m.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F_i\u002Fet\u002Fhu\u002F_iethu6tktjfhc85y3ulrh5xf8m.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fow\u002F6s\u002Ffh\u002Fow6sfhpdvcmxy2lz0jemul6o0-i.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fow\u002F6s\u002Ffh\u002Fow6sfhpdvcmxy2lz0jemul6o0-i.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТак как девайс получился небольшой, но это все же ардуинка, то озадачился выводом миниатюрных разьемов для программирования. И соответственно к разьемам был сделан небольшой переходничек для удобного соединения с програматором и TTL конвертером.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fpl\u002F-l\u002F48\u002Fpl-l48rq33glvskysput8i6gu7y.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fpl\u002F-l\u002F48\u002Fpl-l48rq33glvskysput8i6gu7y.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВсе закупалось на Али (да, там полно оказывается не только ардуино модулей)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nSMD tantalum capacitor 4.7uF — 4.7uF | 10v | 10% — C1\u003Cbr\u002F\u003E\r\nSMD ceramic capacitor 100nF | Y5V — 100nF | 50v | +80-20% — C2, C3, C4, C5, C6, C7\u003Cbr\u002F\u003E\r\nLED — LED SIDE — D1\u003Cbr\u002F\u003E\r\nPin Header Female — 2x3P | 6pin | 1.27mm — J1, J2\u003Cbr\u002F\u003E\r\nSMD resistor 20K Ohm — 20K | 5% — R1\u003Cbr\u002F\u003E\r\nSMD resistor 4.7K Ohm — 4.7K | 5% — R2, R3, R4\u003Cbr\u002F\u003E\r\nSMD resistor 470K Ohm — 470 | 1% — R5\u003Cbr\u002F\u003E\r\nSMD resistor 1M Ohm — 1M | 1% — R6\u003Cbr\u002F\u003E\r\nSMD resistor 18K Ohm — 18K | 5% — R7\u003Cbr\u002F\u003E\r\nSMD resistor 10K Ohm — 10K | 5% — R8\u003Cbr\u002F\u003E\r\n4-pin SMD side button — SW1, SW2\u003Cbr\u002F\u003E\r\n512-Kbit, 1.65V SPI Serial Flash Memory — AT25DF512C-SSHN-B — U1\u003Cbr\u002F\u003E\r\nMini NRF24L01 + 2.4GHz 1.27MM RF — nRF24l01 1.27 SMD — U2\u003Cbr\u002F\u003E\r\nATMEGA328P-MU QFN32 — U3\u003Cbr\u002F\u003E\r\nCRYPTO AUTHENTICATION, 1 WIRE — ATSHA204A-STUCZ-T — U4\u003Cbr\u002F\u003E\r\nHumidity and Temperature Sensor IC — SHT20 — U5\u003Cbr\u002F\u003E\r\nBATTERY HOLDER FOR CR2477-1 — L-KLS5-CR2477-1 — U6\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nКод программы достаточно прост. Для работы с датчиком SHT20 был использован пример библиотеки DFRobot. Впринципе любой скетч, для любого датчика можно за 5 минут преватить в скетч для работы в сети Mysensors.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\" role=\"button\" tabindex=\"0\"\u003E\n                        \u003Cb class=\"spoiler_title\"\u003EЛистинг кода\u003C\u002Fb\u003E\n                        \u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"cpp\"\u003E#include &lt;Wire.h\u003E\n#include \"DFRobot_SHT20.h\"\nDFRobot_SHT20    sht20; \u002F\u002F https:\u002F\u002Fgithub.com\u002FDFRobot\u002FDFRobot_SHT20\n\n#define MY_DEBUG\n\u002F\u002F#define MY_DISABLED_SERIAL\n#define MY_RADIO_RF24\n#define MY_PASSIVE_NODE\n#define MY_NODE_ID 200\n#define MY_PARENT_NODE_ID 0\n#define MY_PARENT_NODE_IS_STATIC\n#define MY_TRANSPORT_UPLINK_CHECK_DISABLED\n\u002F\u002F#define MY_OTA_FIRMWARE_FEATURE\n\u002F\u002F#define MY_SIGNING_ATSHA204\n\u002F\u002F#define MY_SIGNING_ATSHA204_PIN A3\n\u002F\u002F#define MY_SIGNING_REQUEST_SIGNATURES\n\n#define TEMP_SENS_ID 1\n#define HUM_SENS_ID 2\n#define SETTING_LED_SENS_ID 100\n#define DELAY_TIME_SENS_ID 101\n#define BATTARY_SEND_SENS_ID 102\n#define BATTARY_DATA_SENS_ID 103\n\n#define BAT_COOF 3.04\n#define BAT_MIN 195\n#define BAT_MAX 295\n#define ON 1\n#define OFF 0\n\nfloat humd;\nfloat temp;\nfloat oldhumd;\nfloat oldtemp;\nfloat tempThreshold = 0.5;\nfloat humThreshold = 10.0;\nstatic uint32_t lightMillis;\nstatic uint32_t previousMillis;\nuint32_t send_batteryTime;\nuint32_t w_battetyTime = 0;\nstatic uint8_t led_pin = 4;\nstatic uint8_t mode_pin = 2; \u002F\u002F interrupt\nuint32_t delayTime;\nint8_t battery;\nint8_t old_battery;\nuint8_t set_led;\nboolean sleep_mode;\nboolean configMode = 0;\nint8_t timer_status = 0;\nbool flag_mode_button = 0;\nbool sleep_flag = 0;\nbool listen_flag = 0;\n\n#include &lt;MySensors.h\u003E\n\nMyMessage msg_temp(TEMP_SENS_ID, V_TEMP);\nMyMessage msg_hum(HUM_SENS_ID, V_HUM);\nMyMessage msg_setting_led(SETTING_LED_SENS_ID, V_VAR1);\nMyMessage msg_delay_time(DELAY_TIME_SENS_ID, V_VAR1);\nMyMessage msg_battary_send(BATTARY_SEND_SENS_ID, V_VAR1);\nMyMessage powerMsg(BATTARY_DATA_SENS_ID, V_VAR1);\n\nvoid preHwInit()\n{\n  pinMode(led_pin, OUTPUT);\n  digitalWrite(led_pin, OFF);\n  pinMode(mode_pin, INPUT_PULLUP);\n}\n\nvoid before()\n{\n  set_led = loadState(100);\n  if (set_led \u003E 1) {\n    set_led = 1;\n    saveState(100, set_led);\n  }\n  delayTime = loadState(101);\n  if (delayTime \u003E 60) {\n    delayTime = 3;\n    saveState(101, delayTime);\n  }\n  send_batteryTime = loadState(102);\n  if (send_batteryTime \u003E 48) {\n    send_batteryTime = 6;\n    saveState(102, send_batteryTime);\n  }\n\n\n  digitalWrite(led_pin, ON);\n}\n\n\nvoid presentation()\n{\n  sendSketchInfo(\"Temp &amp; Hum Sensor CR2477\", \"1.0\");\n  wait(100);\n  present(TEMP_SENS_ID, S_TEMP, \"TEMPERATURE DATA\");\n  wait(100);\n  present(HUM_SENS_ID, S_HUM, \"HUMIDITY DATA\");\n  wait(100);\n  present(SETTING_LED_SENS_ID, S_CUSTOM, \"LED MODE\");\n  wait(100);\n  present(DELAY_TIME_SENS_ID, S_CUSTOM, \"DELAY TIME\u002FMIN\");\n  wait(100);\n  present(BATTARY_SEND_SENS_ID, S_CUSTOM, \"BATTERY SEND TIME\u002FH\");\n  wait(100);\n  present(BATTARY_DATA_SENS_ID, S_CUSTOM, \"BATTERY DATA\");\n}\n\nvoid setup()\n{\n  \u002F\u002FattachInterrupt(0, configListener, RISING);\n  digitalWrite(led_pin, OFF);\n  wait(500);\n  digitalWrite(led_pin, ON);\n  wait(75);\n  digitalWrite(led_pin, OFF);\n  wait(50);\n  digitalWrite(led_pin, ON);\n  wait(75);\n  digitalWrite(led_pin, OFF);\n  wait(50);\n  digitalWrite(led_pin, ON);\n  wait(75);\n  digitalWrite(led_pin, OFF);\n  TRANSPORT_DEBUG(PSTR(\"MyS: OPERATING MODE\\n\"));\n  wait(100);\n  readBatLev();\n  wait(100);\n  sht20.initSHT20();\n  wait(100);\n  send_data();\n  wait(100);\n  send(msg_delay_time.set(delayTime));\n  wait(100);\n  send(msg_setting_led.set(set_led));\n  wait(100);\n  send(msg_battary_send.set(send_batteryTime));\n}\n\nvoid loop()\n{\n  if (configMode == 0) {\n\n\n\n    if (sleep_flag == 0) {\n      timer_status = sleep(digitalPinToInterrupt(mode_pin), FALLING, delayTime * 60 * 1000, false);\n      \u002F\u002Ftimer_status = sleep(digitalPinToInterrupt(mode_pin), RISING, delayTime * 60 * 1000, false);\n      sleep_flag = 1;\n    }\n    if (timer_status == -1) {\n\n      w_battetyTime = w_battetyTime + (delayTime * 60 * 1000);\n\n      if (w_battetyTime \u003E= send_batteryTime * 60 * 60 * 1000) {\n        readBatLev();\n        w_battetyTime = 0;\n      }\n      send_data();\n      sleep_flag = 0;\n    }\n    if (timer_status == 0) {\n      if (digitalRead(2) == LOW &amp;&amp; flag_mode_button == 0) \u002F\u002Fесли кнопка нажата\n      {\n        flag_mode_button = 1;\n        previousMillis = millis();\n        wait(50);\n      }\n      if (digitalRead(2) == LOW &amp;&amp; flag_mode_button == 1) {\n        if ((millis() - previousMillis \u003E 0) &amp;&amp; (millis() - previousMillis &lt;= 2000)) {\n          if (millis() - lightMillis \u003E 50)    {\n            lightMillis = millis();\n            digitalWrite(led_pin, !digitalRead(led_pin));\n          }\n        }\n        if ((millis() - previousMillis \u003E 2000) &amp;&amp; (millis() - previousMillis &lt;= 2500)) {\n          digitalWrite(led_pin, OFF);\n        }\n        if ((millis() - previousMillis \u003E 2500) &amp;&amp; (millis() - previousMillis &lt;= 4500)) {\n          if (millis() - lightMillis \u003E 25)    {\n            lightMillis = millis();\n            digitalWrite(led_pin, !digitalRead(led_pin));\n          }\n        }\n        if (millis() - previousMillis \u003E 4500) {\n          digitalWrite(led_pin, OFF);\n        }\n      }\n      if (digitalRead(2) == HIGH &amp;&amp; flag_mode_button == 1) \u002F\u002Fесли кнопка НЕ нажата\n      {\n        if ((millis() - previousMillis \u003E 0) &amp;&amp; (millis() - previousMillis &lt;= 2000)) {\n          configMode = !configMode;\n          flag_mode_button = 0;\n          TRANSPORT_DEBUG(PSTR(\"MyS: CONFIGURATION MODE\\n\"));\n          sleep_flag = 0;\n          digitalWrite(led_pin, OFF);\n        }\n        if ((millis() - previousMillis \u003E 2000) &amp;&amp; (millis() - previousMillis &lt;= 2500)) {\n          flag_mode_button = 0;\n          sleep_flag = 0;\n        }\n        if ((millis() - previousMillis \u003E 2500) &amp;&amp; (millis() - previousMillis &lt;= 4500))\n        {\n          flag_mode_button = 0;\n          sleep_flag = 0;\n          digitalWrite(led_pin, OFF);\n        }\n        if (millis() - previousMillis \u003E 4500) {\n          flag_mode_button = 0;\n          sleep_flag = 0;\n          wait(50);\n        }\n      }\n    }\n  } else {\n    if (listen_flag == 0) {\n      RF24_startListening();\n      listen_flag = 1;\n    }\n    if (millis() - lightMillis \u003E 1000) {\n      lightMillis = millis();\n      digitalWrite(led_pin, !digitalRead(led_pin));\n    }\n    if (digitalRead(2) == LOW &amp;&amp; flag_mode_button == 0) \u002F\u002Fесли кнопка нажата\n    {\n      flag_mode_button = 1;\n      \u002F\u002FpreviousMillis = millis();\n      wait(50);\n    }\n    if (digitalRead(2) == LOW &amp;&amp; flag_mode_button == 1) {\n      \n    }\n    if (digitalRead(2) == HIGH &amp;&amp; flag_mode_button == 1) \u002F\u002Fесли кнопка НЕ нажата\n    {\n       \n      configMode = !configMode;\n      listen_flag = 0;\n      flag_mode_button = 0;\n      TRANSPORT_DEBUG(PSTR(\"MyS: OPERATING MODE\\n\"));\n      digitalWrite(led_pin, OFF);\n      wait(50);\n    }\n  }\n}\n\n\n\nvoid receive(const MyMessage &amp; message)\n{\n  if (message.sensor == SETTING_LED_SENS_ID) {\n    if (message.type == V_VAR1) {\n      if (message.getByte() &lt;= 1) {\n        set_led = message.getBool();\n        saveState(100, set_led);\n        send(msg_setting_led.set(set_led));\n        if (set_led == 0) {\n          TRANSPORT_DEBUG(PSTR(\"MyS: STATUS LED: OFF\\n\"));\n        }\n        if (set_led == 1) {\n          TRANSPORT_DEBUG(PSTR(\"MyS: STATUS LED: ON\\n\"));\n          if (set_led == 1) {\n            digitalWrite(led_pin, ON);\n            wait(50);\n            digitalWrite(led_pin, OFF);\n          }\n        }\n      }\n    }\n  }\n  if (message.sensor == DELAY_TIME_SENS_ID) {\n    if (message.type == V_VAR1) {\n      if (message.getULong() &lt;= 60 &amp;&amp; message.getULong() != 0) {\n        delayTime = message.getULong();\n        saveState(101, delayTime);\n        send(msg_delay_time.set(delayTime));\n        TRANSPORT_DEBUG(PSTR(\"MyS: THE NEW INTERVAL TEMP&amp;HUM SEND VALUE IS SET: %d MIN.\\n\"), delayTime);\n        if (set_led == 1) {\n          digitalWrite(led_pin, ON);\n          wait(50);\n          digitalWrite(led_pin, OFF);\n        }\n      } else if (message.getULong() \u003E 60) {\n        delayTime = 60;\n        saveState(101, delayTime);\n        send(msg_delay_time.set(delayTime));\n        TRANSPORT_DEBUG(PSTR(\"MyS: THE NEW INTERVAL TEMP&amp;HUM SEND VALUE IS SET: %d MIN.\\n\"), delayTime);\n        if (set_led == 1) {\n          digitalWrite(led_pin, ON);\n          wait(50);\n          digitalWrite(led_pin, OFF);\n        }\n      } else if (message.getULong() == 0) {\n        delayTime = 1;\n        saveState(101, delayTime);\n        send(msg_delay_time.set(delayTime));\n        TRANSPORT_DEBUG(PSTR(\"MyS: THE NEW INTERVAL TEMP&amp;HUM SEND VALUE IS SET: %d MIN.\\n\"), delayTime);\n        if (set_led == 1) {\n          digitalWrite(led_pin, ON);\n          wait(50);\n          digitalWrite(led_pin, OFF);\n        }\n      }\n    }\n  }\n  if (message.sensor == BATTARY_SEND_SENS_ID) {\n    if (message.type == V_VAR1) {\n      if (message.getULong() &lt;= 168) {\n        send_batteryTime = message.getULong();\n        saveState(102, send_batteryTime);\n        send(msg_battary_send.set(send_batteryTime));\n        TRANSPORT_DEBUG(PSTR(\"MyS: THE NEW INTERVAL BATTERY SEND IS SET: %d HOUR\\n\"), send_batteryTime);\n        if (set_led == 1) {\n          digitalWrite(led_pin, ON);\n          wait(50);\n          digitalWrite(led_pin, OFF);\n        }\n      }\n    }\n  }\n}\n\nvoid send_data()\n{\n  humd = sht20.readHumidity();\n  temp = sht20.readTemperature();\n  int t_humd = (int)humd;\n  int t_temp = (int)temp;\n  if (abs(temp - oldtemp) \u003E= tempThreshold) {\n    send(msg_temp.set(temp, 1));\n    oldtemp = temp;\n    if (set_led == 1) {\n      digitalWrite(led_pin, ON);\n      wait(50);\n      digitalWrite(led_pin, OFF);\n    }\n  }\n  wait(100);\n  if (abs(humd - oldhumd) \u003E= humThreshold) {\n    send(msg_hum.set(humd, 1));\n    oldhumd = humd;\n    if (set_led == 1) {\n      digitalWrite(led_pin, ON);\n      wait(50);\n      digitalWrite(led_pin, OFF);\n    }\n  }\n  TRANSPORT_DEBUG(PSTR(\"MyS: DATA - TEMPERATURE: %d, HUMIDITY %d\\n\"), t_temp, t_humd);\n}\n\n\nvoid readBatLev() {\n  ADMUX = _BV(REFS1) | _BV(REFS0) | _BV(MUX0);\n  wait(100);\n  RF24_startListening();\n  wait(200);\n  ADCSRA |= _BV(ADSC);\n  while (bit_is_set(ADCSRA, ADSC));\n  uint8_t low  = ADCL;\n  uint8_t high = ADCH;\n  long temp = (high &lt;&lt; 8) | low;\n  float vcc = temp * 1.1 \u002F 1023 * BAT_COOF * 100;\n  battery = map((int)vcc, BAT_MIN, BAT_MAX, 0, 100);\n  if (battery &lt; 0) {\n    battery = 0;\n  }\n  if (battery \u003E 100) {\n    battery = 100;\n  }\n  TRANSPORT_DEBUG(PSTR(\"MyS: BATTERY LEVEL: %d, PREVIUS BATTERY LEVEL: %d\\n\"), battery, old_battery);\n  TRANSPORT_DEBUG(PSTR(\"MyS: BATTERY LEVEL ADC: %d\\n\"), temp);\n\n  \u002F*\n    if (old_battery != battery) {\n      if (battery &lt; old_battery) {\n        old_battery = battery;\n        wait(100);\n        sendBatteryLevel(battery);\n        wait(100);\n        send(powerMsg.set(temp));\n        TRANSPORT_DEBUG(PSTR(\"MyS: SEND BATTERY LEVEL\\n\"));\n      } else {\n        battery = old_battery;\n      }\n    }\n  *\u002F\n  wait(100);\n  sendBatteryLevel(battery);\n  wait(100);\n  send(powerMsg.set(temp));\n  TRANSPORT_DEBUG(PSTR(\"MyS: SEND BATTERY LEVEL\\n\"));\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\n                    \u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nНа видео показан тест работы датчика:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"oembed\"\u003E\u003Cdiv\u003E\u003Cdiv style=\"left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.2493%;\"\u003E\u003Cdiv class=\"tm-iframe_temp\" data-src=\"https:\u002F\u002Fwww.youtube.com\u002Fembed\u002FXWu5sogiiQg?rel=0&amp;showinfo=1&amp;hl=en-US\" data-style=\"border: 0; top: 0; left: 0; width: 100%; height: 100%; position: absolute;\" id=\"\" width=\"\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nРабота датчика с Мажордомо:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"oembed\"\u003E\u003Cdiv\u003E\u003Cdiv style=\"left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.2493%;\"\u003E\u003Cdiv class=\"tm-iframe_temp\" data-src=\"https:\u002F\u002Fwww.youtube.com\u002Fembed\u002FjuQU4pSIvPg?rel=0&amp;showinfo=1&amp;hl=en-US\" data-style=\"border: 0; top: 0; left: 0; width: 100%; height: 100%; position: absolute;\" id=\"\" width=\"\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nКонтролером умного дома является Мажордомо(думаю многим известная система), написан модуль Mysensors(пожалуй одна из лучших реализаций поддержки протокола Mysensors в контролерах)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F8x\u002F6i\u002Fie\u002F8x6iie5r4kpdwjan5kqdkvq337c.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПроект естественно открытый и рекомендованный к повторению. Все детали разработки, файлы плат, прошивка, 3d модели корпуса выложены на сайте \u003Ca href=\"http:\u002F\u002Fwww.openhardware.io\"\u003Ewww.openhardware.io\u003C\u002Fa\u003E. На вопросы по данной разработке, по трудностям в ваших разработках на ардуинках и Mysensors всегда придут на помощь в нашем телеграмм чате — \u003Cb\u003E\u003Ca href=\"https:\u002F\u002Ft.me\u002Fmysensors_rus\"\u003Et.me\u002Fmysensors_rus\u003C\u002Fa\u003E\u003C\u002Fb\u003E.\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"arduino"},{"titleHtml":"atmega328p"},{"titleHtml":"sht20"},{"titleHtml":"nrf24l01+"},{"titleHtml":"mysensors"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F452234\u002F3b558880ff7fc77ff74b5669544cdcfa\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F452234\u002F3b558880ff7fc77ff74b5669544cdcfa\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F452234\\\u002F\"},\"headline\":\"Термометр &amp; гигрометр на ATMEGA 328P-MU — Поднимаем уровень ардуино разработок\",\"datePublished\":\"2019-05-17T00:44:18+03:00\",\"dateModified\":\"2019-05-17T09:56:25+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Berkseo\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Сегодня хочу поделиться одним из своих Ардуино проектов. Когда-то, не очень что бы давно я где-то на просторах интернета узнал об Ардуино. Влился я в это дело до...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F452234\\\u002F#post-content-body\",\"about\":[\"h_DIY\",\"f_popsci\"],\"image\":[\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fmt\\\u002F3r\\\u002Fci\\\u002Fmt3rci4yk0yasyrccfbqe_ii3uw.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fg8\\\u002Fvt\\\u002F89\\\u002Fg8vt89xocfduchhvirqldwcurh4.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fzu\\\u002Fwm\\\u002Fzs\\\u002Fzuwmzsu8ervyhmnbxzdfprmdbcu.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fq2\\\u002Fa8\\\u002Fyz\\\u002Fq2a8yzmu0x8pzg6qtxs9nf4d0sc.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F12\\\u002F2j\\\u002Fpk\\\u002F122jpkp-anp4zxqhshi7wp5bbga.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fer\\\u002Fil\\\u002Fak\\\u002Ferilakhq5uhxtx09ab54rn5brao.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fd3\\\u002Fpa\\\u002Ffh\\\u002Fd3pafhom0t6ydozgxjgm_o0g9eo.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fk-\\\u002F2i\\\u002Fyj\\\u002Fk-2iyjlk9snioo4vktlengxti_g.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fcc\\\u002Fdu\\\u002Fyy\\\u002Fccduyyya0_8awrvrplyrt4q3qze.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fet\\\u002Fnf\\\u002F5w\\\u002Fetnf5wimx4pwsf6k76uh5gobk3e.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fre\\\u002Fg8\\\u002Fz9\\\u002Freg8z9zer-swbz32kn5afhkvwsq.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F_i\\\u002Fet\\\u002Fhu\\\u002F_iethu6tktjfhc85y3ulrh5xf8m.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fow\\\u002F6s\\\u002Ffh\\\u002Fow6sfhpdvcmxy2lz0jemul6o0-i.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fpl\\\u002F-l\\\u002F48\\\u002Fpl-l48rq33glvskysput8i6gu7y.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F8x\\\u002F6i\\\u002Fie\\\u002F8x6iie5r4kpdwjan5kqdkvq337c.png\"]}","metaDescription":"Сегодня хочу поделиться одним из своих Ардуино проектов. Когда-то, не очень что бы давно я где-то на просторах интернета узнал об Ардуино. Влился я в это дело довольно быстро, уровень вхождения там не...","mainImageUrl":null,"amp":false},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":"DIY"},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
