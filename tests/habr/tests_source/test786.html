<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Делаем простой гидроакустический модем / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/451800\/"},"headline":"Делаем простой гидроакустический модем","datePublished":"2019-05-15T06:56:17+03:00","dateModified":"2020-07-09T11:59:59+03:00","author":{"@type":"Person","name":"Aleksandr Dikarev"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Привет, глубокоуважаемые! В этой статье, по многочисленным просьбам мы расскажем как сделать простейший гидроакустический модем: немного цифровой обработки сигна...","url":"https:\/\/habr.com\/ru\/post\/451800\/#post-content-body","about":["h_netdev","h_electronics","h_gadgets","h_DIY","h_easyelectronics","f_develop","f_popsci"],"image":["https:\/\/habrastorage.org\/webt\/_8\/0u\/jz\/_80ujzh-1afojo46fevq6egccvg.jpeg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/ad1\/7f8\/7ff\/ad17f87ff18c3764da78faf86ee52105.svg","https:\/\/habrastorage.org\/webt\/__\/zm\/oe\/__zmoe1u0jzgjderykrsaogn0k8.png","https:\/\/habrastorage.org\/webt\/aj\/w5\/q5\/ajw5q5dls4ruoi_gjzdswjay0ko.png","https:\/\/habrastorage.org\/webt\/ah\/ee\/0j\/ahee0jsjvmnm_cm89jvyroxmrlg.png","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/e60\/511\/dc4\/e60511dc487bc1f17a7fd670db1d7a8f.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/f9e\/b64\/2c0\/f9eb642c0d93ef26cc66c0ec3564ef12.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/dd8\/a86\/2f5\/dd8a862f53583925b661220cb68f577b.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/ac3\/083\/60e\/ac308360eae61fd755545518922b103f.svg","https:\/\/habrastorage.org\/webt\/za\/17\/0e\/za170ex4xgid-pacrxgcevfkmm8.jpeg","https:\/\/habrastorage.org\/webt\/wu\/72\/zy\/wu72zyy3twxj-iovwsbu1oplf0o.jpeg","https:\/\/habrastorage.org\/webt\/aq\/c8\/of\/aqc8of9rwkf_jv4df7o6gb4zqt0.jpeg","https:\/\/habrastorage.org\/webt\/gr\/g5\/-l\/grg5-lzyj3bpl574on7uycmo7xk.jpeg","https:\/\/habrastorage.org\/webt\/7k\/sp\/ru\/7ksprumtearv6eixwlfndk9fnoo.jpeg","https:\/\/habrastorage.org\/webt\/ut\/e5\/xu\/ute5xu86kbik8c542za18_omuna.jpeg","https:\/\/habrastorage.org\/webt\/rg\/lg\/98\/rglg989tlqi-zotwzq5gwkadbo4.jpeg","https:\/\/habrastorage.org\/webt\/dk\/lv\/jc\/dklvjcuntfws7eg27fr4soukldo.jpeg","https:\/\/habrastorage.org\/webt\/wc\/nq\/ri\/wcnqrifmzqht9luucn3lt0xf1uc.jpeg","https:\/\/habrastorage.org\/webt\/vk\/de\/k7\/vkdek7hiqs1p3van-coacl4gkk4.jpeg","https:\/\/habrastorage.org\/webt\/ks\/x-\/hd\/ksx-hd6m6qdijzicf1rwgnhwoy4.jpeg","https:\/\/habrastorage.org\/webt\/wn\/x4\/fd\/wnx4fd56r1newq2ew6cjr1hmlaa.jpeg","https:\/\/habrastorage.org\/webt\/mc\/03\/dj\/mc03djslty9veqpq1aqsllzbckq.jpeg","https:\/\/habrastorage.org\/webt\/bi\/pd\/dy\/bipddyy5zubboog4qimejpdxvjw.png","https:\/\/habrastorage.org\/webt\/ft\/ny\/jm\/ftnyjmiapa0uoyeuyhjo2ztaeji.png","https:\/\/habrastorage.org\/webt\/zy\/my\/o9\/zymyo9ptbahm3xh60dsv-5hz1mg.png","https:\/\/habrastorage.org\/webt\/om\/ym\/sw\/omymswxytjqy_l6uvzbijcr1pac.png","https:\/\/habrastorage.org\/webt\/bq\/jh\/_n\/bqjh_nwss-l-zjzi5hj5m7xru44.jpeg","https:\/\/habrastorage.org\/webt\/be\/hk\/jm\/behkjmbi2kz0_sxallhxjwyoqvc.jpeg","https:\/\/habrastorage.org\/webt\/yu\/ke\/-w\/yuke-wfwsgcozt5pg77d8g4cic8.png","https:\/\/habrastorage.org\/webt\/wp\/bz\/6i\/wpbz6i4wngzg4fdgfza2bxkr2h0.png","https:\/\/habrastorage.org\/webt\/-i\/_u\/lk\/-i_ulk8o3bsyu4ni7um5tyky73c.png"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Делаем простой гидроакустический модем" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Делаем простой гидроакустический модем" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Делаем простой гидроакустический модем" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Привет, глубокоуважаемые!
В этой статье, по многочисленным просьбам мы расскажем как сделать простейший гидроакустический модем: немного цифровой обработки сигналов, немного программирования, немного..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Привет, глубокоуважаемые!
В этой статье, по многочисленным просьбам мы расскажем как сделать простейший гидроакустический модем: немного цифровой обработки сигналов, немного программирования, немного..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Привет, глубокоуважаемые!
В этой статье, по многочисленным просьбам мы расскажем как сделать простейший гидроакустический модем: немного цифровой обработки сигналов, немного программирования, немного..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Привет, глубокоуважаемые!
В этой статье, по многочисленным просьбам мы расскажем как сделать простейший гидроакустический модем: немного цифровой обработки сигналов, немного программирования, немного..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Привет, глубокоуважаемые!
В этой статье, по многочисленным просьбам мы расскажем как сделать простейший гидроакустический модем: немного цифровой обработки сигналов, немного программирования, немного..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/451800/b55e90d2d309868a3161293b9c822ad4/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/451800/b55e90d2d309868a3161293b9c822ad4/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/451800/b55e90d2d309868a3161293b9c822ad4/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/451800/b55e90d2d309868a3161293b9c822ad4/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/451800/b55e90d2d309868a3161293b9c822ad4/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="451800" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2019-05-15T03:56:17.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/451800/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/451800/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/451800/b55e90d2d309868a3161293b9c822ad4/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/AlekDikarev/" title="AlekDikarev" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" loading="lazy" src="//habrastorage.org/r/w32/getpro/habr/avatars/280/4b2/b87/2804b2b8772332fdecddd2168581e5b2.png" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/AlekDikarev/" class="tm-user-info__username">
      AlekDikarev
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2019-05-15T03:56:17.000Z" title="2019-05-15, 06:56">15  мая  2019 в 06:56</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Делаем простой гидроакустический модем</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/netdev/" class="tm-article-snippet__hubs-item-link"><span>Разработка систем связи</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/electronics/" class="tm-article-snippet__hubs-item-link"><span>Производство и разработка электроники</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/gadgets/" class="tm-article-snippet__hubs-item-link"><span>Гаджеты</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/DIY/" class="tm-article-snippet__hubs-item-link"><span>DIY или Сделай сам</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/easyelectronics/" class="tm-article-snippet__hubs-item-link"><span>Электроника для начинающих</span> <!----></a></span></div> <div class="tm-article-snippet__labels"><div class="tm-article-snippet__label"><span>
        Tutorial
      </span></div></div> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml"><h3>Привет, глубокоуважаемые!</h3><br/>
В этой статье, по многочисленным просьбам мы расскажем как сделать простейший гидроакустический модем: немного цифровой обработки сигналов, немного программирования, немного самодельных печатных плат и капля практической гидрологии.<br/>
<br/>
Всем заинтересованным — милости просим под кат, в реверберирующий мир подводной связи!<br/>
<br/>
А вот релевантная картинка, для привлечения внимания:<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/_8/0u/jz/_80ujzh-1afojo46fevq6egccvg.jpeg" data-src="https://habrastorage.org/webt/_8/0u/jz/_80ujzh-1afojo46fevq6egccvg.jpeg" data-blurred="true"/><br/>
<a name="habracut"></a><br/>
<blockquote>«В конечном счете смысл нашего существования — тратить энергию… И по возможности, знаете ли, так, чтобы и самому было интересно, и другим полезно.»<br/>
(С) АБС, «Полдень, XXII век»</blockquote> <h3>Для экономии вашего времени — краткое содержание</h3><br/>
<ul>
<li>Гидроакустические модемы пока не продают на Aliexpress</li>
<li>Есть простой и нетребовательный к вычислительным ресурсам метод детектирования тона, частота которого в 4 раза меньше частоты дискретизации; Для реализации хватит и Arduino</li>
<li><a href="https://github.com/AlekUnderwater/SimpleUnderwaterAcousticModem/tree/master/SRC" rel="nofollow">Пример кода</a> для PC лежит на GitHub</li>
<li>Приемную и передающие антенны делаем из пьезопищалок по 10 р штука</li>
<li>Покупаем (или делаем сами) платку усилителя на TDA2030 на Ali за 50 рублей</li>
<li>Делаем ЛУТ-ом предусилитель, с суммарной стоимостью ~100 рублей</li>
<li>Подключаем и идем на водоем</li>
<li>Радуемся</li>
</ul><br/>
<h3>Мотивационная прелюдия</h3><br/>
Сейчас вы можете купить на Aliexpress или eBay практически все, что угодно. Особенно много всякого разного для самостоятельного изготовления чего-либо электронного на основе Arduino. Вы можете сделать (если просто купить неинтересно) мильен-стопервую метеостанцию с подключением к интернет, автоматическую кормушку для кота, контроллер домашней пивоварни, но пока еще вы не можете купить гидроакустический модем, конструктор для его изготовления или хотя бы модуль для адруино. Ну и хорошо! И не надо — сейчас мы расскажем как его сделать, а еще расскажем как он работает.<br/>
<br/>
Мы всей лабораторией долго думали, что можно предложить любителям для самостоятельного изготовления. Что-нибудь очень простое, собрать которое под силу и школьнику, из <s>палки и веревки</s> того, что есть под рукой у каждого, но в то же время обязательно представляющее хотя бы минимальную практическую или учебную ценность. <br/>
<br/>
Что-нибудь обещающее долгое и увлекательное совершенствование, то, что в последствие можно перенести даже на ардуино<s>, будь оно неладно</s>. <br/>
<br/>
Если подходить к вопросу материалистически, то нам хотелось предложить подробный туториал для изготовления некоего простого устройства, которое было бы более-менее в состоянии передавать данные в мелководном водоеме (мелководный гидроакустический канал — наиболее сложный), подразумевало бы максимум изготовление печатной платы при помощи ЛУТ, с общей стоимостью, не превышающей на минималочках пары-тройки сотен рублей.<br/>
<br/>
<h3>Что мы будем делать сегодня?</h3><br/>
<ul>
<li>вспомним, как сделать подходящую гидроакустическую антенну и изготовим парочку;</li>
<li>одну из антенн подключим к ПК через усилитель на TDA за ~50 рублей и получим передатчик;</li>
<li>для второй сделаем при помощи ЛУТ предусилитель за ~100 рублей;</li>
<li>напишем <s>(я уже все написал и положил на Git)</s> простой модем на C# и испытаем все на ближайшем водоеме;</li>
</ul><br/>
<h3>Что нам для этого понадобится?</h3><br/>
<ul>
<li>два пьезоэлемента. Например, <a href="https://www.aliexpress.com/item/5PCS-LOT-15cm-cable-length-diameter-35mm-Piezo-Ceramic-Element/32887402292.html?spm=2114.search0104.3.51.2fa41c2eDCvl13&amp;ws_ab_test=searchweb0_0,searchweb201602_1_10065_10068_10890_319_10546_317_10548_10696_453_10084_454_10083_10618_10307_537_536_10059_10884_10887_321_322_10915_10103_10910,searchweb201603_52,ppcSwitch_0&amp;algo_expid=fc0df690-2647-4172-8edc-978e564b3ec7-7&amp;algo_pvid=fc0df690-2647-4172-8edc-978e564b3ec7&amp;transAbTest=ae803_5" rel="nofollow">от часов или открытки</a>;</li>
<li>кабель RG-174/U (или аналогичный) ~5 метров;</li>
<li>безуксусный герметик;</li>
<li>водостойки лак;</li>
<li>фольгированный текстолит, в общей сложности примерно 100x200 мм;</li>
<li>усилитель на TDA2030 (например, <a href="https://www.aliexpress.com/item/1pcs-TDA2030A-Module-Single-Power-Supply-Audio-Amplifier-Board-Module/32847983961.html?tt=sns_none&amp;aff_platform=default&amp;cpt=1557766052396&amp;sk=XXxRqxY&amp;aff_trace_key=24a5a2a3375a462ebee4006e2341e3bb-1557766052396-09983-XXxRqxY&amp;terminal_id=6eb28f235e794d9897c6710be47d8866" rel="nofollow">такой</a>, за 50 рублей);</li>
<li><a href="https://github.com/AlekUnderwater/SimpleUnderwaterAcousticModem/blob/master/Preamplifier_board/BOM.xlsx" rel="nofollow">комплектующие</a> для предусилителя</li>
</ul><br/>
<h3>Как оно работает?</h3><br/>
Вся идея простейшего модема построена на, опять же, простейшем (совпадение?) детекторе определенного тона, про который, я к своему стыду не слышал. Рассказал мне про него совершенно невзначай <a href="https://habr.com/ru/users/andrey_9999a/" class="user_link">andrey_9999a</a>. Он, кстати, сделал и плату предусилителя.<br/>
<br/>
В связи с этим мне вспомнилась цитата из книги Леонарда Сасскинда «Битва при черной дыре»:<br/>
<blockquote>«Как ценитель вина, я более или менее уверен, что даже с закрытыми глазами смогу отличить красное от белого. Еще более надежно я отличу вино от пива. Но вот дальше вкус меня подведет.»<br/>
</blockquote> Могу сказать про себя, что как заправский электронщик я более или менее уверен, что точно смогу спаять два толстых провода. Еще более надежно я отличу горячий паяльник от холодного даже с закрытыми глазами, но вот дальше навык меня подведет. Поэтому все, что касается разработки и изготовления плат — это работа моих товарищей и коллег <a href="https://habr.com/ru/users/andrey_9999a/" class="user_link">andrey_9999a</a> и <a href="https://habr.com/ru/users/stdmitriev/" class="user_link">StDmitriev</a>.<br/>
<br/>
Итак, вернемся к детектору. Он является упрощенным частным случаем вычисления интеграла Фурье:<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/ad1/7f8/7ff/ad17f87ff18c3764da78faf86ee52105.svg" alt="$\int_0^Tf(x)sin(\omega t)dt$" data-tex="display"/></p><br/>
В случае цифрового сигнала, для вычисления амплитуды произвольной гармоники потребуется выполнить дискретное преобразование Фурье, для Ардуины это тяжеловато, но хитрость состоит в том, что если взять в качестве несущей частоты <i>Fc</i> такую, что она будет ровно в 4 раза меньше частоты дискретизации <i>Fs</i>, то амплитуду этой гармоники можно вычислять демонически проще.<br/>
<br/>
В этом случае <i>dt = 2π*(Fs/4)/Fs = π/2</i>, и на период несущей приходится всего 4 сэмпла:<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/__/zm/oe/__zmoe1u0jzgjderykrsaogn0k8.png"/><br/>
<br/>
Если все сдвинуть на <i>π/4</i> то сэмплы будут принимать только два значения: √2/2 и -√2/2, для простоты оставим только знаки — <b>«+» и «-»</b>.<br/>
<br/>
Суть же метода состоит в том, что синусную фазу мы представляем как последовательность знаков <b>«+» «+» «-» «-»</b>, а косинусную как <b>«+» «-» «-» «+»</b>.<br/>
<br/>
Пусть входной сигнал лежит в буфере <i>sn</i>, у нас есть два кольцевых буфера усреднения для синусной и косинусной фазы — <i>bs</i> и <i>bc</i> размером <i>N</i>. Указатели головы и хвоста у них общие — <i>bH</i> и <i>bT</i>. В начальный момент времени <i>bH = N-1, bT = 0</i>. Счетчик циклов усреденения <i>C = 0</i>.<br/>
<br/>
Берем из входного буфера по 4 сэмпла и складываем согласно последовательностям знаков.<br/>
<br/>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">Пример кода</b>
                        <div class="spoiler_text"><code>a = sn(i)<br/>
bs(bH) = a<br/>
bc(bH) = a<br/>
s1 = s1 + a - bs(bT)<br/>
s2 = s2 + a - bc(bT) <br/>
bH = (bH + 1) % N<br/>
bT = (bT + 1) % N<br/>
<br/>
a = sn(i+1)<br/>
bs(bH) = a<br/>
bc(bH) = -a<br/>
s1 = s1 + a - bs(bT)<br/>
s2 = s2 - a - bc(bT) <br/>
bH = (bH + 1) % N<br/>
bT = (bT + 1) % N<br/>
<br/>
a = sn(i+2)<br/>
bs(bH) = -a<br/>
bc(bH) = -a<br/>
s1 = s1 - a - bs(bT)<br/>
s2 = s2 - a - bc(bT) <br/>
bH = (bH + 1) % N<br/>
bT = (bT + 1) % N<br/>
<br/>
a = sn(i+3)<br/>
bs(bH) = -a<br/>
bc(bH) = a<br/>
s1 = s1 - a - bs(bT)<br/>
s2 = s2 + a - bc(bT) <br/>
bH = (bH + 1) % N<br/>
bT = (bT + 1) % N</code><br/>
</div>
                    </div><br/>
После каждой обработанной четверки сэмплов проверяем счетчик циклов усреднения и если он перевалил за <i>N</i>, то вычисляем амплитуду <i>cA</i> несущей:<br/>
<br/>
<pre><code class="plaintext">if ++cycle >= N
      cA = sqrt(s1 * s1 + s2 * s2)
      cycle = 0
end</code></pre><br/>
Вот так это выглядит на идеальном сигнале:<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/aj/w5/q5/ajw5q5dls4ruoi_gjzdswjay0ko.png"/><br/>
<br/>
Синим показан сам сигнал, красным — значения амлитуды несущей (все приведено к диапазону -1..1). В данном случае <i>N=2</i> т.к. нет никаких шумов и все и так отлично работает.<br/>
<br/>
Теперь добавим немного белого шума и посмотрим, как на это отреагирует наш детектор:<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/ah/ee/0j/ahee0jsjvmnm_cm89jvyroxmrlg.png"/><br/>
<br/>
Я добавил белого шума таким образом, чтобы соотношение сигнал-шум было равно 0 дБ. На рисунке выше синим показан зашумленный сигнал, зеленым — исходный, а красным — значение амплитуды. В этом случае детектор при <i>N=2</i> уже ничего не задетектировал, и минимальное N при котором он исправно работет равно 32. Т.е. размер окна обработки в сэмплах составил <i>32*4 = 128</i> сэмплов. <br/>
<br/>
То есть, теперь мы можем анализировать входной сигнал и оценивать некий параметр, который количественно показывает наличие частоты, в четыре раза меньше частоты дискретизации. Если задаться неким пороговым значением для этого параметра, то все можно бинаризовать, и говоря по-простому, мы сможем дать ответ на вопрос: присутствует ли заданный тон во входном сигнале или нет?<br/>
<br/>
Это очень хорошо, но нам нужно передавать биты, а биты могут принимать два значения.<br/>
<br/>
Реализовать систему с двумя сигнальными состояниями при помощи одного — так себе идея, поэтому мы <i>не будем</i> кодировать одно из состояний тишиной (паузой). Это бы сильно затруднило детектирование: нужно было бы как-то выделять начало посылки, придумывать как оформить ее конец и т.д.<br/>
<br/>
Вместо этого «1» и «0» мы будем кодировать импульсами разной длины, между битами наличествует т.н. защитный интервал — ведь нам же еще нужно бороться с многолучевым распространением и реверберацией. Говоря простым языком, защитный интервал — это то место (время), где затухнут все отражения предшествующего бита, все послезвучия и эхо.<br/>
<br/>
Забегая вперед, примем к сведению, что при такой структуре сигнала алгоритм работы приемника очень сильно упрощается: ждем когда появился тон, засекаем начало, ждем, когда тон пропал и опять засекаем время — если полученное время больше похоже по длине на «1» то, наверное мы приняли бит со значением «1», если больше похоже на «0» — то видимо мы приняли бит, со значением «0». <br/>
<br/>
В общем, можно сказать, что это некий вариант морзянки.<br/>
<br/>
<h3>Софтовая часть модема</h3><br/>
Для нетерпеливых — <a href="https://github.com/AlekUnderwater/SimpleUnderwaterAcousticModem" rel="nofollow">пример лежит на GitHub</a>. Написан на скорую руку на C# (потому что для ПК я пишу на нем и мне просто так удобнее и быстрее).<br/>
<br/>
Для воспроизведения и захвата звука с микрофонного входа используется замечательная библиотека <a href="https://github.com/naudio/NAudio" rel="nofollow">NAudio</a>.<br/>
<br/>
Вся логика модема находится в классе <a href="https://github.com/AlekUnderwater/SimpleUnderwaterAcousticModem/blob/master/SRC/C%23/SUAModem.cs" rel="nofollow">SUAModem</a> (Simple Underwater Acoustic Modem).<br/>
<br/>
В конструктор передаются следующие параметры:<br/>
<br/>
double sRateHz — частота дискретизации в Герцах;<br/>
int wSize — размер окна обработки в сэмплах;<br/>
int oneMultiplier — сколько «окон» длится бит со значением «1»<br/>
int zeroMultiplier — сколько «окон» длится бит со значением «0»<br/>
double eThreshold — порог, скажем о нем позже<br/>
<br/>
Для формирования сигнала из массива байт есть метод ModulateData(byte[] data), который возвращает массив 16-ти битных знаковых сэмплов.<br/>
<br/>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">public short[] ModulateData(byte[] data)</b>
                        <div class="spoiler_text"><pre><code class="cs">public short[] ModulateData(byte[] data)
{
   double alpha = 0;
   double phase = 0;           

   List&lt;short> samples = new List&lt;short>();            
   BitArray bits = new BitArray(data);         

   for (int i = 0; i &lt; bits.Length; i++)
   {
         int sLim = (bits[i]) ? oneDurationSmp : zeroDurationSmp;
         alpha = 0;
         phase = 0;
   
         for (int sIdx = 0; sIdx &lt;= sLim; sIdx++)
         {
               alpha = Math.Sin(phase);
               phase += delta;
               if (phase >= alimit)
                        phase -= alimit;
               samples.Add(Convert.ToInt16(alpha * short.MaxValue));
         }
         samples.AddRange(new short[defenseIntervalSmp]);                
     }
     return samples.ToArray();
}
</code></pre><br/>
</div>
                    </div><br/>
В основном цикле по передаваемым битам происходит заполнение списка samples. В зависимсоти от текущего передаваемого бита устанавливается длина sLim формируемого сигнала в сэмплах. После каждого бита добавляется защитный интервал.<br/>
<br/>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">Конечно...</b>
                        <div class="spoiler_text">Многие могут заметить, что при генерации сигнала можно было бы обойтись и без функции синуса, но данный пример позволяет, изменив соотвествующим образом значение delta, изменить и частоту генерируемого тона.<br/>
<br/>
Для генерации тона с частотой <img src="https://habrastorage.org/getpro/habr/formulas/e60/511/dc4/e60511dc487bc1f17a7fd670db1d7a8f.svg" alt="$F_n$" data-tex="inline"/> при заданной частоте дискретизации <img src="https://habrastorage.org/getpro/habr/formulas/f9e/b64/2c0/f9eb642c0d93ef26cc66c0ec3564ef12.svg" alt="$F_s$" data-tex="inline"/> соответствующее значение <img src="https://habrastorage.org/getpro/habr/formulas/dd8/a86/2f5/dd8a862f53583925b661220cb68f577b.svg" alt="$\delta$" data-tex="inline"/> вычисляется просто:<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/ac3/083/60e/ac308360eae61fd755545518922b103f.svg" alt="$\delta=2\pi F_n/F_s$" data-tex="display"/></p><br/>
</div>
                    </div><br/>
Для формирования и излучения сигнала есть метод TransmitData(byte[] data), который внутри себя вызывает ModulateData:<br/>
<br/>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">public double TransmitData(byte[] data)</b>
                        <div class="spoiler_text"><pre><code class="cs">public double TransmitData(byte[] data)
{
     var samples = ModulateData(data);
     double txTime = ((double)samples.Length) / SampleRateHz;

     var rawBytes = new byte[samples.Length * 2];
     for (int i = 0; i &lt; samples.Length; i++)
     {
          var bts = BitConverter.GetBytes(samples[i]);
          rawBytes[i * 2] = bts[0];
          rawBytes[i * 2 + 1] = bts[1];
     }

     using (var ms = new MemoryStream(rawBytes))
     {
          using (var rs = new RawSourceWaveStream(ms, new    WaveFormat(Convert.ToInt32(SampleRateHz), 16, 1)))
                {
                    using (var wo = new WaveOutEvent())
                    {
                        wo.Init(rs);
                        wo.Play();
                        while (wo.PlaybackState == PlaybackState.Playing)
                        {
                            Thread.SpinWait(1);
                        }                        
                    }

                    rs.Close();
             }
             ms.Close();
       }
       return txTime;
}
</code></pre><br/>
</div>
                    </div><br/>
О принятии очередного байта класс SUAModem сообщает при помощи события DataReceivedEventHandler.<br/>
<br/>
Входные сэмплы послупают в анализ при помощи метода ProcessInputSignal(short[] data), где записываются в кольцевой буфер ring. Анализ происходит в отдельном потоке, в методе Receiver.<br/>
<br/>
А сам приемник живет в методе Receive:<br/>
<br/>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">private void Receive()</b>
                        <div class="spoiler_text"><pre><code class="cs">private void Receive()
int a;
            while (rCnt >= 4)
            {
                a = ring[rRPos];
                rRPos = (rRPos + 1) % rSize;
                rCnt--;
                dRing1[rHead] = a;
                dRing2[rHead] = a;
                s1 += a - dRing1[rTail];
                s2 += a - dRing2[rTail];
                rHead = (rHead + 1) % windowSize;
                rTail = (rTail + 1) % windowSize;

                a = ring[rRPos];
                rRPos = (rRPos + 1) % rSize;
                rCnt--;
                dRing1[rHead] = a;
                dRing2[rHead] = -a;
                s1 += a - dRing1[rTail];
                s2 += -a - dRing2[rTail];
                rHead = (rHead + 1) % windowSize;
                rTail = (rTail + 1) % windowSize;

                a = ring[rRPos];
                rRPos = (rRPos + 1) % rSize;
                rCnt--;
                dRing1[rHead] = -a;
                dRing2[rHead] = -a;
                s1 += -a - dRing1[rTail];
                s2 += -a - dRing2[rTail];
                rHead = (rHead + 1) % windowSize;
                rTail = (rTail + 1) % windowSize;

                a = ring[rRPos];
                rRPos = (rRPos + 1) % rSize;
                rCnt--;
                dRing1[rHead] = -a;
                dRing2[rHead] = a;
                s1 += -a - dRing1[rTail];
                s2 += a - dRing2[rTail];
                rHead = (rHead + 1) % windowSize;
                rTail = (rTail + 1) % windowSize;

                if (++cycle >= windowSize)
                {
                    cycle = 0;

                    currentEnergy = Math.Sqrt(s1 * s1 + s2 * s2) / windowSize;
                    double de = currentEnergy - prevEnergy;                   

                    #region analysis

                    if (skip > 0)
                        skip -= windowSize * 4;
                    else
                    {
                        if (isRise)
                        {
                            if (de > -Threshold)
                            {
                                riseSmp += windowSize * 4;
                            }
                            else
                            {
                                // analyse symbol
                                isRise = false;

                                double oneDiff = Math.Abs(oneDurationSmp - riseSmp);
                                double zeroDiff = Math.Abs(zeroDurationSmp - riseSmp);

                                if (oneDiff > zeroDiff)
                                {
                                    // Mostly likely "0"
                                    AddBit(false);
                                }
                                else
                                {
                                    // Mostly likely "1"
                                    AddBit(true);
                                }

                                samplesSinceLastBit = 0;
                                skip = defenseIntervalSmp / 2;
                            }
                        }
                        else
                        {
                            if (de > Threshold)
                            {
                                isRise = true;
                                riseSmp = windowSize * 4;
                            }
                        }
                    }

                    #endregion

                    prevEnergy = currentEnergy;

                    if (bPos > 0)
                    {                        
                        samplesSinceLastBit += 4 * windowSize;
                        if (samplesSinceLastBit >= defenseIntervalSmp * 2 + zeroDurationSmp + oneDurationSmp)
                        {                            
                            DiscardBits();
                        }
                    }
                }                
            }
        }        
</code></pre><br/>
</div>
                    </div><br/>
Из кода видно, что анализ ведется по 4 сэмпла, при желании можно сохранять состояние и вести обработку и по одному сэмплу, что будет полезно при переносе на какой-нибудь немощный МК.<br/>
По мере поступления данных вычисляется значение амлитуды s на частоте sRateHz/4. Вычисляется разница между предыдущим и текущим значением амплитуды и затем сравнивается с заданным порогом, подобранным экспериментально. Пример позволяет в реальном времени этот порог менять.<br/>
<br/>
Резкое увеличение амплитуды свидетельствует о начале «бита», резкий (несколько менее резкий — из-за реверберации) спад — о завершении «бита».<br/>
<br/>
После приема очередного бита отрабатываем защитный интервал — пропускаем заданное количество сэмплов — в них всякие эхо, они нам будут только мешать.<br/>
<br/>
<h3>Железная часть модема</h3><br/>
Итак, со структурой сигнала все понятно, как его принимать тоже ясно. Дело за малым — научиться излучать сигнал в воду и принимать его из воды.<br/>
<br/>
Если у вас еще нет гидроакустических антенн, то самое время их сделать по <a href="https://habr.com/ru/post/431302/">нашему предыдущему туториалу</a>.<br/>
<br/>
У меня они остались с того раза, так что я этот шаг пропускаю.<br/>
<br/>
Ту антенну, которая предназначена для передачи мы подключаем к <a href="https://www.aliexpress.com/item/1pcs-TDA2030A-Module-Single-Power-Supply-Audio-Amplifier-Board-Module/32847983961.html?tt=sns_none&amp;aff_platform=default&amp;cpt=1557765605290&amp;sk=XXxRqxY&amp;aff_trace_key=5b7cbf3c89fc4d6fbe6aa2e870630181-1557765605290-02601-XXxRqxY&amp;terminal_id=6eb28f235e794d9897c6710be47d8866" rel="nofollow">плате усилителя с алиэкспресс</a>. Для нескольких десятков метров (может даже для сотни) нам этого вполне хватит. Никаких хитростей тут нет — выход звуковой карты ноутбука идет на вход усилителя, который питается от свинцового АКБ 12 вольт 4 Ач. На выход подключена наша гидроакустическая передающая антенна из пьезопищалки. В моем случае это выглядит вот так:<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/za/17/0e/za170ex4xgid-pacrxgcevfkmm8.jpeg" data-src="https://habrastorage.org/webt/za/17/0e/za170ex4xgid-pacrxgcevfkmm8.jpeg" data-blurred="true"/><br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/_8/0u/jz/_80ujzh-1afojo46fevq6egccvg.jpeg" data-src="https://habrastorage.org/webt/_8/0u/jz/_80ujzh-1afojo46fevq6egccvg.jpeg" data-blurred="true"/><br/>
<br/>
На фото выше, на экране есть небольшой спойлер следующей статьи. В следующий раз на этих же железках мы снова будем пытаться передавать «видео» звуком через воду, но совершенно иным способом, чем в <a href="https://habr.com/ru/post/408871/">прошлый раз</a>.<br/>
<br/>
С приемной антенной несколько сложнее. Хоть пьезопищалки и очень чувствительны, все же этого недостаточно. Нам придется собрать плату предусилителя с фильтром на полосу 5-35 кГц. <br/>
Коэффициент усиления мы берем 1000.<br/>
<br/>
Схема, дизайн печатной платы и список компонентов предусилителя лежит у нас на GitHub: <a href="https://github.com/AlekUnderwater/SimpleUnderwaterAcousticModem/blob/master/Preamplifier_board/piezo_preamp_1000_5-35kHz_schematic.pdf" rel="nofollow">схема</a>, дорожки — <a href="https://github.com/AlekUnderwater/SimpleUnderwaterAcousticModem/blob/master/Preamplifier_board/Top_70x25_mm.bmp" rel="nofollow">верхний слой</a> и <a href="https://github.com/AlekUnderwater/SimpleUnderwaterAcousticModem/blob/master/Preamplifier_board/Bottom_70x25_mm.bmp" rel="nofollow">нижний слой</a>, <a href="https://github.com/AlekUnderwater/SimpleUnderwaterAcousticModem/blob/master/Preamplifier_board/BOM.xlsx" rel="nofollow">BOM</a>.<br/>
<br/>
<a href="https://habr.com/ru/search/?q=%D0%9B%D0%A3%D0%A2#h">Технология ЛУТ</a> обсуждалась стотыщмильенов раз, но дайте же и нам внести свою лепту. <br/>
<br/>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">Фото технологического процесса</b>
                        <div class="spoiler_text">Итак, берем подходящий журнал, у нас под рукой оказался только этот:<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/wu/72/zy/wu72zyy3twxj-iovwsbu1oplf0o.jpeg" data-src="https://habrastorage.org/webt/wu/72/zy/wu72zyy3twxj-iovwsbu1oplf0o.jpeg" data-blurred="true"/><br/>
<br/>
Берем оттуда пару страниц и печатаем на них слои при помощи лазерного принтера.<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/aq/c8/of/aqc8of9rwkf_jv4df7o6gb4zqt0.jpeg" data-src="https://habrastorage.org/webt/aq/c8/of/aqc8of9rwkf_jv4df7o6gb4zqt0.jpeg" data-blurred="true"/><br/>
<br/>
Совмещаем при помощи иголочек и склеиваем по одной стороне, как показано на фото:<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/gr/g5/-l/grg5-lzyj3bpl574on7uycmo7xk.jpeg" data-src="https://habrastorage.org/webt/gr/g5/-l/grg5-lzyj3bpl574on7uycmo7xk.jpeg" data-blurred="true"/><br/>
<br/>
Перед применением утюга смачиваем тонер изопропиловым спиртом:<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/7k/sp/ru/7ksprumtearv6eixwlfndk9fnoo.jpeg" data-src="https://habrastorage.org/webt/7k/sp/ru/7ksprumtearv6eixwlfndk9fnoo.jpeg" data-blurred="true"/><br/>
<br/>
Утюжим через сложенный вчетверо лист А4:<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/ut/e5/xu/ute5xu86kbik8c542za18_omuna.jpeg" data-src="https://habrastorage.org/webt/ut/e5/xu/ute5xu86kbik8c542za18_omuna.jpeg" data-blurred="true"/><br/>
<br/>
Размачиваем теплой водой под краном:<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/rg/lg/98/rglg989tlqi-zotwzq5gwkadbo4.jpeg" data-src="https://habrastorage.org/webt/rg/lg/98/rglg989tlqi-zotwzq5gwkadbo4.jpeg" data-blurred="true"/><br/>
<br/>
И отмываем остатки бумаги. После чего получаем заготовку, готовую к травлению:<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/dk/lv/jc/dklvjcuntfws7eg27fr4soukldo.jpeg" data-src="https://habrastorage.org/webt/dk/lv/jc/dklvjcuntfws7eg27fr4soukldo.jpeg" data-blurred="true"/><br/>
<br/>
Лишнее отрезаем при помощи ножниц по металлу или кому чем удобнее.<br/>
<br/>
Травим в хлорном железе. Специально для статьи мы развели свежее, оно оказалось настолько забористое что от будущей платы активно идут пузырики:<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/wc/nq/ri/wcnqrifmzqht9luucn3lt0xf1uc.jpeg" data-src="https://habrastorage.org/webt/wc/nq/ri/wcnqrifmzqht9luucn3lt0xf1uc.jpeg" data-blurred="true"/><br/>
<br/>
В результате, после травления и отмывки тонера получаем такой полуфабрикат:<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/vk/de/k7/vkdek7hiqs1p3van-coacl4gkk4.jpeg" data-src="https://habrastorage.org/webt/vk/de/k7/vkdek7hiqs1p3van-coacl4gkk4.jpeg" data-blurred="true"/><br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/ks/x-/hd/ksx-hd6m6qdijzicf1rwgnhwoy4.jpeg" data-src="https://habrastorage.org/webt/ks/x-/hd/ksx-hd6m6qdijzicf1rwgnhwoy4.jpeg" data-blurred="true"/><br/>
<br/>
После напайки компонентов и отмывки плата выгладит вот так. <br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/wn/x4/fd/wnx4fd56r1newq2ew6cjr1hmlaa.jpeg" data-src="https://habrastorage.org/webt/wn/x4/fd/wnx4fd56r1newq2ew6cjr1hmlaa.jpeg" data-blurred="true"/><br/>
</div>
                    </div><br/>
А так выглядит приемная часть в сборе. Питание осуществляется от такого же свинцового АКБ 12 вольт:<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/mc/03/dj/mc03djslty9veqpq1aqsllzbckq.jpeg" data-src="https://habrastorage.org/webt/mc/03/dj/mc03djslty9veqpq1aqsllzbckq.jpeg" data-blurred="true"/><br/>
<br/>
<div class="spoiler" role="button" tabindex="0">
                        <b class="spoiler_title">Небольшой дисклеймер по поводу фильтра</b>
                        <div class="spoiler_text">Если читатель захочет изменить полосу, то предлагаем пересчитать фильтр 8-ого порядка, собранный на дешевом 4-х канальном операционнике TL084C (DA2 на <a href="https://github.com/AlekUnderwater/SimpleUnderwaterAcousticModem/blob/master/Preamplifier_board/piezo_preamp_1000_5-35kHz_schematic.pdf" rel="nofollow">схеме</a>), резисторах R10-R13, R15-R23 и конденсаторах C5-C8, C11, C12, C14 и С15.<br/>
<br/>
На всякий случай приведем здесь АЧХ текущей реализации фильтра:<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/bi/pd/dy/bipddyy5zubboog4qimejpdxvjw.png"/><br/>
<br/>
А вот еще <a href="https://github.com/AlekUnderwater/SimpleUnderwaterAcousticModem/blob/master/Preamplifier_board/filter.sch" rel="nofollow">проект</a> для этого фильтра, созданный в приложении <a href="http://qucs.sourceforge.net/" rel="nofollow">Qucs</a><br/>
</div>
                    </div><br/>
<h3>Опыты и испытания</h3><br/>
Для подключения к ноутбуку используем обычный Jack 3.5 мм, самый кончик — сигнал, средний — не подключен, земля — к земле <s>прах к праху</s>. Все усиления и любые эффекты микрофона нужно отключить, а громкостью придется поиграться, чтобы достичь оптимального уровня. Зашкал должен происходить при касании подключенной к предусилителю антенны пальцем и легком поглаживании.<br/>
<br/>
Если просто положить одну пьезу на другую без усилителя и предусилителя и подключить их к аудиовходу и выходу, то все работает идеально. Ниже представлен отрезок сигнала и можно даже на глаз определить где какие значения битов:<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/ft/ny/jm/ftnyjmiapa0uoyeuyhjo2ztaeji.png"/><br/>
<br/>
Синим показан сам сигнал, красным — разница между текущим и предыдущим значениями амплитуды (фронт), зеленым — разница между предыдущим и текущим значениями (спад). Без труда можно «демодулировать» эту часть посылки: 1 0 0 0 1 1 0. Ноль у нас в два раза дольше единицы, а длительность защитного интервала равна длительности нуля.<br/>
<br/>
Далее, также без усилителя и предусилителя опускаем наши антенны в металлический бак, размерами 3х1.5х1.5. У нас такой стоит в лаборатории, и мы завели себе правило, что не занимаемся никакой связью, если она хоть как-то не в состоянии работать в этом баке. Дело в том, что в таком замкнутом объеме энергии особо некуда деваться — звук чудесно и многократно отражается от металлических стенок и в точке приема получается каша. А с учетом того, что мы обычно проверяем готовые девайсы с энергетикой, рассчитанной на тысячи метров, можете представить что там творится. <br/>
<br/>
Например, два наших модема <a href="https://github.com/ucnl/ucnl.github.io/blob/master/documentation/RU/RedLINE/RedLine_Specification_ru.md" rel="nofollow">RedLINE</a> устойчиво работают в этом баке только на расстоянии не больше двух метров, а два <a href="https://habr.com/ru/post/428367/">uWAVE</a>-а стабильно работают примерно на 1 метре. При том что первый в открытой воде работает до 8000 метров, а второй — <a href="https://www.youtube.com/watch?v=Z1bVerVecY0" rel="nofollow">до километра</a>. <br/>
Конечно, все коммерческие продукты не используют такие примитивные схемы модуляции, о которой идет речь в статье и устроены гораздо сложнее, но нам сейчас важно понять азы и с пользой поделать что-то руками.<br/>
<br/>
В общем, опускаем антенны в бак на расстояние порядка 50 сантиметров и получаем уже нечто гораздо менее благообразное, чем при непосредственном контакте антенн:<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/zy/my/o9/zymyo9ptbahm3xh60dsv-5hz1mg.png"/><br/>
<br/>
Хотя здесь использован значительно более долгий защитный интервал, все равно видно, что эхо гуляет почти до следующего бита, фронты и особенно спады сильно размыты. Но все еще можно определить содержание сообщения: 1 0 0 0 1 1 0<br/>
<br/>
В обоих случаях я передавал сообщение «123» и эти семь бит принадлежат символу единицы.<br/>
Выглядело это примерно так, потом интерфейс был немного переделан<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/om/ym/sw/omymswxytjqy_l6uvzbijcr1pac.png"/><br/>
<br/>
Из скрина выше видно, что при тех настройках, передача сообщения «Hello, <a href="https://habr.com/ru/users/habr/" class="user_link">habr</a>!!! :-)» состоящее из 19 байт занимает 9.132 секунд, то есть скорость передачи составила 16,6 бит/с. К слову сказать, чтобы модем работал в нашем баке пришлось увеличить защитный интервал так, что скорость передачи упала до ~3 бит/с.<br/>
<br/>
Мы проверяли самоделку в плавательном бассейне, где устойчиво она заработала на 10 метрах.<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/bq/jh/_n/bqjh_nwss-l-zjzi5hj5m7xru44.jpeg" data-src="https://habrastorage.org/webt/bq/jh/_n/bqjh_nwss-l-zjzi5hj5m7xru44.jpeg" data-blurred="true"/><br/>
<br/>
Еще мы баловались самоделкой на пруду. Я использовал активный гидрофон очень похожий по конструкции на предложенный в статье, только вместо пьезопищалки там применен датчик от парктроника, аккумулятор там смонтирован в катушку, на которую наматывается кабель:<br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/webt/be/hk/jm/behkjmbi2kz0_sxallhxjwyoqvc.jpeg" data-src="https://habrastorage.org/webt/be/hk/jm/behkjmbi2kz0_sxallhxjwyoqvc.jpeg" data-blurred="true"/><br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/yu/ke/-w/yuke-wfwsgcozt5pg77d8g4cic8.png"/><br/>
<br/>
Антенны приемника и передатчика опускались прямо с берега, глубина там резко уходит с 0.5 до 2 метров. В опыте, который показан на фото выше были, как ни странно, самые плохие условия, дистанция там была всего порядка 5 метров — это вообще была первоначальная настройка. Из 20 переданных сообщений по 3 байта, в шести из них было побито по одному байту.<br/>
<br/>
Потом, когда мы подключили приемник ко второму ноутбуку и перенесли на другой берег пруда (дистанция порядка 30 метров) передача проходила значительно лучше — на 40 сообщений размером от 3 до 13 байт было всего пару ошибок.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/wp/bz/6i/wpbz6i4wngzg4fdgfza2bxkr2h0.png"/><br/>
<br/>
На следующем фото на карте видны места, где располагались антенны.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/-i/_u/lk/-i_ulk8o3bsyu4ni7um5tyky73c.png"/><br/>
<br/>
<h3>Заключение и дальнейшие изыскания</h3><br/>
Как и обещал, за мало рублей мы собрали рабочее устройство. Хоть практическая ценность его сомнительна, но сам процесс изготовления и настройки на водоеме будет очень полезен начинающим. На описанном методе детектирования несущей вполне можно придумать разных простых навигационных систем для любительского применения, а что особенно приятно, вычислительная сложность позволяет реализовать метод на простом микроконтроллере.<br/>
<br/>
Чтобы не быть голословным относительно построения навигационных систем на простых сигналах, взгляните на <a href="https://www.semanticscholar.org/paper/UNDERWATER-ACOUSTIC-POSITIONING-SYSTEMS-BASED-ON-Alcocer-Oliveira/134a4e769a6a64c6f5bc0f0efda9ed2a93893bdb" rel="nofollow">интересную работу</a>, в которой построили полноценную длиннобазисную навигационную систему. В этой системе определяют положение пингера, который периодически передает свою глубину. Значение глубины при этом кодируется расстоянием между двумя простыми импульсами на определенной частоте. Так что да-да, горшки не боги обжигают, дорогу осилит идущий, терпение и труд, учиться, учиться, учиться — вот это вот все.<br/>
<br/>
Возможно, при наличии времени мы сделаем DIY-проект по позиционированию автономного пингера, излучающего простые сигналы. Нечто подобное, но не DIY мы уже делали на базе наших модемов <a href="https://github.com/ucnl/ucnl.github.io/blob/master/documentation/RU/uWAVE/uWAVE_Specification_ru.md" rel="nofollow">uWAVE</a>, о чем даже попытались <a href="https://www.youtube.com/watch?v=UHfTv7TtABU&amp;t=11s" rel="nofollow">снять видео</a>. Будет очень интересно услышать ваши мнения на этот счет — очень важно иметь подтверждение, что делаешь что-то не напрасно.<br/>
<br/>
Тем не менее, возвращаясь к основной теме, отметим, что можно было бы улучшить в предложенной схеме:<br/>
<br/>
<ul>
<li>сделать вычисление порога адаптивным</li>
<li>анализировать ширину сигналов автоматически</li>
<li>попробовать использовать разные длины для разных битовых комбинаций</li>
<li>прикрутить <s>обожебоже</s> помехоустойчивое кодирование</li>
<li>перенести все это на ардуино</li>
<li>громкость и порог приходится долго и нудно подбирать, поэтому хорошо бы добавить в предусилитель АРУ</li>
</ul><br/>
На этом заседание объявлю закрытым, а если вас заинтересовала тема, вот список наших предыдущих статей:<br/>
<br/>
<a href="https://habr.com/ru/post/370083/">Подводный GPS с нуля за год</a><br/>
<a href="https://habr.com/ru/post/449072/">Подводный GPS на подводном роботе: опыт использования</a><br/>
<a href="https://habr.com/ru/post/428367/">Мы сделали самый маленький в мире гидроакустический модем</a><br/>
<a href="https://geektimes.ru/post/293681/" rel="nofollow">К вопросу о влиянии цианобактерий на речевые функции президента</a><br/>
<a href="https://habr.com/ru/post/431302/">Делаем простую гидроакустическую антенну из мусора</a><br/>
<a href="https://habr.com/post/408871/">Сеанс передачи видео звуком через воду с разоблачением</a><br/>
<a href="https://habr.com/ru/post/421977/">Подводный «GPS» на двух приемопередатчиках</a><br/>
<a href="https://habr.com/ru/post/405845/">Навигация под водой: пеленгуй не пеленгуй — обречен ты на успех</a><br/>
<a href="https://habr.com/ru/post/403891/">Подводный GPS: продолжение</a><br/>
<br/>
<h3>P.S.</h3><br/>
 Как всегда с удовольствием выслушаем замечания и предложения, обоснованную критику и одобряющие возгласы )<br/>
<br/>
<h3>P.P.S.</h3> <br/>
Железки далеко не убирайте — в следующий раз мы с их помощью будем опять передавать «видео» через воду.</div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B3%D0%B8%D0%B4%D1%80%D0%BE%D0%B0%D0%BA%D1%83%D1%81%D1%82%D0%B8%D0%BA%D0%B0%5D" class="tm-tags-list__link">гидроакустика</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BC%D0%BE%D0%B4%D0%B5%D0%BC%5D" class="tm-tags-list__link">модем</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BDIY%5D" class="tm-tags-list__link">DIY</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BF%D1%8C%D0%B5%D0%B7%D0%BE%D1%8D%D0%BB%D0%B5%D0%BC%D0%B5%D0%BD%D1%82%D1%8B%5D" class="tm-tags-list__link">пьезоэлементы</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BF%D0%BE%D0%B4%D0%B2%D0%BE%D0%B4%D0%BD%D0%B0%D1%8F%20%D1%81%D0%B2%D1%8F%D0%B7%D1%8C%5D" class="tm-tags-list__link">подводная связь</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BC%23%5D" class="tm-tags-list__link">C#</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BNAudio%5D" class="tm-tags-list__link">NAudio</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BDSP%5D" class="tm-tags-list__link">DSP</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B4%D0%B5%D1%82%D0%B5%D0%BA%D1%82%D0%BE%D1%80%20%D1%87%D0%B0%D1%81%D1%82%D0%BE%D1%82%D1%8B%5D" class="tm-tags-list__link">детектор частоты</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BC%D0%BE%D0%B4%D1%83%D0%BB%D1%8F%D1%86%D0%B8%D1%8F%20%D1%81%D0%B8%D0%B3%D0%BD%D0%B0%D0%BB%D0%B0%5D" class="tm-tags-list__link">модуляция сигнала</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B7%D0%B2%D1%83%D0%BA%5D" class="tm-tags-list__link">звук</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BF%D1%80%D0%B5%D0%B4%D1%83%D1%81%D0%B8%D0%BB%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%5D" class="tm-tags-list__link">предусилитель</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%83%D0%BB%D1%8C%D1%82%D1%80%D0%B0%D0%B7%D0%B2%D1%83%D0%BA%5D" class="tm-tags-list__link">ультразвук</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BF%D0%BE%D0%BB%D0%BE%D1%81%D0%BE%D0%B2%D0%BE%D0%B9%20%D1%84%D0%B8%D0%BB%D1%8C%D1%82%D1%80%5D" class="tm-tags-list__link">полосовой фильтр</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hub/netdev/" class="tm-hubs-list__link">
    Разработка систем связи
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/electronics/" class="tm-hubs-list__link">
    Производство и разработка электроники
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/gadgets/" class="tm-hubs-list__link">
    Гаджеты
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/DIY/" class="tm-hubs-list__link">
    DIY или Сделай сам
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/easyelectronics/" class="tm-hubs-list__link">
    Электроника для начинающих
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 48: ↑48 и ↓0</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 48: ↑48 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+48</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">9.4K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    75
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/AlekDikarev/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/280/4b2/b87/2804b2b8772332fdecddd2168581e5b2.png" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 142 голоса " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    106
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><span class="tm-user-card__name tm-user-card__name_variant-article">Aleksandr Dikarev</span> <a href="/ru/users/AlekDikarev/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @AlekDikarev
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">Embedded software developer</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/451800/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 25 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <!----> <!----> <!----> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/451800/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/451800/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"451800":{"id":"451800","timePublished":"2019-05-15T03:56:17+00:00","isCorporative":false,"lang":"ru","titleHtml":"Делаем простой гидроакустический модем","leadData":{"textHtml":"\u003Ch3\u003EПривет, глубокоуважаемые!\u003C\u002Fh3\u003E\u003Cbr\u003E\r\nВ этой статье, по многочисленным просьбам мы расскажем как сделать простейший гидроакустический модем: немного цифровой обработки сигналов, немного программирования, немного самодельных печатных плат и капля практической гидрологии.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nВсем заинтересованным — милости просим под кат, в реверберирующий мир подводной связи!\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nА вот релевантная картинка, для привлечения внимания:\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F_8\u002F0u\u002Fjz\u002F_80ujzh-1afojo46fevq6egccvg.jpeg\"\u003E\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"editorVersion":"1.0","postType":"article","postLabels":[{"type":"tutorial","data":null}],"author":{"scoreStats":{"score":106,"votesCount":142},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"1358500","alias":"AlekDikarev","fullname":"Aleksandr Dikarev","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F280\u002F4b2\u002Fb87\u002F2804b2b8772332fdecddd2168581e5b2.png","speciality":"Embedded software developer"},"statistics":{"commentsCount":25,"favoritesCount":75,"readingCount":9411,"score":48,"votesCount":48},"hubs":[{"relatedData":null,"id":"19395","alias":"netdev","type":"collective","title":"Разработка систем связи","titleHtml":"Разработка систем связи","isProfiled":true},{"relatedData":null,"id":"21484","alias":"electronics","type":"collective","title":"Производство и разработка электроники","titleHtml":"Производство и разработка электроники","isProfiled":true},{"relatedData":null,"id":"21894","alias":"gadgets","type":"collective","title":"Гаджеты","titleHtml":"Гаджеты","isProfiled":false},{"relatedData":null,"id":"21976","alias":"DIY","type":"collective","title":"DIY или Сделай сам","titleHtml":"DIY или Сделай сам","isProfiled":false},{"relatedData":null,"id":"22016","alias":"easyelectronics","type":"collective","title":"Электроника для начинающих","titleHtml":"Электроника для начинающих","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Ch3\u003EПривет, глубокоуважаемые!\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nВ этой статье, по многочисленным просьбам мы расскажем как сделать простейший гидроакустический модем: немного цифровой обработки сигналов, немного программирования, немного самодельных печатных плат и капля практической гидрологии.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВсем заинтересованным — милости просим под кат, в реверберирующий мир подводной связи!\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nА вот релевантная картинка, для привлечения внимания:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002F_8\u002F0u\u002Fjz\u002F_80ujzh-1afojo46fevq6egccvg.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F_8\u002F0u\u002Fjz\u002F_80ujzh-1afojo46fevq6egccvg.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E«В конечном счете смысл нашего существования — тратить энергию… И по возможности, знаете ли, так, чтобы и самому было интересно, и другим полезно.»\u003Cbr\u002F\u003E\r\n(С) АБС, «Полдень, XXII век»\u003C\u002Fblockquote\u003E \u003Ch3\u003EДля экономии вашего времени — краткое содержание\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003EГидроакустические модемы пока не продают на Aliexpress\u003C\u002Fli\u003E\r\n\u003Cli\u003EЕсть простой и нетребовательный к вычислительным ресурсам метод детектирования тона, частота которого в 4 раза меньше частоты дискретизации; Для реализации хватит и Arduino\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002FAlekUnderwater\u002FSimpleUnderwaterAcousticModem\u002Ftree\u002Fmaster\u002FSRC\" rel=\"nofollow\"\u003EПример кода\u003C\u002Fa\u003E для PC лежит на GitHub\u003C\u002Fli\u003E\r\n\u003Cli\u003EПриемную и передающие антенны делаем из пьезопищалок по 10 р штука\u003C\u002Fli\u003E\r\n\u003Cli\u003EПокупаем (или делаем сами) платку усилителя на TDA2030 на Ali за 50 рублей\u003C\u002Fli\u003E\r\n\u003Cli\u003EДелаем ЛУТ-ом предусилитель, с суммарной стоимостью ~100 рублей\u003C\u002Fli\u003E\r\n\u003Cli\u003EПодключаем и идем на водоем\u003C\u002Fli\u003E\r\n\u003Cli\u003EРадуемся\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EМотивационная прелюдия\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nСейчас вы можете купить на Aliexpress или eBay практически все, что угодно. Особенно много всякого разного для самостоятельного изготовления чего-либо электронного на основе Arduino. Вы можете сделать (если просто купить неинтересно) мильен-стопервую метеостанцию с подключением к интернет, автоматическую кормушку для кота, контроллер домашней пивоварни, но пока еще вы не можете купить гидроакустический модем, конструктор для его изготовления или хотя бы модуль для адруино. Ну и хорошо! И не надо — сейчас мы расскажем как его сделать, а еще расскажем как он работает.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nМы всей лабораторией долго думали, что можно предложить любителям для самостоятельного изготовления. Что-нибудь очень простое, собрать которое под силу и школьнику, из \u003Cs\u003Eпалки и веревки\u003C\u002Fs\u003E того, что есть под рукой у каждого, но в то же время обязательно представляющее хотя бы минимальную практическую или учебную ценность. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЧто-нибудь обещающее долгое и увлекательное совершенствование, то, что в последствие можно перенести даже на ардуино\u003Cs\u003E, будь оно неладно\u003C\u002Fs\u003E. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли подходить к вопросу материалистически, то нам хотелось предложить подробный туториал для изготовления некоего простого устройства, которое было бы более-менее в состоянии передавать данные в мелководном водоеме (мелководный гидроакустический канал — наиболее сложный), подразумевало бы максимум изготовление печатной платы при помощи ЛУТ, с общей стоимостью, не превышающей на минималочках пары-тройки сотен рублей.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EЧто мы будем делать сегодня?\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003Eвспомним, как сделать подходящую гидроакустическую антенну и изготовим парочку;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eодну из антенн подключим к ПК через усилитель на TDA за ~50 рублей и получим передатчик;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eдля второй сделаем при помощи ЛУТ предусилитель за ~100 рублей;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eнапишем \u003Cs\u003E(я уже все написал и положил на Git)\u003C\u002Fs\u003E простой модем на C# и испытаем все на ближайшем водоеме;\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EЧто нам для этого понадобится?\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003Eдва пьезоэлемента. Например, \u003Ca href=\"https:\u002F\u002Fwww.aliexpress.com\u002Fitem\u002F5PCS-LOT-15cm-cable-length-diameter-35mm-Piezo-Ceramic-Element\u002F32887402292.html?spm=2114.search0104.3.51.2fa41c2eDCvl13&amp;ws_ab_test=searchweb0_0,searchweb201602_1_10065_10068_10890_319_10546_317_10548_10696_453_10084_454_10083_10618_10307_537_536_10059_10884_10887_321_322_10915_10103_10910,searchweb201603_52,ppcSwitch_0&amp;algo_expid=fc0df690-2647-4172-8edc-978e564b3ec7-7&amp;algo_pvid=fc0df690-2647-4172-8edc-978e564b3ec7&amp;transAbTest=ae803_5\" rel=\"nofollow\"\u003Eот часов или открытки\u003C\u002Fa\u003E;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eкабель RG-174\u002FU (или аналогичный) ~5 метров;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eбезуксусный герметик;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eводостойки лак;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eфольгированный текстолит, в общей сложности примерно 100x200 мм;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eусилитель на TDA2030 (например, \u003Ca href=\"https:\u002F\u002Fwww.aliexpress.com\u002Fitem\u002F1pcs-TDA2030A-Module-Single-Power-Supply-Audio-Amplifier-Board-Module\u002F32847983961.html?tt=sns_none&amp;aff_platform=default&amp;cpt=1557766052396&amp;sk=XXxRqxY&amp;aff_trace_key=24a5a2a3375a462ebee4006e2341e3bb-1557766052396-09983-XXxRqxY&amp;terminal_id=6eb28f235e794d9897c6710be47d8866\" rel=\"nofollow\"\u003Eтакой\u003C\u002Fa\u003E, за 50 рублей);\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002FAlekUnderwater\u002FSimpleUnderwaterAcousticModem\u002Fblob\u002Fmaster\u002FPreamplifier_board\u002FBOM.xlsx\" rel=\"nofollow\"\u003Eкомплектующие\u003C\u002Fa\u003E для предусилителя\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EКак оно работает?\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nВся идея простейшего модема построена на, опять же, простейшем (совпадение?) детекторе определенного тона, про который, я к своему стыду не слышал. Рассказал мне про него совершенно невзначай \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fusers\u002Fandrey_9999a\u002F\" class=\"user_link\"\u003Eandrey_9999a\u003C\u002Fa\u003E. Он, кстати, сделал и плату предусилителя.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ связи с этим мне вспомнилась цитата из книги Леонарда Сасскинда «Битва при черной дыре»:\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003E«Как ценитель вина, я более или менее уверен, что даже с закрытыми глазами смогу отличить красное от белого. Еще более надежно я отличу вино от пива. Но вот дальше вкус меня подведет.»\u003Cbr\u002F\u003E\r\n\u003C\u002Fblockquote\u003E Могу сказать про себя, что как заправский электронщик я более или менее уверен, что точно смогу спаять два толстых провода. Еще более надежно я отличу горячий паяльник от холодного даже с закрытыми глазами, но вот дальше навык меня подведет. Поэтому все, что касается разработки и изготовления плат — это работа моих товарищей и коллег \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fusers\u002Fandrey_9999a\u002F\" class=\"user_link\"\u003Eandrey_9999a\u003C\u002Fa\u003E и \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fusers\u002Fstdmitriev\u002F\" class=\"user_link\"\u003EStDmitriev\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nИтак, вернемся к детектору. Он является упрощенным частным случаем вычисления интеграла Фурье:\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fad1\u002F7f8\u002F7ff\u002Fad17f87ff18c3764da78faf86ee52105.svg\" alt=\"$\\int_0^Tf(x)sin(\\omega t)dt$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\nВ случае цифрового сигнала, для вычисления амплитуды произвольной гармоники потребуется выполнить дискретное преобразование Фурье, для Ардуины это тяжеловато, но хитрость состоит в том, что если взять в качестве несущей частоты \u003Ci\u003EFc\u003C\u002Fi\u003E такую, что она будет ровно в 4 раза меньше частоты дискретизации \u003Ci\u003EFs\u003C\u002Fi\u003E, то амплитуду этой гармоники можно вычислять демонически проще.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ этом случае \u003Ci\u003Edt = 2π*(Fs\u002F4)\u002FFs = π\u002F2\u003C\u002Fi\u003E, и на период несущей приходится всего 4 сэмпла:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F__\u002Fzm\u002Foe\u002F__zmoe1u0jzgjderykrsaogn0k8.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли все сдвинуть на \u003Ci\u003Eπ\u002F4\u003C\u002Fi\u003E то сэмплы будут принимать только два значения: √2\u002F2 и -√2\u002F2, для простоты оставим только знаки — \u003Cb\u003E«+» и «-»\u003C\u002Fb\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСуть же метода состоит в том, что синусную фазу мы представляем как последовательность знаков \u003Cb\u003E«+» «+» «-» «-»\u003C\u002Fb\u003E, а косинусную как \u003Cb\u003E«+» «-» «-» «+»\u003C\u002Fb\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПусть входной сигнал лежит в буфере \u003Ci\u003Esn\u003C\u002Fi\u003E, у нас есть два кольцевых буфера усреднения для синусной и косинусной фазы — \u003Ci\u003Ebs\u003C\u002Fi\u003E и \u003Ci\u003Ebc\u003C\u002Fi\u003E размером \u003Ci\u003EN\u003C\u002Fi\u003E. Указатели головы и хвоста у них общие — \u003Ci\u003EbH\u003C\u002Fi\u003E и \u003Ci\u003EbT\u003C\u002Fi\u003E. В начальный момент времени \u003Ci\u003EbH = N-1, bT = 0\u003C\u002Fi\u003E. Счетчик циклов усреденения \u003Ci\u003EC = 0\u003C\u002Fi\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nБерем из входного буфера по 4 сэмпла и складываем согласно последовательностям знаков.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\" role=\"button\" tabindex=\"0\"\u003E\n                        \u003Cb class=\"spoiler_title\"\u003EПример кода\u003C\u002Fb\u003E\n                        \u003Cdiv class=\"spoiler_text\"\u003E\u003Ccode\u003Ea = sn(i)\u003Cbr\u002F\u003E\r\nbs(bH) = a\u003Cbr\u002F\u003E\r\nbc(bH) = a\u003Cbr\u002F\u003E\r\ns1 = s1 + a - bs(bT)\u003Cbr\u002F\u003E\r\ns2 = s2 + a - bc(bT) \u003Cbr\u002F\u003E\r\nbH = (bH + 1) % N\u003Cbr\u002F\u003E\r\nbT = (bT + 1) % N\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\na = sn(i+1)\u003Cbr\u002F\u003E\r\nbs(bH) = a\u003Cbr\u002F\u003E\r\nbc(bH) = -a\u003Cbr\u002F\u003E\r\ns1 = s1 + a - bs(bT)\u003Cbr\u002F\u003E\r\ns2 = s2 - a - bc(bT) \u003Cbr\u002F\u003E\r\nbH = (bH + 1) % N\u003Cbr\u002F\u003E\r\nbT = (bT + 1) % N\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\na = sn(i+2)\u003Cbr\u002F\u003E\r\nbs(bH) = -a\u003Cbr\u002F\u003E\r\nbc(bH) = -a\u003Cbr\u002F\u003E\r\ns1 = s1 - a - bs(bT)\u003Cbr\u002F\u003E\r\ns2 = s2 - a - bc(bT) \u003Cbr\u002F\u003E\r\nbH = (bH + 1) % N\u003Cbr\u002F\u003E\r\nbT = (bT + 1) % N\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\na = sn(i+3)\u003Cbr\u002F\u003E\r\nbs(bH) = -a\u003Cbr\u002F\u003E\r\nbc(bH) = a\u003Cbr\u002F\u003E\r\ns1 = s1 - a - bs(bT)\u003Cbr\u002F\u003E\r\ns2 = s2 + a - bc(bT) \u003Cbr\u002F\u003E\r\nbH = (bH + 1) % N\u003Cbr\u002F\u003E\r\nbT = (bT + 1) % N\u003C\u002Fcode\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\n                    \u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nПосле каждой обработанной четверки сэмплов проверяем счетчик циклов усреднения и если он перевалил за \u003Ci\u003EN\u003C\u002Fi\u003E, то вычисляем амплитуду \u003Ci\u003EcA\u003C\u002Fi\u003E несущей:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"plaintext\"\u003Eif ++cycle \u003E= N\n      cA = sqrt(s1 * s1 + s2 * s2)\n      cycle = 0\nend\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nВот так это выглядит на идеальном сигнале:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Faj\u002Fw5\u002Fq5\u002Fajw5q5dls4ruoi_gjzdswjay0ko.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСиним показан сам сигнал, красным — значения амлитуды несущей (все приведено к диапазону -1..1). В данном случае \u003Ci\u003EN=2\u003C\u002Fi\u003E т.к. нет никаких шумов и все и так отлично работает.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТеперь добавим немного белого шума и посмотрим, как на это отреагирует наш детектор:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fah\u002Fee\u002F0j\u002Fahee0jsjvmnm_cm89jvyroxmrlg.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЯ добавил белого шума таким образом, чтобы соотношение сигнал-шум было равно 0 дБ. На рисунке выше синим показан зашумленный сигнал, зеленым — исходный, а красным — значение амплитуды. В этом случае детектор при \u003Ci\u003EN=2\u003C\u002Fi\u003E уже ничего не задетектировал, и минимальное N при котором он исправно работет равно 32. Т.е. размер окна обработки в сэмплах составил \u003Ci\u003E32*4 = 128\u003C\u002Fi\u003E сэмплов. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТо есть, теперь мы можем анализировать входной сигнал и оценивать некий параметр, который количественно показывает наличие частоты, в четыре раза меньше частоты дискретизации. Если задаться неким пороговым значением для этого параметра, то все можно бинаризовать, и говоря по-простому, мы сможем дать ответ на вопрос: присутствует ли заданный тон во входном сигнале или нет?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЭто очень хорошо, но нам нужно передавать биты, а биты могут принимать два значения.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nРеализовать систему с двумя сигнальными состояниями при помощи одного — так себе идея, поэтому мы \u003Ci\u003Eне будем\u003C\u002Fi\u003E кодировать одно из состояний тишиной (паузой). Это бы сильно затруднило детектирование: нужно было бы как-то выделять начало посылки, придумывать как оформить ее конец и т.д.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВместо этого «1» и «0» мы будем кодировать импульсами разной длины, между битами наличествует т.н. защитный интервал — ведь нам же еще нужно бороться с многолучевым распространением и реверберацией. Говоря простым языком, защитный интервал — это то место (время), где затухнут все отражения предшествующего бита, все послезвучия и эхо.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЗабегая вперед, примем к сведению, что при такой структуре сигнала алгоритм работы приемника очень сильно упрощается: ждем когда появился тон, засекаем начало, ждем, когда тон пропал и опять засекаем время — если полученное время больше похоже по длине на «1» то, наверное мы приняли бит со значением «1», если больше похоже на «0» — то видимо мы приняли бит, со значением «0». \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ общем, можно сказать, что это некий вариант морзянки.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EСофтовая часть модема\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nДля нетерпеливых — \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FAlekUnderwater\u002FSimpleUnderwaterAcousticModem\" rel=\"nofollow\"\u003Eпример лежит на GitHub\u003C\u002Fa\u003E. Написан на скорую руку на C# (потому что для ПК я пишу на нем и мне просто так удобнее и быстрее).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля воспроизведения и захвата звука с микрофонного входа используется замечательная библиотека \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fnaudio\u002FNAudio\" rel=\"nofollow\"\u003ENAudio\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВся логика модема находится в классе \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FAlekUnderwater\u002FSimpleUnderwaterAcousticModem\u002Fblob\u002Fmaster\u002FSRC\u002FC%23\u002FSUAModem.cs\" rel=\"nofollow\"\u003ESUAModem\u003C\u002Fa\u003E (Simple Underwater Acoustic Modem).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ конструктор передаются следующие параметры:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\ndouble sRateHz — частота дискретизации в Герцах;\u003Cbr\u002F\u003E\r\nint wSize — размер окна обработки в сэмплах;\u003Cbr\u002F\u003E\r\nint oneMultiplier — сколько «окон» длится бит со значением «1»\u003Cbr\u002F\u003E\r\nint zeroMultiplier — сколько «окон» длится бит со значением «0»\u003Cbr\u002F\u003E\r\ndouble eThreshold — порог, скажем о нем позже\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля формирования сигнала из массива байт есть метод ModulateData(byte[] data), который возвращает массив 16-ти битных знаковых сэмплов.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\" role=\"button\" tabindex=\"0\"\u003E\n                        \u003Cb class=\"spoiler_title\"\u003Epublic short[] ModulateData(byte[] data)\u003C\u002Fb\u003E\n                        \u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"cs\"\u003Epublic short[] ModulateData(byte[] data)\n{\n   double alpha = 0;\n   double phase = 0;           \n\n   List&lt;short\u003E samples = new List&lt;short\u003E();            \n   BitArray bits = new BitArray(data);         \n\n   for (int i = 0; i &lt; bits.Length; i++)\n   {\n         int sLim = (bits[i]) ? oneDurationSmp : zeroDurationSmp;\n         alpha = 0;\n         phase = 0;\n   \n         for (int sIdx = 0; sIdx &lt;= sLim; sIdx++)\n         {\n               alpha = Math.Sin(phase);\n               phase += delta;\n               if (phase \u003E= alimit)\n                        phase -= alimit;\n               samples.Add(Convert.ToInt16(alpha * short.MaxValue));\n         }\n         samples.AddRange(new short[defenseIntervalSmp]);                \n     }\n     return samples.ToArray();\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\n                    \u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nВ основном цикле по передаваемым битам происходит заполнение списка samples. В зависимсоти от текущего передаваемого бита устанавливается длина sLim формируемого сигнала в сэмплах. После каждого бита добавляется защитный интервал.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\" role=\"button\" tabindex=\"0\"\u003E\n                        \u003Cb class=\"spoiler_title\"\u003EКонечно...\u003C\u002Fb\u003E\n                        \u003Cdiv class=\"spoiler_text\"\u003EМногие могут заметить, что при генерации сигнала можно было бы обойтись и без функции синуса, но данный пример позволяет, изменив соотвествующим образом значение delta, изменить и частоту генерируемого тона.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля генерации тона с частотой \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fe60\u002F511\u002Fdc4\u002Fe60511dc487bc1f17a7fd670db1d7a8f.svg\" alt=\"$F_n$\" data-tex=\"inline\"\u002F\u003E при заданной частоте дискретизации \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ff9e\u002Fb64\u002F2c0\u002Ff9eb642c0d93ef26cc66c0ec3564ef12.svg\" alt=\"$F_s$\" data-tex=\"inline\"\u002F\u003E соответствующее значение \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fdd8\u002Fa86\u002F2f5\u002Fdd8a862f53583925b661220cb68f577b.svg\" alt=\"$\\delta$\" data-tex=\"inline\"\u002F\u003E вычисляется просто:\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fac3\u002F083\u002F60e\u002Fac308360eae61fd755545518922b103f.svg\" alt=\"$\\delta=2\\pi F_n\u002FF_s$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\n                    \u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nДля формирования и излучения сигнала есть метод TransmitData(byte[] data), который внутри себя вызывает ModulateData:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\" role=\"button\" tabindex=\"0\"\u003E\n                        \u003Cb class=\"spoiler_title\"\u003Epublic double TransmitData(byte[] data)\u003C\u002Fb\u003E\n                        \u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"cs\"\u003Epublic double TransmitData(byte[] data)\n{\n     var samples = ModulateData(data);\n     double txTime = ((double)samples.Length) \u002F SampleRateHz;\n\n     var rawBytes = new byte[samples.Length * 2];\n     for (int i = 0; i &lt; samples.Length; i++)\n     {\n          var bts = BitConverter.GetBytes(samples[i]);\n          rawBytes[i * 2] = bts[0];\n          rawBytes[i * 2 + 1] = bts[1];\n     }\n\n     using (var ms = new MemoryStream(rawBytes))\n     {\n          using (var rs = new RawSourceWaveStream(ms, new    WaveFormat(Convert.ToInt32(SampleRateHz), 16, 1)))\n                {\n                    using (var wo = new WaveOutEvent())\n                    {\n                        wo.Init(rs);\n                        wo.Play();\n                        while (wo.PlaybackState == PlaybackState.Playing)\n                        {\n                            Thread.SpinWait(1);\n                        }                        \n                    }\n\n                    rs.Close();\n             }\n             ms.Close();\n       }\n       return txTime;\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\n                    \u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nО принятии очередного байта класс SUAModem сообщает при помощи события DataReceivedEventHandler.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВходные сэмплы послупают в анализ при помощи метода ProcessInputSignal(short[] data), где записываются в кольцевой буфер ring. Анализ происходит в отдельном потоке, в методе Receiver.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nА сам приемник живет в методе Receive:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\" role=\"button\" tabindex=\"0\"\u003E\n                        \u003Cb class=\"spoiler_title\"\u003Eprivate void Receive()\u003C\u002Fb\u003E\n                        \u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"cs\"\u003Eprivate void Receive()\nint a;\n            while (rCnt \u003E= 4)\n            {\n                a = ring[rRPos];\n                rRPos = (rRPos + 1) % rSize;\n                rCnt--;\n                dRing1[rHead] = a;\n                dRing2[rHead] = a;\n                s1 += a - dRing1[rTail];\n                s2 += a - dRing2[rTail];\n                rHead = (rHead + 1) % windowSize;\n                rTail = (rTail + 1) % windowSize;\n\n                a = ring[rRPos];\n                rRPos = (rRPos + 1) % rSize;\n                rCnt--;\n                dRing1[rHead] = a;\n                dRing2[rHead] = -a;\n                s1 += a - dRing1[rTail];\n                s2 += -a - dRing2[rTail];\n                rHead = (rHead + 1) % windowSize;\n                rTail = (rTail + 1) % windowSize;\n\n                a = ring[rRPos];\n                rRPos = (rRPos + 1) % rSize;\n                rCnt--;\n                dRing1[rHead] = -a;\n                dRing2[rHead] = -a;\n                s1 += -a - dRing1[rTail];\n                s2 += -a - dRing2[rTail];\n                rHead = (rHead + 1) % windowSize;\n                rTail = (rTail + 1) % windowSize;\n\n                a = ring[rRPos];\n                rRPos = (rRPos + 1) % rSize;\n                rCnt--;\n                dRing1[rHead] = -a;\n                dRing2[rHead] = a;\n                s1 += -a - dRing1[rTail];\n                s2 += a - dRing2[rTail];\n                rHead = (rHead + 1) % windowSize;\n                rTail = (rTail + 1) % windowSize;\n\n                if (++cycle \u003E= windowSize)\n                {\n                    cycle = 0;\n\n                    currentEnergy = Math.Sqrt(s1 * s1 + s2 * s2) \u002F windowSize;\n                    double de = currentEnergy - prevEnergy;                   \n\n                    #region analysis\n\n                    if (skip \u003E 0)\n                        skip -= windowSize * 4;\n                    else\n                    {\n                        if (isRise)\n                        {\n                            if (de \u003E -Threshold)\n                            {\n                                riseSmp += windowSize * 4;\n                            }\n                            else\n                            {\n                                \u002F\u002F analyse symbol\n                                isRise = false;\n\n                                double oneDiff = Math.Abs(oneDurationSmp - riseSmp);\n                                double zeroDiff = Math.Abs(zeroDurationSmp - riseSmp);\n\n                                if (oneDiff \u003E zeroDiff)\n                                {\n                                    \u002F\u002F Mostly likely \"0\"\n                                    AddBit(false);\n                                }\n                                else\n                                {\n                                    \u002F\u002F Mostly likely \"1\"\n                                    AddBit(true);\n                                }\n\n                                samplesSinceLastBit = 0;\n                                skip = defenseIntervalSmp \u002F 2;\n                            }\n                        }\n                        else\n                        {\n                            if (de \u003E Threshold)\n                            {\n                                isRise = true;\n                                riseSmp = windowSize * 4;\n                            }\n                        }\n                    }\n\n                    #endregion\n\n                    prevEnergy = currentEnergy;\n\n                    if (bPos \u003E 0)\n                    {                        \n                        samplesSinceLastBit += 4 * windowSize;\n                        if (samplesSinceLastBit \u003E= defenseIntervalSmp * 2 + zeroDurationSmp + oneDurationSmp)\n                        {                            \n                            DiscardBits();\n                        }\n                    }\n                }                \n            }\n        }        \n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\n                    \u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nИз кода видно, что анализ ведется по 4 сэмпла, при желании можно сохранять состояние и вести обработку и по одному сэмплу, что будет полезно при переносе на какой-нибудь немощный МК.\u003Cbr\u002F\u003E\r\nПо мере поступления данных вычисляется значение амлитуды s на частоте sRateHz\u002F4. Вычисляется разница между предыдущим и текущим значением амплитуды и затем сравнивается с заданным порогом, подобранным экспериментально. Пример позволяет в реальном времени этот порог менять.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nРезкое увеличение амплитуды свидетельствует о начале «бита», резкий (несколько менее резкий — из-за реверберации) спад — о завершении «бита».\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПосле приема очередного бита отрабатываем защитный интервал — пропускаем заданное количество сэмплов — в них всякие эхо, они нам будут только мешать.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EЖелезная часть модема\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nИтак, со структурой сигнала все понятно, как его принимать тоже ясно. Дело за малым — научиться излучать сигнал в воду и принимать его из воды.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли у вас еще нет гидроакустических антенн, то самое время их сделать по \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F431302\u002F\"\u003Eнашему предыдущему туториалу\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nУ меня они остались с того раза, так что я этот шаг пропускаю.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТу антенну, которая предназначена для передачи мы подключаем к \u003Ca href=\"https:\u002F\u002Fwww.aliexpress.com\u002Fitem\u002F1pcs-TDA2030A-Module-Single-Power-Supply-Audio-Amplifier-Board-Module\u002F32847983961.html?tt=sns_none&amp;aff_platform=default&amp;cpt=1557765605290&amp;sk=XXxRqxY&amp;aff_trace_key=5b7cbf3c89fc4d6fbe6aa2e870630181-1557765605290-02601-XXxRqxY&amp;terminal_id=6eb28f235e794d9897c6710be47d8866\" rel=\"nofollow\"\u003Eплате усилителя с алиэкспресс\u003C\u002Fa\u003E. Для нескольких десятков метров (может даже для сотни) нам этого вполне хватит. Никаких хитростей тут нет — выход звуковой карты ноутбука идет на вход усилителя, который питается от свинцового АКБ 12 вольт 4 Ач. На выход подключена наша гидроакустическая передающая антенна из пьезопищалки. В моем случае это выглядит вот так:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fza\u002F17\u002F0e\u002Fza170ex4xgid-pacrxgcevfkmm8.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fza\u002F17\u002F0e\u002Fza170ex4xgid-pacrxgcevfkmm8.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002F_8\u002F0u\u002Fjz\u002F_80ujzh-1afojo46fevq6egccvg.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F_8\u002F0u\u002Fjz\u002F_80ujzh-1afojo46fevq6egccvg.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа фото выше, на экране есть небольшой спойлер следующей статьи. В следующий раз на этих же железках мы снова будем пытаться передавать «видео» звуком через воду, но совершенно иным способом, чем в \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F408871\u002F\"\u003Eпрошлый раз\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nС приемной антенной несколько сложнее. Хоть пьезопищалки и очень чувствительны, все же этого недостаточно. Нам придется собрать плату предусилителя с фильтром на полосу 5-35 кГц. \u003Cbr\u002F\u003E\r\nКоэффициент усиления мы берем 1000.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСхема, дизайн печатной платы и список компонентов предусилителя лежит у нас на GitHub: \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FAlekUnderwater\u002FSimpleUnderwaterAcousticModem\u002Fblob\u002Fmaster\u002FPreamplifier_board\u002Fpiezo_preamp_1000_5-35kHz_schematic.pdf\" rel=\"nofollow\"\u003Eсхема\u003C\u002Fa\u003E, дорожки — \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FAlekUnderwater\u002FSimpleUnderwaterAcousticModem\u002Fblob\u002Fmaster\u002FPreamplifier_board\u002FTop_70x25_mm.bmp\" rel=\"nofollow\"\u003Eверхний слой\u003C\u002Fa\u003E и \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FAlekUnderwater\u002FSimpleUnderwaterAcousticModem\u002Fblob\u002Fmaster\u002FPreamplifier_board\u002FBottom_70x25_mm.bmp\" rel=\"nofollow\"\u003Eнижний слой\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FAlekUnderwater\u002FSimpleUnderwaterAcousticModem\u002Fblob\u002Fmaster\u002FPreamplifier_board\u002FBOM.xlsx\" rel=\"nofollow\"\u003EBOM\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fsearch\u002F?q=%D0%9B%D0%A3%D0%A2#h\"\u003EТехнология ЛУТ\u003C\u002Fa\u003E обсуждалась стотыщмильенов раз, но дайте же и нам внести свою лепту. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\" role=\"button\" tabindex=\"0\"\u003E\n                        \u003Cb class=\"spoiler_title\"\u003EФото технологического процесса\u003C\u002Fb\u003E\n                        \u003Cdiv class=\"spoiler_text\"\u003EИтак, берем подходящий журнал, у нас под рукой оказался только этот:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fwu\u002F72\u002Fzy\u002Fwu72zyy3twxj-iovwsbu1oplf0o.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fwu\u002F72\u002Fzy\u002Fwu72zyy3twxj-iovwsbu1oplf0o.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nБерем оттуда пару страниц и печатаем на них слои при помощи лазерного принтера.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Faq\u002Fc8\u002Fof\u002Faqc8of9rwkf_jv4df7o6gb4zqt0.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Faq\u002Fc8\u002Fof\u002Faqc8of9rwkf_jv4df7o6gb4zqt0.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСовмещаем при помощи иголочек и склеиваем по одной стороне, как показано на фото:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fgr\u002Fg5\u002F-l\u002Fgrg5-lzyj3bpl574on7uycmo7xk.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fgr\u002Fg5\u002F-l\u002Fgrg5-lzyj3bpl574on7uycmo7xk.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПеред применением утюга смачиваем тонер изопропиловым спиртом:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002F7k\u002Fsp\u002Fru\u002F7ksprumtearv6eixwlfndk9fnoo.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F7k\u002Fsp\u002Fru\u002F7ksprumtearv6eixwlfndk9fnoo.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nУтюжим через сложенный вчетверо лист А4:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fut\u002Fe5\u002Fxu\u002Fute5xu86kbik8c542za18_omuna.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fut\u002Fe5\u002Fxu\u002Fute5xu86kbik8c542za18_omuna.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nРазмачиваем теплой водой под краном:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Frg\u002Flg\u002F98\u002Frglg989tlqi-zotwzq5gwkadbo4.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Frg\u002Flg\u002F98\u002Frglg989tlqi-zotwzq5gwkadbo4.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nИ отмываем остатки бумаги. После чего получаем заготовку, готовую к травлению:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fdk\u002Flv\u002Fjc\u002Fdklvjcuntfws7eg27fr4soukldo.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fdk\u002Flv\u002Fjc\u002Fdklvjcuntfws7eg27fr4soukldo.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЛишнее отрезаем при помощи ножниц по металлу или кому чем удобнее.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТравим в хлорном железе. Специально для статьи мы развели свежее, оно оказалось настолько забористое что от будущей платы активно идут пузырики:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fwc\u002Fnq\u002Fri\u002Fwcnqrifmzqht9luucn3lt0xf1uc.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fwc\u002Fnq\u002Fri\u002Fwcnqrifmzqht9luucn3lt0xf1uc.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ результате, после травления и отмывки тонера получаем такой полуфабрикат:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fvk\u002Fde\u002Fk7\u002Fvkdek7hiqs1p3van-coacl4gkk4.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fvk\u002Fde\u002Fk7\u002Fvkdek7hiqs1p3van-coacl4gkk4.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fks\u002Fx-\u002Fhd\u002Fksx-hd6m6qdijzicf1rwgnhwoy4.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fks\u002Fx-\u002Fhd\u002Fksx-hd6m6qdijzicf1rwgnhwoy4.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПосле напайки компонентов и отмывки плата выгладит вот так. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fwn\u002Fx4\u002Ffd\u002Fwnx4fd56r1newq2ew6cjr1hmlaa.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fwn\u002Fx4\u002Ffd\u002Fwnx4fd56r1newq2ew6cjr1hmlaa.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\n                    \u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nА так выглядит приемная часть в сборе. Питание осуществляется от такого же свинцового АКБ 12 вольт:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fmc\u002F03\u002Fdj\u002Fmc03djslty9veqpq1aqsllzbckq.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fmc\u002F03\u002Fdj\u002Fmc03djslty9veqpq1aqsllzbckq.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\" role=\"button\" tabindex=\"0\"\u003E\n                        \u003Cb class=\"spoiler_title\"\u003EНебольшой дисклеймер по поводу фильтра\u003C\u002Fb\u003E\n                        \u003Cdiv class=\"spoiler_text\"\u003EЕсли читатель захочет изменить полосу, то предлагаем пересчитать фильтр 8-ого порядка, собранный на дешевом 4-х канальном операционнике TL084C (DA2 на \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FAlekUnderwater\u002FSimpleUnderwaterAcousticModem\u002Fblob\u002Fmaster\u002FPreamplifier_board\u002Fpiezo_preamp_1000_5-35kHz_schematic.pdf\" rel=\"nofollow\"\u003Eсхеме\u003C\u002Fa\u003E), резисторах R10-R13, R15-R23 и конденсаторах C5-C8, C11, C12, C14 и С15.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа всякий случай приведем здесь АЧХ текущей реализации фильтра:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fbi\u002Fpd\u002Fdy\u002Fbipddyy5zubboog4qimejpdxvjw.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nА вот еще \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FAlekUnderwater\u002FSimpleUnderwaterAcousticModem\u002Fblob\u002Fmaster\u002FPreamplifier_board\u002Ffilter.sch\" rel=\"nofollow\"\u003Eпроект\u003C\u002Fa\u003E для этого фильтра, созданный в приложении \u003Ca href=\"http:\u002F\u002Fqucs.sourceforge.net\u002F\" rel=\"nofollow\"\u003EQucs\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\n                    \u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EОпыты и испытания\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nДля подключения к ноутбуку используем обычный Jack 3.5 мм, самый кончик — сигнал, средний — не подключен, земля — к земле \u003Cs\u003Eпрах к праху\u003C\u002Fs\u003E. Все усиления и любые эффекты микрофона нужно отключить, а громкостью придется поиграться, чтобы достичь оптимального уровня. Зашкал должен происходить при касании подключенной к предусилителю антенны пальцем и легком поглаживании.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли просто положить одну пьезу на другую без усилителя и предусилителя и подключить их к аудиовходу и выходу, то все работает идеально. Ниже представлен отрезок сигнала и можно даже на глаз определить где какие значения битов:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fft\u002Fny\u002Fjm\u002Fftnyjmiapa0uoyeuyhjo2ztaeji.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСиним показан сам сигнал, красным — разница между текущим и предыдущим значениями амплитуды (фронт), зеленым — разница между предыдущим и текущим значениями (спад). Без труда можно «демодулировать» эту часть посылки: 1 0 0 0 1 1 0. Ноль у нас в два раза дольше единицы, а длительность защитного интервала равна длительности нуля.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДалее, также без усилителя и предусилителя опускаем наши антенны в металлический бак, размерами 3х1.5х1.5. У нас такой стоит в лаборатории, и мы завели себе правило, что не занимаемся никакой связью, если она хоть как-то не в состоянии работать в этом баке. Дело в том, что в таком замкнутом объеме энергии особо некуда деваться — звук чудесно и многократно отражается от металлических стенок и в точке приема получается каша. А с учетом того, что мы обычно проверяем готовые девайсы с энергетикой, рассчитанной на тысячи метров, можете представить что там творится. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНапример, два наших модема \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fucnl\u002Fucnl.github.io\u002Fblob\u002Fmaster\u002Fdocumentation\u002FRU\u002FRedLINE\u002FRedLine_Specification_ru.md\" rel=\"nofollow\"\u003ERedLINE\u003C\u002Fa\u003E устойчиво работают в этом баке только на расстоянии не больше двух метров, а два \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F428367\u002F\"\u003EuWAVE\u003C\u002Fa\u003E-а стабильно работают примерно на 1 метре. При том что первый в открытой воде работает до 8000 метров, а второй — \u003Ca href=\"https:\u002F\u002Fwww.youtube.com\u002Fwatch?v=Z1bVerVecY0\" rel=\"nofollow\"\u003Eдо километра\u003C\u002Fa\u003E. \u003Cbr\u002F\u003E\r\nКонечно, все коммерческие продукты не используют такие примитивные схемы модуляции, о которой идет речь в статье и устроены гораздо сложнее, но нам сейчас важно понять азы и с пользой поделать что-то руками.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ общем, опускаем антенны в бак на расстояние порядка 50 сантиметров и получаем уже нечто гораздо менее благообразное, чем при непосредственном контакте антенн:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fzy\u002Fmy\u002Fo9\u002Fzymyo9ptbahm3xh60dsv-5hz1mg.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nХотя здесь использован значительно более долгий защитный интервал, все равно видно, что эхо гуляет почти до следующего бита, фронты и особенно спады сильно размыты. Но все еще можно определить содержание сообщения: 1 0 0 0 1 1 0\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ обоих случаях я передавал сообщение «123» и эти семь бит принадлежат символу единицы.\u003Cbr\u002F\u003E\r\nВыглядело это примерно так, потом интерфейс был немного переделан\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fom\u002Fym\u002Fsw\u002Fomymswxytjqy_l6uvzbijcr1pac.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nИз скрина выше видно, что при тех настройках, передача сообщения «Hello, \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fusers\u002Fhabr\u002F\" class=\"user_link\"\u003Ehabr\u003C\u002Fa\u003E!!! :-)» состоящее из 19 байт занимает 9.132 секунд, то есть скорость передачи составила 16,6 бит\u002Fс. К слову сказать, чтобы модем работал в нашем баке пришлось увеличить защитный интервал так, что скорость передачи упала до ~3 бит\u002Fс.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nМы проверяли самоделку в плавательном бассейне, где устойчиво она заработала на 10 метрах.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fbq\u002Fjh\u002F_n\u002Fbqjh_nwss-l-zjzi5hj5m7xru44.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fbq\u002Fjh\u002F_n\u002Fbqjh_nwss-l-zjzi5hj5m7xru44.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕще мы баловались самоделкой на пруду. Я использовал активный гидрофон очень похожий по конструкции на предложенный в статье, только вместо пьезопищалки там применен датчик от парктроника, аккумулятор там смонтирован в катушку, на которую наматывается кабель:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fbe\u002Fhk\u002Fjm\u002Fbehkjmbi2kz0_sxallhxjwyoqvc.jpeg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fbe\u002Fhk\u002Fjm\u002Fbehkjmbi2kz0_sxallhxjwyoqvc.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fyu\u002Fke\u002F-w\u002Fyuke-wfwsgcozt5pg77d8g4cic8.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nАнтенны приемника и передатчика опускались прямо с берега, глубина там резко уходит с 0.5 до 2 метров. В опыте, который показан на фото выше были, как ни странно, самые плохие условия, дистанция там была всего порядка 5 метров — это вообще была первоначальная настройка. Из 20 переданных сообщений по 3 байта, в шести из них было побито по одному байту.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПотом, когда мы подключили приемник ко второму ноутбуку и перенесли на другой берег пруда (дистанция порядка 30 метров) передача проходила значительно лучше — на 40 сообщений размером от 3 до 13 байт было всего пару ошибок.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fwp\u002Fbz\u002F6i\u002Fwpbz6i4wngzg4fdgfza2bxkr2h0.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа следующем фото на карте видны места, где располагались антенны.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F-i\u002F_u\u002Flk\u002F-i_ulk8o3bsyu4ni7um5tyky73c.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EЗаключение и дальнейшие изыскания\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nКак и обещал, за мало рублей мы собрали рабочее устройство. Хоть практическая ценность его сомнительна, но сам процесс изготовления и настройки на водоеме будет очень полезен начинающим. На описанном методе детектирования несущей вполне можно придумать разных простых навигационных систем для любительского применения, а что особенно приятно, вычислительная сложность позволяет реализовать метод на простом микроконтроллере.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЧтобы не быть голословным относительно построения навигационных систем на простых сигналах, взгляните на \u003Ca href=\"https:\u002F\u002Fwww.semanticscholar.org\u002Fpaper\u002FUNDERWATER-ACOUSTIC-POSITIONING-SYSTEMS-BASED-ON-Alcocer-Oliveira\u002F134a4e769a6a64c6f5bc0f0efda9ed2a93893bdb\" rel=\"nofollow\"\u003Eинтересную работу\u003C\u002Fa\u003E, в которой построили полноценную длиннобазисную навигационную систему. В этой системе определяют положение пингера, который периодически передает свою глубину. Значение глубины при этом кодируется расстоянием между двумя простыми импульсами на определенной частоте. Так что да-да, горшки не боги обжигают, дорогу осилит идущий, терпение и труд, учиться, учиться, учиться — вот это вот все.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВозможно, при наличии времени мы сделаем DIY-проект по позиционированию автономного пингера, излучающего простые сигналы. Нечто подобное, но не DIY мы уже делали на базе наших модемов \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fucnl\u002Fucnl.github.io\u002Fblob\u002Fmaster\u002Fdocumentation\u002FRU\u002FuWAVE\u002FuWAVE_Specification_ru.md\" rel=\"nofollow\"\u003EuWAVE\u003C\u002Fa\u003E, о чем даже попытались \u003Ca href=\"https:\u002F\u002Fwww.youtube.com\u002Fwatch?v=UHfTv7TtABU&amp;t=11s\" rel=\"nofollow\"\u003Eснять видео\u003C\u002Fa\u003E. Будет очень интересно услышать ваши мнения на этот счет — очень важно иметь подтверждение, что делаешь что-то не напрасно.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТем не менее, возвращаясь к основной теме, отметим, что можно было бы улучшить в предложенной схеме:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003Eсделать вычисление порога адаптивным\u003C\u002Fli\u003E\r\n\u003Cli\u003Eанализировать ширину сигналов автоматически\u003C\u002Fli\u003E\r\n\u003Cli\u003Eпопробовать использовать разные длины для разных битовых комбинаций\u003C\u002Fli\u003E\r\n\u003Cli\u003Eприкрутить \u003Cs\u003Eобожебоже\u003C\u002Fs\u003E помехоустойчивое кодирование\u003C\u002Fli\u003E\r\n\u003Cli\u003Eперенести все это на ардуино\u003C\u002Fli\u003E\r\n\u003Cli\u003Eгромкость и порог приходится долго и нудно подбирать, поэтому хорошо бы добавить в предусилитель АРУ\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\nНа этом заседание объявлю закрытым, а если вас заинтересовала тема, вот список наших предыдущих статей:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F370083\u002F\"\u003EПодводный GPS с нуля за год\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F449072\u002F\"\u003EПодводный GPS на подводном роботе: опыт использования\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F428367\u002F\"\u003EМы сделали самый маленький в мире гидроакустический модем\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"https:\u002F\u002Fgeektimes.ru\u002Fpost\u002F293681\u002F\" rel=\"nofollow\"\u003EК вопросу о влиянии цианобактерий на речевые функции президента\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F431302\u002F\"\u003EДелаем простую гидроакустическую антенну из мусора\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fpost\u002F408871\u002F\"\u003EСеанс передачи видео звуком через воду с разоблачением\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F421977\u002F\"\u003EПодводный «GPS» на двух приемопередатчиках\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F405845\u002F\"\u003EНавигация под водой: пеленгуй не пеленгуй — обречен ты на успех\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F403891\u002F\"\u003EПодводный GPS: продолжение\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EP.S.\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n Как всегда с удовольствием выслушаем замечания и предложения, обоснованную критику и одобряющие возгласы )\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EP.P.S.\u003C\u002Fh3\u003E \u003Cbr\u002F\u003E\r\nЖелезки далеко не убирайте — в следующий раз мы с их помощью будем опять передавать «видео» через воду.\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"гидроакустика"},{"titleHtml":"модем"},{"titleHtml":"DIY"},{"titleHtml":"пьезоэлементы"},{"titleHtml":"подводная связь"},{"titleHtml":"C#"},{"titleHtml":"NAudio"},{"titleHtml":"DSP"},{"titleHtml":"детектор частоты"},{"titleHtml":"модуляция сигнала"},{"titleHtml":"звук"},{"titleHtml":"предусилитель"},{"titleHtml":"ультразвук"},{"titleHtml":"полосовой фильтр"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F451800\u002Fb55e90d2d309868a3161293b9c822ad4\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F451800\u002Fb55e90d2d309868a3161293b9c822ad4\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F451800\\\u002F\"},\"headline\":\"Делаем простой гидроакустический модем\",\"datePublished\":\"2019-05-15T06:56:17+03:00\",\"dateModified\":\"2020-07-09T11:59:59+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Aleksandr Dikarev\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Привет, глубокоуважаемые! В этой статье, по многочисленным просьбам мы расскажем как сделать простейший гидроакустический модем: немного цифровой обработки сигна...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F451800\\\u002F#post-content-body\",\"about\":[\"h_netdev\",\"h_electronics\",\"h_gadgets\",\"h_DIY\",\"h_easyelectronics\",\"f_develop\",\"f_popsci\"],\"image\":[\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F_8\\\u002F0u\\\u002Fjz\\\u002F_80ujzh-1afojo46fevq6egccvg.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fad1\\\u002F7f8\\\u002F7ff\\\u002Fad17f87ff18c3764da78faf86ee52105.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F__\\\u002Fzm\\\u002Foe\\\u002F__zmoe1u0jzgjderykrsaogn0k8.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Faj\\\u002Fw5\\\u002Fq5\\\u002Fajw5q5dls4ruoi_gjzdswjay0ko.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fah\\\u002Fee\\\u002F0j\\\u002Fahee0jsjvmnm_cm89jvyroxmrlg.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fe60\\\u002F511\\\u002Fdc4\\\u002Fe60511dc487bc1f17a7fd670db1d7a8f.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Ff9e\\\u002Fb64\\\u002F2c0\\\u002Ff9eb642c0d93ef26cc66c0ec3564ef12.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fdd8\\\u002Fa86\\\u002F2f5\\\u002Fdd8a862f53583925b661220cb68f577b.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fac3\\\u002F083\\\u002F60e\\\u002Fac308360eae61fd755545518922b103f.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fza\\\u002F17\\\u002F0e\\\u002Fza170ex4xgid-pacrxgcevfkmm8.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fwu\\\u002F72\\\u002Fzy\\\u002Fwu72zyy3twxj-iovwsbu1oplf0o.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Faq\\\u002Fc8\\\u002Fof\\\u002Faqc8of9rwkf_jv4df7o6gb4zqt0.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fgr\\\u002Fg5\\\u002F-l\\\u002Fgrg5-lzyj3bpl574on7uycmo7xk.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F7k\\\u002Fsp\\\u002Fru\\\u002F7ksprumtearv6eixwlfndk9fnoo.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fut\\\u002Fe5\\\u002Fxu\\\u002Fute5xu86kbik8c542za18_omuna.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Frg\\\u002Flg\\\u002F98\\\u002Frglg989tlqi-zotwzq5gwkadbo4.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fdk\\\u002Flv\\\u002Fjc\\\u002Fdklvjcuntfws7eg27fr4soukldo.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fwc\\\u002Fnq\\\u002Fri\\\u002Fwcnqrifmzqht9luucn3lt0xf1uc.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fvk\\\u002Fde\\\u002Fk7\\\u002Fvkdek7hiqs1p3van-coacl4gkk4.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fks\\\u002Fx-\\\u002Fhd\\\u002Fksx-hd6m6qdijzicf1rwgnhwoy4.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fwn\\\u002Fx4\\\u002Ffd\\\u002Fwnx4fd56r1newq2ew6cjr1hmlaa.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fmc\\\u002F03\\\u002Fdj\\\u002Fmc03djslty9veqpq1aqsllzbckq.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fbi\\\u002Fpd\\\u002Fdy\\\u002Fbipddyy5zubboog4qimejpdxvjw.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fft\\\u002Fny\\\u002Fjm\\\u002Fftnyjmiapa0uoyeuyhjo2ztaeji.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fzy\\\u002Fmy\\\u002Fo9\\\u002Fzymyo9ptbahm3xh60dsv-5hz1mg.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fom\\\u002Fym\\\u002Fsw\\\u002Fomymswxytjqy_l6uvzbijcr1pac.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fbq\\\u002Fjh\\\u002F_n\\\u002Fbqjh_nwss-l-zjzi5hj5m7xru44.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fbe\\\u002Fhk\\\u002Fjm\\\u002Fbehkjmbi2kz0_sxallhxjwyoqvc.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fyu\\\u002Fke\\\u002F-w\\\u002Fyuke-wfwsgcozt5pg77d8g4cic8.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fwp\\\u002Fbz\\\u002F6i\\\u002Fwpbz6i4wngzg4fdgfza2bxkr2h0.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F-i\\\u002F_u\\\u002Flk\\\u002F-i_ulk8o3bsyu4ni7um5tyky73c.png\"]}","metaDescription":"Привет, глубокоуважаемые!\r\nВ этой статье, по многочисленным просьбам мы расскажем как сделать простейший гидроакустический модем: немного цифровой обработки сигналов, немного программирования, немного...","mainImageUrl":null,"amp":false},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":"netdev,electronics,gadgets,DIY,easyelectronics"},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
