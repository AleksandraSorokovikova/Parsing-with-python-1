<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Разрабатываем игру на Svelte 3 / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/452684\/"},"headline":"Разрабатываем игру на Svelte 3","datePublished":"2019-05-29T08:55:44+03:00","dateModified":"2019-06-19T15:44:29+03:00","author":{"@type":"Person","name":"Alexander Zinchenko"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Чуть больше месяца назад вышел релиз Svelte 3. Хороший момент для знакомства, &mdash; подумал я и пробежался по отличному туториалу, который еще и переведен на русский...","url":"https:\/\/habr.com\/ru\/post\/452684\/#post-content-body","about":["h_webdev","h_javascript","h_gamedev","h_sveltejs","f_develop"],"image":["https:\/\/habrastorage.org\/webt\/sv\/qn\/gn\/svqngnpfga7_0i44wvfi_blliz4.gif","https:\/\/habrastorage.org\/webt\/jp\/uc\/wt\/jpucwtprafksew6yvz0b0_y68sw.png","https:\/\/habrastorage.org\/webt\/cx\/x0\/e5\/cxx0e5ubvazwuwtzaofnp5y4tqq.gif","https:\/\/habrastorage.org\/webt\/ig\/vl\/wc\/igvlwcgdchgztehn0t4kofofddk.gif","https:\/\/habrastorage.org\/webt\/gf\/be\/_a\/gfbe_a4u6bin74_wg4xdpgcolme.gif","https:\/\/habrastorage.org\/webt\/ko\/8k\/96\/ko8k96c-ffehw1nm81cpptkhiga.gif"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Разрабатываем игру на Svelte 3" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Разрабатываем игру на Svelte 3" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Разрабатываем игру на Svelte 3" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Чуть больше месяца назад вышел релиз Svelte 3. Хороший момент для знакомства, — подумал я и пробежался по отличному туториалу, который еще и переведен на русский.
Для закрепления пройденного я сделал..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Чуть больше месяца назад вышел релиз Svelte 3. Хороший момент для знакомства, — подумал я и пробежался по отличному туториалу, который еще и переведен на русский.
Для закрепления пройденного я сделал..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Чуть больше месяца назад вышел релиз Svelte 3. Хороший момент для знакомства, — подумал я и пробежался по отличному туториалу, который еще и переведен на русский.
Для закрепления пройденного я сделал..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Чуть больше месяца назад вышел релиз Svelte 3. Хороший момент для знакомства, — подумал я и пробежался по отличному туториалу, который еще и переведен на русский.
Для закрепления пройденного я сделал..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Чуть больше месяца назад вышел релиз Svelte 3. Хороший момент для знакомства, — подумал я и пробежался по отличному туториалу, который еще и переведен на русский.
Для закрепления пройденного я сделал..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/452684/85e6b1a03b19e6343e389c2062130256/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/452684/85e6b1a03b19e6343e389c2062130256/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/452684/85e6b1a03b19e6343e389c2062130256/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/452684/85e6b1a03b19e6343e389c2062130256/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/452684/85e6b1a03b19e6343e389c2062130256/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="452684" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2019-05-29T05:55:44.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/452684/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/452684/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/452684/85e6b1a03b19e6343e389c2062130256/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/sanReal/" title="sanReal" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" loading="lazy" src="//habrastorage.org/r/w32/getpro/habr/avatars/2c7/d5b/f88/2c7d5bf88d612d72f76a9b837c7d41c8.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/sanReal/" class="tm-user-info__username">
      sanReal
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2019-05-29T05:55:44.000Z" title="2019-05-29, 08:55">29  мая  2019 в 08:55</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Разрабатываем игру на Svelte 3</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/webdev/" class="tm-article-snippet__hubs-item-link"><span>Разработка веб-сайтов</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/javascript/" class="tm-article-snippet__hubs-item-link"><span>JavaScript</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/gamedev/" class="tm-article-snippet__hubs-item-link"><span>Разработка игр</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/sveltejs/" class="tm-article-snippet__hubs-item-link"><span>SvelteJS</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <div class="tm-article-snippet__labels"><div class="tm-article-snippet__label"><span>
        Tutorial
      </span></div></div> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml"><p>Чуть больше месяца назад вышел релиз <a href="https://habr.com/ru/post/449450/">Svelte 3</a>. Хороший момент для знакомства, — подумал я и пробежался по <a href="https://ru.svelte.dev/tutorial/basics">отличному туториалу</a>, который еще и переведен на русский.</p><br/>
<p>Для закрепления пройденного я сделал небольшой проект и делюсь результатами с вами. Это не one-more-todo-list, а игра, в которой нужно отстреливаться от черных квадратов. </p><br/>
<p><img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/webt/sv/qn/gn/svqngnpfga7_0i44wvfi_blliz4.gif"/></p><a name="habracut"></a><br/>
<h2 id="0-dlya-neterpelivyh">0. Для нетерпеливых</h2><br/>
<p><a href="https://github.com/az67128/svelte-war/tree/MVP">Репозиторий туториала</a><br/>
<a href="https://github.com/az67128/svelte-war/tree/master">Репозиторий с дополнениями</a><br/>
<a href="https://az67128.github.io/svelte-war">Демо</a></p><br/>
<h2 id="1-podgotovka">1. Подготовка</h2><br/>
<p>Клонируем <a href="https://github.com/sveltejs/template">шаблон</a> для разработки </p><br/>
<pre><code class="bash">git clone https://github.com/sveltejs/template.git</code></pre><br/>
<p>Устанавливаем зависимости.</p><br/>
<pre><code class="bash">cd template/
npm i</code></pre><br/>
<p>Запускаем dev сервер.</p><br/>
<pre><code class="bash">npm run dev</code></pre><br/>
<p>Наш шаблон доступен по адресу<br/>
<a href="http://localhost:5000">http://localhost:5000</a>. Сервер поддерживает hot reload, поэтому наши изменения будут видны в браузере по мере сохранения изменений.</p><br/>
<p>Если вы не хотите разворачивать среду локально, то можете использовать онлайн песочницы <a href="https://codesandbox.io/s/svelte">codesandbox</a> и <a href="https://stackblitz.com/fork/svelte">stackblitz</a>, которые поддерживают Svelte.</p><br/>
<h2 id="2-karkas-igry">2. Каркас игры</h2><br/>
<p>Папка src состоит из двух файлов <strong>main.js</strong> и <strong>App.svelte</strong>.<br/>
<strong>main.js</strong> — это точка входа в наше приложение. Во время разработки мы ее трогать не будем. Здесь компонент App.svelte монтируется в body документа.<br/>
<strong>App.svelte</strong> — это компонент svelte. Шаблон компонента состоит из трех частей:</p><br/>
<pre><code class="html">&lt;script>
    // JS код компонента
    export let name;
&lt;/script>

&lt;style>
    /* CSS стили компонента */
    h1 {
        color: purple;
    }
&lt;/style>
&lt;!-- разметка компонента -->
&lt;h1>Hello {name}!&lt;/h1></code></pre><br/>
<p>Стили компонента изолированы, но есть возможность назначить глобальные стили директивой :global(). <a href="https://ru.svelte.dev/docs#style">Подробнее о стилях</a>.<br/>
Добавим общие стили для нашего компонента</p><br/>
<div class="spoiler"><b class="spoiler_title">src/App.svelte</b><div class="spoiler_text"><pre><code class="html">&lt;script>
  export let name;
&lt;/script>

&lt;style>
  :global(html) {
    height: 100%; /* Наша игра будет занимать 100% высоты*/
  }
  :global(body) {
    height: 100%; /* Наша игра будет занимать 100% высоты*/
    overscroll-behavior: none; /* отключает pull to refresh*/
    user-select: none; /* для тач интерфейсов отключает выделение при нажатии */
    margin: 0; /* убираем отступы*/
    background-color: #efefef; /* устанавливаем цвет фона */
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
      Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif; /* устанавливаем шрифты */
  }
&lt;/style>

&lt;h1>Hello {name}!&lt;/h1></code></pre></div></div><br/>
<p>Давайте создадим папку <strong>src/components</strong>, в которой будут храниться наши компоненты<br/>
В этой папке создадим два файла, которые будут содержать игровое поле и элементы управления.</p><br/>
<div class="spoiler"><b class="spoiler_title">src/components/GameField.svelte</b><div class="spoiler_text"><pre><code class="html">&lt;div>GameField&lt;/div></code></pre></div></div><br/>
<div class="spoiler"><b class="spoiler_title">src/components/Controls.svelte</b><div class="spoiler_text"><pre><code class="html">&lt;div>Controls&lt;/div></code></pre></div></div><br/>
<p>Импорт компонента осуществляется директивой</p><br/>
<pre><code class="javascript">import Controls from "./components/Controls.svelte";</code></pre><br/>
<p>Для отображения компонента достаточно вставить тег компонента в разметку. <a href="https://ru.svelte.dev/docs#Tegi">Подробнее о тегах</a>.</p><br/>
<pre><code class="javascript">&lt;Controls /></code></pre><br/>
<p>Теперь импортируем и отобразим наши компоненты в App.svelte.</p><br/>
<div class="spoiler"><b class="spoiler_title">src/App.svelte</b><div class="spoiler_text"><pre><code class="html">&lt;script>
  // импортируем компоненты
  import Controls from "./components/Controls.svelte";
  import GameField from "./components/GameField.svelte";
&lt;/script>

&lt;style>
  :global(html) {
    height: 100%; 
  }
  :global(body) {
    height: 100%; 
    overscroll-behavior: none; 
    user-select: none; 
    margin: 0; 
    background-color: #efefef; 
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
      Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif; 
  }
&lt;/style>

&lt;!-- Отображаем компоненты. Заметьте, нам не нужен рут компонент, как, например, в react -->
&lt;Controls />
&lt;GameField /></code></pre></div></div><br/>
<h2 id="3-elementy-upravleniya">3. Элементы управления</h2><br/>
<p>Компонент Controls.svelte будет состоять из трех кнопок: движение влево, движение вправо, огонь. Иконки кнопок будут отображаться svg элементом.<br/>
Создадим папку <strong>src/asssets</strong>, в которую добавим наши svg иконки.</p><br/>
<div class="spoiler"><b class="spoiler_title">src/assets/Bullet.svelte</b><div class="spoiler_text"><pre><code class="html">&lt;svg height="40px" viewBox="0 0 427 427.08344" width="40px">
  &lt;path
    d="m341.652344 38.511719-37.839844 37.839843 46.960938 46.960938
    37.839843-37.839844c8.503907-8.527344 15-18.839844
    19.019531-30.191406l19.492188-55.28125-55.28125 19.492188c-11.351562
    4.019531-21.664062 10.515624-30.191406 19.019531zm0 0" />
  &lt;path
    d="m258.65625 99.078125 69.390625 69.390625
    14.425781-33.65625-50.160156-50.160156zm0 0" />
  &lt;path
    d="m.0429688 352.972656 28.2812502-28.285156 74.113281 74.113281-28.28125
    28.28125zm0 0" />
  &lt;path
    d="m38.226562 314.789062 208.167969-208.171874 74.113281
    74.113281-208.171874 208.171875zm0 0" />
&lt;/svg></code></pre></div></div><br/>
<div class="spoiler"><b class="spoiler_title">src/assets/LeftArrow.svelte</b><div class="spoiler_text"><pre><code class="html">&lt;svg
  width="40px"
  height="40px"
  viewBox="0 0 292.359 292.359"
  transform="translate(-5 0)">
  &lt;path
    d="M222.979,5.424C219.364,1.807,215.08,0,210.132,0c-4.949,0-9.233,1.807-12.848,5.424L69.378,133.331
    c-3.615,3.617-5.424,7.898-5.424,12.847c0,4.949,1.809,9.233,5.424,12.847l127.906,127.907c3.614,3.617,7.898,5.428,12.848,5.428
    c4.948,0,9.232-1.811,12.847-5.428c3.617-3.614,5.427-7.898,5.427-12.847V18.271C228.405,13.322,226.596,9.042,222.979,5.424z" />
&lt;/svg></code></pre></div></div><br/>
<div class="spoiler"><b class="spoiler_title">src/assets/RightArrow.svelte</b><div class="spoiler_text"><pre><code class="html">&lt;svg
  width="40px"
  height="40px"
  viewBox="0 0 292.359 292.359"
  transform="translate(5 0) rotate(180)">
  &lt;path
    d="M222.979,5.424C219.364,1.807,215.08,0,210.132,0c-4.949,0-9.233,1.807-12.848,5.424L69.378,133.331
    c-3.615,3.617-5.424,7.898-5.424,12.847c0,4.949,1.809,9.233,5.424,12.847l127.906,127.907c3.614,3.617,7.898,5.428,12.848,5.428
    c4.948,0,9.232-1.811,12.847-5.428c3.617-3.614,5.427-7.898,5.427-12.847V18.271C228.405,13.322,226.596,9.042,222.979,5.424z" />
&lt;/svg></code></pre></div></div><br/>
<p>Добавим компонент кнопки <strong>src/components/IconButton.svelte</strong>.<br/>
Мы будем принимать обработчики событий из родительского компонента. Для того, чтобы можно было зажать кнопку, нам понадобятся два обработчика: начало нажатия и конец нажатия. Объявим переменные <strong>start</strong> и <strong>release</strong>, куда будем принимать обработчики событий начала и окончания нажатия. Еще нам понадобится переменная <strong>active</strong>, которая будет отображать, нажата кнопка или нет.</p><br/>
<pre><code class="html">&lt;script>
  export let start;
  export let release;
  export let active;
&lt;/script></code></pre><br/>
<p>Стилизуем наш компонент</p><br/>
<pre><code class="html">&lt;style>
  .iconButton {
    /* С помощью flex выравниваем содержимое по центру */
    display: flex;
    align-items: center;
    justify-content: center;
    /* Устанавливаем размер элемента 60px */
    width: 60px;
    height: 60px;
    /* Добавляем обводку */
    border: 1px solid black;
    /* Делаем обводку круглой */
    border-radius: 50px;
   /* Убираем лишние стили кнопки */
    outline: none;
    background: transparent;
  }
  .active {
    /* Устанавливаем фон для состояния, когда кнопка нажата */
    background-color: #bdbdbd;
  }
&lt;/style></code></pre><br/>
<p>Кнопка представляет собой button элемент, внутри которого отображается контент, переданный из родительского компонента. Место, где будут монтироваться переданный контент обозначается тегом &lt;slot/>. <a href="https://ru.svelte.dev/docs#Sloty">Подробнее об элементе &lt;slot/></a>.</p><br/>
<pre><code class="html">&lt;button>
  &lt;slot />
&lt;/button></code></pre><br/>
<p>Обработчики событий обозначаются через директиву <strong>on:</strong>, например, <strong>on:click</strong>.<br/>
Мы будем обрабатывать события мыши и тач нажатия. <a href="https://ru.svelte.dev/docs#Sobytiya_komponenta">Подробнее о привязке событий</a>.<br/>
К базовому классу компонента будет добавляться класс <strong>active</strong>, если кнопка нажата. Назначить класс можно свойством <strong>class</strong>. <a href="https://ru.svelte.dev/docs#Klassy">Подробнее о классах</a></p><br/>
<pre><code class="html">&lt;button
  on:mousedown={start}
  on:touchstart={start}
  on:mouseup={release}
  on:touchend={release}
  class={`iconButton ${active ? 'active' : ''}`}>
  &lt;slot />
&lt;/button></code></pre><br/>
<p>В итоге наш компонент будет выглядеть следующим образом:</p><br/>
<div class="spoiler"><b class="spoiler_title">src/components/IconButton.svelte</b><div class="spoiler_text"><pre><code class="html">&lt;script>
  export let start;
  export let release;
  export let active;
&lt;/script>

&lt;style>
  .iconButton {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 60px;
    height: 60px;
    border: 1px solid black;
    border-radius: 50px;
    outline: none;
    background: transparent;
  }
  .active {
    background-color: #bdbdbd;
  }
&lt;/style>

&lt;button
  on:mousedown={start}
  on:touchstart={start}
  on:mouseup={release}
  on:touchend={release}
  class={`iconButton ${active ? 'active' : ''}`}>
  &lt;slot />
&lt;/button></code></pre></div></div><br/>
<p>Теперь импортируем наши иконки и элемент кнопки в <strong>src/components/Controls.svelte</strong> и сверстаем расположение.</p><br/>
<div class="spoiler"><b class="spoiler_title">src/components/Controls.svelte</b><div class="spoiler_text"><pre><code class="html">&lt;script>
  // импортируем компонент кнопки и иконки
  import IconButton from "./IconButton.svelte";
  import LeftArrow from "../assets/LeftArrow.svelte";
  import RightArrow from "../assets/RightArrow.svelte";
  import Bullet from "../assets/Bullet.svelte";
&lt;/script>

&lt;style>
  /* положение элементов управления фиксированное, внизу экрана */
  .controls {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
  }
  /* контейнер кнопок будет разносить наши элементы по краям экрана */
  .container {
    display: flex;
    justify-content: space-between;
    margin: 1rem;
  }
  /* сделаем отступ между стрелок */
  .arrowGroup {
    display: flex;
    justify-content: space-between;
    width: 150px;
  }
&lt;/style>

&lt;div class="controls">
  &lt;div class="container">
    &lt;div class="arrowGroup">
      &lt;IconButton>
        &lt;LeftArrow />
      &lt;/IconButton>
      &lt;IconButton>
        &lt;RightArrow />
      &lt;/IconButton>
    &lt;/div>
    &lt;IconButton>
      &lt;Bullet />
    &lt;/IconButton>
  &lt;/div>
&lt;/div></code></pre></div></div><br/>
<p>Наше приложение должно выглядеть так:<br/>
<img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/webt/jp/uc/wt/jpucwtprafksew6yvz0b0_y68sw.png"/></p><br/>
<h2 id="4-igrovoe-pole">4. Игровое поле</h2><br/>
<p>Игровое поле представляет собой svg компонент, куда мы будем добавлять наши элементы игры (пушку, снаряды, противников).<br/>
Обновим код <strong>src/components/GameField.svelte</strong></p><br/>
<div class="spoiler"><b class="spoiler_title">src/components/GameField.svelte</b><div class="spoiler_text"><pre><code class="html">&lt;style>
  /* Сделаем так, чтобы наше игровое поле растягивалось на весь экран */
  .container {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    max-height: 100%;
  }
&lt;/style>

&lt;div class="container">
  &lt;!-- Благодаря указанию атрибута viewBox пропорции нашего
         игрового поля будут сохраняться при изменении размеров -->
  &lt;svg viewBox="0 0 480 800">
  &lt;/svg>
&lt;/div></code></pre></div></div><br/>
<p>Создадим пушку <strong>src/components/Cannon.svelte</strong>. Громко сказано для прямоугольника, но тем не менее.</p><br/>
<div class="spoiler"><b class="spoiler_title">src/components/Cannon.svelte</b><div class="spoiler_text"><pre><code class="html">&lt;style>
  /* Сместим центр трансформации, чтобы наша пушка вращалась вокруг нижней грани */
  .cannon {
    transform-origin: 4px 55px;
  }
&lt;/style>

&lt;!-- Наша пушка всего лишь прямоугольник svg элемента. 
      Обертка элементом &lt;g> нужна для корректной трансформации -->
&lt;g class="cannon" transform={`translate(236, 700)`}>
  &lt;rect width="8" height="60" fill="#212121" />
&lt;/g></code></pre></div></div><br/>
<p>Теперь импортируем нашу пушку на игровое поле.</p><br/>
<div class="spoiler"><b class="spoiler_title">src/GameField.svelte</b><div class="spoiler_text"><pre><code class="html">&lt;script>
  // Импортируем компонент пушки
  import Cannon from "./Cannon.svelte";
&lt;/script>

&lt;style>
  .container {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    max-height: 100%;
  }
&lt;/style>

&lt;div class="container">
  &lt;svg viewBox="0 0 480 800">
    &lt;!-- Отображаем компонент пушки -->
    &lt;Cannon />
  &lt;/svg>
&lt;/div>
</code></pre></div></div><br/>
<h2 id="5-igrovoy-cikl">5. Игровой цикл</h2><br/>
<p>У нас есть базовый каркас игры. Следующий шаг — создать игровой цикл, который будет обрабатывать нашу логику.<br/>
Создадим хранилища, где будут содержаться переменные для нашей логики. Нам понадобится компонент writable из модуля svelte/store. <a href="https://ru.svelte.dev/docs#svelte_store">Подробнее о store</a>.<br/>
Создание простого хранилища выглядит так:</p><br/>
<pre><code class="javascript">// импортируем модуль изменяемой переменной
import { writable } from "svelte/store";

// Объявляем переменную с начальным значением null
export const isPlaying = writable(null);</code></pre><br/>
<p>Создадим папку <strong>src/stores/</strong>, здесь будут храниться все изменяемые значения нашей игры.<br/>
Создадим файл <strong>src/stores/game.js</strong>, в котором будут храниться переменные, отвечающие за общее состояние игры.</p><br/>
<div class="spoiler"><b class="spoiler_title">src/stores/game.js</b><div class="spoiler_text"><pre><code class="javascript">// импортируем модуль изменяемой переменной
import { writable } from "svelte/store";

// Запущен в данный момент игровой цикл или нет, может принимать значения true/false
export const isPlaying = writable(false);</code></pre></div></div><br/>
<p>Создадим файл <strong>src/stores/cannon.js</strong>, в котором будут храниться переменные, отвечающие за состояние пушки</p><br/>
<div class="spoiler"><b class="spoiler_title">src/stores/cannon.js</b><div class="spoiler_text"><pre><code class="javascript">// импортируем модуль изменяемой переменной
import { writable } from "svelte/store";

// Отвечает за текущее направление, в котором нужно поворачивать пушку. 
// Будет принимать значения 'left', 'right', null, устанавливается нашими кнопками
export const direction = writable(null);

// Текущий угол поворота пушки
export const angle = writable(0);</code></pre></div></div><br/>
<p>Svelte позволяет создавать пользовательские хранилища, включающие логику работы. Подробнее об этом можно почитать <a href="https://ru.svelte.dev/tutorial/custom-stores">в учебнике</a>. У меня не получилось красиво вписать это в концепцию игрового цикла, поэтому в хранилище мы только объявляем переменные. Все манипуляции с ними мы будем производить в разделе <strong>src/gameLoop</strong>.</p><br/>
<p>Игровой цикл будет планироваться с помощью функции <a href="https://developer.mozilla.org/ru/docs/DOM/window.requestAnimationFrame">requestAnimationFrame</a>. На вход будет подаваться массив из функций, описывающий логику игры. По завершении игрового цикла, если игра еще не закончена, планируется следующая итерация. В игровом цикле мы будет обращаться к значению переменной <strong>isPlaying</strong>, чтобы проверить, не закончилась ли игра. </p><br/>
<p>Используя хранилище можно создавать подписку на значение. Этот функционал мы будем использовать в компонентах. Пока для чтения значения переменной будем использовать функцию <strong>get</strong>. Для установки значения будем использовать метод <strong>.set()</strong> переменной.<br/>
Обновить значение можно вызвав метод <strong>.update()</strong>, который на вход принимает функцию, в первый аргумент которого передается текущее значение. <a href="https://ru.svelte.dev/docs#writable">Подробнее в документации</a>. Все остальное — чистый JS.</p><br/>
<div class="spoiler"><b class="spoiler_title">src/gameLoop/gameLoop.js</b><div class="spoiler_text"><pre><code class="javascript">// Импортируем переменную из хранилища
import { isPlaying } from '../stores/game';
// с помощью функции get можно получить текущее значение стора, без подписки.
import { get } from 'svelte/store';

// Функция отвечает за игровой цикл
function startLoop(steps) {
  window.requestAnimationFrame(() => {
    // Проходим по массиву игровых шагов
    steps.forEach(step => {
      // Если шаг функция - запускаем
      if (typeof step === 'function') step();
    });
    // Если игра не остановилась, планируем следующий цикл
    if (get(isPlaying)) startLoop(steps);
  });
}

// Функция отвечает за запуск игрового цикла
export const startGame = () => {
  // Устанавливаем переменную, которая хранит состояние игры в true
  isPlaying.set(true);
  // запускаем игровой цикл. Пока массив шагов пустой
  startLoop([]);
};

// Функция отвечает за остановку игрового цикла
export function stopGame() {
  // Устанавливаем переменную, которая хранит состояние игры в false
  isPlaying.set(false);
}</code></pre></div></div><br/>
<p>Теперь опишем логику поведения нашей пушки. </p><br/>
<div class="spoiler"><b class="spoiler_title">src/gameLoop/cannon.js</b><div class="spoiler_text"><pre><code class="javascript">// с помощью функции get можно получить текущее значение стора, без подписки.
import { get } from 'svelte/store';

// Импорт всех переменных из хранилища cannon
import { angle, direction } from '../stores/cannon.js';

// Функция обновления угла поворота пушки
export function rotateCannon() {
  // Получаем текущий угол поворота
  const currentAngle = get(angle);
  // В зависимости от того, какая кнопка зажата, обновляем угол поворота
  switch (get(direction)) {
    // Если зажата кнопка "влево" и угол поворота меньше -45°, 
    // то уменьшаем угол поворота на 0.4
    case 'left':
      if (currentAngle > -45) angle.update(a => a - 0.4);
      break;
    // Если зажата кнопка "вправо" и угол поворота меньше 45°,
    // то увеличиваем угол поворота на 0.4
    case 'right':
      if (currentAngle &lt; 45) angle.update(a => a + 0.4);
      break;
    default:
      break;
  }
}</code></pre></div></div><br/>
<p>Теперь добавим наш обработчик поворота пушки в игровой цикл. </p><br/>
<pre><code class="javascript">import { rotateCannon } from "./cannon";
/* ... */
export const startGame = () => {
  isPlaying.set(true);
  startLoop([rotateCannon]);
};</code></pre><br/>
<p>Текущий код игрового цикла:</p><br/>
<div class="spoiler"><b class="spoiler_title">src/gameLoop/gameLoop.js</b><div class="spoiler_text"><pre><code class="javascript">import { isPlaying } from '../stores/game';
import { get } from 'svelte/store';

import { rotateCannon } from './cannon'; // импортируем обработчик поворота пушки

function startLoop(steps) {
  window.requestAnimationFrame(() => {
    steps.forEach(step => {
      if (typeof step === 'function') step();
    });
    if (get(isPlaying)) startLoop(steps);
  });
}

export const startGame = () => {
  isPlaying.set(true);
  startLoop([rotateCannon]); // Добавим обработчик в игровой цикл
};

export function stopGame() {
  isPlaying.set(false);
}</code></pre></div></div><br/>
<p>У нас есть логика, которая умеет поворачивать пушку. Но мы еще не связали ее с нажатием кнопок. Самое время сделать это. Обработчики событий нажатий будем добавлять в <strong>src/components/Controls.svelte</strong>.</p><br/>
<pre><code class="javascript">import { direction } from "../stores/cannon.js"; // импортируем переменную направления поворота из хранилища

// создаем обработчики событий 
const resetDirection = () => direction.set(null);
const setDirectionLeft = () => direction.set("left");
const setDirectionRight = () => direction.set("right");</code></pre><br/>
<p>Добавим наши обработчики и текущее состояние нажатия в элементы <strong>IconButton</strong>. Для этого просто передадим значения в ранее созданные атрибуты <strong>start</strong>, <strong>release</strong> и <strong>active</strong>, как описано в <a href="https://ru.svelte.dev/docs#Atributy">документации</a>. </p><br/>
<pre><code class="html">&lt;IconButton
  start={setDirectionLeft}
  release={resetDirection}
  active={$direction === 'left'}>
  &lt;LeftArrow />
&lt;/IconButton>
&lt;IconButton
  start={setDirectionRight}
  release={resetDirection}
  active={$direction === 'right'}>
  &lt;RightArrow />
&lt;/IconButton></code></pre><br/>
<p>Мы использовали выражение <strong>$</strong> для переменной <strong>$direction</strong>. Этот синтаксис делает значение реактивным, автоматически создавая подписку на изменения. <a href="https://ru.svelte.dev/docs#4_Dobavte_prefiks_%24_k_hranilishhu_dlya_polucheniya_ego_znacheniya">Подробнее в документации</a>.</p><br/>
<div class="spoiler"><b class="spoiler_title">src/components/Controls.svelte</b><div class="spoiler_text"><pre><code class="html">&lt;script>
  import IconButton from "./IconButton.svelte";
  import LeftArrow from "../assets/LeftArrow.svelte";
  import RightArrow from "../assets/RightArrow.svelte";
  import Bullet from "../assets/Bullet.svelte";
  // импортируем переменную направления поворота
  import { direction } from "../stores/cannon.js"; 

  // создаем обработчики событий 
  const resetDirection = () => direction.set(null);
  const setDirectionLeft = () => direction.set("left");
  const setDirectionRight = () => direction.set("right");
&lt;/script>

&lt;style>
  .controls {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
  }
  .container {
    display: flex;
    justify-content: space-between;
    margin: 1rem;
  }
  .arrowGroup {
    display: flex;
    justify-content: space-between;
    width: 150px;
  }
&lt;/style>

&lt;div class="controls">
  &lt;div class="container">
    &lt;div class="arrowGroup">
      &lt;!-- Передаем наши обработчики и направление в атрибуты -->
      &lt;IconButton
        start={setDirectionLeft}
        release={resetDirection}
        active={$direction === 'left'}>
        &lt;LeftArrow />
      &lt;/IconButton>
      &lt;IconButton
        start={setDirectionRight}
        release={resetDirection}
        active={$direction === 'right'}>
        &lt;RightArrow />
      &lt;/IconButton>
    &lt;/div>
    &lt;IconButton>
      &lt;Bullet />
    &lt;/IconButton>
  &lt;/div>
&lt;/div></code></pre></div></div><br/>
<p>На данный момент при нажатии у нашей кнопки происходит выделение, но пушка еще не поворачивается. Нам необходимо импортировать значение <strong>angle</strong> в компонент <strong>Cannon.svelte</strong> и обновить правила трансформации <strong>transform</strong></p><br/>
<div class="spoiler"><b class="spoiler_title">src/components/Cannon.svelte</b><div class="spoiler_text"><pre><code class="html">&lt;script>
  // Импортируем угол поворота из хранилища
  import { angle } from "../stores/cannon.js";
&lt;/script>

&lt;style>
  .cannon {
    transform-origin: 4px 55px;
  }
&lt;/style>

&lt;!-- Поворачиваем пушку директивой rotate(${$angle})-->
&lt;g class="cannon" transform={`translate(236, 700) rotate(${$angle})`}>
  &lt;rect width="8" height="60" fill="#212121" />
&lt;/g></code></pre></div></div><br/>
<p>Осталось запустить наш игровой цикл в компоненте <strong>App.svelte</strong>.</p><br/>
<pre><code class="javascript">import { startGame } from "./gameLoop/gameLoop";
startGame();</code></pre><br/>
<div class="spoiler"><b class="spoiler_title">App.svelte</b><div class="spoiler_text"><pre><code class="html">&lt;script>
  import Controls from "./components/Controls.svelte";
  import GameField from "./components/GameField.svelte";
  // импортируем функцию страта игры
  import { startGame } from "./gameLoop/gameLoop";
  // Запускаем
  startGame();
&lt;/script>

&lt;style>
  :global(html) {
    height: 100%;
  }
  :global(body) {
    height: 100%;
    overscroll-behavior: none;
    user-select: none;
    margin: 0;
    background-color: #efefef;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
      Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
  }
&lt;/style>

&lt;Controls />
&lt;GameField /></code></pre></div></div><br/>
<p>Ура! Наша пушка начала двигаться.<br/>
<img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/webt/cx/x0/e5/cxx0e5ubvazwuwtzaofnp5y4tqq.gif"/></p><br/>
<h2 id="6-vystrely">6. Выстрелы</h2><br/>
<p>Теперь научим нашу пушку стрелять. Нам нужно хранить значения:</p><br/>
<ul>
<li>Стреляет ли сейчас пушка (зажата кнопка огонь);</li>
<li>Временную метку последнего выстрела, нужно для расчета скорострельности;</li>
<li>Массив снарядов.</li>
</ul><br/>
<p>Добавим эти переменные в наше хранилище <strong>src/stores/cannon.js</strong>.</p><br/>
<div class="spoiler"><b class="spoiler_title">src/stores/cannon.js</b><div class="spoiler_text"><pre><code class="javascript">import { writable } from 'svelte/store';

export const direction = writable(null);
export const angle = writable(0);
// Добавляем переменные
export const isFiring = writable(false);
export const lastFireAt = writable(0);
export const bulletList = writable([]);
</code></pre></div></div><br/>
<p>Обновим импорты и игровую логику в <strong>src/gameLoop/cannon.js</strong>. </p><br/>
<div class="spoiler"><b class="spoiler_title">src/gameLoop/cannon.js</b><div class="spoiler_text"><pre><code class="javascript">import { get } from 'svelte/store';
// Обновим импорты
import { angle, direction, isFiring, lastFireAt, bulletList } from '../stores/cannon.js';

export function rotateCannon() {
  const currentAngle = get(angle);
  switch (get(direction)) {
    case 'left':
      if (currentAngle > -45) angle.update(a => a - 0.4);
      break;
    case 'right':
      if (currentAngle &lt; 45) angle.update(a => a + 0.4);
      break;
    default:
      break;
  }
}

// Функция выстрела
export function shoot() {
  // Если зажата кнопка огня и последний выстрел произошел более чем 800мс назад, 
  // то добавляем снаряд в массив и обновляем временную метку
  if (get(isFiring) &amp;&amp; Date.now() - get(lastFireAt) > 800) {
    lastFireAt.set(Date.now());
    // Позиция и угол поворота снаряда совпадают с положением пушки. 
    // Для id используем функцию Math.random и временную метку
    bulletList.update(bullets => [...bullets, { x: 238, y: 760, angle: get(angle), id: () => Math.random() + Date.now() }]);
  }
}

// Функция перемещения снарядов
export function moveBullet() {
  // Возвращаем новый массив снарядов, в котором сдвигаем положение оси y на -20, 
  // а положение по оси х рассчитываем по формуле прямоугольного треугольника. 
  // Для знатоков геометрии отвечу, да, по диагонали снаряд летит быстрее. 
  // Но визуально вы этого не заметили, верно?
  bulletList.update(bullets =>
    bullets.map(bullet => ({
      ...bullet,
      y: bullet.y - 20,
      x: (780 - bullet.y) * Math.tan((bullet.angle * Math.PI) / 180) + 238,
    })),
  );
}

// Удаляем снаряд из массива, если он вылетел за экран.
export function clearBullets() {
  bulletList.update(bullets => bullets.filter(bullet => bullet.y > 0));
}

// Функция удаления снаряда по Id. Пригодится, когда мы добавим противников и обработку столкновений
export function removeBullet(id) {
  bulletList.update(bullets => bullets.filter(bullet => bullet.id !== id));
}</code></pre></div></div><br/>
<p>Теперь импортируем наши обработчики в <strong>gameLoop.js</strong> и добавим их в игровой цикл.</p><br/>
<pre><code class="javascript">import { rotateCannon, shoot, moveBullet, clearBullets } from "./cannon";
/* ... */
export const startGame = () => {
  isPlaying.set(true);
  startLoop([rotateCannon, shoot, moveBullet, clearBullets ]); 
};</code></pre><br/>
<div class="spoiler"><b class="spoiler_title">src/gameLoop/gameLoop.js</b><div class="spoiler_text"><pre><code class="javascript">import { isPlaying } from '../stores/game';
import { get } from 'svelte/store';
// Импортируем все обработчики событий пушки и снарядов
import { rotateCannon, shoot, moveBullet, clearBullets } from "./cannon";

function startLoop(steps) {
  window.requestAnimationFrame(() => {
    steps.forEach(step => {
      if (typeof step === 'function') step();
    });
    if (get(isPlaying)) startLoop(steps);
  });
}

export const startGame = () => {
  isPlaying.set(true);
  // добавим обработчики в игровой цикл
  startLoop([rotateCannon, shoot, moveBullet, clearBullets ]); 
};

export function stopGame() {
  isPlaying.set(false);
}</code></pre></div></div><br/>
<p>Теперь нам осталось создать обработку нажатия кнопки огонь и добавить отображение снарядов на игровом поле.<br/>
Отредактируем <strong>src/components/Controls.svelte</strong>.</p><br/>
<pre><code class="javascript">// Импортируем переменную, которая отвечает за нажатие кнопки огонь
import { direction, isFiring } from "../stores/cannon.js";
// Добавим обработчики нажатия кнопки огонь
const startFire = () => isFiring.set(true);
const stopFire = () => isFiring.set(false);</code></pre><br/>
<p>Теперь добавим наши обработчики к кнопке, управляющей огнем, как мы делали это с кнопками поворота</p><br/>
<pre><code class="html">&lt;IconButton start={startFire} release={stopFire} active={$isFiring}>
  &lt;Bullet />
&lt;/IconButton></code></pre><br/>
<div class="spoiler"><b class="spoiler_title">src/components/Controls.svelte</b><div class="spoiler_text"><pre><code class="html">&lt;script>
  import IconButton from "./IconButton.svelte";
  import LeftArrow from "../assets/LeftArrow.svelte";
  import RightArrow from "../assets/RightArrow.svelte";
  import Bullet from "../assets/Bullet.svelte";
  // Импортируем переменную, которая отвечает за нажатие кнопки огонь
  import { direction, isFiring } from "../stores/cannon.js";

  const resetDirection = () => direction.set(null);
  const setDirectionLeft = () => direction.set("left");
  const setDirectionRight = () => direction.set("right");
  // Добавим обработчики нажатия кнопки огонь
  const startFire = () => isFiring.set(true);
  const stopFire = () => isFiring.set(false);
&lt;/script>

&lt;style>
  .controls {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
  }
  .container {
    display: flex;
    justify-content: space-between;
    margin: 1rem;
  }
  .arrowGroup {
    display: flex;
    justify-content: space-between;
    width: 150px;
  }
&lt;/style>

&lt;div class="controls">
  &lt;div class="container">
    &lt;div class="arrowGroup">
      &lt;IconButton
        start={setDirectionLeft}
        release={resetDirection}
        active={$direction === 'left'}>
        &lt;LeftArrow />
      &lt;/IconButton>
      &lt;IconButton
        start={setDirectionRight}
        release={resetDirection}
        active={$direction === 'right'}>
        &lt;RightArrow />
      &lt;/IconButton>
    &lt;/div>
    &lt;!-- Добавим обработчики для кнопки -->
    &lt;IconButton start={startFire} release={stopFire} active={$isFiring}>
      &lt;Bullet />
    &lt;/IconButton>
  &lt;/div>
&lt;/div></code></pre></div></div><br/>
<p>Осталось отобразить снаряды на игровом поле. Сначала создадим компонент снаряда</p><br/>
<div class="spoiler"><b class="spoiler_title">src/components/Bullet.svelte</b><div class="spoiler_text"><pre><code class="html">&lt;script>
 // В переменную bullet принимаем объект, описывающий положение снаряда
  export let bullet;
&lt;/script>
&lt;!-- Снаряд - это svg прямоугольник -->
&lt;g
  transform={`translate(${bullet.x}, ${bullet.y}) rotate(${bullet.angle})`}>
  &lt;rect width="3" height="5" fill="#212121" />
&lt;/g></code></pre></div></div><br/>
<p>Поскольку снаряды у нас хранятся в массиве, нам понадобится итератор для их отображения. В svelte для таких случаев есть директива <strong>Each</strong>. <a href="https://ru.svelte.dev/docs#Bloki_Each">Подробнее в документации</a>. </p><br/>
<pre><code class="html">// Проходим по массиву bulletList, записывая каждый объект в переменную bullet.
// Выражение в скобках указывает на id каждого объекта, так svelte может оптимизировать вычисления и обновлять только то, что действительно обновилось. 
// Аналог key из мира React
{#each $bulletList as bullet (bullet.id)}
  &lt;Bullet {bullet}/>
{/each}</code></pre><br/>
<div class="spoiler"><b class="spoiler_title">src/components/GameField.svelte</b><div class="spoiler_text"><pre><code class="html">&lt;script>
  import Cannon from "./Cannon.svelte";
  // Импортируем компонент снаряда
  import Bullet from "./Bullet.svelte";
  // импортируем список снарядов из хранилища
  import { bulletList } from "../stores/cannon";
&lt;/script>

&lt;style>
  .container {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    max-height: 100%;
  }
&lt;/style>

&lt;div class="container">
  &lt;svg viewBox="0 0 480 800">
  &lt;!-- Добавим итерацию по нашему массиву снарядов -->
    {#each $bulletList as bullet (bullet.id)}
      &lt;Bullet {bullet} />
    {/each}
    &lt;Cannon />
  &lt;/svg>
&lt;/div></code></pre></div></div><br/>
<p>Теперь наша пушка умеет стрелять.<br/>
<img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/webt/ig/vl/wc/igvlwcgdchgztehn0t4kofofddk.gif"/></p><br/>
<h2 id="7-vragi">7. Враги</h2><br/>
<p>Отлично. Для минимального геймплея нам осталось добавить врагов. Давайте создадим хранилище <strong>src/stores/enemy.js</strong>.</p><br/>
<div class="spoiler"><b class="spoiler_title">src/stores/enemy.js</b><div class="spoiler_text"><pre><code class="javascript">import { writable } from "svelte/store";

// Массив врагов
export const enemyList = writable([]);
// Временная метка добавления последнего врага
export const lastEnemyAddedAt = writable(0);</code></pre></div></div><br/>
<p>Создадим обработчики игрового цикла для врагов в <strong>src/gameLoop/enemy.js</strong></p><br/>
<div class="spoiler"><b class="spoiler_title">src/gameLoop/enemy.js</b><div class="spoiler_text"><pre><code class="javascript">import { get } from 'svelte/store';
// Импортируем переменные врагов из хранилища
import { enemyList, lastEnemyAddedAt } from '../stores/enemy.js';

// Функция добавления врага
export function addEnemy() {
  // Если с момента добавления последнего врага прошло больше 2500 мс, 
  // то добавить нового врага
  if (Date.now() - get(lastEnemyAddedAt) > 2500) {
    // Обновим временную метку последнего добавления
    lastEnemyAddedAt.set(Date.now());
    // Добавим врага со случайной координатой х от 1 до 499 
    // (размер нашего игрового поля)
    enemyList.update(enemies => [
      ...enemies,
      {
        x: Math.floor(Math.random() * 449) + 1,
        y: 0,
        id: () => Math.random() + Date.now(),
      },
    ]);
  }
}

// Функция перемещения врага. Каждый игровой цикл перемещаем врага на 0.5
export function moveEnemy() {
  enemyList.update(enemyList =>
    enemyList.map(enemy => ({
      ...enemy,
      y: enemy.y + 0.5,
    })),
  );
}

// Удалить врага из массива по id, пригодится для обработки попаданий
export function removeEnemy(id) {
  enemyList.update(enemies => enemies.filter(enemy => enemy.id !== id));
}</code></pre></div></div><br/>
<p>Добавим обработчики врагов в наш игровой цикл.</p><br/>
<div class="spoiler"><b class="spoiler_title">src/gameLoop/gameLoop.js</b><div class="spoiler_text"><pre><code class="javascript">import { isPlaying } from '../stores/game';
import { get } from 'svelte/store';
import { rotateCannon, shoot, moveBullet, clearBullets } from './cannon';
// Импортируем все обработчики событий врагов
import { addEnemy, moveEnemy } from './enemy';

function startLoop(steps) {
  window.requestAnimationFrame(() => {
    steps.forEach(step => {
      if (typeof step === 'function') step();
    });
    if (get(isPlaying)) startLoop(steps);
  });
}

export const startGame = () => {
  isPlaying.set(true);
  // добавим обработчики в игровой цикл
  startLoop([rotateCannon, shoot, moveBullet, clearBullets, addEnemy, moveEnemy]);
};

export function stopGame() {
  isPlaying.set(false);
}</code></pre></div></div><br/>
<p>Создадим компонент <strong>src/components/Enemy.js</strong> по аналогии со снарядом.</p><br/>
<div class="spoiler"><b class="spoiler_title">src/components/Enemy.js</b><div class="spoiler_text"><pre><code class="html">&lt;script>
 // В переменную enemy будем принимать объект, описывающий врага
 export let enemy;
&lt;/script>

// Отобразим прямоугольник с врагом, выполнив трансформацию по текущим координатам.
&lt;g transform={`translate(${enemy.x}, ${enemy.y})`} >
    &lt;rect width="30" height="30" fill="#212121" />
&lt;/g></code></pre></div></div><br/>
<p>Осталось импортировать компонент врага, массив с объектами врагов в наше игровое поле и отобразить их в цикле <strong>Each</strong></p><br/>
<div class="spoiler"><b class="spoiler_title">src/components/GameField.svelte</b><div class="spoiler_text"><pre><code class="html">&lt;script>
  import Cannon from "./Cannon.svelte";
  import Bullet from "./Bullet.svelte";
  // импортируем компонент врагов
  import Enemy from "./Enemy.svelte";

  import { bulletList } from "../stores/cannon";
  // импортируем список врагов из хранилища
  import { enemyList } from "../stores/enemy";
&lt;/script>

&lt;style>
  .container {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    max-height: 100%;
  }
&lt;/style>

&lt;div class="container">
  &lt;svg viewBox="0 0 480 800">
    &lt;!-- Добавим итерацию по нашему массиву врагов -->
    {#each $enemyList as enemy (enemy.id)}
      &lt;Enemy {enemy} />
    {/each}
    {#each $bulletList as bullet (bullet.id)}
      &lt;Bullet {bullet} />
    {/each}
    &lt;Cannon />
  &lt;/svg>
&lt;/div></code></pre></div></div><br/>
<p>Враг наступает!<br/>
<img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/webt/gf/be/_a/gfbe_a4u6bin74_wg4xdpgcolme.gif"/></p><br/>
<h2 id="8-stolknoveniya">8. Столкновения</h2><br/>
<p>Пока наши снаряды пролетают мимо, не причинив никакого вреда врагам.<br/>
Самое время добавить обработку столкновений. Общая игровая логика будет жить в файле <strong>src/gameLoop/game.js</strong>. Описание методики расчета столкновений можно прочитать на <a href="https://developer.mozilla.org/en-US/docs/Games/Techniques/2D_collision_detection">MDN</a></p><br/>
<div class="spoiler"><b class="spoiler_title">src/gameLoop/game.js</b><div class="spoiler_text"><pre><code class="javascript">import { get } from 'svelte/store';
// Импортируем массив снарядов
import { bulletList } from '../stores/cannon';
// Импортируем массив врагов
import { enemyList } from '../stores/enemy';
// Импортируем обработчик удаления снарядов
import { removeBullet } from './cannon';
// Импортируем обработчик удаления врагов
import { removeEnemy } from './enemy';

// Запишем в константы размеры врагов и снарядов. 
// Размер снаряда сделан чуть больше, чем наш svg, чтобы компенсировать расстояние, 
// которое пройдет снаряд и враг за игровой цикл. 
const enemyWidth = 30;
const bulletWidth = 5;
const enemyHeight = 30;
const bulletHeight = 8;

// Функция обработки столкновений
export function checkCollision() {
  get(bulletList).forEach(bullet => {
    get(enemyList).forEach(enemy => {
      if (
        bullet.x &lt; enemy.x + enemyWidth &amp;&amp;
        bullet.x + bulletWidth > enemy.x &amp;&amp;
        bullet.y &lt; enemy.y + enemyHeight &amp;&amp;
        bullet.y + bulletHeight > enemy.y
      ) {
          // Если произошло столкновение, то удаляем снаряд и врага с игрового поля
        removeBullet(bullet.id);
        removeEnemy(enemy.id);
      }
    });
  });
}</code></pre></div></div><br/>
<p>Осталось добавить обработчик столкновений в игровой цикл.</p><br/>
<div class="spoiler"><b class="spoiler_title">src/gameLoop/gameLoop.js</b><div class="spoiler_text"><pre><code class="javascript">import { isPlaying } from '../stores/game';
import { get } from 'svelte/store';
import { rotateCannon, shoot, moveBullet, clearBullets } from './cannon';
// импортируем обработчик столкновений
import { checkCollision } from './game';
import { addEnemy, moveEnemy } from './enemy';

function startLoop(steps) {
  window.requestAnimationFrame(() => {
    steps.forEach(step => {
      if (typeof step === 'function') step();
    });
    if (get(isPlaying)) startLoop(steps);
  });
}

export const startGame = () => {
  isPlaying.set(true);
  // добавим обработчик в игровой цикл
  startLoop([rotateCannon, shoot, moveBullet, clearBullets, addEnemy, moveEnemy, checkCollision]);
};

export function stopGame() {
  isPlaying.set(false);
}</code></pre></div></div><br/>
<p>Отлично, наши снаряды научились поражать цель.<br/>
<img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/webt/ko/8k/96/ko8k96c-ffehw1nm81cpptkhiga.gif"/></p><br/>
<h2 id="9-chto-dalshe">9. Что дальше</h2><br/>
<p>Если вы дожили до этого момента и не потеряли интерес к нашим квадратным войнам, то у меня есть список ToDo на самостоятельное изучение:</p><br/>
<ul>
<li>Добавить обработку проигрыша, когда один из врагов добрался до нижней границы экрана;</li>
<li>Добавить подсчет очков;</li>
<li>Добавить экран старта и окончания игры с выводом текущих и максимально набранных очков;</li>
<li>Добавить анимацию убийства врага. В svelte есть <a href="https://ru.svelte.dev/tutorial/transition">крутые штуки</a> для этого;</li>
<li>Добавить управление с клавиатуры;</li>
<li>Добавить логику увеличения интенсивности появления и скорости движения врагов с каждым убитым. Постепенное увеличение сложности добавит реиграбельности.</li>
</ul><br/>
<p>Мою реализацию этого списка вы можете посмотреть на <a href="https://github.com/az67128/svelte-war">github</a> и в <a href="https://az67128.github.io/svelte-war">демо</a>.</p><br/>
<h2 id="zaklyuchenie">Заключение</h2><br/>
<p>Эту игру, в качестве обучающего примера, я пытался сделать на React. Из коробки мне не удалось завести игру в 60 FPS, а вот со Svelte получилось с первой попытки.<br/>
Попробуйте Svelte прямо сейчас, вам понравится.</p></div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bjavascript%5D" class="tm-tags-list__link">javascript</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bsvelte%5D" class="tm-tags-list__link">svelte</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bgame%20development%5D" class="tm-tags-list__link">game development</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Breactive%20programming%5D" class="tm-tags-list__link">reactive programming</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hub/webdev/" class="tm-hubs-list__link">
    Разработка веб-сайтов
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/javascript/" class="tm-hubs-list__link">
    JavaScript
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/gamedev/" class="tm-hubs-list__link">
    Разработка игр
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/sveltejs/" class="tm-hubs-list__link">
    SvelteJS
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 27: ↑26 и ↓1</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 27: ↑26 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+25</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">11K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    80
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/sanReal/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/2c7/d5b/f88/2c7d5bf88d612d72f76a9b837c7d41c8.jpg" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 29 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    29
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><span class="tm-user-card__name tm-user-card__name_variant-article">Alexander Zinchenko</span> <a href="/ru/users/sanReal/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @sanReal
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">JS dev</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <button type="submit" class="tm-user-card__button btn btn_transparent btn_small">
      Задонатить
    </button> <!----> <!----></div></div> <div class="tm-article-author__user-contacts"><a href="https://github.com/az67128/" rel="noopener" target="_blank" class="tm-article-author__contact">
      Github
    </a></div></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/452684/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 32 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <!----> <!----> <!----> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/452684/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/452684/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"452684":{"id":"452684","timePublished":"2019-05-29T05:55:44+00:00","isCorporative":false,"lang":"ru","titleHtml":"Разрабатываем игру на Svelte 3","leadData":{"textHtml":"\u003Cp\u003EЧуть больше месяца назад вышел релиз \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F449450\u002F\"\u003ESvelte 3\u003C\u002Fa\u003E. Хороший момент для знакомства, — подумал я и пробежался по \u003Ca href=\"https:\u002F\u002Fru.svelte.dev\u002Ftutorial\u002Fbasics\"\u003Eотличному туториалу\u003C\u002Fa\u003E, который еще и переведен на русский.\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003EДля закрепления пройденного я сделал небольшой проект и делюсь результатами с вами. Это не one-more-todo-list, а игра, в которой нужно отстреливаться от черных квадратов. \u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fsv\u002Fqn\u002Fgn\u002Fsvqngnpfga7_0i44wvfi_blliz4.gif\" alt=\"image\"\u003E\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше →","image":null},"editorVersion":"1.0","postType":"article","postLabels":[{"type":"tutorial","data":null}],"author":{"scoreStats":{"score":29,"votesCount":29},"rating":0,"relatedData":null,"contacts":[{"title":"Github","url":"https:\u002F\u002Fgithub.com\u002Faz67128\u002F","value":"az67128"}],"authorContacts":[{"title":"Github","url":"https:\u002F\u002Fgithub.com\u002Faz67128\u002F","value":"az67128"}],"paymentDetails":{"paymentYandexMoney":"41001460525876","paymentPayPalMe":null,"paymentWebmoney":null},"id":"1005344","alias":"sanReal","fullname":"Alexander Zinchenko","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F2c7\u002Fd5b\u002Ff88\u002F2c7d5bf88d612d72f76a9b837c7d41c8.jpg","speciality":"JS dev"},"statistics":{"commentsCount":32,"favoritesCount":80,"readingCount":11119,"score":25,"votesCount":27},"hubs":[{"relatedData":null,"id":"91","alias":"webdev","type":"collective","title":"Разработка веб-сайтов","titleHtml":"Разработка веб-сайтов","isProfiled":true},{"relatedData":null,"id":"357","alias":"javascript","type":"collective","title":"JavaScript","titleHtml":"JavaScript","isProfiled":true},{"relatedData":null,"id":"7773","alias":"gamedev","type":"collective","title":"Разработка игр","titleHtml":"Разработка игр","isProfiled":true},{"relatedData":null,"id":"22278","alias":"sveltejs","type":"collective","title":"SvelteJS","titleHtml":"SvelteJS","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cp\u003EЧуть больше месяца назад вышел релиз \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F449450\u002F\"\u003ESvelte 3\u003C\u002Fa\u003E. Хороший момент для знакомства, — подумал я и пробежался по \u003Ca href=\"https:\u002F\u002Fru.svelte.dev\u002Ftutorial\u002Fbasics\"\u003Eотличному туториалу\u003C\u002Fa\u003E, который еще и переведен на русский.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EДля закрепления пройденного я сделал небольшой проект и делюсь результатами с вами. Это не one-more-todo-list, а игра, в которой нужно отстреливаться от черных квадратов. \u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fsv\u002Fqn\u002Fgn\u002Fsvqngnpfga7_0i44wvfi_blliz4.gif\"\u002F\u003E\u003C\u002Fp\u003E\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2 id=\"0-dlya-neterpelivyh\"\u003E0. Для нетерпеливых\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Faz67128\u002Fsvelte-war\u002Ftree\u002FMVP\"\u003EРепозиторий туториала\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Faz67128\u002Fsvelte-war\u002Ftree\u002Fmaster\"\u003EРепозиторий с дополнениями\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ca href=\"https:\u002F\u002Faz67128.github.io\u002Fsvelte-war\"\u003EДемо\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2 id=\"1-podgotovka\"\u003E1. Подготовка\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EКлонируем \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fsveltejs\u002Ftemplate\"\u003Eшаблон\u003C\u002Fa\u003E для разработки \u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"bash\"\u003Egit clone https:\u002F\u002Fgithub.com\u002Fsveltejs\u002Ftemplate.git\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EУстанавливаем зависимости.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"bash\"\u003Ecd template\u002F\nnpm i\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЗапускаем dev сервер.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"bash\"\u003Enpm run dev\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EНаш шаблон доступен по адресу\u003Cbr\u002F\u003E\r\n\u003Ca href=\"http:\u002F\u002Flocalhost:5000\"\u003Ehttp:\u002F\u002Flocalhost:5000\u003C\u002Fa\u003E. Сервер поддерживает hot reload, поэтому наши изменения будут видны в браузере по мере сохранения изменений.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЕсли вы не хотите разворачивать среду локально, то можете использовать онлайн песочницы \u003Ca href=\"https:\u002F\u002Fcodesandbox.io\u002Fs\u002Fsvelte\"\u003Ecodesandbox\u003C\u002Fa\u003E и \u003Ca href=\"https:\u002F\u002Fstackblitz.com\u002Ffork\u002Fsvelte\"\u003Estackblitz\u003C\u002Fa\u003E, которые поддерживают Svelte.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2 id=\"2-karkas-igry\"\u003E2. Каркас игры\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПапка src состоит из двух файлов \u003Cstrong\u003Emain.js\u003C\u002Fstrong\u003E и \u003Cstrong\u003EApp.svelte\u003C\u002Fstrong\u003E.\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003Emain.js\u003C\u002Fstrong\u003E — это точка входа в наше приложение. Во время разработки мы ее трогать не будем. Здесь компонент App.svelte монтируется в body документа.\u003Cbr\u002F\u003E\r\n\u003Cstrong\u003EApp.svelte\u003C\u002Fstrong\u003E — это компонент svelte. Шаблон компонента состоит из трех частей:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;script\u003E\n    \u002F\u002F JS код компонента\n    export let name;\n&lt;\u002Fscript\u003E\n\n&lt;style\u003E\n    \u002F* CSS стили компонента *\u002F\n    h1 {\n        color: purple;\n    }\n&lt;\u002Fstyle\u003E\n&lt;!-- разметка компонента --\u003E\n&lt;h1\u003EHello {name}!&lt;\u002Fh1\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EСтили компонента изолированы, но есть возможность назначить глобальные стили директивой :global(). \u003Ca href=\"https:\u002F\u002Fru.svelte.dev\u002Fdocs#style\"\u003EПодробнее о стилях\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\nДобавим общие стили для нашего компонента\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002FApp.svelte\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;script\u003E\n  export let name;\n&lt;\u002Fscript\u003E\n\n&lt;style\u003E\n  :global(html) {\n    height: 100%; \u002F* Наша игра будет занимать 100% высоты*\u002F\n  }\n  :global(body) {\n    height: 100%; \u002F* Наша игра будет занимать 100% высоты*\u002F\n    overscroll-behavior: none; \u002F* отключает pull to refresh*\u002F\n    user-select: none; \u002F* для тач интерфейсов отключает выделение при нажатии *\u002F\n    margin: 0; \u002F* убираем отступы*\u002F\n    background-color: #efefef; \u002F* устанавливаем цвет фона *\u002F\n    font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Oxygen,\n      Ubuntu, Cantarell, \"Open Sans\", \"Helvetica Neue\", sans-serif; \u002F* устанавливаем шрифты *\u002F\n  }\n&lt;\u002Fstyle\u003E\n\n&lt;h1\u003EHello {name}!&lt;\u002Fh1\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EДавайте создадим папку \u003Cstrong\u003Esrc\u002Fcomponents\u003C\u002Fstrong\u003E, в которой будут храниться наши компоненты\u003Cbr\u002F\u003E\r\nВ этой папке создадим два файла, которые будут содержать игровое поле и элементы управления.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002Fcomponents\u002FGameField.svelte\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;div\u003EGameField&lt;\u002Fdiv\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002Fcomponents\u002FControls.svelte\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;div\u003EControls&lt;\u002Fdiv\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EИмпорт компонента осуществляется директивой\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003Eimport Controls from \".\u002Fcomponents\u002FControls.svelte\";\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EДля отображения компонента достаточно вставить тег компонента в разметку. \u003Ca href=\"https:\u002F\u002Fru.svelte.dev\u002Fdocs#Tegi\"\u003EПодробнее о тегах\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003E&lt;Controls \u002F\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EТеперь импортируем и отобразим наши компоненты в App.svelte.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002FApp.svelte\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;script\u003E\n  \u002F\u002F импортируем компоненты\n  import Controls from \".\u002Fcomponents\u002FControls.svelte\";\n  import GameField from \".\u002Fcomponents\u002FGameField.svelte\";\n&lt;\u002Fscript\u003E\n\n&lt;style\u003E\n  :global(html) {\n    height: 100%; \n  }\n  :global(body) {\n    height: 100%; \n    overscroll-behavior: none; \n    user-select: none; \n    margin: 0; \n    background-color: #efefef; \n    font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Oxygen,\n      Ubuntu, Cantarell, \"Open Sans\", \"Helvetica Neue\", sans-serif; \n  }\n&lt;\u002Fstyle\u003E\n\n&lt;!-- Отображаем компоненты. Заметьте, нам не нужен рут компонент, как, например, в react --\u003E\n&lt;Controls \u002F\u003E\n&lt;GameField \u002F\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2 id=\"3-elementy-upravleniya\"\u003E3. Элементы управления\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EКомпонент Controls.svelte будет состоять из трех кнопок: движение влево, движение вправо, огонь. Иконки кнопок будут отображаться svg элементом.\u003Cbr\u002F\u003E\r\nСоздадим папку \u003Cstrong\u003Esrc\u002Fasssets\u003C\u002Fstrong\u003E, в которую добавим наши svg иконки.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002Fassets\u002FBullet.svelte\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;svg height=\"40px\" viewBox=\"0 0 427 427.08344\" width=\"40px\"\u003E\n  &lt;path\n    d=\"m341.652344 38.511719-37.839844 37.839843 46.960938 46.960938\n    37.839843-37.839844c8.503907-8.527344 15-18.839844\n    19.019531-30.191406l19.492188-55.28125-55.28125 19.492188c-11.351562\n    4.019531-21.664062 10.515624-30.191406 19.019531zm0 0\" \u002F\u003E\n  &lt;path\n    d=\"m258.65625 99.078125 69.390625 69.390625\n    14.425781-33.65625-50.160156-50.160156zm0 0\" \u002F\u003E\n  &lt;path\n    d=\"m.0429688 352.972656 28.2812502-28.285156 74.113281 74.113281-28.28125\n    28.28125zm0 0\" \u002F\u003E\n  &lt;path\n    d=\"m38.226562 314.789062 208.167969-208.171874 74.113281\n    74.113281-208.171874 208.171875zm0 0\" \u002F\u003E\n&lt;\u002Fsvg\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002Fassets\u002FLeftArrow.svelte\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;svg\n  width=\"40px\"\n  height=\"40px\"\n  viewBox=\"0 0 292.359 292.359\"\n  transform=\"translate(-5 0)\"\u003E\n  &lt;path\n    d=\"M222.979,5.424C219.364,1.807,215.08,0,210.132,0c-4.949,0-9.233,1.807-12.848,5.424L69.378,133.331\n    c-3.615,3.617-5.424,7.898-5.424,12.847c0,4.949,1.809,9.233,5.424,12.847l127.906,127.907c3.614,3.617,7.898,5.428,12.848,5.428\n    c4.948,0,9.232-1.811,12.847-5.428c3.617-3.614,5.427-7.898,5.427-12.847V18.271C228.405,13.322,226.596,9.042,222.979,5.424z\" \u002F\u003E\n&lt;\u002Fsvg\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002Fassets\u002FRightArrow.svelte\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;svg\n  width=\"40px\"\n  height=\"40px\"\n  viewBox=\"0 0 292.359 292.359\"\n  transform=\"translate(5 0) rotate(180)\"\u003E\n  &lt;path\n    d=\"M222.979,5.424C219.364,1.807,215.08,0,210.132,0c-4.949,0-9.233,1.807-12.848,5.424L69.378,133.331\n    c-3.615,3.617-5.424,7.898-5.424,12.847c0,4.949,1.809,9.233,5.424,12.847l127.906,127.907c3.614,3.617,7.898,5.428,12.848,5.428\n    c4.948,0,9.232-1.811,12.847-5.428c3.617-3.614,5.427-7.898,5.427-12.847V18.271C228.405,13.322,226.596,9.042,222.979,5.424z\" \u002F\u003E\n&lt;\u002Fsvg\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EДобавим компонент кнопки \u003Cstrong\u003Esrc\u002Fcomponents\u002FIconButton.svelte\u003C\u002Fstrong\u003E.\u003Cbr\u002F\u003E\r\nМы будем принимать обработчики событий из родительского компонента. Для того, чтобы можно было зажать кнопку, нам понадобятся два обработчика: начало нажатия и конец нажатия. Объявим переменные \u003Cstrong\u003Estart\u003C\u002Fstrong\u003E и \u003Cstrong\u003Erelease\u003C\u002Fstrong\u003E, куда будем принимать обработчики событий начала и окончания нажатия. Еще нам понадобится переменная \u003Cstrong\u003Eactive\u003C\u002Fstrong\u003E, которая будет отображать, нажата кнопка или нет.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;script\u003E\n  export let start;\n  export let release;\n  export let active;\n&lt;\u002Fscript\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EСтилизуем наш компонент\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;style\u003E\n  .iconButton {\n    \u002F* С помощью flex выравниваем содержимое по центру *\u002F\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    \u002F* Устанавливаем размер элемента 60px *\u002F\n    width: 60px;\n    height: 60px;\n    \u002F* Добавляем обводку *\u002F\n    border: 1px solid black;\n    \u002F* Делаем обводку круглой *\u002F\n    border-radius: 50px;\n   \u002F* Убираем лишние стили кнопки *\u002F\n    outline: none;\n    background: transparent;\n  }\n  .active {\n    \u002F* Устанавливаем фон для состояния, когда кнопка нажата *\u002F\n    background-color: #bdbdbd;\n  }\n&lt;\u002Fstyle\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EКнопка представляет собой button элемент, внутри которого отображается контент, переданный из родительского компонента. Место, где будут монтироваться переданный контент обозначается тегом &lt;slot\u002F\u003E. \u003Ca href=\"https:\u002F\u002Fru.svelte.dev\u002Fdocs#Sloty\"\u003EПодробнее об элементе &lt;slot\u002F\u003E\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;button\u003E\n  &lt;slot \u002F\u003E\n&lt;\u002Fbutton\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EОбработчики событий обозначаются через директиву \u003Cstrong\u003Eon:\u003C\u002Fstrong\u003E, например, \u003Cstrong\u003Eon:click\u003C\u002Fstrong\u003E.\u003Cbr\u002F\u003E\r\nМы будем обрабатывать события мыши и тач нажатия. \u003Ca href=\"https:\u002F\u002Fru.svelte.dev\u002Fdocs#Sobytiya_komponenta\"\u003EПодробнее о привязке событий\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\nК базовому классу компонента будет добавляться класс \u003Cstrong\u003Eactive\u003C\u002Fstrong\u003E, если кнопка нажата. Назначить класс можно свойством \u003Cstrong\u003Eclass\u003C\u002Fstrong\u003E. \u003Ca href=\"https:\u002F\u002Fru.svelte.dev\u002Fdocs#Klassy\"\u003EПодробнее о классах\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;button\n  on:mousedown={start}\n  on:touchstart={start}\n  on:mouseup={release}\n  on:touchend={release}\n  class={`iconButton ${active ? 'active' : ''}`}\u003E\n  &lt;slot \u002F\u003E\n&lt;\u002Fbutton\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EВ итоге наш компонент будет выглядеть следующим образом:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002Fcomponents\u002FIconButton.svelte\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;script\u003E\n  export let start;\n  export let release;\n  export let active;\n&lt;\u002Fscript\u003E\n\n&lt;style\u003E\n  .iconButton {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 60px;\n    height: 60px;\n    border: 1px solid black;\n    border-radius: 50px;\n    outline: none;\n    background: transparent;\n  }\n  .active {\n    background-color: #bdbdbd;\n  }\n&lt;\u002Fstyle\u003E\n\n&lt;button\n  on:mousedown={start}\n  on:touchstart={start}\n  on:mouseup={release}\n  on:touchend={release}\n  class={`iconButton ${active ? 'active' : ''}`}\u003E\n  &lt;slot \u002F\u003E\n&lt;\u002Fbutton\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EТеперь импортируем наши иконки и элемент кнопки в \u003Cstrong\u003Esrc\u002Fcomponents\u002FControls.svelte\u003C\u002Fstrong\u003E и сверстаем расположение.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002Fcomponents\u002FControls.svelte\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;script\u003E\n  \u002F\u002F импортируем компонент кнопки и иконки\n  import IconButton from \".\u002FIconButton.svelte\";\n  import LeftArrow from \"..\u002Fassets\u002FLeftArrow.svelte\";\n  import RightArrow from \"..\u002Fassets\u002FRightArrow.svelte\";\n  import Bullet from \"..\u002Fassets\u002FBullet.svelte\";\n&lt;\u002Fscript\u003E\n\n&lt;style\u003E\n  \u002F* положение элементов управления фиксированное, внизу экрана *\u002F\n  .controls {\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    width: 100%;\n  }\n  \u002F* контейнер кнопок будет разносить наши элементы по краям экрана *\u002F\n  .container {\n    display: flex;\n    justify-content: space-between;\n    margin: 1rem;\n  }\n  \u002F* сделаем отступ между стрелок *\u002F\n  .arrowGroup {\n    display: flex;\n    justify-content: space-between;\n    width: 150px;\n  }\n&lt;\u002Fstyle\u003E\n\n&lt;div class=\"controls\"\u003E\n  &lt;div class=\"container\"\u003E\n    &lt;div class=\"arrowGroup\"\u003E\n      &lt;IconButton\u003E\n        &lt;LeftArrow \u002F\u003E\n      &lt;\u002FIconButton\u003E\n      &lt;IconButton\u003E\n        &lt;RightArrow \u002F\u003E\n      &lt;\u002FIconButton\u003E\n    &lt;\u002Fdiv\u003E\n    &lt;IconButton\u003E\n      &lt;Bullet \u002F\u003E\n    &lt;\u002FIconButton\u003E\n  &lt;\u002Fdiv\u003E\n&lt;\u002Fdiv\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EНаше приложение должно выглядеть так:\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fjp\u002Fuc\u002Fwt\u002Fjpucwtprafksew6yvz0b0_y68sw.png\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2 id=\"4-igrovoe-pole\"\u003E4. Игровое поле\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EИгровое поле представляет собой svg компонент, куда мы будем добавлять наши элементы игры (пушку, снаряды, противников).\u003Cbr\u002F\u003E\r\nОбновим код \u003Cstrong\u003Esrc\u002Fcomponents\u002FGameField.svelte\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002Fcomponents\u002FGameField.svelte\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;style\u003E\n  \u002F* Сделаем так, чтобы наше игровое поле растягивалось на весь экран *\u002F\n  .container {\n    flex-grow: 1;\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    max-height: 100%;\n  }\n&lt;\u002Fstyle\u003E\n\n&lt;div class=\"container\"\u003E\n  &lt;!-- Благодаря указанию атрибута viewBox пропорции нашего\n         игрового поля будут сохраняться при изменении размеров --\u003E\n  &lt;svg viewBox=\"0 0 480 800\"\u003E\n  &lt;\u002Fsvg\u003E\n&lt;\u002Fdiv\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EСоздадим пушку \u003Cstrong\u003Esrc\u002Fcomponents\u002FCannon.svelte\u003C\u002Fstrong\u003E. Громко сказано для прямоугольника, но тем не менее.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002Fcomponents\u002FCannon.svelte\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;style\u003E\n  \u002F* Сместим центр трансформации, чтобы наша пушка вращалась вокруг нижней грани *\u002F\n  .cannon {\n    transform-origin: 4px 55px;\n  }\n&lt;\u002Fstyle\u003E\n\n&lt;!-- Наша пушка всего лишь прямоугольник svg элемента. \n      Обертка элементом &lt;g\u003E нужна для корректной трансформации --\u003E\n&lt;g class=\"cannon\" transform={`translate(236, 700)`}\u003E\n  &lt;rect width=\"8\" height=\"60\" fill=\"#212121\" \u002F\u003E\n&lt;\u002Fg\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EТеперь импортируем нашу пушку на игровое поле.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002FGameField.svelte\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;script\u003E\n  \u002F\u002F Импортируем компонент пушки\n  import Cannon from \".\u002FCannon.svelte\";\n&lt;\u002Fscript\u003E\n\n&lt;style\u003E\n  .container {\n    flex-grow: 1;\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    max-height: 100%;\n  }\n&lt;\u002Fstyle\u003E\n\n&lt;div class=\"container\"\u003E\n  &lt;svg viewBox=\"0 0 480 800\"\u003E\n    &lt;!-- Отображаем компонент пушки --\u003E\n    &lt;Cannon \u002F\u003E\n  &lt;\u002Fsvg\u003E\n&lt;\u002Fdiv\u003E\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2 id=\"5-igrovoy-cikl\"\u003E5. Игровой цикл\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EУ нас есть базовый каркас игры. Следующий шаг — создать игровой цикл, который будет обрабатывать нашу логику.\u003Cbr\u002F\u003E\r\nСоздадим хранилища, где будут содержаться переменные для нашей логики. Нам понадобится компонент writable из модуля svelte\u002Fstore. \u003Ca href=\"https:\u002F\u002Fru.svelte.dev\u002Fdocs#svelte_store\"\u003EПодробнее о store\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\nСоздание простого хранилища выглядит так:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003E\u002F\u002F импортируем модуль изменяемой переменной\nimport { writable } from \"svelte\u002Fstore\";\n\n\u002F\u002F Объявляем переменную с начальным значением null\nexport const isPlaying = writable(null);\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EСоздадим папку \u003Cstrong\u003Esrc\u002Fstores\u002F\u003C\u002Fstrong\u003E, здесь будут храниться все изменяемые значения нашей игры.\u003Cbr\u002F\u003E\r\nСоздадим файл \u003Cstrong\u003Esrc\u002Fstores\u002Fgame.js\u003C\u002Fstrong\u003E, в котором будут храниться переменные, отвечающие за общее состояние игры.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002Fstores\u002Fgame.js\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003E\u002F\u002F импортируем модуль изменяемой переменной\nimport { writable } from \"svelte\u002Fstore\";\n\n\u002F\u002F Запущен в данный момент игровой цикл или нет, может принимать значения true\u002Ffalse\nexport const isPlaying = writable(false);\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EСоздадим файл \u003Cstrong\u003Esrc\u002Fstores\u002Fcannon.js\u003C\u002Fstrong\u003E, в котором будут храниться переменные, отвечающие за состояние пушки\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002Fstores\u002Fcannon.js\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003E\u002F\u002F импортируем модуль изменяемой переменной\nimport { writable } from \"svelte\u002Fstore\";\n\n\u002F\u002F Отвечает за текущее направление, в котором нужно поворачивать пушку. \n\u002F\u002F Будет принимать значения 'left', 'right', null, устанавливается нашими кнопками\nexport const direction = writable(null);\n\n\u002F\u002F Текущий угол поворота пушки\nexport const angle = writable(0);\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003ESvelte позволяет создавать пользовательские хранилища, включающие логику работы. Подробнее об этом можно почитать \u003Ca href=\"https:\u002F\u002Fru.svelte.dev\u002Ftutorial\u002Fcustom-stores\"\u003Eв учебнике\u003C\u002Fa\u003E. У меня не получилось красиво вписать это в концепцию игрового цикла, поэтому в хранилище мы только объявляем переменные. Все манипуляции с ними мы будем производить в разделе \u003Cstrong\u003Esrc\u002FgameLoop\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EИгровой цикл будет планироваться с помощью функции \u003Ca href=\"https:\u002F\u002Fdeveloper.mozilla.org\u002Fru\u002Fdocs\u002FDOM\u002Fwindow.requestAnimationFrame\"\u003ErequestAnimationFrame\u003C\u002Fa\u003E. На вход будет подаваться массив из функций, описывающий логику игры. По завершении игрового цикла, если игра еще не закончена, планируется следующая итерация. В игровом цикле мы будет обращаться к значению переменной \u003Cstrong\u003EisPlaying\u003C\u002Fstrong\u003E, чтобы проверить, не закончилась ли игра. \u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EИспользуя хранилище можно создавать подписку на значение. Этот функционал мы будем использовать в компонентах. Пока для чтения значения переменной будем использовать функцию \u003Cstrong\u003Eget\u003C\u002Fstrong\u003E. Для установки значения будем использовать метод \u003Cstrong\u003E.set()\u003C\u002Fstrong\u003E переменной.\u003Cbr\u002F\u003E\r\nОбновить значение можно вызвав метод \u003Cstrong\u003E.update()\u003C\u002Fstrong\u003E, который на вход принимает функцию, в первый аргумент которого передается текущее значение. \u003Ca href=\"https:\u002F\u002Fru.svelte.dev\u002Fdocs#writable\"\u003EПодробнее в документации\u003C\u002Fa\u003E. Все остальное — чистый JS.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002FgameLoop\u002FgameLoop.js\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003E\u002F\u002F Импортируем переменную из хранилища\nimport { isPlaying } from '..\u002Fstores\u002Fgame';\n\u002F\u002F с помощью функции get можно получить текущее значение стора, без подписки.\nimport { get } from 'svelte\u002Fstore';\n\n\u002F\u002F Функция отвечает за игровой цикл\nfunction startLoop(steps) {\n  window.requestAnimationFrame(() =\u003E {\n    \u002F\u002F Проходим по массиву игровых шагов\n    steps.forEach(step =\u003E {\n      \u002F\u002F Если шаг функция - запускаем\n      if (typeof step === 'function') step();\n    });\n    \u002F\u002F Если игра не остановилась, планируем следующий цикл\n    if (get(isPlaying)) startLoop(steps);\n  });\n}\n\n\u002F\u002F Функция отвечает за запуск игрового цикла\nexport const startGame = () =\u003E {\n  \u002F\u002F Устанавливаем переменную, которая хранит состояние игры в true\n  isPlaying.set(true);\n  \u002F\u002F запускаем игровой цикл. Пока массив шагов пустой\n  startLoop([]);\n};\n\n\u002F\u002F Функция отвечает за остановку игрового цикла\nexport function stopGame() {\n  \u002F\u002F Устанавливаем переменную, которая хранит состояние игры в false\n  isPlaying.set(false);\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EТеперь опишем логику поведения нашей пушки. \u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002FgameLoop\u002Fcannon.js\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003E\u002F\u002F с помощью функции get можно получить текущее значение стора, без подписки.\nimport { get } from 'svelte\u002Fstore';\n\n\u002F\u002F Импорт всех переменных из хранилища cannon\nimport { angle, direction } from '..\u002Fstores\u002Fcannon.js';\n\n\u002F\u002F Функция обновления угла поворота пушки\nexport function rotateCannon() {\n  \u002F\u002F Получаем текущий угол поворота\n  const currentAngle = get(angle);\n  \u002F\u002F В зависимости от того, какая кнопка зажата, обновляем угол поворота\n  switch (get(direction)) {\n    \u002F\u002F Если зажата кнопка \"влево\" и угол поворота меньше -45°, \n    \u002F\u002F то уменьшаем угол поворота на 0.4\n    case 'left':\n      if (currentAngle \u003E -45) angle.update(a =\u003E a - 0.4);\n      break;\n    \u002F\u002F Если зажата кнопка \"вправо\" и угол поворота меньше 45°,\n    \u002F\u002F то увеличиваем угол поворота на 0.4\n    case 'right':\n      if (currentAngle &lt; 45) angle.update(a =\u003E a + 0.4);\n      break;\n    default:\n      break;\n  }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EТеперь добавим наш обработчик поворота пушки в игровой цикл. \u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003Eimport { rotateCannon } from \".\u002Fcannon\";\n\u002F* ... *\u002F\nexport const startGame = () =\u003E {\n  isPlaying.set(true);\n  startLoop([rotateCannon]);\n};\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EТекущий код игрового цикла:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002FgameLoop\u002FgameLoop.js\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003Eimport { isPlaying } from '..\u002Fstores\u002Fgame';\nimport { get } from 'svelte\u002Fstore';\n\nimport { rotateCannon } from '.\u002Fcannon'; \u002F\u002F импортируем обработчик поворота пушки\n\nfunction startLoop(steps) {\n  window.requestAnimationFrame(() =\u003E {\n    steps.forEach(step =\u003E {\n      if (typeof step === 'function') step();\n    });\n    if (get(isPlaying)) startLoop(steps);\n  });\n}\n\nexport const startGame = () =\u003E {\n  isPlaying.set(true);\n  startLoop([rotateCannon]); \u002F\u002F Добавим обработчик в игровой цикл\n};\n\nexport function stopGame() {\n  isPlaying.set(false);\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EУ нас есть логика, которая умеет поворачивать пушку. Но мы еще не связали ее с нажатием кнопок. Самое время сделать это. Обработчики событий нажатий будем добавлять в \u003Cstrong\u003Esrc\u002Fcomponents\u002FControls.svelte\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003Eimport { direction } from \"..\u002Fstores\u002Fcannon.js\"; \u002F\u002F импортируем переменную направления поворота из хранилища\n\n\u002F\u002F создаем обработчики событий \nconst resetDirection = () =\u003E direction.set(null);\nconst setDirectionLeft = () =\u003E direction.set(\"left\");\nconst setDirectionRight = () =\u003E direction.set(\"right\");\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EДобавим наши обработчики и текущее состояние нажатия в элементы \u003Cstrong\u003EIconButton\u003C\u002Fstrong\u003E. Для этого просто передадим значения в ранее созданные атрибуты \u003Cstrong\u003Estart\u003C\u002Fstrong\u003E, \u003Cstrong\u003Erelease\u003C\u002Fstrong\u003E и \u003Cstrong\u003Eactive\u003C\u002Fstrong\u003E, как описано в \u003Ca href=\"https:\u002F\u002Fru.svelte.dev\u002Fdocs#Atributy\"\u003Eдокументации\u003C\u002Fa\u003E. \u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;IconButton\n  start={setDirectionLeft}\n  release={resetDirection}\n  active={$direction === 'left'}\u003E\n  &lt;LeftArrow \u002F\u003E\n&lt;\u002FIconButton\u003E\n&lt;IconButton\n  start={setDirectionRight}\n  release={resetDirection}\n  active={$direction === 'right'}\u003E\n  &lt;RightArrow \u002F\u003E\n&lt;\u002FIconButton\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EМы использовали выражение \u003Cstrong\u003E$\u003C\u002Fstrong\u003E для переменной \u003Cstrong\u003E$direction\u003C\u002Fstrong\u003E. Этот синтаксис делает значение реактивным, автоматически создавая подписку на изменения. \u003Ca href=\"https:\u002F\u002Fru.svelte.dev\u002Fdocs#4_Dobavte_prefiks_%24_k_hranilishhu_dlya_polucheniya_ego_znacheniya\"\u003EПодробнее в документации\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002Fcomponents\u002FControls.svelte\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;script\u003E\n  import IconButton from \".\u002FIconButton.svelte\";\n  import LeftArrow from \"..\u002Fassets\u002FLeftArrow.svelte\";\n  import RightArrow from \"..\u002Fassets\u002FRightArrow.svelte\";\n  import Bullet from \"..\u002Fassets\u002FBullet.svelte\";\n  \u002F\u002F импортируем переменную направления поворота\n  import { direction } from \"..\u002Fstores\u002Fcannon.js\"; \n\n  \u002F\u002F создаем обработчики событий \n  const resetDirection = () =\u003E direction.set(null);\n  const setDirectionLeft = () =\u003E direction.set(\"left\");\n  const setDirectionRight = () =\u003E direction.set(\"right\");\n&lt;\u002Fscript\u003E\n\n&lt;style\u003E\n  .controls {\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    width: 100%;\n  }\n  .container {\n    display: flex;\n    justify-content: space-between;\n    margin: 1rem;\n  }\n  .arrowGroup {\n    display: flex;\n    justify-content: space-between;\n    width: 150px;\n  }\n&lt;\u002Fstyle\u003E\n\n&lt;div class=\"controls\"\u003E\n  &lt;div class=\"container\"\u003E\n    &lt;div class=\"arrowGroup\"\u003E\n      &lt;!-- Передаем наши обработчики и направление в атрибуты --\u003E\n      &lt;IconButton\n        start={setDirectionLeft}\n        release={resetDirection}\n        active={$direction === 'left'}\u003E\n        &lt;LeftArrow \u002F\u003E\n      &lt;\u002FIconButton\u003E\n      &lt;IconButton\n        start={setDirectionRight}\n        release={resetDirection}\n        active={$direction === 'right'}\u003E\n        &lt;RightArrow \u002F\u003E\n      &lt;\u002FIconButton\u003E\n    &lt;\u002Fdiv\u003E\n    &lt;IconButton\u003E\n      &lt;Bullet \u002F\u003E\n    &lt;\u002FIconButton\u003E\n  &lt;\u002Fdiv\u003E\n&lt;\u002Fdiv\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EНа данный момент при нажатии у нашей кнопки происходит выделение, но пушка еще не поворачивается. Нам необходимо импортировать значение \u003Cstrong\u003Eangle\u003C\u002Fstrong\u003E в компонент \u003Cstrong\u003ECannon.svelte\u003C\u002Fstrong\u003E и обновить правила трансформации \u003Cstrong\u003Etransform\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002Fcomponents\u002FCannon.svelte\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;script\u003E\n  \u002F\u002F Импортируем угол поворота из хранилища\n  import { angle } from \"..\u002Fstores\u002Fcannon.js\";\n&lt;\u002Fscript\u003E\n\n&lt;style\u003E\n  .cannon {\n    transform-origin: 4px 55px;\n  }\n&lt;\u002Fstyle\u003E\n\n&lt;!-- Поворачиваем пушку директивой rotate(${$angle})--\u003E\n&lt;g class=\"cannon\" transform={`translate(236, 700) rotate(${$angle})`}\u003E\n  &lt;rect width=\"8\" height=\"60\" fill=\"#212121\" \u002F\u003E\n&lt;\u002Fg\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EОсталось запустить наш игровой цикл в компоненте \u003Cstrong\u003EApp.svelte\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003Eimport { startGame } from \".\u002FgameLoop\u002FgameLoop\";\nstartGame();\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EApp.svelte\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;script\u003E\n  import Controls from \".\u002Fcomponents\u002FControls.svelte\";\n  import GameField from \".\u002Fcomponents\u002FGameField.svelte\";\n  \u002F\u002F импортируем функцию страта игры\n  import { startGame } from \".\u002FgameLoop\u002FgameLoop\";\n  \u002F\u002F Запускаем\n  startGame();\n&lt;\u002Fscript\u003E\n\n&lt;style\u003E\n  :global(html) {\n    height: 100%;\n  }\n  :global(body) {\n    height: 100%;\n    overscroll-behavior: none;\n    user-select: none;\n    margin: 0;\n    background-color: #efefef;\n    font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Oxygen,\n      Ubuntu, Cantarell, \"Open Sans\", \"Helvetica Neue\", sans-serif;\n  }\n&lt;\u002Fstyle\u003E\n\n&lt;Controls \u002F\u003E\n&lt;GameField \u002F\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EУра! Наша пушка начала двигаться.\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fcx\u002Fx0\u002Fe5\u002Fcxx0e5ubvazwuwtzaofnp5y4tqq.gif\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2 id=\"6-vystrely\"\u003E6. Выстрелы\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EТеперь научим нашу пушку стрелять. Нам нужно хранить значения:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003EСтреляет ли сейчас пушка (зажата кнопка огонь);\u003C\u002Fli\u003E\r\n\u003Cli\u003EВременную метку последнего выстрела, нужно для расчета скорострельности;\u003C\u002Fli\u003E\r\n\u003Cli\u003EМассив снарядов.\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EДобавим эти переменные в наше хранилище \u003Cstrong\u003Esrc\u002Fstores\u002Fcannon.js\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002Fstores\u002Fcannon.js\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003Eimport { writable } from 'svelte\u002Fstore';\n\nexport const direction = writable(null);\nexport const angle = writable(0);\n\u002F\u002F Добавляем переменные\nexport const isFiring = writable(false);\nexport const lastFireAt = writable(0);\nexport const bulletList = writable([]);\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EОбновим импорты и игровую логику в \u003Cstrong\u003Esrc\u002FgameLoop\u002Fcannon.js\u003C\u002Fstrong\u003E. \u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002FgameLoop\u002Fcannon.js\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003Eimport { get } from 'svelte\u002Fstore';\n\u002F\u002F Обновим импорты\nimport { angle, direction, isFiring, lastFireAt, bulletList } from '..\u002Fstores\u002Fcannon.js';\n\nexport function rotateCannon() {\n  const currentAngle = get(angle);\n  switch (get(direction)) {\n    case 'left':\n      if (currentAngle \u003E -45) angle.update(a =\u003E a - 0.4);\n      break;\n    case 'right':\n      if (currentAngle &lt; 45) angle.update(a =\u003E a + 0.4);\n      break;\n    default:\n      break;\n  }\n}\n\n\u002F\u002F Функция выстрела\nexport function shoot() {\n  \u002F\u002F Если зажата кнопка огня и последний выстрел произошел более чем 800мс назад, \n  \u002F\u002F то добавляем снаряд в массив и обновляем временную метку\n  if (get(isFiring) &amp;&amp; Date.now() - get(lastFireAt) \u003E 800) {\n    lastFireAt.set(Date.now());\n    \u002F\u002F Позиция и угол поворота снаряда совпадают с положением пушки. \n    \u002F\u002F Для id используем функцию Math.random и временную метку\n    bulletList.update(bullets =\u003E [...bullets, { x: 238, y: 760, angle: get(angle), id: () =\u003E Math.random() + Date.now() }]);\n  }\n}\n\n\u002F\u002F Функция перемещения снарядов\nexport function moveBullet() {\n  \u002F\u002F Возвращаем новый массив снарядов, в котором сдвигаем положение оси y на -20, \n  \u002F\u002F а положение по оси х рассчитываем по формуле прямоугольного треугольника. \n  \u002F\u002F Для знатоков геометрии отвечу, да, по диагонали снаряд летит быстрее. \n  \u002F\u002F Но визуально вы этого не заметили, верно?\n  bulletList.update(bullets =\u003E\n    bullets.map(bullet =\u003E ({\n      ...bullet,\n      y: bullet.y - 20,\n      x: (780 - bullet.y) * Math.tan((bullet.angle * Math.PI) \u002F 180) + 238,\n    })),\n  );\n}\n\n\u002F\u002F Удаляем снаряд из массива, если он вылетел за экран.\nexport function clearBullets() {\n  bulletList.update(bullets =\u003E bullets.filter(bullet =\u003E bullet.y \u003E 0));\n}\n\n\u002F\u002F Функция удаления снаряда по Id. Пригодится, когда мы добавим противников и обработку столкновений\nexport function removeBullet(id) {\n  bulletList.update(bullets =\u003E bullets.filter(bullet =\u003E bullet.id !== id));\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EТеперь импортируем наши обработчики в \u003Cstrong\u003EgameLoop.js\u003C\u002Fstrong\u003E и добавим их в игровой цикл.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003Eimport { rotateCannon, shoot, moveBullet, clearBullets } from \".\u002Fcannon\";\n\u002F* ... *\u002F\nexport const startGame = () =\u003E {\n  isPlaying.set(true);\n  startLoop([rotateCannon, shoot, moveBullet, clearBullets ]); \n};\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002FgameLoop\u002FgameLoop.js\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003Eimport { isPlaying } from '..\u002Fstores\u002Fgame';\nimport { get } from 'svelte\u002Fstore';\n\u002F\u002F Импортируем все обработчики событий пушки и снарядов\nimport { rotateCannon, shoot, moveBullet, clearBullets } from \".\u002Fcannon\";\n\nfunction startLoop(steps) {\n  window.requestAnimationFrame(() =\u003E {\n    steps.forEach(step =\u003E {\n      if (typeof step === 'function') step();\n    });\n    if (get(isPlaying)) startLoop(steps);\n  });\n}\n\nexport const startGame = () =\u003E {\n  isPlaying.set(true);\n  \u002F\u002F добавим обработчики в игровой цикл\n  startLoop([rotateCannon, shoot, moveBullet, clearBullets ]); \n};\n\nexport function stopGame() {\n  isPlaying.set(false);\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EТеперь нам осталось создать обработку нажатия кнопки огонь и добавить отображение снарядов на игровом поле.\u003Cbr\u002F\u003E\r\nОтредактируем \u003Cstrong\u003Esrc\u002Fcomponents\u002FControls.svelte\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003E\u002F\u002F Импортируем переменную, которая отвечает за нажатие кнопки огонь\nimport { direction, isFiring } from \"..\u002Fstores\u002Fcannon.js\";\n\u002F\u002F Добавим обработчики нажатия кнопки огонь\nconst startFire = () =\u003E isFiring.set(true);\nconst stopFire = () =\u003E isFiring.set(false);\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EТеперь добавим наши обработчики к кнопке, управляющей огнем, как мы делали это с кнопками поворота\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;IconButton start={startFire} release={stopFire} active={$isFiring}\u003E\n  &lt;Bullet \u002F\u003E\n&lt;\u002FIconButton\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002Fcomponents\u002FControls.svelte\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;script\u003E\n  import IconButton from \".\u002FIconButton.svelte\";\n  import LeftArrow from \"..\u002Fassets\u002FLeftArrow.svelte\";\n  import RightArrow from \"..\u002Fassets\u002FRightArrow.svelte\";\n  import Bullet from \"..\u002Fassets\u002FBullet.svelte\";\n  \u002F\u002F Импортируем переменную, которая отвечает за нажатие кнопки огонь\n  import { direction, isFiring } from \"..\u002Fstores\u002Fcannon.js\";\n\n  const resetDirection = () =\u003E direction.set(null);\n  const setDirectionLeft = () =\u003E direction.set(\"left\");\n  const setDirectionRight = () =\u003E direction.set(\"right\");\n  \u002F\u002F Добавим обработчики нажатия кнопки огонь\n  const startFire = () =\u003E isFiring.set(true);\n  const stopFire = () =\u003E isFiring.set(false);\n&lt;\u002Fscript\u003E\n\n&lt;style\u003E\n  .controls {\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    width: 100%;\n  }\n  .container {\n    display: flex;\n    justify-content: space-between;\n    margin: 1rem;\n  }\n  .arrowGroup {\n    display: flex;\n    justify-content: space-between;\n    width: 150px;\n  }\n&lt;\u002Fstyle\u003E\n\n&lt;div class=\"controls\"\u003E\n  &lt;div class=\"container\"\u003E\n    &lt;div class=\"arrowGroup\"\u003E\n      &lt;IconButton\n        start={setDirectionLeft}\n        release={resetDirection}\n        active={$direction === 'left'}\u003E\n        &lt;LeftArrow \u002F\u003E\n      &lt;\u002FIconButton\u003E\n      &lt;IconButton\n        start={setDirectionRight}\n        release={resetDirection}\n        active={$direction === 'right'}\u003E\n        &lt;RightArrow \u002F\u003E\n      &lt;\u002FIconButton\u003E\n    &lt;\u002Fdiv\u003E\n    &lt;!-- Добавим обработчики для кнопки --\u003E\n    &lt;IconButton start={startFire} release={stopFire} active={$isFiring}\u003E\n      &lt;Bullet \u002F\u003E\n    &lt;\u002FIconButton\u003E\n  &lt;\u002Fdiv\u003E\n&lt;\u002Fdiv\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EОсталось отобразить снаряды на игровом поле. Сначала создадим компонент снаряда\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002Fcomponents\u002FBullet.svelte\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;script\u003E\n \u002F\u002F В переменную bullet принимаем объект, описывающий положение снаряда\n  export let bullet;\n&lt;\u002Fscript\u003E\n&lt;!-- Снаряд - это svg прямоугольник --\u003E\n&lt;g\n  transform={`translate(${bullet.x}, ${bullet.y}) rotate(${bullet.angle})`}\u003E\n  &lt;rect width=\"3\" height=\"5\" fill=\"#212121\" \u002F\u003E\n&lt;\u002Fg\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПоскольку снаряды у нас хранятся в массиве, нам понадобится итератор для их отображения. В svelte для таких случаев есть директива \u003Cstrong\u003EEach\u003C\u002Fstrong\u003E. \u003Ca href=\"https:\u002F\u002Fru.svelte.dev\u002Fdocs#Bloki_Each\"\u003EПодробнее в документации\u003C\u002Fa\u003E. \u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"html\"\u003E\u002F\u002F Проходим по массиву bulletList, записывая каждый объект в переменную bullet.\n\u002F\u002F Выражение в скобках указывает на id каждого объекта, так svelte может оптимизировать вычисления и обновлять только то, что действительно обновилось. \n\u002F\u002F Аналог key из мира React\n{#each $bulletList as bullet (bullet.id)}\n  &lt;Bullet {bullet}\u002F\u003E\n{\u002Feach}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002Fcomponents\u002FGameField.svelte\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;script\u003E\n  import Cannon from \".\u002FCannon.svelte\";\n  \u002F\u002F Импортируем компонент снаряда\n  import Bullet from \".\u002FBullet.svelte\";\n  \u002F\u002F импортируем список снарядов из хранилища\n  import { bulletList } from \"..\u002Fstores\u002Fcannon\";\n&lt;\u002Fscript\u003E\n\n&lt;style\u003E\n  .container {\n    flex-grow: 1;\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    max-height: 100%;\n  }\n&lt;\u002Fstyle\u003E\n\n&lt;div class=\"container\"\u003E\n  &lt;svg viewBox=\"0 0 480 800\"\u003E\n  &lt;!-- Добавим итерацию по нашему массиву снарядов --\u003E\n    {#each $bulletList as bullet (bullet.id)}\n      &lt;Bullet {bullet} \u002F\u003E\n    {\u002Feach}\n    &lt;Cannon \u002F\u003E\n  &lt;\u002Fsvg\u003E\n&lt;\u002Fdiv\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EТеперь наша пушка умеет стрелять.\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fig\u002Fvl\u002Fwc\u002Figvlwcgdchgztehn0t4kofofddk.gif\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2 id=\"7-vragi\"\u003E7. Враги\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EОтлично. Для минимального геймплея нам осталось добавить врагов. Давайте создадим хранилище \u003Cstrong\u003Esrc\u002Fstores\u002Fenemy.js\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002Fstores\u002Fenemy.js\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003Eimport { writable } from \"svelte\u002Fstore\";\n\n\u002F\u002F Массив врагов\nexport const enemyList = writable([]);\n\u002F\u002F Временная метка добавления последнего врага\nexport const lastEnemyAddedAt = writable(0);\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EСоздадим обработчики игрового цикла для врагов в \u003Cstrong\u003Esrc\u002FgameLoop\u002Fenemy.js\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002FgameLoop\u002Fenemy.js\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003Eimport { get } from 'svelte\u002Fstore';\n\u002F\u002F Импортируем переменные врагов из хранилища\nimport { enemyList, lastEnemyAddedAt } from '..\u002Fstores\u002Fenemy.js';\n\n\u002F\u002F Функция добавления врага\nexport function addEnemy() {\n  \u002F\u002F Если с момента добавления последнего врага прошло больше 2500 мс, \n  \u002F\u002F то добавить нового врага\n  if (Date.now() - get(lastEnemyAddedAt) \u003E 2500) {\n    \u002F\u002F Обновим временную метку последнего добавления\n    lastEnemyAddedAt.set(Date.now());\n    \u002F\u002F Добавим врага со случайной координатой х от 1 до 499 \n    \u002F\u002F (размер нашего игрового поля)\n    enemyList.update(enemies =\u003E [\n      ...enemies,\n      {\n        x: Math.floor(Math.random() * 449) + 1,\n        y: 0,\n        id: () =\u003E Math.random() + Date.now(),\n      },\n    ]);\n  }\n}\n\n\u002F\u002F Функция перемещения врага. Каждый игровой цикл перемещаем врага на 0.5\nexport function moveEnemy() {\n  enemyList.update(enemyList =\u003E\n    enemyList.map(enemy =\u003E ({\n      ...enemy,\n      y: enemy.y + 0.5,\n    })),\n  );\n}\n\n\u002F\u002F Удалить врага из массива по id, пригодится для обработки попаданий\nexport function removeEnemy(id) {\n  enemyList.update(enemies =\u003E enemies.filter(enemy =\u003E enemy.id !== id));\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EДобавим обработчики врагов в наш игровой цикл.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002FgameLoop\u002FgameLoop.js\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003Eimport { isPlaying } from '..\u002Fstores\u002Fgame';\nimport { get } from 'svelte\u002Fstore';\nimport { rotateCannon, shoot, moveBullet, clearBullets } from '.\u002Fcannon';\n\u002F\u002F Импортируем все обработчики событий врагов\nimport { addEnemy, moveEnemy } from '.\u002Fenemy';\n\nfunction startLoop(steps) {\n  window.requestAnimationFrame(() =\u003E {\n    steps.forEach(step =\u003E {\n      if (typeof step === 'function') step();\n    });\n    if (get(isPlaying)) startLoop(steps);\n  });\n}\n\nexport const startGame = () =\u003E {\n  isPlaying.set(true);\n  \u002F\u002F добавим обработчики в игровой цикл\n  startLoop([rotateCannon, shoot, moveBullet, clearBullets, addEnemy, moveEnemy]);\n};\n\nexport function stopGame() {\n  isPlaying.set(false);\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EСоздадим компонент \u003Cstrong\u003Esrc\u002Fcomponents\u002FEnemy.js\u003C\u002Fstrong\u003E по аналогии со снарядом.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002Fcomponents\u002FEnemy.js\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;script\u003E\n \u002F\u002F В переменную enemy будем принимать объект, описывающий врага\n export let enemy;\n&lt;\u002Fscript\u003E\n\n\u002F\u002F Отобразим прямоугольник с врагом, выполнив трансформацию по текущим координатам.\n&lt;g transform={`translate(${enemy.x}, ${enemy.y})`} \u003E\n    &lt;rect width=\"30\" height=\"30\" fill=\"#212121\" \u002F\u003E\n&lt;\u002Fg\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EОсталось импортировать компонент врага, массив с объектами врагов в наше игровое поле и отобразить их в цикле \u003Cstrong\u003EEach\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002Fcomponents\u002FGameField.svelte\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"html\"\u003E&lt;script\u003E\n  import Cannon from \".\u002FCannon.svelte\";\n  import Bullet from \".\u002FBullet.svelte\";\n  \u002F\u002F импортируем компонент врагов\n  import Enemy from \".\u002FEnemy.svelte\";\n\n  import { bulletList } from \"..\u002Fstores\u002Fcannon\";\n  \u002F\u002F импортируем список врагов из хранилища\n  import { enemyList } from \"..\u002Fstores\u002Fenemy\";\n&lt;\u002Fscript\u003E\n\n&lt;style\u003E\n  .container {\n    flex-grow: 1;\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    max-height: 100%;\n  }\n&lt;\u002Fstyle\u003E\n\n&lt;div class=\"container\"\u003E\n  &lt;svg viewBox=\"0 0 480 800\"\u003E\n    &lt;!-- Добавим итерацию по нашему массиву врагов --\u003E\n    {#each $enemyList as enemy (enemy.id)}\n      &lt;Enemy {enemy} \u002F\u003E\n    {\u002Feach}\n    {#each $bulletList as bullet (bullet.id)}\n      &lt;Bullet {bullet} \u002F\u003E\n    {\u002Feach}\n    &lt;Cannon \u002F\u003E\n  &lt;\u002Fsvg\u003E\n&lt;\u002Fdiv\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EВраг наступает!\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fgf\u002Fbe\u002F_a\u002Fgfbe_a4u6bin74_wg4xdpgcolme.gif\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2 id=\"8-stolknoveniya\"\u003E8. Столкновения\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПока наши снаряды пролетают мимо, не причинив никакого вреда врагам.\u003Cbr\u002F\u003E\r\nСамое время добавить обработку столкновений. Общая игровая логика будет жить в файле \u003Cstrong\u003Esrc\u002FgameLoop\u002Fgame.js\u003C\u002Fstrong\u003E. Описание методики расчета столкновений можно прочитать на \u003Ca href=\"https:\u002F\u002Fdeveloper.mozilla.org\u002Fen-US\u002Fdocs\u002FGames\u002FTechniques\u002F2D_collision_detection\"\u003EMDN\u003C\u002Fa\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002FgameLoop\u002Fgame.js\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003Eimport { get } from 'svelte\u002Fstore';\n\u002F\u002F Импортируем массив снарядов\nimport { bulletList } from '..\u002Fstores\u002Fcannon';\n\u002F\u002F Импортируем массив врагов\nimport { enemyList } from '..\u002Fstores\u002Fenemy';\n\u002F\u002F Импортируем обработчик удаления снарядов\nimport { removeBullet } from '.\u002Fcannon';\n\u002F\u002F Импортируем обработчик удаления врагов\nimport { removeEnemy } from '.\u002Fenemy';\n\n\u002F\u002F Запишем в константы размеры врагов и снарядов. \n\u002F\u002F Размер снаряда сделан чуть больше, чем наш svg, чтобы компенсировать расстояние, \n\u002F\u002F которое пройдет снаряд и враг за игровой цикл. \nconst enemyWidth = 30;\nconst bulletWidth = 5;\nconst enemyHeight = 30;\nconst bulletHeight = 8;\n\n\u002F\u002F Функция обработки столкновений\nexport function checkCollision() {\n  get(bulletList).forEach(bullet =\u003E {\n    get(enemyList).forEach(enemy =\u003E {\n      if (\n        bullet.x &lt; enemy.x + enemyWidth &amp;&amp;\n        bullet.x + bulletWidth \u003E enemy.x &amp;&amp;\n        bullet.y &lt; enemy.y + enemyHeight &amp;&amp;\n        bullet.y + bulletHeight \u003E enemy.y\n      ) {\n          \u002F\u002F Если произошло столкновение, то удаляем снаряд и врага с игрового поля\n        removeBullet(bullet.id);\n        removeEnemy(enemy.id);\n      }\n    });\n  });\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EОсталось добавить обработчик столкновений в игровой цикл.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Esrc\u002FgameLoop\u002FgameLoop.js\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"javascript\"\u003Eimport { isPlaying } from '..\u002Fstores\u002Fgame';\nimport { get } from 'svelte\u002Fstore';\nimport { rotateCannon, shoot, moveBullet, clearBullets } from '.\u002Fcannon';\n\u002F\u002F импортируем обработчик столкновений\nimport { checkCollision } from '.\u002Fgame';\nimport { addEnemy, moveEnemy } from '.\u002Fenemy';\n\nfunction startLoop(steps) {\n  window.requestAnimationFrame(() =\u003E {\n    steps.forEach(step =\u003E {\n      if (typeof step === 'function') step();\n    });\n    if (get(isPlaying)) startLoop(steps);\n  });\n}\n\nexport const startGame = () =\u003E {\n  isPlaying.set(true);\n  \u002F\u002F добавим обработчик в игровой цикл\n  startLoop([rotateCannon, shoot, moveBullet, clearBullets, addEnemy, moveEnemy, checkCollision]);\n};\n\nexport function stopGame() {\n  isPlaying.set(false);\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EОтлично, наши снаряды научились поражать цель.\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fko\u002F8k\u002F96\u002Fko8k96c-ffehw1nm81cpptkhiga.gif\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2 id=\"9-chto-dalshe\"\u003E9. Что дальше\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЕсли вы дожили до этого момента и не потеряли интерес к нашим квадратным войнам, то у меня есть список ToDo на самостоятельное изучение:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003EДобавить обработку проигрыша, когда один из врагов добрался до нижней границы экрана;\u003C\u002Fli\u003E\r\n\u003Cli\u003EДобавить подсчет очков;\u003C\u002Fli\u003E\r\n\u003Cli\u003EДобавить экран старта и окончания игры с выводом текущих и максимально набранных очков;\u003C\u002Fli\u003E\r\n\u003Cli\u003EДобавить анимацию убийства врага. В svelte есть \u003Ca href=\"https:\u002F\u002Fru.svelte.dev\u002Ftutorial\u002Ftransition\"\u003Eкрутые штуки\u003C\u002Fa\u003E для этого;\u003C\u002Fli\u003E\r\n\u003Cli\u003EДобавить управление с клавиатуры;\u003C\u002Fli\u003E\r\n\u003Cli\u003EДобавить логику увеличения интенсивности появления и скорости движения врагов с каждым убитым. Постепенное увеличение сложности добавит реиграбельности.\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EМою реализацию этого списка вы можете посмотреть на \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Faz67128\u002Fsvelte-war\"\u003Egithub\u003C\u002Fa\u003E и в \u003Ca href=\"https:\u002F\u002Faz67128.github.io\u002Fsvelte-war\"\u003Eдемо\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2 id=\"zaklyuchenie\"\u003EЗаключение\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЭту игру, в качестве обучающего примера, я пытался сделать на React. Из коробки мне не удалось завести игру в 60 FPS, а вот со Svelte получилось с первой попытки.\u003Cbr\u002F\u003E\r\nПопробуйте Svelte прямо сейчас, вам понравится.\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"javascript"},{"titleHtml":"svelte"},{"titleHtml":"game development"},{"titleHtml":"reactive programming"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F452684\u002F85e6b1a03b19e6343e389c2062130256\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F452684\u002F85e6b1a03b19e6343e389c2062130256\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F452684\\\u002F\"},\"headline\":\"Разрабатываем игру на Svelte 3\",\"datePublished\":\"2019-05-29T08:55:44+03:00\",\"dateModified\":\"2019-06-19T15:44:29+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Alexander Zinchenko\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Чуть больше месяца назад вышел релиз Svelte 3. Хороший момент для знакомства, &mdash; подумал я и пробежался по отличному туториалу, который еще и переведен на русский...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F452684\\\u002F#post-content-body\",\"about\":[\"h_webdev\",\"h_javascript\",\"h_gamedev\",\"h_sveltejs\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fsv\\\u002Fqn\\\u002Fgn\\\u002Fsvqngnpfga7_0i44wvfi_blliz4.gif\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fjp\\\u002Fuc\\\u002Fwt\\\u002Fjpucwtprafksew6yvz0b0_y68sw.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fcx\\\u002Fx0\\\u002Fe5\\\u002Fcxx0e5ubvazwuwtzaofnp5y4tqq.gif\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fig\\\u002Fvl\\\u002Fwc\\\u002Figvlwcgdchgztehn0t4kofofddk.gif\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fgf\\\u002Fbe\\\u002F_a\\\u002Fgfbe_a4u6bin74_wg4xdpgcolme.gif\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fko\\\u002F8k\\\u002F96\\\u002Fko8k96c-ffehw1nm81cpptkhiga.gif\"]}","metaDescription":"Чуть больше месяца назад вышел релиз Svelte 3. Хороший момент для знакомства, — подумал я и пробежался по отличному туториалу, который еще и переведен на русский.\r\nДля закрепления пройденного я сделал...","mainImageUrl":null,"amp":false},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":"webdev,javascript,gamedev,sveltejs"},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
