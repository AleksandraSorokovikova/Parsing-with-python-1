<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Уличная магия сравнения кодеков. Раскрываем секреты / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/451664\/"},"headline":"Уличная магия сравнения кодеков. Раскрываем секреты","datePublished":"2019-05-28T08:58:08+03:00","dateModified":"2019-05-28T12:16:38+03:00","author":{"@type":"Person","name":"Dmitriy Vatolin"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"В этом году исполняется юбилей &mdash; 16 лет, как был запущен сайт compression.ru, на котором автор и сотоварищи организуют сравнения видеокодеков и кодеров изображ...","url":"https:\/\/habr.com\/ru\/post\/451664\/#post-content-body","about":["h_video","h_programming","h_popular_science","h_artificial_intelligence","h_futurenow","f_develop","f_design","f_popsci"],"image":["https:\/\/habrastorage.org\/webt\/cf\/qr\/em\/cfqrems_svzniipdihzqjse9x8w.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/160\/24d\/ed2\/16024ded279944b894b2b04da7f16295.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/ca5\/f58\/b9a\/ca5f58b9aa1fbcaa9b9e81b1576020d2.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/f7d\/a54\/ecf\/f7da54ecf22620640daed4ad80cebfd2.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/5c4\/3ca\/3b6\/5c43ca3b6f7f8f21245c3c0c2fad4c4a.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/547\/d95\/10d\/547d9510d1d57dc45709ed07214d37c0.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/4e2\/14d\/be8\/4e214dbe8f0f2a0e8a18c78bdbb432c1.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/698\/a99\/6be\/698a996be23d64bac98b77669dea5cbc.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/d26\/a37\/663\/d26a3766375fe7cb586d311052ea3004.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/872\/3df\/41a\/8723df41ac59b0938bb45af01b2ab80e.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/03c\/3bb\/47a\/03c3bb47a18b7628ec97797cc9c718c3.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/133\/5b1\/5ac\/1335b15ac516afcd8d2a4ef46905adab.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/b94\/088\/dbb\/b94088dbb1df5202c298e7caa7397eb5.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/dee\/4e1\/640\/dee4e1640e8e11ce84fb4963ea5a1805.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/0e1\/928\/dab\/0e1928dab2d19e3e19c0265a4a75f949.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/669\/483\/9f5\/6694839f57118c38b289c5f8dbbe0fc0.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/720\/f71\/3d6\/720f713d6b6fc7d36a8bb9f01451b825.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/faa\/e6d\/5cc\/faae6d5cc5349d82c1f963c68c01dd9b.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/333\/cb0\/a85\/333cb0a85d929aee14267c52daf88261.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/bd8\/13b\/243\/bd813b2436a77e56628f44a416e85a3a.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/08d\/9e4\/a6d\/08d9e4a6d585e69efe7fae22118bad06.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/1fc\/f37\/d2d\/1fcf37d2d45986f6e36259ebc1dd3e43.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/a51\/ceb\/2ab\/a51ceb2ab0905dcebe7a58e0cd744f41.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/de6\/1e2\/8ed\/de61e28ed4a63094c5bd2dfb0393fb2b.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/293\/e52\/598\/293e52598e14e1b1b62f3a9ceab12f9f.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/556\/62a\/b48\/55662ab486e914fbca85af43a1da2860.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/fb8\/181\/71c\/fb818171cad436993ca5fb1be4f16dc8.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/889\/137\/425\/889137425623b25d7f4fb92d67b40589.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/7e2\/3a7\/f4d\/7e23a7f4df74d138098ffaf5f6caea61.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/02c\/f0c\/639\/02cf0c639bdb1a2f337305c14ff86e9e.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/6b3\/545\/17d\/6b354517d00814640a78209d92c23be8.png","https:\/\/habrastorage.org\/webt\/_h\/v_\/jz\/_hv_jzpjxj-ve3kkmalz2k17vo4.png","https:\/\/habrastorage.org\/webt\/ls\/sn\/be\/lssnbevnse0hidehiryouacpxl4.png"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Уличная магия сравнения кодеков. Раскрываем секреты" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Уличная магия сравнения кодеков. Раскрываем секреты" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Уличная магия сравнения кодеков. Раскрываем секреты" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="В этом году исполняется юбилей — 16 лет, как был запущен сайт compression.ru, на котором автор и сотоварищи организуют сравнения видеокодеков и кодеров изображений. За это время были проведены..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="В этом году исполняется юбилей — 16 лет, как был запущен сайт compression.ru, на котором автор и сотоварищи организуют сравнения видеокодеков и кодеров изображений. За это время были проведены..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="В этом году исполняется юбилей — 16 лет, как был запущен сайт compression.ru, на котором автор и сотоварищи организуют сравнения видеокодеков и кодеров изображений. За это время были проведены..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="В этом году исполняется юбилей — 16 лет, как был запущен сайт compression.ru, на котором автор и сотоварищи организуют сравнения видеокодеков и кодеров изображений. За это время были проведены..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="В этом году исполняется юбилей — 16 лет, как был запущен сайт compression.ru, на котором автор и сотоварищи организуют сравнения видеокодеков и кодеров изображений. За это время были проведены..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/451664/88849794c6c15df911597cfda143494f/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/451664/88849794c6c15df911597cfda143494f/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/451664/88849794c6c15df911597cfda143494f/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/451664/88849794c6c15df911597cfda143494f/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/451664/88849794c6c15df911597cfda143494f/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="451664" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2019-05-28T05:58:08.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/451664/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/451664/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/451664/88849794c6c15df911597cfda143494f/" data-vmid="image:href"><link data-vue-meta="ssr" rel="amphtml" href="https://habr.com/ru/amp/post/451664/">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/3Dvideo/" title="3Dvideo" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" loading="lazy" src="//habrastorage.org/r/w32/getpro/habr/avatars/05b/eba/901/05beba9012f0fefe9a75c25ca46b40ff.png" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/3Dvideo/" class="tm-user-info__username">
      3Dvideo
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2019-05-28T05:58:08.000Z" title="2019-05-28, 08:58">28  мая  2019 в 08:58</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Уличная магия сравнения кодеков. Раскрываем секреты</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/video/" class="tm-article-snippet__hubs-item-link"><span>Работа с видео</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/programming/" class="tm-article-snippet__hubs-item-link"><span>Программирование</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/popular_science/" class="tm-article-snippet__hubs-item-link"><span>Научно-популярное</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/artificial_intelligence/" class="tm-article-snippet__hubs-item-link"><span>Искусственный интеллект</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/futurenow/" class="tm-article-snippet__hubs-item-link"><span>Будущее здесь</span> <!----></a></span></div> <!----> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/cf/qr/em/cfqrems_svzniipdihzqjse9x8w.png"/><br/>
<br/>
В этом году исполняется юбилей — 16 лет, как был запущен сайт compression.ru, на котором автор и сотоварищи организуют <a href="https://en.wikipedia.org/wiki/Comparison_of_video_codecs">сравнения видеокодеков</a> и кодеров изображений. За это время были проведены <a href="http://compression.ru/video/codec_comparison/index_en.html">десятки сравнений с отчетами от 23 до 550+ страниц</a>, количество графиков в последнем сравнении перевалило за 7000, а количество разных феерических случаев за это время окончательно превысило все разумные пределы. Поскольку следующая круглая дата (32 года) наступит еще нескоро, есть желание рассказать в честь юбилея малую толику феерического.<br/>
<br/>
Если говорить про кодеки, то не секрет, что большинство сравнений и графиков, которые видит почтеннейшая публика — это продукт отдела маркетинга. В лучшем случае — графики грамотно делали инженеры, а маркетинг только давал добро на публикацию. В худшем случае инженеры вообще не участвовали в их подготовке. <s>К чему тратить время этих занятых людей!</s><br/>
<br/>
При этом тема сжатия весьма популярна. В <a href="https://ru.wikipedia.org/wiki/%D0%9A%D1%80%D0%B5%D0%BC%D0%BD%D0%B8%D0%B5%D0%B2%D0%B0%D1%8F_%D0%B4%D0%BE%D0%BB%D0%B8%D0%BD%D0%B0_(%D1%82%D0%B5%D0%BB%D0%B5%D1%81%D0%B5%D1%80%D0%B8%D0%B0%D0%BB)">сериале «‎Кремниевая долина»</a>‎ стартап главного героя разработал гениальный алгоритм, который в последней серии первого сезона показал невероятное сжатие <a href="https://habr.com/ru/users/3Dvideo/">3D видео</a> и в итоге теперь миллионы стартаперов (и инвесторов) мира знают, что главное — это чтобы коэффициент Вайсмана был побольше и ещё гения надо найти, а остальное — фигня-вопрос. Чудо будет! Это естественным образом увеличивает ожидание чудес и, конечно (КОНЕЧНО!) эти чудеса радостно демонстрируются компаниями! В том числе с использованием последних достижений уличной магии. <br/>
<br/>
<b><font color="#ff0000">DISCLAIMER: Любые совпадения имен и названий компаний ниже с реальными именами и названиями абсолютно случайны.</font></b><br/>
<br/>
Усаживайтесь поудобнее! Обещаем, что к концу рассказа вы сможете показывать подобные фокусы сами, как, впрочем, и раскрывать многие из них. Поехали! <br/>
<a name="habracut"></a><br/>
<br/>
<h2>Level 1, фокусы для начинающих</h2><br/>
Начнем с самого простого, ибо, как ни странно, эти методы вполне в современной (не сериальной, а настоящей!) Кремниевой долине прокатывают.<br/>
<br/>
<i>Итак, почтеннейшая публика, фокусы с демонстрацией сверхсильного сжатия начинаются!<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/160/24d/ed2/16024ded279944b894b2b04da7f16295.png"/></i><br/>
<br/>
Наверняка многие видели подобные динамические сравнения <s>с незаметными котиками</s> на основе JS на страницах. Если сравнивается сжатие, то разумно чтобы качество было максимально одинаково (в идеале совершенно одинаково), а справа было бы сжато в 2 раза лучше, например. <br/>
<br/>
Сказано — сделано! <br/>
<br/>
Компания заявляет на 30% лучшее сжатие (все совпадения случайны!). А картинки выглядят совершенно одинаково! Даже профессионально наметанный взгляд не находит различий. Возникает желание посмотреть детальнее. Лезем в код страницы и видим, что слайдер для первой и второй картинки берет данные из одного файла! Получаем преимущества сразу по нескольким параметрам — во-первых, идеально демонстрируется лучший результат, во-вторых, не отвлекали инженера от работы, и, наконец, это место страницы сайта грузится вдвое быстрее. <b>Сплошной profit!!!</b> <br/>
<br/>
<i>Случай, не поверите, реальный. Теперь вы знаете, куда стоит посмотреть!</i><br/>
<br/>
В другом месте — тоже слайдер и опять замечательный результат. Заглядываем в код слайдера — грузятся разные файлы. Наученные горьким опытом скачиваем их — они не просто до байта одного размера, они совпадают побитно! В общем — все плюсы предыдущего способа, но фокус раскрывается чуть сложнее, правда за счет замедления загрузки страницы (за все приходится чем-то платить...). И, главное, не нужно привлекать дорогих специалистов в сжатии.<br/>
<br/>
Впрочем, более продвинутые маркетологи этого уровня идут еще дальше. Выкладывается слайдер — смотришь — картинки отличаются, но качество о-о-очень похоже. Ну ок. Дальше больше! Демонстрируется фантастическая открытость — есть даже линки на видеофайлы. Скачиваешь — очень неплохое преимущество у их метода, даже непонятно, как они это сделали. Выручает то, что мы же тут все поголовно русские хакеры (уже бренд на западе). Смотрим битовый поток и видим чудную картину:<br/>
<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/ca5/f58/b9a/ca5f58b9aa1fbcaa9b9e81b1576020d2.png"/></div><br/>
То есть даже многие эксперты, если не будут глубоко копать и перепроверять, подтвердят, что действительно у людей отличный результат примерно вдвое превосходящий по размеру сегодняшнего лидера при сравнимом качестве. Вы не поверите, подобные методы вполне себе используются и даже в некоторых случаях позволяют получить десятки миллионов долларов инвестиций. <br/>
<br/>
<i>Вспоминается встреча с русским стартапом 6 лет назад. Их директор прямо с порога сказал: «‎Вы должны нам все сделать на совесть. У нас инвесторы из «‎Северстали»‎, и, если что, к вам выедут спортивные бритые ребята с паяльниками.»‎ Как вы понимаете, в таких суровых условиях качество исследовательской работы волшебным образом возрастает, а количество фокусов разного уровня — падает… При работе с такими кейсами у нас, на родине слонов, возникает непреодолимое чувство жалости к западным инвесторам. Правда не все наши инвесторы такие чисто конкретные, и свои фокусники и в наших палестинах тоже находятся. Причем регулярно. Но про это в другой раз...</i><br/>
<br/>
<h2>Level 7, резонансный</h2><br/>
Эта история не про видеокодек, а про сжатие картинок, но в ней многое было по всем законам жанра «‎честных фокусов»‎.<br/>
<br/>
Как-то довольно известная компания М решила, что им к своим форматам Windows Media Video (WMV) и Windows Media Audio (WMA) нужно добавить Windows Media Photo (WMP). Чисто для комплекта, как вы понимаете. <br/>
<br/>
<i>Молодой человек на галёрке! Ну не надо так громко кричать, не вас одного осенило! Культурные люди (посмотрите на первый ряд) максимум — понимающе усмехнулись в усы…</i><br/>
<br/>
Сказано — сделано!<br/>
<br/>
Далее внимательно следим за руками:<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/f7d/a54/ecf/f7da54ecf22620640daed4ad80cebfd2.png"/><br/>
<br/>
Т.е. у WMP больше деталей, чем у JPEG и JPEG 2000 при том же уровне сжатия (мягко уравниваются JPEG и JPEG 2000 и задается уровень 24 раза), а <a href="https://www.cnet.com/news/microsoft-shows-off-jpeg-rival-1/">в следующем абзаце</a>:<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/5c4/3ca/3b6/5c43ca3b6f7f8f21245c3c0c2fad4c4a.png"/><img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/547/d95/10d/547d9510d1d57dc45709ed07214d37c0.png"/><br/>
<br/>
Т.е. обычно только в 6 раз сжимают, а было 24. Вау, пахнет тремя разами! И вообще мы лучше в 2 раза точно. СМИ понесли благую весть в массы (некоторые написали, что в 2 раза лучше JPEG 2000), даже <a href="https://habr.com/ru/post/15793/">на Хабре повторили эту новость</a>. <br/>
<br/>
Чуть позднее появился график из этой презентации:<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/4e2/14d/be8/4e214dbe8f0f2a0e8a18c78bdbb432c1.png" data-width="75%"/></div><br/>
<br/>
<div class="spoiler"><b class="spoiler_title">Как интерпретировать такие графики?</b><div class="spoiler_text"><div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/698/a99/6be/698a996be23d64bac98b77669dea5cbc.png" data-width="75%"/></div><br/>
По вертикали обычно идет качество (какая-то из метрик в зависимости от моды в этот момент времени), по горизонтали — так или иначе — размер. Обычно с увеличением размера качество растет (хотя на практике всякое бывает). По линии одинакового качества (красная горизонтальная) можно прикинуть, что «‎пурпурный»‎ кодек примерно в 2 раза проигрывает по размеру «‎синему»‎ при том же качестве на этом диапазоне битрейтов.<br/>
</div></div><br/>
<br/>
Преимущество по сравнению с JPEG 2000 было небольшим, при том, что они, очевидно, отобрали лучшую картинку с чудным мальчиком и дельфинами. Мы с большим нетерпением ждали возможности поиграться с этим кодером. Примерно через полгода утилиту для сжатия таки выложили.<br/>
<br/>
У нас к тому моменту как раз было годичной давности <a href="http://www.compression.ru/video/codec_comparison/pdf/jpeg2000_codec_comparison_en.pdf">сравнение 9 реализаций JPEG 2000 </a><br/>
<br/>
<i>Да-да-да! Как не все йогурты одинаково полезны, так и не все реализации стандарта жмут одинаково хорошо. <a href="https://ru.wikipedia.org/wiki/MPEG">Стандарт</a> оговаривает только битовый поток, положить в который данные (и, кстати, вынуть!) можно сильно по-разному, это порождает отдельный рынок <a href="https://ru.wikipedia.org/wiki/Xvid">кодеков</a> со своей жесткой конкуренцией по доброму десятку параметров. Простой пипл этого, как правило, не знает, что позволяет безнаказанно ездить ему по ушам практически на бульдозере («‎Наш видеорегистратор поддерживает новейший H.265/HEVC, больше его ни у кого нет!»‎). И никто (никто!) КРАЙНЕ вероятной подставы не замечает.</i><br/>
<br/>
Мы радостно вставили в предыдущий отчет 3 линии для WMP. Получилось как-то так:<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/d26/a37/663/d26a3766375fe7cb586d311052ea3004.png" data-width="75%"/></div><br/>
Видно, что линии реализаций JPEG 2000 идут довольно кучно и у жирной синей (лучшая реализация WMP) результаты где-то посередине, т.е. ПРОИГРЫВАЕТ JPEG 2000. Если взять JASPER за ноль и все по вертикали относительно него показать, то видно, что WMP с худшим параметром проигрывает почти всем, кроме двух последних (одна из них KDU, запомним это), а с лучшим — лежит где-то по центру, проигрывая многим реализациям:<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/872/3df/41a/8723df41ac59b0938bb45af01b2ab80e.png" data-width="75%"/></div><br/>
Поскольку сравнение было выложено публично и наделало шуму в узких кругах, то разработчик даже ответил на него <a href="https://blogs.msdn.microsoft.com/billcrow/2006/10/20/msu-evaluates-windows-media-photo-vs-jpeg-2000/">в официальном блоге</a>. Заметка была вежливая: похвалили, покритиковали, а дальше, если продраться сквозь текст, человек чистосердечно признался, что они использовали самую худшую реализацию JPEG 2000 нашего сравнения (опубликованного за полгода до того) в своем сравнении, правда «‎совершенно случайно»‎. Мы, конечно, им поверим. Компания уважаемая и все такое. <br/>
<br/>
Дальше название технологии было изменено с WMP на HD Photo, впрочем в сети остался <a href="https://blog.codinghorror.com/beyond-jpeg/">такой вердикт</a>:<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/03c/3bb/47a/03c3bb47a18b7628ec97797cc9c718c3.png"/><br/>
В качестве вишенки на торт. Наши коллеги пошли дальше: взяли больше картинок и показали, что HD Photo проигрывает не только JPEG 2000, но и хорошей реализации JPEG (<a href="http://imagecompression.info/lossy/">в 7 случаях из 14</a>). И проигрывает конкретно. Есть основания полагать, что они подбирали картинки, но они откровенно закопали HDPhoto, ибо кому нужен формат, который в половине случаев проигрывает древнему JPEG — непонятно:<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/133/5b1/5ac/1335b15ac516afcd8d2a4ef46905adab.png" data-width="75%"/></div><br/>
<br/>
Итого, секреты этого фокуса:<br/>
<ul>
<li>Берем худшую реализацию основного конкурента, сравниваем с ней.<br/>
</li>
<li>Создаем рекламную шумиху (в стиле «‎мы всех сильно обогнали»‎).<br/>
</li>
<li>Когда шумиха отходит на второй план, делаем релиз и надеемся, что никто не проверит, что там было на самом деле.<br/>
</li>
</ul><br/>
<i>Дети! Никогда так не делайте и не обманывайте других! Ваша компания может потерять миллионы долларов и доверие специалистов.</i><br/>
<br/>
<h2>Level 10, свежий! С нейросетями!</h2><br/>
Вообще подобных случаев — очень много. Даже в России я сталкиваюсь с подобными ситуациями примерно пару раз в год (к нам, как к хозяевам compression.ru, информация стекается). На западе разводят <s>лохов</s> инвесторов примерно ежемесячно. А сейчас еще и Китай к этому развлечению подключился. Мощность компьютеров растет, сложность и возможности алгоритмов — тоже. Разбираться в этом все сложнее. Как следствие — бурное веселье продолжается! <br/>
<br/>
В последнее время очень популярны стали нейросети. Абсолютно все, к чему они прикасаются, волшебным образом улучшается. А не применить ли их к сжатию видео?<br/>
<br/>
Сказано — сделано! <br/>
<br/>
В ноябре прошлого года очередная благая весть <a href="https://www.wsj.com/articles/actual-silicon-valley-startup-gets-inspiration-from-hbos-silicon-valley-startup-1542391937">с подачи самого «Уолл Стрит Джорнал»</a> облетела мир. Создан видеокодек на основе машинного обучения, который всех порвал! Вот пруф:<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/b94/088/dbb/b94088dbb1df5202c298e7caa7397eb5.png" data-width="75%"/></div><br/>
<i>Вообще я лично крайне скептически воспринимаю все новости с упоминанием нейросетей. И вам советую (ОСОБЕННО, если вы инвестор). Нейросети устроены таким образом, что грамотно подбирая обучающую выборку под тестовую можно показать любой (для непонятливых — ЛЮБОЙ!) желаемый результат. Нейросети — идеальный инструмент для постановки на поток маркетинговых чудес. Одно чудеснее другого!</i><br/>
<br/>
В общем график есть, картинки есть. Согласитесь — убедительно. Специально для скептиков господа привели еще несколько графиков на известных тестовых наборах:<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/dee/4e1/640/dee4e1640e8e11ce84fb4963ea5a1805.png" data-width="75%"/><br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/0e1/928/dab/0e1928dab2d19e3e19c0265a4a75f949.png" data-width="75%"/><br/>
Впрочем, если предыдущий график с картинками лично для меня был еще как-то объясним (заточиться на одно видео да еще с глубокими нейросетями можно всегда), то эти два графика заставили резко насторожиться. <br/>
<br/>
<i>Вас в них ничего не смущает?</i><br/>
<div class="spoiler"><b class="spoiler_title">Ответ</b><div class="spoiler_text"> Из них следует, что за десять лет с принятия стандарта H.264 до принятия H.265 особого развития кодеков не происходило! Эти тупые исследователи 10 лет топтались на месте и делали более медленные кодеки, которые сжимают так же!!! Разница — 20% максимум, а то и меньше!!! 8-\ </div></div><br/>
Они даже под это подводят базу, типа классические кодеки уперлись в предел и уже особо не развиваются (и тут на сцену выходят они, все в белом). И вы знаете, такая наглая ложь прекрасно работает! Причем ладно <a href="https://www.wsj.com/articles/actual-silicon-valley-startup-gets-inspiration-from-hbos-silicon-valley-startup-1542391937">«The Wall Street Journal»</a> — они (хотелось бы верить) только в финансах разбираются, ладно <a href="https://www.technologyreview.com/s/612462/deep-learning-will-help-keep-video-from-clogging-up-the-internet/">«MIT Technology Review»</a> — эти джентльмены джентльменам Кремниевой долины верят на слово, но как некритически воспринял новость такой уважаемый ресурс, как <a href="https://habr.com/ru/post/431354/">Хабр</a> — ума не приложу! Чего уж говорить про массово перепечатавших новость …<br/>
<br/>
В реальности картина развития кодеков, к счастью, заметно отличается. Во-первых, на графике ниже, построенном нами <b><i>на том же</i></b> наборе видео xiph, можно увидеть, что H.265 на 25−31% лучше, чем H.264. Т.е. 10 лет развития кодеков таки не прошли даром! (<i>Уфф, прямо от сердца отлегло...</i>) Во-вторых, свежий AV1 показывает практически двукратное улучшение по сравнению с H.264, и ступенька его преимущества, прямо скажем, весьма заметна:<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/669/483/9f5/6694839f57118c38b289c5f8dbbe0fc0.png" data-width="75%"/></div><br/>
<br/>
Соответственно на глаз видно, что если наложить график AV1 на 45% левее H.264 на графике авторов — он покроет новый кодек как… [вырезано цензурой]. Хорошо покроет, короче. Потому с ним и «‎забыли»‎ сравниться. Реальный расклад выглядит как-то так (сильно менее кучно, согласитесь):<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/720/f71/3d6/720f713d6b6fc7d36a8bb9f01451b825.png" data-width="75%"/></div><br/>
Чтобы было понятно — у кодеков есть стандартные пресеты, которые позволяют варьировать скорость в значительных пределах (часто десятки раз), но при этом достигать большего сжатия при том же качестве (часто больше 2 раз). У x265 (очень неплохой open-source реализации стандарта <a href="https://en.wikipedia.org/wiki/High_Efficiency_Video_Coding">HEVC</a>) они называются: ultrafast, superfast, veryfast, faster, fast, medium, slow, slower, veryslow, placebo. Если взять medium за 1, то по скорости и размеру файла при том же качестве они для конкретного файла могут располагаться, например, как на графике ниже. Можно говорить, что относительно medium можно сделать файл на 40% больше или меньше, варьируя скорость в 10 раз:<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/faa/e6d/5cc/faae6d5cc5349d82c1f963c68c01dd9b.png" data-width="75%"/></div>Заметим, что для некоторых видео стандартные опции не обязательно идут монотонно (в данном случае по качеству). Также иногда «‎нестандартные»‎ опции <a href="http://compression.ru/video/video_codec_optimization/">могут дать большой выигрыш по размеру</a>, в частности на примере выше потеряв 20% по скорости по сравнению с medium можно наиграть 30% по размеру — практически как при переходе на стандарт следующего уровня, но при прежней невысокой сложности декодера. Но это уже более сложный level, о нем в другой раз. <br/>
<br/>
Как легко заметить выше, господа взяли для сравнения «slower». Хорошо, что не «veryfast», ведь могли бы и его! ) И не важно, что у них у самих кодек феерически медленный. Люди в массе своей, глядя на график, не вспоминают о том, что скорость работы кодека может <i>на пару порядков</i> отличаться в зависимости от параметров. Поэтому такой прием вполне прокатывает. Хотя на нашем графике выше («Bitrate/quality...») их пачка линий была в районе красной (которая самая плохая). Заодно оправдывая топтание на месте в развитии кодеков. Ага-ага!<br/>
<br/>
Есть и более тонкие подтасовки, например, господа пишут: «To remove B-frames, we use H.264/5 with the bframes=0 option, VP9 with -auto-alt-ref 0 -lag-in-frames 0, and use the HM encoder lowdelay P main.cfg profile.» То есть они не смогли побить обычные кодеки в честном соревновании и выбрали low-latency режим с низкой задержкой, который используется обычно для реального времени, например, для видеоконференций. Результаты кодека в нем хуже, естественно. При этом их декодер (про энкодер промолчим) работает 2 секунды на кадр, то есть ни о каком low-latency даже близко говорить нельзя. Зато еще несколько процентов наиграли.<br/>
<br/>
Это не все трюки, которые были использованы господами стартаперами, но картина уже ясна. <br/>
<br/>
Понятно, что, чтобы фокус выглядел правдоподобно, нужны еще дополнительные штрихи, которые придают реализма. Например, эти господа опубликовали статью на <a href="https://arxiv.org/abs/1811.06981">https://arxiv.org/abs/1811.06981</a>. Сегодня развитие алгоритмов идет настолько быстро, что ждать, пока выйдет статья в журнале становится нестерпимо, поэтому многие сильные авторы публикуют результаты сначала на arxiv.org. Для уличных магов этот сайт удобен тем, что там можно разместить абсолютно любой материал — в отличие от рецензируемых журналов и конференций никто не задаст неприятных вопросов и не зарубит публикацию (нет kill reviewing серьезных мест). А про то, что, например, на 1 апреля на arxiv.org принято публиковать разного рода пародии на научные статьи, в том числе высмеивая его как место публикаций, широкая публика не знает, поэтому для широкой публики публикация там выглядит типа даже солидно.<br/>
<br/>
Идем дальше. Статья на хабре про них называлась «‎<a href="https://habr.com/ru/post/431354/">Первый видеокодек на машинном обучении кардинально превзошел все существующие кодеки, в том числе H.265 и VP9»‎</a>. Очередной прикол заключается в том, что машинное обучение в сжатии не только активно исследуется, чему уже посвящаются <a href="https://www2.securecms.com/PCS2018/Papers/PublicSessionIndex3.asp?Sessionid=1000">отдельные треки конференций</a> (то есть <i>статей много</i>), но и активно <a href="https://www.google.com/search?q=%22av1%22+encoder+machine+learning">используется, например, в AV1</a> (специально привожу гугловый запрос). Но, если бы они честно сказали: «‎Мы выпустили второй кодек с использованием машинного обучения, при этом проиграв первому и по скорости, и по сжатию»‎, то Wall Street Journal мог про них и не написать… И MIT TechReview не написал бы… И даже Хабр… Очевидно, не вынеся последнего, в компании <i>чуть-чуть</i> поправили подачу. При этом особенностью современного интернета является то, что люди не проверяют информацию, что позволяет спокойно провозглашать себя первыми много кому (начиная с известных компаний). Наглость, как известно, города берет! А фактчекинг не моден.<br/>
<br/>
<i>— Загугли!<br/>
— Это как это?<br/>
[пример запроса дан выше)))]</i><br/>
<br/>
И еще про ML/DL. В далекие-далекие времена, когда дискеты были большими, а винчестеры маленькими, одним из приемов «‎уличной магии для архиваторов»‎ было сохранить часть сжимаемого файла куда-нибудь подальше в директорию со временными файлами и таким образом показать рекорд. С тех пор времена изменились. Винчестеры — выросли, дискеты совсем пропали, а данные стало модно прятать вглубь нескольких сотен мегабайт коэффициентов сетки. Можно сохранить «‎авторский знак»‎ в сетке, можно — пасхалку, а можно фейковый рекорд сжатия поставить. Глубокие нейросети — однозначно сила, короче!<br/>
<br/>
Резюмируя данный путь к успеху:<br/>
<ul>
<li>Игнорируем современного лидера так, будто его вообще нет.<br/>
</li>
<li>Аккуратно формулируем все так, чтобы читалось будто мы первые использовали какую-нибудь новую технологию (и даже если первый это сделал лидер — никто проверять не будет).<br/>
</li>
<li>У стандартов 5− и 15−летней давности откручиваем ручки так, чтобы они работали хуже нас.<br/>
</li>
<li>Побольше наглости — обосновываем то, что они легли кучно позади нас тем, что они уперлись в предел и уже не развиваются.<br/>
</li>
<li>Публикуемся в «The Wall Street Journal» и на Хабре…<br/>
</li>
</ul><br/>
<i>И… (барабанная дробь!)… вам дают еще несколько миллионов долларов! Или не дают… Я бы не давал… Инвесторы! Не спать! А то потом опять будете на воду дуть...</i><br/>
<br/>
<h2>А теперь мастер-класс!</h2><br/>
Как я и обещал выше, к концу этого текста вы сможете легко блистать на подмостках условного pikabu. <br/>
<br/>
<i>Сейчас, о почтеннейшая публика, я покажу вам фокус, позволяющий сравнивать, что угодно с чем угодно с любым заранее заданным результатом. Т.е. если надо, чтобы кодек А был лучше кодека Б — значит покажем это, если нужно, чтобы Б был лучше А, хорошо, можем показать и это. Исполним любой каприз отдела маркетинга <s>за ваши деньги</s> совершенно бесплатно! </i><br/>
<br/>
Давайте сами проверим, как эти самые кодеки жмут. Как говорится — не верь никому, проверь сам. А то, может, и правда эти стандарты не развиваются и нас просто дурят, заставляя зря платить заработанные непосильным трудом деньги непонятно за что? <br/>
<br/>
Возьмем «‎Аватар»‎ в формате 480p24 и сожмем его кодеком x264 c настройками "-preset superfast -x264-params «nal-hrd=cbr» -b:v 1M -minrate 1M -maxrate 1M -bufsize 2M" и кодеком xvid с настройками "-preset superfast -b:v 1M -minrate 1M -maxrate 1M -bufsize 2M" (две очень неплохие open-source реализации стандартов H.264 и MPEG-4). Почему взяты эти кодеки и настройки будет объяснено позднее.<br/>
<br/>
У нас получились два файла почти одного размера:<br/>
avatar_x264_cbr1M_superfast.mkv — 1402 MB<br/>
avatar_xvid_cbr1M_superfast.mkv — 1401 MB<br/>
<br/>
<i>А теперь, дамы и господа! Внимательно следите за руками!!!</i><br/>
<br/>
Смотрим, вот новый стандарт и старый:<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/333/cb0/a85/333cb0a85d929aee14267c52daf88261.png" data-width="50%"/><img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/bd8/13b/243/bd813b2436a77e56628f44a416e85a3a.png" data-width="50%"/><br/>
<br/>
Смотрим другой кадр:<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/08d/9e4/a6d/08d9e4a6d585e69efe7fae22118bad06.png" data-width="50%"/><img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/1fc/f37/d2d/1fcf37d2d45986f6e36259ebc1dd3e43.png" data-width="50%"/><br/>
<i>Без комментариев! А если быстрое движение?<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/a51/ceb/2ab/a51ceb2ab0905dcebe7a58e0cd744f41.png" data-width="50%"/><img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/de6/1e2/8ed/de61e28ed4a63094c5bd2dfb0393fb2b.png" data-width="50%"/><br/>
<br/>
Согласитесь! Прогресс явный и неумолимый! Все развивается и становится все лучше и лучше! А жизнь </i>—<i> краше и веселее!<br/>
<br/>
Хотя… <br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/293/e52/598/293e52598e14e1b1b62f3a9ceab12f9f.png" data-width="50%"/><img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/556/62a/b48/55662ab486e914fbca85af43a1da2860.png" data-width="50%"/><br/>
<br/>
Боже, что это??? Новый стандарт совсем слил…<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/fb8/181/71c/fb818171cad436993ca5fb1be4f16dc8.png" data-width="50%"/><img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/889/137/425/889137425623b25d7f4fb92d67b40589.png" data-width="50%"/><br/>
<br/>
А-а-а-а! Люди! Знайте! Корпорации вас обманывают!!! Кодеки уже давно не развиваются, но вам сообщают что все идет хорошо!<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/7e2/3a7/f4d/7e23a7f4df74d138098ffaf5f6caea61.png" data-width="50%"/><img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/02c/f0c/639/02cf0c639bdb1a2f337305c14ff86e9e.png" data-width="50%"/><br/>
<br/>
Вы видите? Все, чему они научились за 10 лет — это размывать блочность! Причем делают это просто отвратительно! Стало хуже, чем было! Вас водят за нос все эти годы!!!!!!!11</i><br/>
<br/>
А теперь разберемся, как это сделано.<br/>
<br/>
На самом деле полный кадр выглядит так:<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/6b3/545/17d/6b354517d00814640a78209d92c23be8.png"/><br/>
Когда кодек работает, особенно в режиме постоянного битрейта, качество кадров достаточно сильно колеблется. Вот начало фильма, например — качество по классической метрике <a href="https://en.wikipedia.org/wiki/Peak_signal-to-noise_ratio">PSNR</a> (сомнений кто лучше, кто хуже, кстати, нет, видно что зеленый xvid проигрывает в среднем):<br/>
<a href="https://habrastorage.org/webt/_h/v_/jz/_hv_jzpjxj-ve3kkmalz2k17vo4.png"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/_h/v_/jz/_hv_jzpjxj-ve3kkmalz2k17vo4.png"/></a><br/>
<i> Картинка кликается </i><br/>
<br/>
Если вычесть один график из другого (на рисунке ниже, другое место в файле) — то видно, что в целом кодек более старого стандарта будет проигрывать, однако местами он может вполне уходить на +5 dB (PSNR удобна тем, что она обратно логарифмически пропорциональна среднеквадратичному отклонению, за счет чего, обычно, работает правило: на диапазоне средних и низких битрейтов на глаз видна разница в 1.5 dB). И тут же виден кадр, где в другую сторону разница 20 dB:<br/>
<a href="https://habrastorage.org/webt/ls/sn/be/lssnbevnse0hidehiryouacpxl4.png"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/ls/sn/be/lssnbevnse0hidehiryouacpxl4.png"/></a><br/>
<i> Картинка кликается </i><br/>
<br/>
<i>Теперь вы понимаете, почему ваш покорный слуга всегда с искренним умилением смотрит на приведенные в маркетинговых материалах компаний отдельные кадры, как на доказательство более высокого качества на видео (особенно когда нет графиков)… И ведь так до сих пор иногда приводят! </i><br/>
<br/>
Чтобы отбирать кадры было проще, мы больше 10 лет назад сделали режим сравнения в нашей тулзе <a href="http://www.compression.ru/video/quality_measure/video_measurement_tool.html">MSU VQMT</a>, при котором сравнивались сразу 3 файла — оригинал, кодек-1 и кодек-2 и сразу сохранялись, например, 30 лучших пар кадров в одну или в другую сторону. Главное — взять файл подлиннее! <br/>
<br/>
А MPEG-4 с низким битрейтом был взят, чтобы с блочностью было все нагляднее. <br/>
<br/>
Итого, путь к успеху:<br/>
<ul>
<li>Выбираем режим, при котором колебание качества у кодеков максимально (обычно, однопроходный CBR).<br/>
</li>
<li>Уменьшаем разрешение исходника в 2 раза (ибо скорее всего придется увеличивать фрагменты, например выше фрагменты были увеличены в 3 раза)<br/>
</li>
<li>Берем какую-нибудь метрику (<a href="https://www.google.com/search?q=PSNR+metric+program">PSNR</a>, <a href="https://www.google.com/search?q=SSIM+metric+program">SSIM</a>, модную в этом сезоне <a href="https://www.google.com/search?q=VMAF+metric+program">VMAF</a>).<br/>
</li>
<li>Берем в качестве сравнения старый стандарт с блочностью или отключаем внутренний деблокинг у конкурента опциями.<br/>
</li>
<li>И последнее, не забываем взять файл подлиннее: 3 часа фильма — самое оно!<br/>
</li>
</ul><br/>
И БИНГО! У вас несколько примеров насколько вы лучше конкурента!<br/>
<br/>
Ну или где-нибудь, где публика не слишком разборчива, можно кого-нибудь с кем-нибудь успешно сравнить. Пипл будет доволен.<br/>
<br/>
<i>Теперь вы знаете, какие вопросы задавать, когда видите сравнение с кадрами в материалах компаний! Может хоть пореже, наконец, они будут встречаться...</i><br/>
<br/>
<h2>Вместо заключения</h2><br/>
Выше разбирались относительно простые способы подготовки маркетинговых материалов «в свою пользу» в сравнениях кодеков и кодеров. Естественно, в реальной жизни все сложнее. Увы, если идти глубже, оно будет не так увлекательно и заметно сложнее (желающие могут почитать <a href="https://habr.com/ru/post/388423/">статью и комментарии тут</a>, например). <br/>
<br/>
А людей, обычно, интересуют простые ответы. Самый популярный ответ в Ответы@Mail.ru на вопрос ‎<a href="https://otvet.mail.ru/question/6580477">«Какой самый лучший видеокодек?»‎</a> — «K-Lite Mega Codec Pack». И это для массового зрителя действительно самый короткий, понятный и точный ответ. А вы говорите — кодеки, стандарты…<br/>
<br/>
Но чем больше будет людей, хотя бы на среднем уровне разбирающихся в предмете, тем реже будут совсем уж нахально лапшу на уши вешать отделы маркетинга или дуть в уши инвесторам нахальные стартаперы. И жизнь станет чуточку лучше.<br/>
<br/>
<i>Спасибо за внимание, дамы и господа! Всем — технической грамотности!</i><br/>
<br/>
<div class="spoiler"><b class="spoiler_title">Благодарности</b><div class="spoiler_text">Хотелось бы сердечно поблагодарить:<br/>
<ul>
<li>Лабораторию Компьютерной Графики ВМК МГУ им. М.В.Ломоносова за вклад в развитие компьютерной графики в России и не только,<br/>
</li>
<li>наших коллег из видеогруппы, в том числе Сергея Звездакова, Анастасию Анциферову и Романа Казанцева, чьи примеры использованы выше,<br/>
</li>
<li>персонально Константина Кожемякова, который сделал очень много для того, чтобы эта статья стала лучше и нагляднее,<br/>
</li>
<li>и, наконец, огромное спасибо Сергею Лаврушкину, Егору Склярову, Ивану Молодецких, Евгению Ляпустину, Дмитрию Куликову, Александре Анзиной, Виталию Людвиченко, Михаилу Ерофееву и Георгию Осипову за большое количество дельных замечаний и правок, сделавших этот текст намного лучше!<br/>
</li>
</ul></div></div></div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%81%D0%B6%D0%B0%D1%82%D0%B8%D0%B5%5D" class="tm-tags-list__link">сжатие</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B2%D0%B8%D0%B4%D0%B5%D0%BE%5D" class="tm-tags-list__link">видео</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BA%D0%BE%D0%B4%D0%B5%D0%BA%5D" class="tm-tags-list__link">кодек</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%81%D1%80%D0%B0%D0%B2%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%BA%D0%BE%D0%B4%D0%B5%D0%BA%D0%BE%D0%B2%5D" class="tm-tags-list__link">сравнение кодеков</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BD%D0%B5%D0%B9%D1%80%D0%BE%D1%81%D0%B5%D1%82%D0%B8%5D" class="tm-tags-list__link">нейросети</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bx264%5D" class="tm-tags-list__link">x264</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bx265%5D" class="tm-tags-list__link">x265</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bxvid%5D" class="tm-tags-list__link">xvid</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bcompression%5D" class="tm-tags-list__link">compression</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bvideo%20codecs%5D" class="tm-tags-list__link">video codecs</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hub/video/" class="tm-hubs-list__link">
    Работа с видео
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/programming/" class="tm-hubs-list__link">
    Программирование
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/popular_science/" class="tm-hubs-list__link">
    Научно-популярное
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/artificial_intelligence/" class="tm-hubs-list__link">
    Искусственный интеллект
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/futurenow/" class="tm-hubs-list__link">
    Будущее здесь
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 144: ↑144 и ↓0</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 144: ↑144 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+144</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">32K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    131
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/3Dvideo/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/05b/eba/901/05beba9012f0fefe9a75c25ca46b40ff.png" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 511 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    428.2
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><span class="tm-user-card__name tm-user-card__name_variant-article">Dmitriy Vatolin</span> <a href="/ru/users/3Dvideo/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @3Dvideo
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">Современная обработка видео</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <button type="submit" class="tm-user-card__button btn btn_transparent btn_small">
      Задонатить
    </button> <!----> <!----></div></div> <div class="tm-article-author__user-contacts"><a href="http://compression.ru/video/" rel="noopener" target="_blank" class="tm-article-author__contact">
      Сайт
    </a><a href="https://videoprocessing.ai/" rel="noopener" target="_blank" class="tm-article-author__contact">
      Сайт
    </a><a href="http://videocompletion.org/" rel="noopener" target="_blank" class="tm-article-author__contact">
      Сайт
    </a><a href="http://videomatting.com/" rel="noopener" target="_blank" class="tm-article-author__contact">
      Сайт
    </a><a href="http://subjectify.us/" rel="noopener" target="_blank" class="tm-article-author__contact">
      Сайт
    </a></div></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/451664/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 123 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <!----> <!----> <!----> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/451664/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/451664/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"451664":{"id":"451664","timePublished":"2019-05-28T05:58:08+00:00","isCorporative":false,"lang":"ru","titleHtml":"Уличная магия сравнения кодеков. Раскрываем секреты","leadData":{"textHtml":"\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fcf\u002Fqr\u002Fem\u002Fcfqrems_svzniipdihzqjse9x8w.png\"\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nВ этом году исполняется юбилей — 16 лет, как был запущен сайт compression.ru, на котором автор и сотоварищи организуют \u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FComparison_of_video_codecs\"\u003Eсравнения видеокодеков\u003C\u002Fa\u003E и кодеров изображений. За это время были проведены \u003Ca href=\"http:\u002F\u002Fcompression.ru\u002Fvideo\u002Fcodec_comparison\u002Findex_en.html\"\u003Eдесятки сравнений с отчетами от 23 до 550+ страниц\u003C\u002Fa\u003E, количество графиков в последнем сравнении перевалило за 7000, а количество разных феерических случаев за это время окончательно превысило все разумные пределы. Поскольку следующая круглая дата (32 года) наступит еще нескоро, есть желание рассказать в честь юбилея малую толику феерического.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nЕсли говорить про кодеки, то не секрет, что большинство сравнений и графиков, которые видит почтеннейшая публика — это продукт отдела маркетинга. В лучшем случае — графики грамотно делали инженеры, а маркетинг только давал добро на публикацию. В худшем случае инженеры вообще не участвовали в их подготовке. \u003Cs\u003EК чему тратить время этих занятых людей!\u003C\u002Fs\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nПри этом тема сжатия весьма популярна. В \u003Ca href=\"https:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002F%D0%9A%D1%80%D0%B5%D0%BC%D0%BD%D0%B8%D0%B5%D0%B2%D0%B0%D1%8F_%D0%B4%D0%BE%D0%BB%D0%B8%D0%BD%D0%B0_(%D1%82%D0%B5%D0%BB%D0%B5%D1%81%D0%B5%D1%80%D0%B8%D0%B0%D0%BB)\"\u003Eсериале «‎Кремниевая долина»\u003C\u002Fa\u003E‎ стартап главного героя разработал гениальный алгоритм, который в последней серии первого сезона показал невероятное сжатие \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fusers\u002F3Dvideo\u002F\"\u003E3D видео\u003C\u002Fa\u003E и в итоге теперь миллионы стартаперов (и инвесторов) мира знают, что главное — это чтобы коэффициент Вайсмана был побольше и ещё гения надо найти, а остальное — фигня-вопрос. Чудо будет! Это естественным образом увеличивает ожидание чудес и, конечно (КОНЕЧНО!) эти чудеса радостно демонстрируются компаниями! В том числе с использованием последних достижений уличной магии. \u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cb\u003E\u003Cfont color=\"#ff0000\"\u003EDISCLAIMER: Любые совпадения имен и названий компаний ниже с реальными именами и названиями абсолютно случайны.\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nУсаживайтесь поудобнее! Обещаем, что к концу рассказа вы сможете показывать подобные фокусы сами, как, впрочем, и раскрывать многие из них. Поехали! \u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше →","image":null},"editorVersion":"1.0","postType":"article","postLabels":[],"author":{"scoreStats":{"score":428.2,"votesCount":511},"rating":0,"relatedData":null,"contacts":[{"title":"Сайт","url":"http:\u002F\u002Fcompression.ru\u002Fvideo\u002F","value":"http:\u002F\u002Fcompression.ru\u002Fvideo\u002F"},{"title":"Сайт","url":"https:\u002F\u002Fvideoprocessing.ai\u002F","value":"https:\u002F\u002Fvideoprocessing.ai\u002F"},{"title":"Сайт","url":"http:\u002F\u002Fvideocompletion.org\u002F","value":"http:\u002F\u002Fvideocompletion.org\u002F"},{"title":"Сайт","url":"http:\u002F\u002Fvideomatting.com\u002F","value":"http:\u002F\u002Fvideomatting.com\u002F"},{"title":"Сайт","url":"http:\u002F\u002Fsubjectify.us\u002F","value":"http:\u002F\u002Fsubjectify.us\u002F"}],"authorContacts":[{"title":"Сайт","url":"http:\u002F\u002Fcompression.ru\u002Fvideo\u002F","value":"http:\u002F\u002Fcompression.ru\u002Fvideo\u002F"},{"title":"Сайт","url":"https:\u002F\u002Fvideoprocessing.ai\u002F","value":"https:\u002F\u002Fvideoprocessing.ai\u002F"},{"title":"Сайт","url":"http:\u002F\u002Fvideocompletion.org\u002F","value":"http:\u002F\u002Fvideocompletion.org\u002F"},{"title":"Сайт","url":"http:\u002F\u002Fvideomatting.com\u002F","value":"http:\u002F\u002Fvideomatting.com\u002F"},{"title":"Сайт","url":"http:\u002F\u002Fsubjectify.us\u002F","value":"http:\u002F\u002Fsubjectify.us\u002F"}],"paymentDetails":{"paymentYandexMoney":"41001119611539","paymentPayPalMe":null,"paymentWebmoney":null},"id":"690199","alias":"3Dvideo","fullname":"Dmitriy Vatolin","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F05b\u002Feba\u002F901\u002F05beba9012f0fefe9a75c25ca46b40ff.png","speciality":"Современная обработка видео"},"statistics":{"commentsCount":123,"favoritesCount":131,"readingCount":32007,"score":144,"votesCount":144},"hubs":[{"relatedData":null,"id":"262","alias":"video","type":"collective","title":"Работа с видео","titleHtml":"Работа с видео","isProfiled":true},{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"21910","alias":"popular_science","type":"collective","title":"Научно-популярное","titleHtml":"Научно-популярное","isProfiled":false},{"relatedData":null,"id":"21922","alias":"artificial_intelligence","type":"collective","title":"Искусственный интеллект","titleHtml":"Искусственный интеллект","isProfiled":false},{"relatedData":null,"id":"22014","alias":"futurenow","type":"collective","title":"Будущее здесь","titleHtml":"Будущее здесь","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"2","alias":"design","title":"Дизайн"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fcf\u002Fqr\u002Fem\u002Fcfqrems_svzniipdihzqjse9x8w.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ этом году исполняется юбилей — 16 лет, как был запущен сайт compression.ru, на котором автор и сотоварищи организуют \u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FComparison_of_video_codecs\"\u003Eсравнения видеокодеков\u003C\u002Fa\u003E и кодеров изображений. За это время были проведены \u003Ca href=\"http:\u002F\u002Fcompression.ru\u002Fvideo\u002Fcodec_comparison\u002Findex_en.html\"\u003Eдесятки сравнений с отчетами от 23 до 550+ страниц\u003C\u002Fa\u003E, количество графиков в последнем сравнении перевалило за 7000, а количество разных феерических случаев за это время окончательно превысило все разумные пределы. Поскольку следующая круглая дата (32 года) наступит еще нескоро, есть желание рассказать в честь юбилея малую толику феерического.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли говорить про кодеки, то не секрет, что большинство сравнений и графиков, которые видит почтеннейшая публика — это продукт отдела маркетинга. В лучшем случае — графики грамотно делали инженеры, а маркетинг только давал добро на публикацию. В худшем случае инженеры вообще не участвовали в их подготовке. \u003Cs\u003EК чему тратить время этих занятых людей!\u003C\u002Fs\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПри этом тема сжатия весьма популярна. В \u003Ca href=\"https:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002F%D0%9A%D1%80%D0%B5%D0%BC%D0%BD%D0%B8%D0%B5%D0%B2%D0%B0%D1%8F_%D0%B4%D0%BE%D0%BB%D0%B8%D0%BD%D0%B0_(%D1%82%D0%B5%D0%BB%D0%B5%D1%81%D0%B5%D1%80%D0%B8%D0%B0%D0%BB)\"\u003Eсериале «‎Кремниевая долина»\u003C\u002Fa\u003E‎ стартап главного героя разработал гениальный алгоритм, который в последней серии первого сезона показал невероятное сжатие \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fusers\u002F3Dvideo\u002F\"\u003E3D видео\u003C\u002Fa\u003E и в итоге теперь миллионы стартаперов (и инвесторов) мира знают, что главное — это чтобы коэффициент Вайсмана был побольше и ещё гения надо найти, а остальное — фигня-вопрос. Чудо будет! Это естественным образом увеличивает ожидание чудес и, конечно (КОНЕЧНО!) эти чудеса радостно демонстрируются компаниями! В том числе с использованием последних достижений уличной магии. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003E\u003Cfont color=\"#ff0000\"\u003EDISCLAIMER: Любые совпадения имен и названий компаний ниже с реальными именами и названиями абсолютно случайны.\u003C\u002Ffont\u003E\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nУсаживайтесь поудобнее! Обещаем, что к концу рассказа вы сможете показывать подобные фокусы сами, как, впрочем, и раскрывать многие из них. Поехали! \u003Cbr\u002F\u003E\r\n\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003ELevel 1, фокусы для начинающих\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nНачнем с самого простого, ибо, как ни странно, эти методы вполне в современной (не сериальной, а настоящей!) Кремниевой долине прокатывают.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ci\u003EИтак, почтеннейшая публика, фокусы с демонстрацией сверхсильного сжатия начинаются!\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F160\u002F24d\u002Fed2\u002F16024ded279944b894b2b04da7f16295.png\"\u002F\u003E\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНаверняка многие видели подобные динамические сравнения \u003Cs\u003Eс незаметными котиками\u003C\u002Fs\u003E на основе JS на страницах. Если сравнивается сжатие, то разумно чтобы качество было максимально одинаково (в идеале совершенно одинаково), а справа было бы сжато в 2 раза лучше, например. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСказано — сделано! \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nКомпания заявляет на 30% лучшее сжатие (все совпадения случайны!). А картинки выглядят совершенно одинаково! Даже профессионально наметанный взгляд не находит различий. Возникает желание посмотреть детальнее. Лезем в код страницы и видим, что слайдер для первой и второй картинки берет данные из одного файла! Получаем преимущества сразу по нескольким параметрам — во-первых, идеально демонстрируется лучший результат, во-вторых, не отвлекали инженера от работы, и, наконец, это место страницы сайта грузится вдвое быстрее. \u003Cb\u003EСплошной profit!!!\u003C\u002Fb\u003E \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ci\u003EСлучай, не поверите, реальный. Теперь вы знаете, куда стоит посмотреть!\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ другом месте — тоже слайдер и опять замечательный результат. Заглядываем в код слайдера — грузятся разные файлы. Наученные горьким опытом скачиваем их — они не просто до байта одного размера, они совпадают побитно! В общем — все плюсы предыдущего способа, но фокус раскрывается чуть сложнее, правда за счет замедления загрузки страницы (за все приходится чем-то платить...). И, главное, не нужно привлекать дорогих специалистов в сжатии.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВпрочем, более продвинутые маркетологи этого уровня идут еще дальше. Выкладывается слайдер — смотришь — картинки отличаются, но качество о-о-очень похоже. Ну ок. Дальше больше! Демонстрируется фантастическая открытость — есть даже линки на видеофайлы. Скачиваешь — очень неплохое преимущество у их метода, даже непонятно, как они это сделали. Выручает то, что мы же тут все поголовно русские хакеры (уже бренд на западе). Смотрим битовый поток и видим чудную картину:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fca5\u002Ff58\u002Fb9a\u002Fca5f58b9aa1fbcaa9b9e81b1576020d2.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nТо есть даже многие эксперты, если не будут глубоко копать и перепроверять, подтвердят, что действительно у людей отличный результат примерно вдвое превосходящий по размеру сегодняшнего лидера при сравнимом качестве. Вы не поверите, подобные методы вполне себе используются и даже в некоторых случаях позволяют получить десятки миллионов долларов инвестиций. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ci\u003EВспоминается встреча с русским стартапом 6 лет назад. Их директор прямо с порога сказал: «‎Вы должны нам все сделать на совесть. У нас инвесторы из «‎Северстали»‎, и, если что, к вам выедут спортивные бритые ребята с паяльниками.»‎ Как вы понимаете, в таких суровых условиях качество исследовательской работы волшебным образом возрастает, а количество фокусов разного уровня — падает… При работе с такими кейсами у нас, на родине слонов, возникает непреодолимое чувство жалости к западным инвесторам. Правда не все наши инвесторы такие чисто конкретные, и свои фокусники и в наших палестинах тоже находятся. Причем регулярно. Но про это в другой раз...\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003ELevel 7, резонансный\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nЭта история не про видеокодек, а про сжатие картинок, но в ней многое было по всем законам жанра «‎честных фокусов»‎.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nКак-то довольно известная компания М решила, что им к своим форматам Windows Media Video (WMV) и Windows Media Audio (WMA) нужно добавить Windows Media Photo (WMP). Чисто для комплекта, как вы понимаете. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ci\u003EМолодой человек на галёрке! Ну не надо так громко кричать, не вас одного осенило! Культурные люди (посмотрите на первый ряд) максимум — понимающе усмехнулись в усы…\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСказано — сделано!\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДалее внимательно следим за руками:\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Ff7d\u002Fa54\u002Fecf\u002Ff7da54ecf22620640daed4ad80cebfd2.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТ.е. у WMP больше деталей, чем у JPEG и JPEG 2000 при том же уровне сжатия (мягко уравниваются JPEG и JPEG 2000 и задается уровень 24 раза), а \u003Ca href=\"https:\u002F\u002Fwww.cnet.com\u002Fnews\u002Fmicrosoft-shows-off-jpeg-rival-1\u002F\"\u003Eв следующем абзаце\u003C\u002Fa\u003E:\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F5c4\u002F3ca\u002F3b6\u002F5c43ca3b6f7f8f21245c3c0c2fad4c4a.png\"\u002F\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F547\u002Fd95\u002F10d\u002F547d9510d1d57dc45709ed07214d37c0.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nТ.е. обычно только в 6 раз сжимают, а было 24. Вау, пахнет тремя разами! И вообще мы лучше в 2 раза точно. СМИ понесли благую весть в массы (некоторые написали, что в 2 раза лучше JPEG 2000), даже \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F15793\u002F\"\u003Eна Хабре повторили эту новость\u003C\u002Fa\u003E. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЧуть позднее появился график из этой презентации:\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F4e2\u002F14d\u002Fbe8\u002F4e214dbe8f0f2a0e8a18c78bdbb432c1.png\" data-width=\"75%\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EКак интерпретировать такие графики?\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F698\u002Fa99\u002F6be\u002F698a996be23d64bac98b77669dea5cbc.png\" data-width=\"75%\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nПо вертикали обычно идет качество (какая-то из метрик в зависимости от моды в этот момент времени), по горизонтали — так или иначе — размер. Обычно с увеличением размера качество растет (хотя на практике всякое бывает). По линии одинакового качества (красная горизонтальная) можно прикинуть, что «‎пурпурный»‎ кодек примерно в 2 раза проигрывает по размеру «‎синему»‎ при том же качестве на этом диапазоне битрейтов.\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПреимущество по сравнению с JPEG 2000 было небольшим, при том, что они, очевидно, отобрали лучшую картинку с чудным мальчиком и дельфинами. Мы с большим нетерпением ждали возможности поиграться с этим кодером. Примерно через полгода утилиту для сжатия таки выложили.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nУ нас к тому моменту как раз было годичной давности \u003Ca href=\"http:\u002F\u002Fwww.compression.ru\u002Fvideo\u002Fcodec_comparison\u002Fpdf\u002Fjpeg2000_codec_comparison_en.pdf\"\u003Eсравнение 9 реализаций JPEG 2000 \u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ci\u003EДа-да-да! Как не все йогурты одинаково полезны, так и не все реализации стандарта жмут одинаково хорошо. \u003Ca href=\"https:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002FMPEG\"\u003EСтандарт\u003C\u002Fa\u003E оговаривает только битовый поток, положить в который данные (и, кстати, вынуть!) можно сильно по-разному, это порождает отдельный рынок \u003Ca href=\"https:\u002F\u002Fru.wikipedia.org\u002Fwiki\u002FXvid\"\u003Eкодеков\u003C\u002Fa\u003E со своей жесткой конкуренцией по доброму десятку параметров. Простой пипл этого, как правило, не знает, что позволяет безнаказанно ездить ему по ушам практически на бульдозере («‎Наш видеорегистратор поддерживает новейший H.265\u002FHEVC, больше его ни у кого нет!»‎). И никто (никто!) КРАЙНЕ вероятной подставы не замечает.\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nМы радостно вставили в предыдущий отчет 3 линии для WMP. Получилось как-то так:\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fd26\u002Fa37\u002F663\u002Fd26a3766375fe7cb586d311052ea3004.png\" data-width=\"75%\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nВидно, что линии реализаций JPEG 2000 идут довольно кучно и у жирной синей (лучшая реализация WMP) результаты где-то посередине, т.е. ПРОИГРЫВАЕТ JPEG 2000. Если взять JASPER за ноль и все по вертикали относительно него показать, то видно, что WMP с худшим параметром проигрывает почти всем, кроме двух последних (одна из них KDU, запомним это), а с лучшим — лежит где-то по центру, проигрывая многим реализациям:\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F872\u002F3df\u002F41a\u002F8723df41ac59b0938bb45af01b2ab80e.png\" data-width=\"75%\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nПоскольку сравнение было выложено публично и наделало шуму в узких кругах, то разработчик даже ответил на него \u003Ca href=\"https:\u002F\u002Fblogs.msdn.microsoft.com\u002Fbillcrow\u002F2006\u002F10\u002F20\u002Fmsu-evaluates-windows-media-photo-vs-jpeg-2000\u002F\"\u003Eв официальном блоге\u003C\u002Fa\u003E. Заметка была вежливая: похвалили, покритиковали, а дальше, если продраться сквозь текст, человек чистосердечно признался, что они использовали самую худшую реализацию JPEG 2000 нашего сравнения (опубликованного за полгода до того) в своем сравнении, правда «‎совершенно случайно»‎. Мы, конечно, им поверим. Компания уважаемая и все такое. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДальше название технологии было изменено с WMP на HD Photo, впрочем в сети остался \u003Ca href=\"https:\u002F\u002Fblog.codinghorror.com\u002Fbeyond-jpeg\u002F\"\u003Eтакой вердикт\u003C\u002Fa\u003E:\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F03c\u002F3bb\u002F47a\u002F03c3bb47a18b7628ec97797cc9c718c3.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\nВ качестве вишенки на торт. Наши коллеги пошли дальше: взяли больше картинок и показали, что HD Photo проигрывает не только JPEG 2000, но и хорошей реализации JPEG (\u003Ca href=\"http:\u002F\u002Fimagecompression.info\u002Flossy\u002F\"\u003Eв 7 случаях из 14\u003C\u002Fa\u003E). И проигрывает конкретно. Есть основания полагать, что они подбирали картинки, но они откровенно закопали HDPhoto, ибо кому нужен формат, который в половине случаев проигрывает древнему JPEG — непонятно:\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F133\u002F5b1\u002F5ac\u002F1335b15ac516afcd8d2a4ef46905adab.png\" data-width=\"75%\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nИтого, секреты этого фокуса:\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003EБерем худшую реализацию основного конкурента, сравниваем с ней.\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003Cli\u003EСоздаем рекламную шумиху (в стиле «‎мы всех сильно обогнали»‎).\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003Cli\u003EКогда шумиха отходит на второй план, делаем релиз и надеемся, что никто не проверит, что там было на самом деле.\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Ci\u003EДети! Никогда так не делайте и не обманывайте других! Ваша компания может потерять миллионы долларов и доверие специалистов.\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003ELevel 10, свежий! С нейросетями!\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nВообще подобных случаев — очень много. Даже в России я сталкиваюсь с подобными ситуациями примерно пару раз в год (к нам, как к хозяевам compression.ru, информация стекается). На западе разводят \u003Cs\u003Eлохов\u003C\u002Fs\u003E инвесторов примерно ежемесячно. А сейчас еще и Китай к этому развлечению подключился. Мощность компьютеров растет, сложность и возможности алгоритмов — тоже. Разбираться в этом все сложнее. Как следствие — бурное веселье продолжается! \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ последнее время очень популярны стали нейросети. Абсолютно все, к чему они прикасаются, волшебным образом улучшается. А не применить ли их к сжатию видео?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСказано — сделано! \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ ноябре прошлого года очередная благая весть \u003Ca href=\"https:\u002F\u002Fwww.wsj.com\u002Farticles\u002Factual-silicon-valley-startup-gets-inspiration-from-hbos-silicon-valley-startup-1542391937\"\u003Eс подачи самого «Уолл Стрит Джорнал»\u003C\u002Fa\u003E облетела мир. Создан видеокодек на основе машинного обучения, который всех порвал! Вот пруф:\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fb94\u002F088\u002Fdbb\u002Fb94088dbb1df5202c298e7caa7397eb5.png\" data-width=\"75%\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Ci\u003EВообще я лично крайне скептически воспринимаю все новости с упоминанием нейросетей. И вам советую (ОСОБЕННО, если вы инвестор). Нейросети устроены таким образом, что грамотно подбирая обучающую выборку под тестовую можно показать любой (для непонятливых — ЛЮБОЙ!) желаемый результат. Нейросети — идеальный инструмент для постановки на поток маркетинговых чудес. Одно чудеснее другого!\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ общем график есть, картинки есть. Согласитесь — убедительно. Специально для скептиков господа привели еще несколько графиков на известных тестовых наборах:\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fdee\u002F4e1\u002F640\u002Fdee4e1640e8e11ce84fb4963ea5a1805.png\" data-width=\"75%\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F0e1\u002F928\u002Fdab\u002F0e1928dab2d19e3e19c0265a4a75f949.png\" data-width=\"75%\"\u002F\u003E\u003Cbr\u002F\u003E\r\nВпрочем, если предыдущий график с картинками лично для меня был еще как-то объясним (заточиться на одно видео да еще с глубокими нейросетями можно всегда), то эти два графика заставили резко насторожиться. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ci\u003EВас в них ничего не смущает?\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EОтвет\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E Из них следует, что за десять лет с принятия стандарта H.264 до принятия H.265 особого развития кодеков не происходило! Эти тупые исследователи 10 лет топтались на месте и делали более медленные кодеки, которые сжимают так же!!! Разница — 20% максимум, а то и меньше!!! 8-\\ \u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nОни даже под это подводят базу, типа классические кодеки уперлись в предел и уже особо не развиваются (и тут на сцену выходят они, все в белом). И вы знаете, такая наглая ложь прекрасно работает! Причем ладно \u003Ca href=\"https:\u002F\u002Fwww.wsj.com\u002Farticles\u002Factual-silicon-valley-startup-gets-inspiration-from-hbos-silicon-valley-startup-1542391937\"\u003E«The Wall Street Journal»\u003C\u002Fa\u003E — они (хотелось бы верить) только в финансах разбираются, ладно \u003Ca href=\"https:\u002F\u002Fwww.technologyreview.com\u002Fs\u002F612462\u002Fdeep-learning-will-help-keep-video-from-clogging-up-the-internet\u002F\"\u003E«MIT Technology Review»\u003C\u002Fa\u003E — эти джентльмены джентльменам Кремниевой долины верят на слово, но как некритически воспринял новость такой уважаемый ресурс, как \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F431354\u002F\"\u003EХабр\u003C\u002Fa\u003E — ума не приложу! Чего уж говорить про массово перепечатавших новость …\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ реальности картина развития кодеков, к счастью, заметно отличается. Во-первых, на графике ниже, построенном нами \u003Cb\u003E\u003Ci\u003Eна том же\u003C\u002Fi\u003E\u003C\u002Fb\u003E наборе видео xiph, можно увидеть, что H.265 на 25−31% лучше, чем H.264. Т.е. 10 лет развития кодеков таки не прошли даром! (\u003Ci\u003EУфф, прямо от сердца отлегло...\u003C\u002Fi\u003E) Во-вторых, свежий AV1 показывает практически двукратное улучшение по сравнению с H.264, и ступенька его преимущества, прямо скажем, весьма заметна:\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F669\u002F483\u002F9f5\u002F6694839f57118c38b289c5f8dbbe0fc0.png\" data-width=\"75%\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСоответственно на глаз видно, что если наложить график AV1 на 45% левее H.264 на графике авторов — он покроет новый кодек как… [вырезано цензурой]. Хорошо покроет, короче. Потому с ним и «‎забыли»‎ сравниться. Реальный расклад выглядит как-то так (сильно менее кучно, согласитесь):\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F720\u002Ff71\u002F3d6\u002F720f713d6b6fc7d36a8bb9f01451b825.png\" data-width=\"75%\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nЧтобы было понятно — у кодеков есть стандартные пресеты, которые позволяют варьировать скорость в значительных пределах (часто десятки раз), но при этом достигать большего сжатия при том же качестве (часто больше 2 раз). У x265 (очень неплохой open-source реализации стандарта \u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FHigh_Efficiency_Video_Coding\"\u003EHEVC\u003C\u002Fa\u003E) они называются: ultrafast, superfast, veryfast, faster, fast, medium, slow, slower, veryslow, placebo. Если взять medium за 1, то по скорости и размеру файла при том же качестве они для конкретного файла могут располагаться, например, как на графике ниже. Можно говорить, что относительно medium можно сделать файл на 40% больше или меньше, варьируя скорость в 10 раз:\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Ffaa\u002Fe6d\u002F5cc\u002Ffaae6d5cc5349d82c1f963c68c01dd9b.png\" data-width=\"75%\"\u002F\u003E\u003C\u002Fdiv\u003EЗаметим, что для некоторых видео стандартные опции не обязательно идут монотонно (в данном случае по качеству). Также иногда «‎нестандартные»‎ опции \u003Ca href=\"http:\u002F\u002Fcompression.ru\u002Fvideo\u002Fvideo_codec_optimization\u002F\"\u003Eмогут дать большой выигрыш по размеру\u003C\u002Fa\u003E, в частности на примере выше потеряв 20% по скорости по сравнению с medium можно наиграть 30% по размеру — практически как при переходе на стандарт следующего уровня, но при прежней невысокой сложности декодера. Но это уже более сложный level, о нем в другой раз. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nКак легко заметить выше, господа взяли для сравнения «slower». Хорошо, что не «veryfast», ведь могли бы и его! ) И не важно, что у них у самих кодек феерически медленный. Люди в массе своей, глядя на график, не вспоминают о том, что скорость работы кодека может \u003Ci\u003Eна пару порядков\u003C\u002Fi\u003E отличаться в зависимости от параметров. Поэтому такой прием вполне прокатывает. Хотя на нашем графике выше («Bitrate\u002Fquality...») их пачка линий была в районе красной (которая самая плохая). Заодно оправдывая топтание на месте в развитии кодеков. Ага-ага!\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсть и более тонкие подтасовки, например, господа пишут: «To remove B-frames, we use H.264\u002F5 with the bframes=0 option, VP9 with -auto-alt-ref 0 -lag-in-frames 0, and use the HM encoder lowdelay P main.cfg profile.» То есть они не смогли побить обычные кодеки в честном соревновании и выбрали low-latency режим с низкой задержкой, который используется обычно для реального времени, например, для видеоконференций. Результаты кодека в нем хуже, естественно. При этом их декодер (про энкодер промолчим) работает 2 секунды на кадр, то есть ни о каком low-latency даже близко говорить нельзя. Зато еще несколько процентов наиграли.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЭто не все трюки, которые были использованы господами стартаперами, но картина уже ясна. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПонятно, что, чтобы фокус выглядел правдоподобно, нужны еще дополнительные штрихи, которые придают реализма. Например, эти господа опубликовали статью на \u003Ca href=\"https:\u002F\u002Farxiv.org\u002Fabs\u002F1811.06981\"\u003Ehttps:\u002F\u002Farxiv.org\u002Fabs\u002F1811.06981\u003C\u002Fa\u003E. Сегодня развитие алгоритмов идет настолько быстро, что ждать, пока выйдет статья в журнале становится нестерпимо, поэтому многие сильные авторы публикуют результаты сначала на arxiv.org. Для уличных магов этот сайт удобен тем, что там можно разместить абсолютно любой материал — в отличие от рецензируемых журналов и конференций никто не задаст неприятных вопросов и не зарубит публикацию (нет kill reviewing серьезных мест). А про то, что, например, на 1 апреля на arxiv.org принято публиковать разного рода пародии на научные статьи, в том числе высмеивая его как место публикаций, широкая публика не знает, поэтому для широкой публики публикация там выглядит типа даже солидно.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nИдем дальше. Статья на хабре про них называлась «‎\u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F431354\u002F\"\u003EПервый видеокодек на машинном обучении кардинально превзошел все существующие кодеки, в том числе H.265 и VP9»‎\u003C\u002Fa\u003E. Очередной прикол заключается в том, что машинное обучение в сжатии не только активно исследуется, чему уже посвящаются \u003Ca href=\"https:\u002F\u002Fwww2.securecms.com\u002FPCS2018\u002FPapers\u002FPublicSessionIndex3.asp?Sessionid=1000\"\u003Eотдельные треки конференций\u003C\u002Fa\u003E (то есть \u003Ci\u003Eстатей много\u003C\u002Fi\u003E), но и активно \u003Ca href=\"https:\u002F\u002Fwww.google.com\u002Fsearch?q=%22av1%22+encoder+machine+learning\"\u003Eиспользуется, например, в AV1\u003C\u002Fa\u003E (специально привожу гугловый запрос). Но, если бы они честно сказали: «‎Мы выпустили второй кодек с использованием машинного обучения, при этом проиграв первому и по скорости, и по сжатию»‎, то Wall Street Journal мог про них и не написать… И MIT TechReview не написал бы… И даже Хабр… Очевидно, не вынеся последнего, в компании \u003Ci\u003Eчуть-чуть\u003C\u002Fi\u003E поправили подачу. При этом особенностью современного интернета является то, что люди не проверяют информацию, что позволяет спокойно провозглашать себя первыми много кому (начиная с известных компаний). Наглость, как известно, города берет! А фактчекинг не моден.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ci\u003E— Загугли!\u003Cbr\u002F\u003E\r\n— Это как это?\u003Cbr\u002F\u003E\r\n[пример запроса дан выше)))]\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nИ еще про ML\u002FDL. В далекие-далекие времена, когда дискеты были большими, а винчестеры маленькими, одним из приемов «‎уличной магии для архиваторов»‎ было сохранить часть сжимаемого файла куда-нибудь подальше в директорию со временными файлами и таким образом показать рекорд. С тех пор времена изменились. Винчестеры — выросли, дискеты совсем пропали, а данные стало модно прятать вглубь нескольких сотен мегабайт коэффициентов сетки. Можно сохранить «‎авторский знак»‎ в сетке, можно — пасхалку, а можно фейковый рекорд сжатия поставить. Глубокие нейросети — однозначно сила, короче!\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nРезюмируя данный путь к успеху:\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003EИгнорируем современного лидера так, будто его вообще нет.\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003Cli\u003EАккуратно формулируем все так, чтобы читалось будто мы первые использовали какую-нибудь новую технологию (и даже если первый это сделал лидер — никто проверять не будет).\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003Cli\u003EУ стандартов 5− и 15−летней давности откручиваем ручки так, чтобы они работали хуже нас.\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003Cli\u003EПобольше наглости — обосновываем то, что они легли кучно позади нас тем, что они уперлись в предел и уже не развиваются.\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003Cli\u003EПубликуемся в «The Wall Street Journal» и на Хабре…\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Ci\u003EИ… (барабанная дробь!)… вам дают еще несколько миллионов долларов! Или не дают… Я бы не давал… Инвесторы! Не спать! А то потом опять будете на воду дуть...\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EА теперь мастер-класс!\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nКак я и обещал выше, к концу этого текста вы сможете легко блистать на подмостках условного pikabu. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ci\u003EСейчас, о почтеннейшая публика, я покажу вам фокус, позволяющий сравнивать, что угодно с чем угодно с любым заранее заданным результатом. Т.е. если надо, чтобы кодек А был лучше кодека Б — значит покажем это, если нужно, чтобы Б был лучше А, хорошо, можем показать и это. Исполним любой каприз отдела маркетинга \u003Cs\u003Eза ваши деньги\u003C\u002Fs\u003E совершенно бесплатно! \u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДавайте сами проверим, как эти самые кодеки жмут. Как говорится — не верь никому, проверь сам. А то, может, и правда эти стандарты не развиваются и нас просто дурят, заставляя зря платить заработанные непосильным трудом деньги непонятно за что? \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВозьмем «‎Аватар»‎ в формате 480p24 и сожмем его кодеком x264 c настройками \"-preset superfast -x264-params «nal-hrd=cbr» -b:v 1M -minrate 1M -maxrate 1M -bufsize 2M\" и кодеком xvid с настройками \"-preset superfast -b:v 1M -minrate 1M -maxrate 1M -bufsize 2M\" (две очень неплохие open-source реализации стандартов H.264 и MPEG-4). Почему взяты эти кодеки и настройки будет объяснено позднее.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nУ нас получились два файла почти одного размера:\u003Cbr\u002F\u003E\r\navatar_x264_cbr1M_superfast.mkv — 1402 MB\u003Cbr\u002F\u003E\r\navatar_xvid_cbr1M_superfast.mkv — 1401 MB\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ci\u003EА теперь, дамы и господа! Внимательно следите за руками!!!\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСмотрим, вот новый стандарт и старый:\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F333\u002Fcb0\u002Fa85\u002F333cb0a85d929aee14267c52daf88261.png\" data-width=\"50%\"\u002F\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fbd8\u002F13b\u002F243\u002Fbd813b2436a77e56628f44a416e85a3a.png\" data-width=\"50%\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСмотрим другой кадр:\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F08d\u002F9e4\u002Fa6d\u002F08d9e4a6d585e69efe7fae22118bad06.png\" data-width=\"50%\"\u002F\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F1fc\u002Ff37\u002Fd2d\u002F1fcf37d2d45986f6e36259ebc1dd3e43.png\" data-width=\"50%\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Ci\u003EБез комментариев! А если быстрое движение?\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fa51\u002Fceb\u002F2ab\u002Fa51ceb2ab0905dcebe7a58e0cd744f41.png\" data-width=\"50%\"\u002F\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Fde6\u002F1e2\u002F8ed\u002Fde61e28ed4a63094c5bd2dfb0393fb2b.png\" data-width=\"50%\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСогласитесь! Прогресс явный и неумолимый! Все развивается и становится все лучше и лучше! А жизнь \u003C\u002Fi\u003E—\u003Ci\u003E краше и веселее!\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nХотя… \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F293\u002Fe52\u002F598\u002F293e52598e14e1b1b62f3a9ceab12f9f.png\" data-width=\"50%\"\u002F\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F556\u002F62a\u002Fb48\u002F55662ab486e914fbca85af43a1da2860.png\" data-width=\"50%\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nБоже, что это??? Новый стандарт совсем слил…\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Ffb8\u002F181\u002F71c\u002Ffb818171cad436993ca5fb1be4f16dc8.png\" data-width=\"50%\"\u002F\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F889\u002F137\u002F425\u002F889137425623b25d7f4fb92d67b40589.png\" data-width=\"50%\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nА-а-а-а! Люди! Знайте! Корпорации вас обманывают!!! Кодеки уже давно не развиваются, но вам сообщают что все идет хорошо!\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F7e2\u002F3a7\u002Ff4d\u002F7e23a7f4df74d138098ffaf5f6caea61.png\" data-width=\"50%\"\u002F\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F02c\u002Ff0c\u002F639\u002F02cf0c639bdb1a2f337305c14ff86e9e.png\" data-width=\"50%\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВы видите? Все, чему они научились за 10 лет — это размывать блочность! Причем делают это просто отвратительно! Стало хуже, чем было! Вас водят за нос все эти годы!!!!!!!11\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nА теперь разберемся, как это сделано.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа самом деле полный кадр выглядит так:\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F6b3\u002F545\u002F17d\u002F6b354517d00814640a78209d92c23be8.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\nКогда кодек работает, особенно в режиме постоянного битрейта, качество кадров достаточно сильно колеблется. Вот начало фильма, например — качество по классической метрике \u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FPeak_signal-to-noise_ratio\"\u003EPSNR\u003C\u002Fa\u003E (сомнений кто лучше, кто хуже, кстати, нет, видно что зеленый xvid проигрывает в среднем):\u003Cbr\u002F\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F_h\u002Fv_\u002Fjz\u002F_hv_jzpjxj-ve3kkmalz2k17vo4.png\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F_h\u002Fv_\u002Fjz\u002F_hv_jzpjxj-ve3kkmalz2k17vo4.png\"\u002F\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ci\u003E Картинка кликается \u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли вычесть один график из другого (на рисунке ниже, другое место в файле) — то видно, что в целом кодек более старого стандарта будет проигрывать, однако местами он может вполне уходить на +5 dB (PSNR удобна тем, что она обратно логарифмически пропорциональна среднеквадратичному отклонению, за счет чего, обычно, работает правило: на диапазоне средних и низких битрейтов на глаз видна разница в 1.5 dB). И тут же виден кадр, где в другую сторону разница 20 dB:\u003Cbr\u002F\u003E\r\n\u003Ca href=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fls\u002Fsn\u002Fbe\u002Flssnbevnse0hidehiryouacpxl4.png\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fls\u002Fsn\u002Fbe\u002Flssnbevnse0hidehiryouacpxl4.png\"\u002F\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ci\u003E Картинка кликается \u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ci\u003EТеперь вы понимаете, почему ваш покорный слуга всегда с искренним умилением смотрит на приведенные в маркетинговых материалах компаний отдельные кадры, как на доказательство более высокого качества на видео (особенно когда нет графиков)… И ведь так до сих пор иногда приводят! \u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЧтобы отбирать кадры было проще, мы больше 10 лет назад сделали режим сравнения в нашей тулзе \u003Ca href=\"http:\u002F\u002Fwww.compression.ru\u002Fvideo\u002Fquality_measure\u002Fvideo_measurement_tool.html\"\u003EMSU VQMT\u003C\u002Fa\u003E, при котором сравнивались сразу 3 файла — оригинал, кодек-1 и кодек-2 и сразу сохранялись, например, 30 лучших пар кадров в одну или в другую сторону. Главное — взять файл подлиннее! \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nА MPEG-4 с низким битрейтом был взят, чтобы с блочностью было все нагляднее. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nИтого, путь к успеху:\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003EВыбираем режим, при котором колебание качества у кодеков максимально (обычно, однопроходный CBR).\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003Cli\u003EУменьшаем разрешение исходника в 2 раза (ибо скорее всего придется увеличивать фрагменты, например выше фрагменты были увеличены в 3 раза)\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003Cli\u003EБерем какую-нибудь метрику (\u003Ca href=\"https:\u002F\u002Fwww.google.com\u002Fsearch?q=PSNR+metric+program\"\u003EPSNR\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fwww.google.com\u002Fsearch?q=SSIM+metric+program\"\u003ESSIM\u003C\u002Fa\u003E, модную в этом сезоне \u003Ca href=\"https:\u002F\u002Fwww.google.com\u002Fsearch?q=VMAF+metric+program\"\u003EVMAF\u003C\u002Fa\u003E).\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003Cli\u003EБерем в качестве сравнения старый стандарт с блочностью или отключаем внутренний деблокинг у конкурента опциями.\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003Cli\u003EИ последнее, не забываем взять файл подлиннее: 3 часа фильма — самое оно!\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\nИ БИНГО! У вас несколько примеров насколько вы лучше конкурента!\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНу или где-нибудь, где публика не слишком разборчива, можно кого-нибудь с кем-нибудь успешно сравнить. Пипл будет доволен.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ci\u003EТеперь вы знаете, какие вопросы задавать, когда видите сравнение с кадрами в материалах компаний! Может хоть пореже, наконец, они будут встречаться...\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EВместо заключения\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nВыше разбирались относительно простые способы подготовки маркетинговых материалов «в свою пользу» в сравнениях кодеков и кодеров. Естественно, в реальной жизни все сложнее. Увы, если идти глубже, оно будет не так увлекательно и заметно сложнее (желающие могут почитать \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F388423\u002F\"\u003Eстатью и комментарии тут\u003C\u002Fa\u003E, например). \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nА людей, обычно, интересуют простые ответы. Самый популярный ответ в Ответы@Mail.ru на вопрос ‎\u003Ca href=\"https:\u002F\u002Fotvet.mail.ru\u002Fquestion\u002F6580477\"\u003E«Какой самый лучший видеокодек?»‎\u003C\u002Fa\u003E — «K-Lite Mega Codec Pack». И это для массового зрителя действительно самый короткий, понятный и точный ответ. А вы говорите — кодеки, стандарты…\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНо чем больше будет людей, хотя бы на среднем уровне разбирающихся в предмете, тем реже будут совсем уж нахально лапшу на уши вешать отделы маркетинга или дуть в уши инвесторам нахальные стартаперы. И жизнь станет чуточку лучше.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ci\u003EСпасибо за внимание, дамы и господа! Всем — технической грамотности!\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EБлагодарности\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003EХотелось бы сердечно поблагодарить:\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003EЛабораторию Компьютерной Графики ВМК МГУ им. М.В.Ломоносова за вклад в развитие компьютерной графики в России и не только,\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003Cli\u003Eнаших коллег из видеогруппы, в том числе Сергея Звездакова, Анастасию Анциферову и Романа Казанцева, чьи примеры использованы выше,\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003Cli\u003Eперсонально Константина Кожемякова, который сделал очень много для того, чтобы эта статья стала лучше и нагляднее,\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003Cli\u003Eи, наконец, огромное спасибо Сергею Лаврушкину, Егору Склярову, Ивану Молодецких, Евгению Ляпустину, Дмитрию Куликову, Александре Анзиной, Виталию Людвиченко, Михаилу Ерофееву и Георгию Осипову за большое количество дельных замечаний и правок, сделавших этот текст намного лучше!\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"сжатие"},{"titleHtml":"видео"},{"titleHtml":"кодек"},{"titleHtml":"сравнение кодеков"},{"titleHtml":"нейросети"},{"titleHtml":"x264"},{"titleHtml":"x265"},{"titleHtml":"xvid"},{"titleHtml":"compression"},{"titleHtml":"video codecs"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F451664\u002F88849794c6c15df911597cfda143494f\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F451664\u002F88849794c6c15df911597cfda143494f\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F451664\\\u002F\"},\"headline\":\"Уличная магия сравнения кодеков. Раскрываем секреты\",\"datePublished\":\"2019-05-28T08:58:08+03:00\",\"dateModified\":\"2019-05-28T12:16:38+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Dmitriy Vatolin\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"В этом году исполняется юбилей &mdash; 16 лет, как был запущен сайт compression.ru, на котором автор и сотоварищи организуют сравнения видеокодеков и кодеров изображ...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F451664\\\u002F#post-content-body\",\"about\":[\"h_video\",\"h_programming\",\"h_popular_science\",\"h_artificial_intelligence\",\"h_futurenow\",\"f_develop\",\"f_design\",\"f_popsci\"],\"image\":[\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fcf\\\u002Fqr\\\u002Fem\\\u002Fcfqrems_svzniipdihzqjse9x8w.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F160\\\u002F24d\\\u002Fed2\\\u002F16024ded279944b894b2b04da7f16295.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fca5\\\u002Ff58\\\u002Fb9a\\\u002Fca5f58b9aa1fbcaa9b9e81b1576020d2.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Ff7d\\\u002Fa54\\\u002Fecf\\\u002Ff7da54ecf22620640daed4ad80cebfd2.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F5c4\\\u002F3ca\\\u002F3b6\\\u002F5c43ca3b6f7f8f21245c3c0c2fad4c4a.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F547\\\u002Fd95\\\u002F10d\\\u002F547d9510d1d57dc45709ed07214d37c0.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F4e2\\\u002F14d\\\u002Fbe8\\\u002F4e214dbe8f0f2a0e8a18c78bdbb432c1.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F698\\\u002Fa99\\\u002F6be\\\u002F698a996be23d64bac98b77669dea5cbc.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fd26\\\u002Fa37\\\u002F663\\\u002Fd26a3766375fe7cb586d311052ea3004.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F872\\\u002F3df\\\u002F41a\\\u002F8723df41ac59b0938bb45af01b2ab80e.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F03c\\\u002F3bb\\\u002F47a\\\u002F03c3bb47a18b7628ec97797cc9c718c3.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F133\\\u002F5b1\\\u002F5ac\\\u002F1335b15ac516afcd8d2a4ef46905adab.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fb94\\\u002F088\\\u002Fdbb\\\u002Fb94088dbb1df5202c298e7caa7397eb5.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fdee\\\u002F4e1\\\u002F640\\\u002Fdee4e1640e8e11ce84fb4963ea5a1805.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F0e1\\\u002F928\\\u002Fdab\\\u002F0e1928dab2d19e3e19c0265a4a75f949.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F669\\\u002F483\\\u002F9f5\\\u002F6694839f57118c38b289c5f8dbbe0fc0.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F720\\\u002Ff71\\\u002F3d6\\\u002F720f713d6b6fc7d36a8bb9f01451b825.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Ffaa\\\u002Fe6d\\\u002F5cc\\\u002Ffaae6d5cc5349d82c1f963c68c01dd9b.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F333\\\u002Fcb0\\\u002Fa85\\\u002F333cb0a85d929aee14267c52daf88261.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fbd8\\\u002F13b\\\u002F243\\\u002Fbd813b2436a77e56628f44a416e85a3a.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F08d\\\u002F9e4\\\u002Fa6d\\\u002F08d9e4a6d585e69efe7fae22118bad06.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F1fc\\\u002Ff37\\\u002Fd2d\\\u002F1fcf37d2d45986f6e36259ebc1dd3e43.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fa51\\\u002Fceb\\\u002F2ab\\\u002Fa51ceb2ab0905dcebe7a58e0cd744f41.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Fde6\\\u002F1e2\\\u002F8ed\\\u002Fde61e28ed4a63094c5bd2dfb0393fb2b.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F293\\\u002Fe52\\\u002F598\\\u002F293e52598e14e1b1b62f3a9ceab12f9f.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F556\\\u002F62a\\\u002Fb48\\\u002F55662ab486e914fbca85af43a1da2860.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Ffb8\\\u002F181\\\u002F71c\\\u002Ffb818171cad436993ca5fb1be4f16dc8.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F889\\\u002F137\\\u002F425\\\u002F889137425623b25d7f4fb92d67b40589.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F7e2\\\u002F3a7\\\u002Ff4d\\\u002F7e23a7f4df74d138098ffaf5f6caea61.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F02c\\\u002Ff0c\\\u002F639\\\u002F02cf0c639bdb1a2f337305c14ff86e9e.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F6b3\\\u002F545\\\u002F17d\\\u002F6b354517d00814640a78209d92c23be8.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F_h\\\u002Fv_\\\u002Fjz\\\u002F_hv_jzpjxj-ve3kkmalz2k17vo4.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fls\\\u002Fsn\\\u002Fbe\\\u002Flssnbevnse0hidehiryouacpxl4.png\"]}","metaDescription":"В этом году исполняется юбилей — 16 лет, как был запущен сайт compression.ru, на котором автор и сотоварищи организуют сравнения видеокодеков и кодеров изображений. За это время были проведены...","mainImageUrl":null,"amp":true},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":"video,programming,popular_science,artificial_intelligence,futurenow"},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
