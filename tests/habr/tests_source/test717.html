<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Поиск пути среди круглых препятствий / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/451642\/"},"headline":"Поиск пути среди круглых препятствий","datePublished":"2019-05-15T12:05:28+03:00","dateModified":"2019-05-15T19:32:50+03:00","author":{"@type":"Person","name":"PatientZero"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Навигация по лесу Алгоритм поиска пути A* &mdash; это мощный инструмент для быстрой генерации оптимальных путей. Обычно A* демонстрируют при навигации по картам из сет...","url":"https:\/\/habr.com\/ru\/post\/451642\/#post-content-body","about":["h_programming","h_gamedev","h_algorithms","f_develop"],"image":["https:\/\/habrastorage.org\/webt\/56\/el\/cv\/56elcvzdfv_ggmypuirpqwr3k1u.png","https:\/\/habrastorage.org\/webt\/o4\/ol\/le\/o4ollekxzlr3gchklwsb9qc-yfc.png","https:\/\/habrastorage.org\/webt\/y9\/bg\/hp\/y9bghpeee4olqqeduhnxhx_9ii8.png","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/ff2\/c64\/99d\/ff2c6499d038a61a41d7ce75cd78788f.svg","https:\/\/habrastorage.org\/webt\/er\/_n\/c3\/er_nc3arspfrz_r70ofttmjgekk.png","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/493\/c1c\/008\/493c1c008018df9bed4910321f29ff00.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/20d\/8ca\/ec6\/20d8caec693d8d8eaf70885e408419f6.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/5fa\/a21\/bad\/5faa21badaafeb989d7de242c31a04e3.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/87e\/544\/4f6\/87e5444f6bd7417684066f4c28a56c96.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/35e\/a85\/36b\/35ea8536b3e6152e60442ccecbc46812.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/872\/703\/d45\/872703d458fc8787c1a2ce98adc0c7a3.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/47e\/792\/77d\/47e79277dc17c254743475ff05980a53.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/c5e\/2ea\/3b6\/c5e2ea3b63d255f7a483773fe1d664b2.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/d4f\/55a\/37f\/d4f55a37fb733b176d0ef014591e1b35.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/b8b\/97c\/656\/b8b97c6567171cc2b6a7f303a0fa8b0a.svg","https:\/\/habrastorage.org\/webt\/bc\/fd\/s-\/bcfds-ush6unllsd497vq6fng6u.png","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/2be\/33a\/e72\/2be33ae72ada1a05087952910c245c75.svg","https:\/\/habrastorage.org\/webt\/ku\/bk\/hu\/kubkhu2akmvzn4vizydsmvtqw0o.png","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/b38\/43a\/0f0\/b3843a0f0dcb58cf3bbf8cfe181ec2a7.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/784\/f98\/db3\/784f98db37a499162c1479600e8465ed.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/25d\/071\/ce2\/25d071ce22ed3b92b9f5bfe00d5507ad.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/613\/d14\/937\/613d14937fc122b080b8d12441d07ec4.svg","https:\/\/habrastorage.org\/webt\/k5\/l0\/vh\/k5l0vh-rxwfiqpbpxcnkh0jwlqg.png","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/623\/832\/a63\/623832a63c4065bba480eef52eae4471.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/392\/c15\/903\/392c159030125c43515d6956bf64bb1c.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/de0\/558\/47d\/de055847d429a6d927facd7df61cda54.svg","https:\/\/habrastorage.org\/webt\/un\/-n\/ex\/un-nex5m1a6aeityrwuxt9sn67o.png","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/4cc\/a97\/67d\/4cca9767d874299cb925a78352b33d15.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/18f\/000\/34f\/18f00034fa5ce903aae2db2027678177.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/168\/2a7\/d9e\/1682a7d9e2b192aa4a2be016f0aab5eb.svg","https:\/\/habrastorage.org\/webt\/q1\/kz\/rx\/q1kzrxg28rfz5nc8yswq_wdearw.png","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/a5d\/538\/f83\/a5d538f83bd73f9d1c9e8338db9a398a.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/421\/5c7\/426\/4215c74264b00200388b671f27b3e9f2.svg","https:\/\/habrastorage.org\/webt\/l8\/yv\/3t\/l8yv3twteszlpv1roazci40eudu.png","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/82a\/305\/487\/82a3054873212ae0ef5fb1dd30f8e576.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/566\/f7b\/22b\/566f7b22b705b7f86b4ae6d215c558e1.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/b50\/bd4\/38e\/b50bd438e42f8085c366eb99ad827be5.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/780\/752\/f5b\/780752f5bf44c00f046560ffb9ff5f09.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/372\/e18\/546\/372e18546a3b7abb94c2672708bc5dfe.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/525\/957\/036\/5259570365f01072a369b7c52e2d9906.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/0d8\/99b\/570\/0d899b570f49a403825587f1a0424e85.svg","https:\/\/habrastorage.org\/webt\/sn\/ga\/5s\/snga5s0m8tyg1sl9j4ndyvk3-o8.png","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/08d\/9fa\/efb\/08d9faefbe272bdf8fbb80773542e343.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/bfc\/4d5\/67c\/bfc4d567c7180cccd2d41ac8602d45ef.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/858\/dcc\/fd7\/858dccfd77b08dc1bc376953c63cbc90.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/839\/f25\/c27\/839f25c2746382debd4f08ea25ad5ecf.svg","https:\/\/habrastorage.org\/webt\/0d\/vc\/ll\/0dvcllwpn8xjmmtbzhl9rxmbiwq.png","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/fad\/558\/ddd\/fad558ddd37ae450265b5ae9bbffbbd1.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/178\/29f\/f0f\/17829ff0f290513d6c10bc9bc4264048.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/00b\/9a0\/b70\/00b9a0b705b2b5fc29f24a6c2cb13ec7.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/d4d\/19a\/f21\/d4d19af21ad8cecaaa74aad035504300.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/a7a\/e35\/877\/a7ae35877923ddd6a964f39df84c1a6a.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/c3d\/2f2\/c44\/c3d2f2c44fc42edea27de7f8f67b4829.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/384\/ea7\/c92\/384ea7c929647710d4896892c0568b6d.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/b33\/d73\/bc0\/b33d73bc005e534dc7b5fc156242f0a6.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/9b8\/6ec\/15d\/9b86ec15d56e63158d17b0481b71ad41.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/30f\/d99\/018\/30fd99018a61f7d1083a661e3b6f24d7.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/d68\/cc4\/926\/d68cc4926bf74bae8fa3b51ca4a09ec8.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/242\/7de\/a25\/2427dea25ae9a360123d8c7745544d74.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/817\/b92\/407\/817b92407f764f57af9226e50cc788fd.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/75d\/b06\/a3f\/75db06a3f01eb559d6f4804eadce01da.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/d41\/8a8\/d69\/d418a8d69ec73ebc960c549a15b1a4c8.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/c3b\/ccc\/7de\/c3bccc7de0f34064b2a89798a4e4c2ff.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/25d\/534\/1cb\/25d5341cb2af330b3d0433fa55f5f537.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/ee7\/11a\/b2e\/ee711ab2e08375b707190293905f0a8c.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/e95\/9b0\/89d\/e959b089d7c8f203b9d057dbe7e59442.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/8f5\/8a1\/9b0\/8f58a19b0f48b80badb33671bc93d52f.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/86f\/333\/aa8\/86f333aa8adce9344a174b0852e74687.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/fea\/427\/1ef\/fea4271efaf450786ceaceb190785c84.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/617\/f4d\/8e5\/617f4d8e5cb74774f454a54403a4333f.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/718\/f55\/434\/718f5543424088b94c9dbd7d6fab9e0d.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/518\/6a4\/2af\/5186a42af5de151d1f3952787c86cc87.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/7f8\/71e\/837\/7f871e8373a281c188165dc02dabb3c9.svg","https:\/\/habrastorage.org\/getpro\/habr\/formulas\/797\/282\/797\/797282797e7773d4a16d91d165e95820.svg"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Поиск пути среди круглых препятствий" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Поиск пути среди круглых препятствий" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Поиск пути среди круглых препятствий" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Навигация по лесу
Алгоритм поиска пути A* — это мощный инструмент для быстрой генерации оптимальных путей. Обычно A* демонстрируют при навигации по картам из сеток, но он может использоваться не..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Навигация по лесу
Алгоритм поиска пути A* — это мощный инструмент для быстрой генерации оптимальных путей. Обычно A* демонстрируют при навигации по картам из сеток, но он может использоваться не..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Навигация по лесу
Алгоритм поиска пути A* — это мощный инструмент для быстрой генерации оптимальных путей. Обычно A* демонстрируют при навигации по картам из сеток, но он может использоваться не..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Навигация по лесу
Алгоритм поиска пути A* — это мощный инструмент для быстрой генерации оптимальных путей. Обычно A* демонстрируют при навигации по картам из сеток, но он может использоваться не..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Навигация по лесу
Алгоритм поиска пути A* — это мощный инструмент для быстрой генерации оптимальных путей. Обычно A* демонстрируют при навигации по картам из сеток, но он может использоваться не..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/451642/f638dc75225b9794b0d4e252ae38938f/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/451642/f638dc75225b9794b0d4e252ae38938f/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/451642/f638dc75225b9794b0d4e252ae38938f/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/451642/f638dc75225b9794b0d4e252ae38938f/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/451642/f638dc75225b9794b0d4e252ae38938f/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="451642" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2019-05-15T09:05:28.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/451642/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/451642/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/451642/f638dc75225b9794b0d4e252ae38938f/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/PatientZero/" title="PatientZero" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" loading="lazy" src="//habrastorage.org/r/w32/getpro/habr/avatars/8de/9c5/34a/8de9c534a18a6cb8693270a2b528d4c0.png" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/PatientZero/" class="tm-user-info__username">
      PatientZero
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2019-05-15T09:05:28.000Z" title="2019-05-15, 12:05">15  мая  2019 в 12:05</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Поиск пути среди круглых препятствий</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/programming/" class="tm-article-snippet__hubs-item-link"><span>Программирование</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/gamedev/" class="tm-article-snippet__hubs-item-link"><span>Разработка игр</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/algorithms/" class="tm-article-snippet__hubs-item-link"><span>Алгоритмы</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <div class="tm-article-snippet__labels"><div class="tm-article-snippet__label"><span>
        Перевод
      </span></div></div> <!----> <!----></div></div> <div class="tm-article-presenter__origin"><a href="https://redblobgames.github.io/circular-obstacle-pathfinding/" target="_blank" class="tm-article-presenter__origin-link">
                Автор оригинала:
                <span>
                  Amit Patel
                </span></a></div> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml"><h2>Навигация по лесу</h2><br/>
Алгоритм поиска пути A* — это мощный инструмент для быстрой генерации оптимальных путей. Обычно A* демонстрируют при навигации по картам из сеток, но он может использоваться не только для сеток! Он может работать с любыми графами. Можно использовать A* для поиска пути в мире круглых препятствий.<br/>
<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/56/el/cv/56elcvzdfv_ggmypuirpqwr3k1u.png"/></div><br/>
<i>В <a href="https://redblobgames.github.io/circular-obstacle-pathfinding/">оригинале статьи</a> все изображения интерактивны.</i><br/>
<br/>
Как один алгоритм решает обе эти задачи? Давайте начнём с краткого описания того, как работает A*.<br/>
<br/>
<h2>Алгоритм A*</h2><br/>
Алгоритм A* находит <em>оптимальный путь</em> из начальной в конечную точку, избегая по дороге препятствия. Он реализует это, постепенно расширяя множество <em>частичных путей</em>. Каждый частичный путь — это серия шагов от начальной точки до какой-то промежуточной точки на дороге к цели. В процессе работы A* частичные пути становятся всё ближе конечной точке. Алгоритм прекращает работу тогда, когда находит полный путь, который лучше оставшихся вариантов, и это можно доказать.<br/>
<br/>
На каждом шаге алгоритма A* оценивает множество частичных путей и генерирует новые пути, расширяя наиболее многообещающий путь из множества. Для этого A* хранит частичные пути в очереди с приоритетами, отсортированном по <em>приблизительной длине</em> — истинной измеренной длине пути плюс примерное оставшееся расстояние до цели. Это приближение должно быть <em>недооценкой</em>; то есть приближение может быть меньше истинного расстояния, но не больше него. В большинстве задач поиска пути хорошей преуменьшенной оценкой является геометрическое расстояние по прямой от конца частичного пути до конечной точки. Истинный наилучший путь до цели от конца частичного пути может быть длиннее, чем это расстояние по прямой, но не может быть короче.<br/>
<a name="habracut"></a><br/>
Когда A* начинает работу, очередь с приоритетами содержит всего один частичный путь: начальную точку. Алгоритм многократно удаляет из очереди с приоритетами наиболее многообещающий путь, то есть путь с наименьшей приблизительной длиной. Если этот путь завершается в конечной точке, то алгоритм выполнил задачу — очередь с приоритетами гарантирует, что никакой другой путь не может быть лучше. В противном случае, начиная с конца частичного пути, который он удалил из очереди, A* генерирует ещё несколько новых путей, делая единичные шаги во всех возможных направлениях. Он помещает эти новые пути снова в очередь с приоритетами и начинает процесс заново.<br/>
<br/>
<h2>Граф</h2><br/>
A* работает с <em>графом</em>: набором <em>узлов</em>, соединённых <em>рёбрами</em>. В мире на основе сетки каждый узел обозначает отдельную ячейку сетки, а каждое ребро — соединение с соседними ячейками к северу, югу, востоку или западу.<br/>
<br/>
Прежде чем можно будет запустить A* для леса из круглых препятствий, нам нужно преобразовать его в граф. Все пути через лес состоят из перемежающихся отрезков прямых и дуг. Они являются рёбрами графа пути. Конечные точки этих рёбер становятся узлами.<br/>
<br/>
Путь через граф — это серия узлов, соединённых рёбрами:<br/>
<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/o4/ol/le/o4ollekxzlr3gchklwsb9qc-yfc.png"/></div><br/>
И отрезки, и дуги являются рёбрами графа. Мы назовём отрезки <em>рёбрами перехода</em>, потому что путь использует их для перехода между препятствиями. Дуги мы назовём <em>огибающими рёбрами</em>, потому что их задача в пути — огибание сторон препятствий.<br/>
<br/>
Далее мы исследуем простой способ преобразования леса с препятствиями в граф: сгенерируем все возможные рёбра перехода и огибающие рёбра.<br/>
<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/y9/bg/hp/y9bghpeee4olqqeduhnxhx_9ii8.png"/></div><br/>
<h3>Генерация рёбер перехода</h3><br/>
Рёбра перехода между парой кругов — это отрезки прямых, которые едва касаются обоих кругов; такие отрезки называются <em>касательными к двум точкам</em>, и для каждой пары кругов существует четыре таких касательных. Касательные к двум точкам, пересекающиеся между кругами, называются <em>внутренними касательными к двум точкам</em>, а проходящие снаружи — <em>внешними</em>.<br/>
<br/>
<h4>Внутренние касательные к двум точкам</h4><br/>
В прошлом поиск внутренних касательных был важен для вычисления длины ремня, соединяющего два шкива разного размера, поэтому задача создания внутренних касательных к двум точкам называется <em>задачей ремней</em>. Для нахождения внутренних касательных к двум точкам нужно вычислить угол <img src="https://habrastorage.org/getpro/habr/formulas/ff2/c64/99d/ff2c6499d038a61a41d7ce75cd78788f.svg" alt="$\theta$" data-tex="inline"/> на показанном ниже чертеже.<br/>
<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/er/_n/c3/er_nc3arspfrz_r70ofttmjgekk.png"/></div><br/>
Как оказалось, для кругов с центрами <img src="https://habrastorage.org/getpro/habr/formulas/493/c1c/008/493c1c008018df9bed4910321f29ff00.svg" alt="$A$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/20d/8ca/ec6/20d8caec693d8d8eaf70885e408419f6.svg" alt="$B$" data-tex="inline"/> и радиусами <img src="https://habrastorage.org/getpro/habr/formulas/5fa/a21/bad/5faa21badaafeb989d7de242c31a04e3.svg" alt="$r_A$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/87e/544/4f6/87e5444f6bd7417684066f4c28a56c96.svg" alt="$r_B$" data-tex="inline"/>, центры которых находятся на расстоянии <img src="https://habrastorage.org/getpro/habr/formulas/35e/a85/36b/35ea8536b3e6152e60442ccecbc46812.svg" alt="$d$" data-tex="inline"/>:<br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/872/703/d45/872703d458fc8787c1a2ce98adc0c7a3.svg" alt="$\theta = \arccos{{r_A+r_B}\over{d}}$" data-tex="display"/></p><br/>
Определив <img src="https://habrastorage.org/getpro/habr/formulas/ff2/c64/99d/ff2c6499d038a61a41d7ce75cd78788f.svg" alt="$\theta$" data-tex="inline"/>, мы можем легко найти точки <img src="https://habrastorage.org/getpro/habr/formulas/47e/792/77d/47e79277dc17c254743475ff05980a53.svg" alt="$C$" data-tex="inline"/>, <img src="https://habrastorage.org/getpro/habr/formulas/c5e/2ea/3b6/c5e2ea3b63d255f7a483773fe1d664b2.svg" alt="$D$" data-tex="inline"/>, <img src="https://habrastorage.org/getpro/habr/formulas/d4f/55a/37f/d4f55a37fb733b176d0ef014591e1b35.svg" alt="$E$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/b8b/97c/656/b8b97c6567171cc2b6a7f303a0fa8b0a.svg" alt="$F$" data-tex="inline"/>.<br/>
<br/>
<h4>Внешние касательные к двум точкам</h4><br/>
При построении внешних касательных (это <em>задача шкивов</em>) используется похожая техника.<br/>
<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/bc/fd/s-/bcfds-ush6unllsd497vq6fng6u.png"/></div><br/>
Для внешних касательных мы можем найти <img src="https://habrastorage.org/getpro/habr/formulas/ff2/c64/99d/ff2c6499d038a61a41d7ce75cd78788f.svg" alt="$\theta$" data-tex="inline"/> следующим образом:<br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/2be/33a/e72/2be33ae72ada1a05087952910c245c75.svg" alt="$\theta = \arccos{{\lvert r_A - r_B \rvert} \over d}$" data-tex="display"/></p><br/>
Не важно, какой из кругов больше, A или B, но как видно из рисунка, <img src="https://habrastorage.org/getpro/habr/formulas/ff2/c64/99d/ff2c6499d038a61a41d7ce75cd78788f.svg" alt="$\theta$" data-tex="inline"/> откладывается на стороне A, ближней к B, но на стороне B, дальней от A.<br/>
<br/>
<h4>Линия видимости</h4><br/>
Взятые вместе, внутренние и внешние касательные к двум точкам между двумя кругами образуют рёбра перехода между кругами. Но что если одно или несколько рёбер перехода закрывает третий круг?<br/>
<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/ku/bk/hu/kubkhu2akmvzn4vizydsmvtqw0o.png"/></div><br/>
Если ребро перехода перекрыто другим кругом, то нам нужно отбросить это ребро. Для распознавания такого случая мы используем простое вычисление <em>расстояния между точкой и прямой</em>. Если расстояние от ребра перехода до центра препятствия меньше радиуса препятствия, то препятствие перекрывает ребро перехода, поэтому мы должны его отбросить.<br/>
<br/>
Для вычисления расстояния от точки <img src="https://habrastorage.org/getpro/habr/formulas/47e/792/77d/47e79277dc17c254743475ff05980a53.svg" alt="$C$" data-tex="inline"/> до отрезка прямой <img src="https://habrastorage.org/getpro/habr/formulas/b38/43a/0f0/b3843a0f0dcb58cf3bbf8cfe181ec2a7.svg" alt="$\overline{AB}$" data-tex="inline"/> воспользуемся <a href="http://paulbourke.net/geometry/pointlineplane/">следующим способом</a>:<br/>
<br/>
Во-первых, вычислим <img src="https://habrastorage.org/getpro/habr/formulas/784/f98/db3/784f98db37a499162c1479600e8465ed.svg" alt="$u$" data-tex="inline"/> — часть расстояния вдоль отрезка <img src="https://habrastorage.org/getpro/habr/formulas/b38/43a/0f0/b3843a0f0dcb58cf3bbf8cfe181ec2a7.svg" alt="$\overline{AB}$" data-tex="inline"/>, в которой перпендикуляр пересекает точку <img src="https://habrastorage.org/getpro/habr/formulas/47e/792/77d/47e79277dc17c254743475ff05980a53.svg" alt="$C$" data-tex="inline"/>:<br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/25d/071/ce2/25d071ce22ed3b92b9f5bfe00d5507ad.svg" alt="$u = {(C - A) \cdot (B-A) \over (B-A)\cdot(B-A)}$" data-tex="display"/></p><br/>
Затем вычисляем позицию <img src="https://habrastorage.org/getpro/habr/formulas/d4f/55a/37f/d4f55a37fb733b176d0ef014591e1b35.svg" alt="$E$" data-tex="inline"/> на <img src="https://habrastorage.org/getpro/habr/formulas/b38/43a/0f0/b3843a0f0dcb58cf3bbf8cfe181ec2a7.svg" alt="$\overline{AB}$" data-tex="inline"/>:<br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/613/d14/937/613d14937fc122b080b8d12441d07ec4.svg" alt="$E = A + \mathrm{clamp}(u, 0, 1) * (B - A)$" data-tex="display"/></p><br/>
<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/k5/l0/vh/k5l0vh-rxwfiqpbpxcnkh0jwlqg.png"/></div><br/>
Расстояние <img src="https://habrastorage.org/getpro/habr/formulas/35e/a85/36b/35ea8536b3e6152e60442ccecbc46812.svg" alt="$d$" data-tex="inline"/> от <img src="https://habrastorage.org/getpro/habr/formulas/47e/792/77d/47e79277dc17c254743475ff05980a53.svg" alt="$C$" data-tex="inline"/> до отрезка <img src="https://habrastorage.org/getpro/habr/formulas/b38/43a/0f0/b3843a0f0dcb58cf3bbf8cfe181ec2a7.svg" alt="$\overline{AB}$" data-tex="inline"/> — это расстояние от <img src="https://habrastorage.org/getpro/habr/formulas/47e/792/77d/47e79277dc17c254743475ff05980a53.svg" alt="$C$" data-tex="inline"/> до <img src="https://habrastorage.org/getpro/habr/formulas/d4f/55a/37f/d4f55a37fb733b176d0ef014591e1b35.svg" alt="$E$" data-tex="inline"/>:<br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/623/832/a63/623832a63c4065bba480eef52eae4471.svg" alt="$d = \|E - C\|$" data-tex="display"/></p><br/>
Так как <img src="https://habrastorage.org/getpro/habr/formulas/392/c15/903/392c159030125c43515d6956bf64bb1c.svg" alt="$d &lt; r$" data-tex="inline"/>, круг перекрывает линию видимости из <img src="https://habrastorage.org/getpro/habr/formulas/493/c1c/008/493c1c008018df9bed4910321f29ff00.svg" alt="$A$" data-tex="inline"/> в <img src="https://habrastorage.org/getpro/habr/formulas/20d/8ca/ec6/20d8caec693d8d8eaf70885e408419f6.svg" alt="$B$" data-tex="inline"/>, и ребро необходимо отбросить. Если <img src="https://habrastorage.org/getpro/habr/formulas/de0/558/47d/de055847d429a6d927facd7df61cda54.svg" alt="$d \ge r$" data-tex="inline"/>, то линия видимости из <img src="https://habrastorage.org/getpro/habr/formulas/493/c1c/008/493c1c008018df9bed4910321f29ff00.svg" alt="$A$" data-tex="inline"/> в <img src="https://habrastorage.org/getpro/habr/formulas/20d/8ca/ec6/20d8caec693d8d8eaf70885e408419f6.svg" alt="$B$" data-tex="inline"/> существует, и ребро следует оставить.<br/>
<br/>
<h3>Генерация огибающих рёбер</h3><br/>
Узлы графа соединяют ребро перехода с огибающим ребром. В предыдущих разделах мы сгенерировали рёбра перехода. Для генерации огибающих рёбер мы начнём с конечной точки ребра перехода, обойдём круг и закончим в конечной точке другого ребра перехода.<br/>
<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/un/-n/ex/un-nex5m1a6aeityrwuxt9sn67o.png"/></div><br/>
Для нахождения множества огибающих рёбер круга сначала найдём все касающиеся круга рёбра перехода. Затем создадим огибающие рёбра между всеми конечными точками рёбер перехода на круге.<br/>
<br/>
<h2>Соединяем всё вместе</h2><br/>
Сгенерировав рёбра перехода, огибающие рёбра и узлы, а затем отбросив все перекрытые рёбра перехода, мы можем создать граф и запустить поиск пути с помощью алгоритма A*.<br/>
<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/56/el/cv/56elcvzdfv_ggmypuirpqwr3k1u.png"/></div><br/>
<h2>Усовершенствования</h2><br/>
Рассмотренная нами процедура генерации графа достаточно хорошо работает для объяснения алгоритма, но во многих аспектах может быть улучшена. Такие улучшения позволят алгоритму тратить меньше ресурсов процессора и памяти, а также обрабатывать больше ситуаций. Давайте рассмотрим некоторые из ситуаций.<br/>
<br/>
<h3>Препятствия, которые касаются друг друга</h3><br/>
Вы могли заметить, что в показанных выше примерах круглые препятствия не накладывались друг на друга и даже не касались. Если допустить, что круги могут касаться друг друга, то это немного усложняет задачу поиска пути<br/>
<br/>
<h4>Касательные к двум точкам</h4><br/>
Вспомним, что касательные к двум точкам можно найти с помощью этой формулы для внутренних касательных:<br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/872/703/d45/872703d458fc8787c1a2ce98adc0c7a3.svg" alt="$\theta = \arccos{{r_A+r_B}\over{d}}$" data-tex="display"/></p><br/>
и формулы для внешних касательных:<br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/2be/33a/e72/2be33ae72ada1a05087952910c245c75.svg" alt="$\theta = \arccos{{\lvert r_A - r_B \rvert} \over d}$" data-tex="display"/></p><br/>
Когда два круга касаются друг друга или пересекаются, то между ними нет внутренних касательных. В таком случае <img src="https://habrastorage.org/getpro/habr/formulas/4cc/a97/67d/4cca9767d874299cb925a78352b33d15.svg" alt="${r_A+r_B}\over d$" data-tex="inline"/> больше единицы. Так как значение арккосинуса за пределами области определения <img src="https://habrastorage.org/getpro/habr/formulas/18f/000/34f/18f00034fa5ce903aae2db2027678177.svg" alt="$[-1, 1]$" data-tex="inline"/> не определено, перед нахождением арккосинуса важно выполнять проверку пересечения кругов.<br/>
<br/>
Аналогично этому, если один круг полностью расположен в другом, то между ними не будет внешних касательных. В таком случае <img src="https://habrastorage.org/getpro/habr/formulas/168/2a7/d9e/1682a7d9e2b192aa4a2be016f0aab5eb.svg" alt="${r_A - r_B} \over d$" data-tex="inline"/> находится вне интервала <img src="https://habrastorage.org/getpro/habr/formulas/18f/000/34f/18f00034fa5ce903aae2db2027678177.svg" alt="$[-1, 1]$" data-tex="inline"/>, то есть не имеет арккосинуса.<br/>
<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/q1/kz/rx/q1kzrxg28rfz5nc8yswq_wdearw.png"/></div><br/>
<h4>Линия видимости ребра перехода</h4><br/>
Если мы допускаем возможность касания или пересечения препятствий, то в вычислениях линии видимости рёбер перехода возникают новые случаи.<br/>
<br/>
Вспомним вычисление <img src="https://habrastorage.org/getpro/habr/formulas/784/f98/db3/784f98db37a499162c1479600e8465ed.svg" alt="$u$" data-tex="inline"/> — части расстояния вдоль ребра перехода, на котором перпендикуляр к точке касается ребра. Если касание кругов не допускается, то значение <img src="https://habrastorage.org/getpro/habr/formulas/784/f98/db3/784f98db37a499162c1479600e8465ed.svg" alt="$u$" data-tex="inline"/> находится вне интервала <img src="https://habrastorage.org/getpro/habr/formulas/a5d/538/f83/a5d538f83bd73f9d1c9e8338db9a398a.svg" alt="$[0,1]$" data-tex="inline"/>, то есть круг не может касаться ребра, потому что для этого ему нужно было бы касаться одной из конечных точек ребра. Это невозможно, потому что конечные точки ребра уже являются касательными к другим кругам.<br/>
<br/>
Однако если мы допустим возможность наложения кругов, то значения <img src="https://habrastorage.org/getpro/habr/formulas/784/f98/db3/784f98db37a499162c1479600e8465ed.svg" alt="$u$" data-tex="inline"/> вне интервала <img src="https://habrastorage.org/getpro/habr/formulas/a5d/538/f83/a5d538f83bd73f9d1c9e8338db9a398a.svg" alt="$[0,1]$" data-tex="inline"/> смогут перекрывать линию видимости вдоль ребра. Это соответствует случаям, когда круг находится за концом ребра перехода, но перекрывает конечную точку или касается её. Чтобы отслеживать такие случаи математически, мы <em>ограничим</em> <img src="https://habrastorage.org/getpro/habr/formulas/784/f98/db3/784f98db37a499162c1479600e8465ed.svg" alt="$u$" data-tex="inline"/> интервалом <img src="https://habrastorage.org/getpro/habr/formulas/a5d/538/f83/a5d538f83bd73f9d1c9e8338db9a398a.svg" alt="$[0,1]$" data-tex="inline"/>:<br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/421/5c7/426/4215c74264b00200388b671f27b3e9f2.svg" alt="$E = A + clamp(u, 0, 1) * (B - A)$" data-tex="display"/></p><br/>
<h4>Линия видимости огибающего ребра</h4><br/>
Когда препятствия могут касаться друг друга или пересекаться, огибающие рёбра могут быть заблокированы препятствиями так же, как и рёбра перехода. Рассмотрим огибающее ребро с рисунка ниже. Если огибающего ребра касается другое препятствие, то ребро блокируется и должно быть отброшено.<br/>
<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/l8/yv/3t/l8yv3twteszlpv1roazci40eudu.png"/></div><br/>
Чтобы определить, заблокировано ли огибающее ребро другим препятствием, воспользуемся <a href="http://paulbourke.net/geometry/circlesphere/">следующим методом</a> для определения точек, в которых пересекаются два круга. Если круги имеют центры в точках <img src="https://habrastorage.org/getpro/habr/formulas/493/c1c/008/493c1c008018df9bed4910321f29ff00.svg" alt="$A$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/20d/8ca/ec6/20d8caec693d8d8eaf70885e408419f6.svg" alt="$B$" data-tex="inline"/> и радиусы <img src="https://habrastorage.org/getpro/habr/formulas/5fa/a21/bad/5faa21badaafeb989d7de242c31a04e3.svg" alt="$r_A$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/87e/544/4f6/87e5444f6bd7417684066f4c28a56c96.svg" alt="$r_B$" data-tex="inline"/>, где <img src="https://habrastorage.org/getpro/habr/formulas/35e/a85/36b/35ea8536b3e6152e60442ccecbc46812.svg" alt="$d$" data-tex="inline"/> — расстояние между <img src="https://habrastorage.org/getpro/habr/formulas/493/c1c/008/493c1c008018df9bed4910321f29ff00.svg" alt="$A$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/20d/8ca/ec6/20d8caec693d8d8eaf70885e408419f6.svg" alt="$B$" data-tex="inline"/>, то нам для начала нужно проверить несколько случаев. Если круги не касаются друг друга (то есть <img src="https://habrastorage.org/getpro/habr/formulas/82a/305/487/82a3054873212ae0ef5fb1dd30f8e576.svg" alt="$d > r_A + r_B$" data-tex="inline"/>),<br/>
находятся один внутри другого (<img src="https://habrastorage.org/getpro/habr/formulas/566/f7b/22b/566f7b22b705b7f86b4ae6d215c558e1.svg" alt="$d &lt; |r_A - r_B|$" data-tex="inline"/>) или совпадают (<img src="https://habrastorage.org/getpro/habr/formulas/b50/bd4/38e/b50bd438e42f8085c366eb99ad827be5.svg" alt="$d = 0$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/780/752/f5b/780752f5bf44c00f046560ffb9ff5f09.svg" alt="$r_A = r_B$" data-tex="inline"/>), то круги не могут влиять на огибающие рёбра друг друга.<br/>
<br/>
Если не одно из этих условий не соблюдается, то круги пересекаются в двух точках; если круги касаются друг друга, то эти две точки совпадают. Рассмотрим <em>радикальную ось</em>, соединяющую точки пересечения; она перпендикулярна прямой, соединяющей <img src="https://habrastorage.org/getpro/habr/formulas/493/c1c/008/493c1c008018df9bed4910321f29ff00.svg" alt="$A$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/20d/8ca/ec6/20d8caec693d8d8eaf70885e408419f6.svg" alt="$B$" data-tex="inline"/>, в какой-то точке <img src="https://habrastorage.org/getpro/habr/formulas/47e/792/77d/47e79277dc17c254743475ff05980a53.svg" alt="$C$" data-tex="inline"/>. Мы можем вычислить расстояние <img src="https://habrastorage.org/getpro/habr/formulas/372/e18/546/372e18546a3b7abb94c2672708bc5dfe.svg" alt="$a$" data-tex="inline"/> от <img src="https://habrastorage.org/getpro/habr/formulas/493/c1c/008/493c1c008018df9bed4910321f29ff00.svg" alt="$A$" data-tex="inline"/> до <img src="https://habrastorage.org/getpro/habr/formulas/47e/792/77d/47e79277dc17c254743475ff05980a53.svg" alt="$C$" data-tex="inline"/> следующим образом:<br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/525/957/036/5259570365f01072a369b7c52e2d9906.svg" alt="$a = {r_A^2 - r_B^2 + d^2 \over 2d }$" data-tex="display"/></p><br/>
Найдя <img src="https://habrastorage.org/getpro/habr/formulas/372/e18/546/372e18546a3b7abb94c2672708bc5dfe.svg" alt="$a$" data-tex="inline"/>, мы можем найти угол <img src="https://habrastorage.org/getpro/habr/formulas/ff2/c64/99d/ff2c6499d038a61a41d7ce75cd78788f.svg" alt="$\theta$" data-tex="inline"/>:<br/>
<br/>
<p></p><p><img src="https://habrastorage.org/getpro/habr/formulas/0d8/99b/570/0d899b570f49a403825587f1a0424e85.svg" alt="$\theta = \arccos {a \over r_A}$" data-tex="display"/></p><br/>
Если <img src="https://habrastorage.org/getpro/habr/formulas/ff2/c64/99d/ff2c6499d038a61a41d7ce75cd78788f.svg" alt="$\theta$" data-tex="inline"/> равен нулю, то круги касаются в точке <img src="https://habrastorage.org/getpro/habr/formulas/47e/792/77d/47e79277dc17c254743475ff05980a53.svg" alt="$C$" data-tex="inline"/>. В противном случае существует две точки пересечения, соответствующие положительному и отрицательному <img src="https://habrastorage.org/getpro/habr/formulas/ff2/c64/99d/ff2c6499d038a61a41d7ce75cd78788f.svg" alt="$\theta$" data-tex="inline"/>.<br/>
<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/sn/ga/5s/snga5s0m8tyg1sl9j4ndyvk3-o8.png"/></div><br/>
Далее определим, находится ли какая-нибудь из точек пересечения между начальной и конечной точками огибающего ребра. Если это так, то препятствие блокирует огибающее ребро, и мы должны отбросить это ребро. Заметьте, что нам не нужно рассматривать случай, когда огибающее ребро целиком находится внутри препятствия, потому что отсечение по линии видимости для рёбер перехода уже отбросило это ребро.<br/>
<br/>
После внесения изменений в вычисление касательных к двум точкам и линии видимости для рёбер перехода и огибающих рёбер всё работает верно.<br/>
<br/>
<h3>Переменный радиус актора и расширение Минковского</h3><br/>
При вычислении навигации круглого объекта в мире круглых препятствий можно учесть наблюдения, упрощающих решение задачи. Во-первых, можно упростить работу, заметив, что движение круга радиусом <em>r</em> по лесу аналогично движению точки через тот же лес с единственным изменением: радиус каждого препятствия увеличивается на <em>r</em>. Это чрезвычайно простой случай применения <em>суммы Минковского</em>. Если радиус актора больше нуля, то перед началом мы просто увеличиваем размер препятствий.<br/>
<br/>
<h3>Отложенная генерация рёбер</h3><br/>
В общем случае граф для леса из <img src="https://habrastorage.org/getpro/habr/formulas/08d/9fa/efb/08d9faefbe272bdf8fbb80773542e343.svg" alt="$n$" data-tex="inline"/> препятствий содержит <img src="https://habrastorage.org/getpro/habr/formulas/bfc/4d5/67c/bfc4d567c7180cccd2d41ac8602d45ef.svg" alt="$O(n^2)$" data-tex="inline"/> рёбер перехода, но так как каждое из них нужно проверить на линию видимости с <img src="https://habrastorage.org/getpro/habr/formulas/08d/9fa/efb/08d9faefbe272bdf8fbb80773542e343.svg" alt="$n$" data-tex="inline"/> препятствиями, то общее время генерации графа равно <img src="https://habrastorage.org/getpro/habr/formulas/858/dcc/fd7/858dccfd77b08dc1bc376953c63cbc90.svg" alt="$O(n^3)$" data-tex="inline"/>. Кроме того, пары рёбер перехода могут приводить к созданию огибающих рёбер, и каждое из них нужно проверить с каждым препятствием на линию видимости. Однако из-за высокой эффективности алгоритма A* обычно для создания оптимального пути он просматривает только часть этого большого графа.<br/>
<br/>
Мы можем сэкономить время, генерируя небольшие части графа на лету в процессе выполнения алгоритма A*, а не делая всю работу заранее. Если A* найдёт путь быстро, то мы сгенерируем только малую часть графа. Мы реализуем это, переместив генерацию рёбер в функцию <code>neighbors()</code>.<br/>
<br/>
Существует несколько случаев. В начале алгоритма нам нужны соседи начальной точки. Это рёбра перехода от начальной точки к левому и правому ребру каждого препятствия.<br/>
<br/>
Следующий случай — когда A* только что добрался до точки <img src="https://habrastorage.org/getpro/habr/formulas/839/f25/c27/839f25c2746382debd4f08ea25ad5ecf.svg" alt="$p$" data-tex="inline"/> на ребре препятствия <img src="https://habrastorage.org/getpro/habr/formulas/47e/792/77d/47e79277dc17c254743475ff05980a53.svg" alt="$C$" data-tex="inline"/> вдоль ребра перехода: <code>neighbors()</code> должна вернуть огибающие рёбра, ведущие из <img src="https://habrastorage.org/getpro/habr/formulas/839/f25/c27/839f25c2746382debd4f08ea25ad5ecf.svg" alt="$p$" data-tex="inline"/>. Для этого мы определим, какие рёбра перехода выходят из препятствия, вычислив касательные к двум точкам между <img src="https://habrastorage.org/getpro/habr/formulas/47e/792/77d/47e79277dc17c254743475ff05980a53.svg" alt="$C$" data-tex="inline"/> и всеми остальными препятствиями, отбросив все те, которые не находятся на линии видимости. Затем найдём все огибающие рёбра, соединяющие <img src="https://habrastorage.org/getpro/habr/formulas/839/f25/c27/839f25c2746382debd4f08ea25ad5ecf.svg" alt="$p$" data-tex="inline"/> с этими рёбрами перехода, отбросив те, которые блокированы другими препятствиями. Возвращаем все эти огибающие рёбра,, сохраняя рёбра перехода для возврата в последующем вызове <code>neighbors()</code>.<br/>
<br/>
Последний случай — когда A* обошёл огибающее ребро вдоль препятствия <img src="https://habrastorage.org/getpro/habr/formulas/47e/792/77d/47e79277dc17c254743475ff05980a53.svg" alt="$C$" data-tex="inline"/> и ему нужно покинуть <img src="https://habrastorage.org/getpro/habr/formulas/47e/792/77d/47e79277dc17c254743475ff05980a53.svg" alt="$C$" data-tex="inline"/> по ребру перехода. Так как предыдущий этап вычислил и сохранил все рёбра перехода, можно просто найти и возвратить правильное множество рёбер.<br/>
<br/>
<h3>Отсекаем заострённые огибающие рёбра</h3><br/>
Огибающие рёбра соединяют рёбра перехода, касающиеся одного круга, но оказывается, что многие из таких огибающих рёбер не подходят для использования в оптимальном пути. Мы можем ускорить алгоритм, устранив их.<br/>
<br/>
Оптимальный путь через лес препятствий всегда состоит из перемежающихся рёбер перехода и огибающих рёбер. Допустим мы входим в узел <img src="https://habrastorage.org/getpro/habr/formulas/493/c1c/008/493c1c008018df9bed4910321f29ff00.svg" alt="$A$" data-tex="inline"/> и решаем, как из него выйти:<br/>
<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/0d/vc/ll/0dvcllwpn8xjmmtbzhl9rxmbiwq.png"/></div><br/>
Вход через <img src="https://habrastorage.org/getpro/habr/formulas/493/c1c/008/493c1c008018df9bed4910321f29ff00.svg" alt="$A$" data-tex="inline"/> означает, что мы движемся <em>по часовой стрелке</em> (<img src="https://habrastorage.org/getpro/habr/formulas/fad/558/ddd/fad558ddd37ae450265b5ae9bbffbbd1.svg" alt="$\circlearrowright$" data-tex="inline"/>). Мы должны выйти через узел, который позволяет нам продолжать двигаться по часовой стрелке (<img src="https://habrastorage.org/getpro/habr/formulas/fad/558/ddd/fad558ddd37ae450265b5ae9bbffbbd1.svg" alt="$\circlearrowright$" data-tex="inline"/>), то есть мы можем выйти только через узел <img src="https://habrastorage.org/getpro/habr/formulas/20d/8ca/ec6/20d8caec693d8d8eaf70885e408419f6.svg" alt="$B$" data-tex="inline"/> или <img src="https://habrastorage.org/getpro/habr/formulas/c5e/2ea/3b6/c5e2ea3b63d255f7a483773fe1d664b2.svg" alt="$D$" data-tex="inline"/>. Если выйти через <img src="https://habrastorage.org/getpro/habr/formulas/47e/792/77d/47e79277dc17c254743475ff05980a53.svg" alt="$C$" data-tex="inline"/>, то создастся <em>перегиб</em> (<img src="https://habrastorage.org/getpro/habr/formulas/178/29f/f0f/17829ff0f290513d6c10bc9bc4264048.svg" alt="$\curlywedge$" data-tex="inline"/>) пути, что никогда не будет оптимальным. Нам нужно отфильтровывать такие заострённые рёбра.<br/>
<br/>
Для начала заметим, что A* и так обрабатывает каждое неориентированное ребро <img src="https://habrastorage.org/getpro/habr/formulas/00b/9a0/b70/00b9a0b705b2b5fc29f24a6c2cb13ec7.svg" alt="$P \longleftrightarrow Q$" data-tex="inline"/> как два ориентированных ребра, <img src="https://habrastorage.org/getpro/habr/formulas/d4d/19a/f21/d4d19af21ad8cecaaa74aad035504300.svg" alt="$P \longrightarrow Q$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/a7a/e35/877/a7ae35877923ddd6a964f39df84c1a6a.svg" alt="$Q \longrightarrow P$" data-tex="inline"/>. Мы можем воспользоваться этим, пометив рёбра и узлы ориентацией.<br/>
<br/>
<ol>
<li>Узлы <img src="https://habrastorage.org/getpro/habr/formulas/c3d/2f2/c44/c3d2f2c44fc42edea27de7f8f67b4829.svg" alt="$P$" data-tex="inline"/> становятся узлами с ориентацией — по часовой (<img src="https://habrastorage.org/getpro/habr/formulas/384/ea7/c92/384ea7c929647710d4896892c0568b6d.svg" alt="$P\circlearrowright$" data-tex="inline"/>) или против часовой (<img src="https://habrastorage.org/getpro/habr/formulas/b33/d73/bc0/b33d73bc005e534dc7b5fc156242f0a6.svg" alt="$P\circlearrowleft$" data-tex="inline"/>) стрелки.</li>
<li>Неориентированные рёбра перехода <img src="https://habrastorage.org/getpro/habr/formulas/00b/9a0/b70/00b9a0b705b2b5fc29f24a6c2cb13ec7.svg" alt="$P \longleftrightarrow Q$" data-tex="inline"/> становятся ориентированными рёбрами <img src="https://habrastorage.org/getpro/habr/formulas/9b8/6ec/15d/9b86ec15d56e63158d17b0481b71ad41.svg" alt="$P,p \longrightarrow Q,\hat{q}$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/30f/d99/018/30fd99018a61f7d1083a661e3b6f24d7.svg" alt="$Q,q \longrightarrow P,\hat{p}$" data-tex="inline"/>, где <img src="https://habrastorage.org/getpro/habr/formulas/839/f25/c27/839f25c2746382debd4f08ea25ad5ecf.svg" alt="$p$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/d68/cc4/926/d68cc4926bf74bae8fa3b51ca4a09ec8.svg" alt="$q$" data-tex="inline"/> — это ориентации, а <img src="https://habrastorage.org/getpro/habr/formulas/242/7de/a25/2427dea25ae9a360123d8c7745544d74.svg" alt="$\hat{x}$" data-tex="inline"/> означает направление, противоположное <img src="https://habrastorage.org/getpro/habr/formulas/817/b92/407/817b92407f764f57af9226e50cc788fd.svg" alt="$x$" data-tex="inline"/>.</li>
<li>Неориентированные огибающие рёбра <img src="https://habrastorage.org/getpro/habr/formulas/00b/9a0/b70/00b9a0b705b2b5fc29f24a6c2cb13ec7.svg" alt="$P \longleftrightarrow Q$" data-tex="inline"/> становятся ориентированными рёбрами <img src="https://habrastorage.org/getpro/habr/formulas/75d/b06/a3f/75db06a3f01eb559d6f4804eadce01da.svg" alt="$P\circlearrowright \longrightarrow Q\circlearrowright$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/d41/8a8/d69/d418a8d69ec73ebc960c549a15b1a4c8.svg" alt="$P\circlearrowleft \longrightarrow Q\circlearrowleft$" data-tex="inline"/>. Именно здесь происходит фильтрация: мы <em>не</em> включаем <img src="https://habrastorage.org/getpro/habr/formulas/c3b/ccc/7de/c3bccc7de0f34064b2a89798a4e4c2ff.svg" alt="$P\circlearrowright \longrightarrow Q\circlearrowleft$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/25d/534/1cb/25d5341cb2af330b3d0433fa55f5f537.svg" alt="$P\circlearrowleft \longrightarrow Q\circlearrowright$" data-tex="inline"/>, потому что смена направления создаёт перегибы (<img src="https://habrastorage.org/getpro/habr/formulas/178/29f/f0f/17829ff0f290513d6c10bc9bc4264048.svg" alt="$\curlywedge$" data-tex="inline"/>).</li>
</ol><br/>
В нашей схеме узел <img src="https://habrastorage.org/getpro/habr/formulas/493/c1c/008/493c1c008018df9bed4910321f29ff00.svg" alt="$A$" data-tex="inline"/> превратится в два узла, <img src="https://habrastorage.org/getpro/habr/formulas/ee7/11a/b2e/ee711ab2e08375b707190293905f0a8c.svg" alt="$A\circlearrowright$" data-tex="inline"/> и <img src="https://habrastorage.org/getpro/habr/formulas/e95/9b0/89d/e959b089d7c8f203b9d057dbe7e59442.svg" alt="$A\circlearrowleft$" data-tex="inline"/>, он имеет входящее ребро перехода <img src="https://habrastorage.org/getpro/habr/formulas/8f5/8a1/9b0/8f58a19b0f48b80badb33671bc93d52f.svg" alt="$\longrightarrow A\circlearrowright$" data-tex="inline"/> и исходящее ребро перехода <img src="https://habrastorage.org/getpro/habr/formulas/86f/333/aa8/86f333aa8adce9344a174b0852e74687.svg" alt="$A\circlearrowleft \longrightarrow$" data-tex="inline"/>. Если мы попали на путь через <img src="https://habrastorage.org/getpro/habr/formulas/ee7/11a/b2e/ee711ab2e08375b707190293905f0a8c.svg" alt="$A\circlearrowright$" data-tex="inline"/>, то должны выйти через узел <img src="https://habrastorage.org/getpro/habr/formulas/fad/558/ddd/fad558ddd37ae450265b5ae9bbffbbd1.svg" alt="$\circlearrowright$" data-tex="inline"/>, который будет или ребром перехода <img src="https://habrastorage.org/getpro/habr/formulas/fea/427/1ef/fea4271efaf450786ceaceb190785c84.svg" alt="$B\circlearrowright \longrightarrow$" data-tex="inline"/> (через огибающее ребро <img src="https://habrastorage.org/getpro/habr/formulas/617/f4d/8e5/617f4d8e5cb74774f454a54403a4333f.svg" alt="$A\circlearrowright \longrightarrow B\circlearrowright$" data-tex="inline"/>), или ребро перехода <img src="https://habrastorage.org/getpro/habr/formulas/718/f55/434/718f5543424088b94c9dbd7d6fab9e0d.svg" alt="$D\circlearrowright \longrightarrow$" data-tex="inline"/> (через огибающее ребро <img src="https://habrastorage.org/getpro/habr/formulas/518/6a4/2af/5186a42af5de151d1f3952787c86cc87.svg" alt="$A\circlearrowright \longrightarrow D\circlearrowright$" data-tex="inline"/>). Мы не можем выйти через <img src="https://habrastorage.org/getpro/habr/formulas/7f8/71e/837/7f871e8373a281c188165dc02dabb3c9.svg" alt="$C\circlearrowleft \longrightarrow$" data-tex="inline"/>, потому что так изменится направление поворота, и мы отфильтровали огибающее ребро <img src="https://habrastorage.org/getpro/habr/formulas/797/282/797/797282797e7773d4a16d91d165e95820.svg" alt="$A\circlearrowright \longrightarrow C\circlearrowleft$" data-tex="inline"/>.<br/>
<br/>
Отфильтровав из графа эти заострённые огибающие рёбра, мы повысили эффективность алгоритма.<br/>
<br/>
<h3>Отсечение пересекающих рёбер</h3><br/>
Можно отсекать частичные пути, последние рёбра перехода которых пересекают предпоследнее ребро перехода.<br/>
<br/>
<h3>Многоугольные препятствия</h3><br/>
См. <a href="https://dl.acm.org/citation.cfm?id=516343">Game Programming Gems 2</a>, Chapter 3.10, Optimizing Points-of-Visibility Pathfinding, написанную Томасом Янгом. В этой главе рассматривается отсечение узлов, но не для кругов, а для многоугольников.<br/>
<br/>
<h2>Справочные материалы</h2><br/>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Belt_problem">Задача ремней</a></li>
<li><a href="https://en.wikipedia.org/wiki/Belt_problem#Pulley_problem">Задача шкивов</a></li>
<li><a href="http://paulbourke.net/geometry/pointlineplane/">Расстояние между точкой и прямой</a></li>
<li><a href="http://paulbourke.net/geometry/circlesphere/">Пересечение двух окружностей</a></li>
</ul></div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BF%D0%BE%D0%B8%D1%81%D0%BA%20%D0%BF%D1%83%D1%82%D0%B8%5D" class="tm-tags-list__link">поиск пути</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B3%D1%80%D0%B0%D1%84%D1%8B%5D" class="tm-tags-list__link">графы</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC%20a%2a%5D" class="tm-tags-list__link">алгоритм a*</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC%D1%8B%20%D0%BF%D0%BE%D0%B8%D1%81%D0%BA%D0%B0%20%D0%BF%D1%83%D1%82%D0%B8%5D" class="tm-tags-list__link">алгоритмы поиска пути</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BE%D1%80%D0%B8%D0%B5%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B9%20%D0%B3%D1%80%D0%B0%D1%84%5D" class="tm-tags-list__link">ориентированный граф</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hub/programming/" class="tm-hubs-list__link">
    Программирование
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/gamedev/" class="tm-hubs-list__link">
    Разработка игр
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/algorithms/" class="tm-hubs-list__link">
    Алгоритмы
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 46: ↑46 и ↓0</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 46: ↑46 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+46</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">11K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    185
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/PatientZero/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/8de/9c5/34a/8de9c534a18a6cb8693270a2b528d4c0.png" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 1325 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    1197
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">84.4</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><!----> <a href="/ru/users/PatientZero/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @PatientZero
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">Переводчик-фрилансер</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <button type="submit" class="tm-user-card__button btn btn_transparent btn_small">
      Задонатить
    </button> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/451642/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 13 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <!----> <!----> <!----> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/451642/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/451642/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"451642":{"id":"451642","timePublished":"2019-05-15T09:05:28+00:00","isCorporative":false,"lang":"ru","titleHtml":"Поиск пути среди круглых препятствий","leadData":{"textHtml":"\u003Ch2\u003EНавигация по лесу\u003C\u002Fh2\u003E\u003Cbr\u003E\r\nАлгоритм поиска пути A* — это мощный инструмент для быстрой генерации оптимальных путей. Обычно A* демонстрируют при навигации по картам из сеток, но он может использоваться не только для сеток! Он может работать с любыми графами. Можно использовать A* для поиска пути в мире круглых препятствий.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F56\u002Fel\u002Fcv\u002F56elcvzdfv_ggmypuirpqwr3k1u.png\"\u003E\u003C\u002Fdiv\u003E\u003Cbr\u003E\r\n\u003Ci\u003EВ \u003Ca href=\"https:\u002F\u002Fredblobgames.github.io\u002Fcircular-obstacle-pathfinding\u002F\"\u003Eоригинале статьи\u003C\u002Fa\u003E все изображения интерактивны.\u003C\u002Fi\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nКак один алгоритм решает обе эти задачи? Давайте начнём с краткого описания того, как работает A*.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Ch2\u003EАлгоритм A*\u003C\u002Fh2\u003E\u003Cbr\u003E\r\nАлгоритм A* находит \u003Cem\u003Eоптимальный путь\u003C\u002Fem\u003E из начальной в конечную точку, избегая по дороге препятствия. Он реализует это, постепенно расширяя множество \u003Cem\u003Eчастичных путей\u003C\u002Fem\u003E. Каждый частичный путь — это серия шагов от начальной точки до какой-то промежуточной точки на дороге к цели. В процессе работы A* частичные пути становятся всё ближе конечной точке. Алгоритм прекращает работу тогда, когда находит полный путь, который лучше оставшихся вариантов, и это можно доказать.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nНа каждом шаге алгоритма A* оценивает множество частичных путей и генерирует новые пути, расширяя наиболее многообещающий путь из множества. Для этого A* хранит частичные пути в очереди с приоритетами, отсортированном по \u003Cem\u003Eприблизительной длине\u003C\u002Fem\u003E — истинной измеренной длине пути плюс примерное оставшееся расстояние до цели. Это приближение должно быть \u003Cem\u003Eнедооценкой\u003C\u002Fem\u003E; то есть приближение может быть меньше истинного расстояния, но не больше него. В большинстве задач поиска пути хорошей преуменьшенной оценкой является геометрическое расстояние по прямой от конца частичного пути до конечной точки. Истинный наилучший путь до цели от конца частичного пути может быть длиннее, чем это расстояние по прямой, но не может быть короче.\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше →","image":null},"editorVersion":"1.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Amit Patel","originalUrl":"https:\u002F\u002Fredblobgames.github.io\u002Fcircular-obstacle-pathfinding\u002F"}}],"author":{"scoreStats":{"score":1197,"votesCount":1325},"rating":84.4,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":"410013829899665","paymentPayPalMe":"vadimivshin","paymentWebmoney":null},"id":"78894","alias":"PatientZero","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F8de\u002F9c5\u002F34a\u002F8de9c534a18a6cb8693270a2b528d4c0.png","speciality":"Переводчик-фрилансер"},"statistics":{"commentsCount":13,"favoritesCount":185,"readingCount":11388,"score":46,"votesCount":46},"hubs":[{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"7773","alias":"gamedev","type":"collective","title":"Разработка игр","titleHtml":"Разработка игр","isProfiled":true},{"relatedData":null,"id":"8000","alias":"algorithms","type":"collective","title":"Алгоритмы","titleHtml":"Алгоритмы","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Ch2\u003EНавигация по лесу\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nАлгоритм поиска пути A* — это мощный инструмент для быстрой генерации оптимальных путей. Обычно A* демонстрируют при навигации по картам из сеток, но он может использоваться не только для сеток! Он может работать с любыми графами. Можно использовать A* для поиска пути в мире круглых препятствий.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F56\u002Fel\u002Fcv\u002F56elcvzdfv_ggmypuirpqwr3k1u.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Ci\u003EВ \u003Ca href=\"https:\u002F\u002Fredblobgames.github.io\u002Fcircular-obstacle-pathfinding\u002F\"\u003Eоригинале статьи\u003C\u002Fa\u003E все изображения интерактивны.\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nКак один алгоритм решает обе эти задачи? Давайте начнём с краткого описания того, как работает A*.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EАлгоритм A*\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nАлгоритм A* находит \u003Cem\u003Eоптимальный путь\u003C\u002Fem\u003E из начальной в конечную точку, избегая по дороге препятствия. Он реализует это, постепенно расширяя множество \u003Cem\u003Eчастичных путей\u003C\u002Fem\u003E. Каждый частичный путь — это серия шагов от начальной точки до какой-то промежуточной точки на дороге к цели. В процессе работы A* частичные пути становятся всё ближе конечной точке. Алгоритм прекращает работу тогда, когда находит полный путь, который лучше оставшихся вариантов, и это можно доказать.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа каждом шаге алгоритма A* оценивает множество частичных путей и генерирует новые пути, расширяя наиболее многообещающий путь из множества. Для этого A* хранит частичные пути в очереди с приоритетами, отсортированном по \u003Cem\u003Eприблизительной длине\u003C\u002Fem\u003E — истинной измеренной длине пути плюс примерное оставшееся расстояние до цели. Это приближение должно быть \u003Cem\u003Eнедооценкой\u003C\u002Fem\u003E; то есть приближение может быть меньше истинного расстояния, но не больше него. В большинстве задач поиска пути хорошей преуменьшенной оценкой является геометрическое расстояние по прямой от конца частичного пути до конечной точки. Истинный наилучший путь до цели от конца частичного пути может быть длиннее, чем это расстояние по прямой, но не может быть короче.\u003Cbr\u002F\u003E\r\n\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\nКогда A* начинает работу, очередь с приоритетами содержит всего один частичный путь: начальную точку. Алгоритм многократно удаляет из очереди с приоритетами наиболее многообещающий путь, то есть путь с наименьшей приблизительной длиной. Если этот путь завершается в конечной точке, то алгоритм выполнил задачу — очередь с приоритетами гарантирует, что никакой другой путь не может быть лучше. В противном случае, начиная с конца частичного пути, который он удалил из очереди, A* генерирует ещё несколько новых путей, делая единичные шаги во всех возможных направлениях. Он помещает эти новые пути снова в очередь с приоритетами и начинает процесс заново.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EГраф\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nA* работает с \u003Cem\u003Eграфом\u003C\u002Fem\u003E: набором \u003Cem\u003Eузлов\u003C\u002Fem\u003E, соединённых \u003Cem\u003Eрёбрами\u003C\u002Fem\u003E. В мире на основе сетки каждый узел обозначает отдельную ячейку сетки, а каждое ребро — соединение с соседними ячейками к северу, югу, востоку или западу.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПрежде чем можно будет запустить A* для леса из круглых препятствий, нам нужно преобразовать его в граф. Все пути через лес состоят из перемежающихся отрезков прямых и дуг. Они являются рёбрами графа пути. Конечные точки этих рёбер становятся узлами.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПуть через граф — это серия узлов, соединённых рёбрами:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fo4\u002Fol\u002Fle\u002Fo4ollekxzlr3gchklwsb9qc-yfc.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nИ отрезки, и дуги являются рёбрами графа. Мы назовём отрезки \u003Cem\u003Eрёбрами перехода\u003C\u002Fem\u003E, потому что путь использует их для перехода между препятствиями. Дуги мы назовём \u003Cem\u003Eогибающими рёбрами\u003C\u002Fem\u003E, потому что их задача в пути — огибание сторон препятствий.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДалее мы исследуем простой способ преобразования леса с препятствиями в граф: сгенерируем все возможные рёбра перехода и огибающие рёбра.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fy9\u002Fbg\u002Fhp\u002Fy9bghpeee4olqqeduhnxhx_9ii8.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EГенерация рёбер перехода\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nРёбра перехода между парой кругов — это отрезки прямых, которые едва касаются обоих кругов; такие отрезки называются \u003Cem\u003Eкасательными к двум точкам\u003C\u002Fem\u003E, и для каждой пары кругов существует четыре таких касательных. Касательные к двум точкам, пересекающиеся между кругами, называются \u003Cem\u003Eвнутренними касательными к двум точкам\u003C\u002Fem\u003E, а проходящие снаружи — \u003Cem\u003Eвнешними\u003C\u002Fem\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EВнутренние касательные к двум точкам\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nВ прошлом поиск внутренних касательных был важен для вычисления длины ремня, соединяющего два шкива разного размера, поэтому задача создания внутренних касательных к двум точкам называется \u003Cem\u003Eзадачей ремней\u003C\u002Fem\u003E. Для нахождения внутренних касательных к двум точкам нужно вычислить угол \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fff2\u002Fc64\u002F99d\u002Fff2c6499d038a61a41d7ce75cd78788f.svg\" alt=\"$\\theta$\" data-tex=\"inline\"\u002F\u003E на показанном ниже чертеже.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fer\u002F_n\u002Fc3\u002Fer_nc3arspfrz_r70ofttmjgekk.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nКак оказалось, для кругов с центрами \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F493\u002Fc1c\u002F008\u002F493c1c008018df9bed4910321f29ff00.svg\" alt=\"$A$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F20d\u002F8ca\u002Fec6\u002F20d8caec693d8d8eaf70885e408419f6.svg\" alt=\"$B$\" data-tex=\"inline\"\u002F\u003E и радиусами \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F5fa\u002Fa21\u002Fbad\u002F5faa21badaafeb989d7de242c31a04e3.svg\" alt=\"$r_A$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F87e\u002F544\u002F4f6\u002F87e5444f6bd7417684066f4c28a56c96.svg\" alt=\"$r_B$\" data-tex=\"inline\"\u002F\u003E, центры которых находятся на расстоянии \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F35e\u002Fa85\u002F36b\u002F35ea8536b3e6152e60442ccecbc46812.svg\" alt=\"$d$\" data-tex=\"inline\"\u002F\u003E:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F872\u002F703\u002Fd45\u002F872703d458fc8787c1a2ce98adc0c7a3.svg\" alt=\"$\\theta = \\arccos{{r_A+r_B}\\over{d}}$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\nОпределив \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fff2\u002Fc64\u002F99d\u002Fff2c6499d038a61a41d7ce75cd78788f.svg\" alt=\"$\\theta$\" data-tex=\"inline\"\u002F\u003E, мы можем легко найти точки \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F47e\u002F792\u002F77d\u002F47e79277dc17c254743475ff05980a53.svg\" alt=\"$C$\" data-tex=\"inline\"\u002F\u003E, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fc5e\u002F2ea\u002F3b6\u002Fc5e2ea3b63d255f7a483773fe1d664b2.svg\" alt=\"$D$\" data-tex=\"inline\"\u002F\u003E, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd4f\u002F55a\u002F37f\u002Fd4f55a37fb733b176d0ef014591e1b35.svg\" alt=\"$E$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fb8b\u002F97c\u002F656\u002Fb8b97c6567171cc2b6a7f303a0fa8b0a.svg\" alt=\"$F$\" data-tex=\"inline\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EВнешние касательные к двум точкам\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nПри построении внешних касательных (это \u003Cem\u003Eзадача шкивов\u003C\u002Fem\u003E) используется похожая техника.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fbc\u002Ffd\u002Fs-\u002Fbcfds-ush6unllsd497vq6fng6u.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nДля внешних касательных мы можем найти \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fff2\u002Fc64\u002F99d\u002Fff2c6499d038a61a41d7ce75cd78788f.svg\" alt=\"$\\theta$\" data-tex=\"inline\"\u002F\u003E следующим образом:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F2be\u002F33a\u002Fe72\u002F2be33ae72ada1a05087952910c245c75.svg\" alt=\"$\\theta = \\arccos{{\\lvert r_A - r_B \\rvert} \\over d}$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\nНе важно, какой из кругов больше, A или B, но как видно из рисунка, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fff2\u002Fc64\u002F99d\u002Fff2c6499d038a61a41d7ce75cd78788f.svg\" alt=\"$\\theta$\" data-tex=\"inline\"\u002F\u003E откладывается на стороне A, ближней к B, но на стороне B, дальней от A.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EЛиния видимости\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nВзятые вместе, внутренние и внешние касательные к двум точкам между двумя кругами образуют рёбра перехода между кругами. Но что если одно или несколько рёбер перехода закрывает третий круг?\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fku\u002Fbk\u002Fhu\u002Fkubkhu2akmvzn4vizydsmvtqw0o.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nЕсли ребро перехода перекрыто другим кругом, то нам нужно отбросить это ребро. Для распознавания такого случая мы используем простое вычисление \u003Cem\u003Eрасстояния между точкой и прямой\u003C\u002Fem\u003E. Если расстояние от ребра перехода до центра препятствия меньше радиуса препятствия, то препятствие перекрывает ребро перехода, поэтому мы должны его отбросить.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля вычисления расстояния от точки \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F47e\u002F792\u002F77d\u002F47e79277dc17c254743475ff05980a53.svg\" alt=\"$C$\" data-tex=\"inline\"\u002F\u003E до отрезка прямой \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fb38\u002F43a\u002F0f0\u002Fb3843a0f0dcb58cf3bbf8cfe181ec2a7.svg\" alt=\"$\\overline{AB}$\" data-tex=\"inline\"\u002F\u003E воспользуемся \u003Ca href=\"http:\u002F\u002Fpaulbourke.net\u002Fgeometry\u002Fpointlineplane\u002F\"\u003Eследующим способом\u003C\u002Fa\u003E:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВо-первых, вычислим \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F784\u002Ff98\u002Fdb3\u002F784f98db37a499162c1479600e8465ed.svg\" alt=\"$u$\" data-tex=\"inline\"\u002F\u003E — часть расстояния вдоль отрезка \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fb38\u002F43a\u002F0f0\u002Fb3843a0f0dcb58cf3bbf8cfe181ec2a7.svg\" alt=\"$\\overline{AB}$\" data-tex=\"inline\"\u002F\u003E, в которой перпендикуляр пересекает точку \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F47e\u002F792\u002F77d\u002F47e79277dc17c254743475ff05980a53.svg\" alt=\"$C$\" data-tex=\"inline\"\u002F\u003E:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F25d\u002F071\u002Fce2\u002F25d071ce22ed3b92b9f5bfe00d5507ad.svg\" alt=\"$u = {(C - A) \\cdot (B-A) \\over (B-A)\\cdot(B-A)}$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\nЗатем вычисляем позицию \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd4f\u002F55a\u002F37f\u002Fd4f55a37fb733b176d0ef014591e1b35.svg\" alt=\"$E$\" data-tex=\"inline\"\u002F\u003E на \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fb38\u002F43a\u002F0f0\u002Fb3843a0f0dcb58cf3bbf8cfe181ec2a7.svg\" alt=\"$\\overline{AB}$\" data-tex=\"inline\"\u002F\u003E:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F613\u002Fd14\u002F937\u002F613d14937fc122b080b8d12441d07ec4.svg\" alt=\"$E = A + \\mathrm{clamp}(u, 0, 1) * (B - A)$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fk5\u002Fl0\u002Fvh\u002Fk5l0vh-rxwfiqpbpxcnkh0jwlqg.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nРасстояние \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F35e\u002Fa85\u002F36b\u002F35ea8536b3e6152e60442ccecbc46812.svg\" alt=\"$d$\" data-tex=\"inline\"\u002F\u003E от \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F47e\u002F792\u002F77d\u002F47e79277dc17c254743475ff05980a53.svg\" alt=\"$C$\" data-tex=\"inline\"\u002F\u003E до отрезка \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fb38\u002F43a\u002F0f0\u002Fb3843a0f0dcb58cf3bbf8cfe181ec2a7.svg\" alt=\"$\\overline{AB}$\" data-tex=\"inline\"\u002F\u003E — это расстояние от \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F47e\u002F792\u002F77d\u002F47e79277dc17c254743475ff05980a53.svg\" alt=\"$C$\" data-tex=\"inline\"\u002F\u003E до \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd4f\u002F55a\u002F37f\u002Fd4f55a37fb733b176d0ef014591e1b35.svg\" alt=\"$E$\" data-tex=\"inline\"\u002F\u003E:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F623\u002F832\u002Fa63\u002F623832a63c4065bba480eef52eae4471.svg\" alt=\"$d = \\|E - C\\|$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\nТак как \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F392\u002Fc15\u002F903\u002F392c159030125c43515d6956bf64bb1c.svg\" alt=\"$d &lt; r$\" data-tex=\"inline\"\u002F\u003E, круг перекрывает линию видимости из \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F493\u002Fc1c\u002F008\u002F493c1c008018df9bed4910321f29ff00.svg\" alt=\"$A$\" data-tex=\"inline\"\u002F\u003E в \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F20d\u002F8ca\u002Fec6\u002F20d8caec693d8d8eaf70885e408419f6.svg\" alt=\"$B$\" data-tex=\"inline\"\u002F\u003E, и ребро необходимо отбросить. Если \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fde0\u002F558\u002F47d\u002Fde055847d429a6d927facd7df61cda54.svg\" alt=\"$d \\ge r$\" data-tex=\"inline\"\u002F\u003E, то линия видимости из \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F493\u002Fc1c\u002F008\u002F493c1c008018df9bed4910321f29ff00.svg\" alt=\"$A$\" data-tex=\"inline\"\u002F\u003E в \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F20d\u002F8ca\u002Fec6\u002F20d8caec693d8d8eaf70885e408419f6.svg\" alt=\"$B$\" data-tex=\"inline\"\u002F\u003E существует, и ребро следует оставить.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EГенерация огибающих рёбер\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nУзлы графа соединяют ребро перехода с огибающим ребром. В предыдущих разделах мы сгенерировали рёбра перехода. Для генерации огибающих рёбер мы начнём с конечной точки ребра перехода, обойдём круг и закончим в конечной точке другого ребра перехода.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fun\u002F-n\u002Fex\u002Fun-nex5m1a6aeityrwuxt9sn67o.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nДля нахождения множества огибающих рёбер круга сначала найдём все касающиеся круга рёбра перехода. Затем создадим огибающие рёбра между всеми конечными точками рёбер перехода на круге.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EСоединяем всё вместе\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nСгенерировав рёбра перехода, огибающие рёбра и узлы, а затем отбросив все перекрытые рёбра перехода, мы можем создать граф и запустить поиск пути с помощью алгоритма A*.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F56\u002Fel\u002Fcv\u002F56elcvzdfv_ggmypuirpqwr3k1u.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EУсовершенствования\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nРассмотренная нами процедура генерации графа достаточно хорошо работает для объяснения алгоритма, но во многих аспектах может быть улучшена. Такие улучшения позволят алгоритму тратить меньше ресурсов процессора и памяти, а также обрабатывать больше ситуаций. Давайте рассмотрим некоторые из ситуаций.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EПрепятствия, которые касаются друг друга\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nВы могли заметить, что в показанных выше примерах круглые препятствия не накладывались друг на друга и даже не касались. Если допустить, что круги могут касаться друг друга, то это немного усложняет задачу поиска пути\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EКасательные к двум точкам\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nВспомним, что касательные к двум точкам можно найти с помощью этой формулы для внутренних касательных:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F872\u002F703\u002Fd45\u002F872703d458fc8787c1a2ce98adc0c7a3.svg\" alt=\"$\\theta = \\arccos{{r_A+r_B}\\over{d}}$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\nи формулы для внешних касательных:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F2be\u002F33a\u002Fe72\u002F2be33ae72ada1a05087952910c245c75.svg\" alt=\"$\\theta = \\arccos{{\\lvert r_A - r_B \\rvert} \\over d}$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\nКогда два круга касаются друг друга или пересекаются, то между ними нет внутренних касательных. В таком случае \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F4cc\u002Fa97\u002F67d\u002F4cca9767d874299cb925a78352b33d15.svg\" alt=\"${r_A+r_B}\\over d$\" data-tex=\"inline\"\u002F\u003E больше единицы. Так как значение арккосинуса за пределами области определения \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F18f\u002F000\u002F34f\u002F18f00034fa5ce903aae2db2027678177.svg\" alt=\"$[-1, 1]$\" data-tex=\"inline\"\u002F\u003E не определено, перед нахождением арккосинуса важно выполнять проверку пересечения кругов.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nАналогично этому, если один круг полностью расположен в другом, то между ними не будет внешних касательных. В таком случае \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F168\u002F2a7\u002Fd9e\u002F1682a7d9e2b192aa4a2be016f0aab5eb.svg\" alt=\"${r_A - r_B} \\over d$\" data-tex=\"inline\"\u002F\u003E находится вне интервала \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F18f\u002F000\u002F34f\u002F18f00034fa5ce903aae2db2027678177.svg\" alt=\"$[-1, 1]$\" data-tex=\"inline\"\u002F\u003E, то есть не имеет арккосинуса.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fq1\u002Fkz\u002Frx\u002Fq1kzrxg28rfz5nc8yswq_wdearw.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EЛиния видимости ребра перехода\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nЕсли мы допускаем возможность касания или пересечения препятствий, то в вычислениях линии видимости рёбер перехода возникают новые случаи.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВспомним вычисление \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F784\u002Ff98\u002Fdb3\u002F784f98db37a499162c1479600e8465ed.svg\" alt=\"$u$\" data-tex=\"inline\"\u002F\u003E — части расстояния вдоль ребра перехода, на котором перпендикуляр к точке касается ребра. Если касание кругов не допускается, то значение \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F784\u002Ff98\u002Fdb3\u002F784f98db37a499162c1479600e8465ed.svg\" alt=\"$u$\" data-tex=\"inline\"\u002F\u003E находится вне интервала \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fa5d\u002F538\u002Ff83\u002Fa5d538f83bd73f9d1c9e8338db9a398a.svg\" alt=\"$[0,1]$\" data-tex=\"inline\"\u002F\u003E, то есть круг не может касаться ребра, потому что для этого ему нужно было бы касаться одной из конечных точек ребра. Это невозможно, потому что конечные точки ребра уже являются касательными к другим кругам.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОднако если мы допустим возможность наложения кругов, то значения \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F784\u002Ff98\u002Fdb3\u002F784f98db37a499162c1479600e8465ed.svg\" alt=\"$u$\" data-tex=\"inline\"\u002F\u003E вне интервала \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fa5d\u002F538\u002Ff83\u002Fa5d538f83bd73f9d1c9e8338db9a398a.svg\" alt=\"$[0,1]$\" data-tex=\"inline\"\u002F\u003E смогут перекрывать линию видимости вдоль ребра. Это соответствует случаям, когда круг находится за концом ребра перехода, но перекрывает конечную точку или касается её. Чтобы отслеживать такие случаи математически, мы \u003Cem\u003Eограничим\u003C\u002Fem\u003E \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F784\u002Ff98\u002Fdb3\u002F784f98db37a499162c1479600e8465ed.svg\" alt=\"$u$\" data-tex=\"inline\"\u002F\u003E интервалом \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fa5d\u002F538\u002Ff83\u002Fa5d538f83bd73f9d1c9e8338db9a398a.svg\" alt=\"$[0,1]$\" data-tex=\"inline\"\u002F\u003E:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F421\u002F5c7\u002F426\u002F4215c74264b00200388b671f27b3e9f2.svg\" alt=\"$E = A + clamp(u, 0, 1) * (B - A)$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch4\u003EЛиния видимости огибающего ребра\u003C\u002Fh4\u003E\u003Cbr\u002F\u003E\r\nКогда препятствия могут касаться друг друга или пересекаться, огибающие рёбра могут быть заблокированы препятствиями так же, как и рёбра перехода. Рассмотрим огибающее ребро с рисунка ниже. Если огибающего ребра касается другое препятствие, то ребро блокируется и должно быть отброшено.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fl8\u002Fyv\u002F3t\u002Fl8yv3twteszlpv1roazci40eudu.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nЧтобы определить, заблокировано ли огибающее ребро другим препятствием, воспользуемся \u003Ca href=\"http:\u002F\u002Fpaulbourke.net\u002Fgeometry\u002Fcirclesphere\u002F\"\u003Eследующим методом\u003C\u002Fa\u003E для определения точек, в которых пересекаются два круга. Если круги имеют центры в точках \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F493\u002Fc1c\u002F008\u002F493c1c008018df9bed4910321f29ff00.svg\" alt=\"$A$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F20d\u002F8ca\u002Fec6\u002F20d8caec693d8d8eaf70885e408419f6.svg\" alt=\"$B$\" data-tex=\"inline\"\u002F\u003E и радиусы \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F5fa\u002Fa21\u002Fbad\u002F5faa21badaafeb989d7de242c31a04e3.svg\" alt=\"$r_A$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F87e\u002F544\u002F4f6\u002F87e5444f6bd7417684066f4c28a56c96.svg\" alt=\"$r_B$\" data-tex=\"inline\"\u002F\u003E, где \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F35e\u002Fa85\u002F36b\u002F35ea8536b3e6152e60442ccecbc46812.svg\" alt=\"$d$\" data-tex=\"inline\"\u002F\u003E — расстояние между \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F493\u002Fc1c\u002F008\u002F493c1c008018df9bed4910321f29ff00.svg\" alt=\"$A$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F20d\u002F8ca\u002Fec6\u002F20d8caec693d8d8eaf70885e408419f6.svg\" alt=\"$B$\" data-tex=\"inline\"\u002F\u003E, то нам для начала нужно проверить несколько случаев. Если круги не касаются друг друга (то есть \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F82a\u002F305\u002F487\u002F82a3054873212ae0ef5fb1dd30f8e576.svg\" alt=\"$d \u003E r_A + r_B$\" data-tex=\"inline\"\u002F\u003E),\u003Cbr\u002F\u003E\r\nнаходятся один внутри другого (\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F566\u002Ff7b\u002F22b\u002F566f7b22b705b7f86b4ae6d215c558e1.svg\" alt=\"$d &lt; |r_A - r_B|$\" data-tex=\"inline\"\u002F\u003E) или совпадают (\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fb50\u002Fbd4\u002F38e\u002Fb50bd438e42f8085c366eb99ad827be5.svg\" alt=\"$d = 0$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F780\u002F752\u002Ff5b\u002F780752f5bf44c00f046560ffb9ff5f09.svg\" alt=\"$r_A = r_B$\" data-tex=\"inline\"\u002F\u003E), то круги не могут влиять на огибающие рёбра друг друга.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли не одно из этих условий не соблюдается, то круги пересекаются в двух точках; если круги касаются друг друга, то эти две точки совпадают. Рассмотрим \u003Cem\u003Eрадикальную ось\u003C\u002Fem\u003E, соединяющую точки пересечения; она перпендикулярна прямой, соединяющей \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F493\u002Fc1c\u002F008\u002F493c1c008018df9bed4910321f29ff00.svg\" alt=\"$A$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F20d\u002F8ca\u002Fec6\u002F20d8caec693d8d8eaf70885e408419f6.svg\" alt=\"$B$\" data-tex=\"inline\"\u002F\u003E, в какой-то точке \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F47e\u002F792\u002F77d\u002F47e79277dc17c254743475ff05980a53.svg\" alt=\"$C$\" data-tex=\"inline\"\u002F\u003E. Мы можем вычислить расстояние \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F372\u002Fe18\u002F546\u002F372e18546a3b7abb94c2672708bc5dfe.svg\" alt=\"$a$\" data-tex=\"inline\"\u002F\u003E от \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F493\u002Fc1c\u002F008\u002F493c1c008018df9bed4910321f29ff00.svg\" alt=\"$A$\" data-tex=\"inline\"\u002F\u003E до \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F47e\u002F792\u002F77d\u002F47e79277dc17c254743475ff05980a53.svg\" alt=\"$C$\" data-tex=\"inline\"\u002F\u003E следующим образом:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F525\u002F957\u002F036\u002F5259570365f01072a369b7c52e2d9906.svg\" alt=\"$a = {r_A^2 - r_B^2 + d^2 \\over 2d }$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\nНайдя \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F372\u002Fe18\u002F546\u002F372e18546a3b7abb94c2672708bc5dfe.svg\" alt=\"$a$\" data-tex=\"inline\"\u002F\u003E, мы можем найти угол \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fff2\u002Fc64\u002F99d\u002Fff2c6499d038a61a41d7ce75cd78788f.svg\" alt=\"$\\theta$\" data-tex=\"inline\"\u002F\u003E:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003C\u002Fp\u003E\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F0d8\u002F99b\u002F570\u002F0d899b570f49a403825587f1a0424e85.svg\" alt=\"$\\theta = \\arccos {a \\over r_A}$\" data-tex=\"display\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\nЕсли \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fff2\u002Fc64\u002F99d\u002Fff2c6499d038a61a41d7ce75cd78788f.svg\" alt=\"$\\theta$\" data-tex=\"inline\"\u002F\u003E равен нулю, то круги касаются в точке \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F47e\u002F792\u002F77d\u002F47e79277dc17c254743475ff05980a53.svg\" alt=\"$C$\" data-tex=\"inline\"\u002F\u003E. В противном случае существует две точки пересечения, соответствующие положительному и отрицательному \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fff2\u002Fc64\u002F99d\u002Fff2c6499d038a61a41d7ce75cd78788f.svg\" alt=\"$\\theta$\" data-tex=\"inline\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fsn\u002Fga\u002F5s\u002Fsnga5s0m8tyg1sl9j4ndyvk3-o8.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nДалее определим, находится ли какая-нибудь из точек пересечения между начальной и конечной точками огибающего ребра. Если это так, то препятствие блокирует огибающее ребро, и мы должны отбросить это ребро. Заметьте, что нам не нужно рассматривать случай, когда огибающее ребро целиком находится внутри препятствия, потому что отсечение по линии видимости для рёбер перехода уже отбросило это ребро.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПосле внесения изменений в вычисление касательных к двум точкам и линии видимости для рёбер перехода и огибающих рёбер всё работает верно.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EПеременный радиус актора и расширение Минковского\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nПри вычислении навигации круглого объекта в мире круглых препятствий можно учесть наблюдения, упрощающих решение задачи. Во-первых, можно упростить работу, заметив, что движение круга радиусом \u003Cem\u003Er\u003C\u002Fem\u003E по лесу аналогично движению точки через тот же лес с единственным изменением: радиус каждого препятствия увеличивается на \u003Cem\u003Er\u003C\u002Fem\u003E. Это чрезвычайно простой случай применения \u003Cem\u003Eсуммы Минковского\u003C\u002Fem\u003E. Если радиус актора больше нуля, то перед началом мы просто увеличиваем размер препятствий.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EОтложенная генерация рёбер\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nВ общем случае граф для леса из \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F08d\u002F9fa\u002Fefb\u002F08d9faefbe272bdf8fbb80773542e343.svg\" alt=\"$n$\" data-tex=\"inline\"\u002F\u003E препятствий содержит \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fbfc\u002F4d5\u002F67c\u002Fbfc4d567c7180cccd2d41ac8602d45ef.svg\" alt=\"$O(n^2)$\" data-tex=\"inline\"\u002F\u003E рёбер перехода, но так как каждое из них нужно проверить на линию видимости с \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F08d\u002F9fa\u002Fefb\u002F08d9faefbe272bdf8fbb80773542e343.svg\" alt=\"$n$\" data-tex=\"inline\"\u002F\u003E препятствиями, то общее время генерации графа равно \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F858\u002Fdcc\u002Ffd7\u002F858dccfd77b08dc1bc376953c63cbc90.svg\" alt=\"$O(n^3)$\" data-tex=\"inline\"\u002F\u003E. Кроме того, пары рёбер перехода могут приводить к созданию огибающих рёбер, и каждое из них нужно проверить с каждым препятствием на линию видимости. Однако из-за высокой эффективности алгоритма A* обычно для создания оптимального пути он просматривает только часть этого большого графа.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nМы можем сэкономить время, генерируя небольшие части графа на лету в процессе выполнения алгоритма A*, а не делая всю работу заранее. Если A* найдёт путь быстро, то мы сгенерируем только малую часть графа. Мы реализуем это, переместив генерацию рёбер в функцию \u003Ccode\u003Eneighbors()\u003C\u002Fcode\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСуществует несколько случаев. В начале алгоритма нам нужны соседи начальной точки. Это рёбра перехода от начальной точки к левому и правому ребру каждого препятствия.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСледующий случай — когда A* только что добрался до точки \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F839\u002Ff25\u002Fc27\u002F839f25c2746382debd4f08ea25ad5ecf.svg\" alt=\"$p$\" data-tex=\"inline\"\u002F\u003E на ребре препятствия \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F47e\u002F792\u002F77d\u002F47e79277dc17c254743475ff05980a53.svg\" alt=\"$C$\" data-tex=\"inline\"\u002F\u003E вдоль ребра перехода: \u003Ccode\u003Eneighbors()\u003C\u002Fcode\u003E должна вернуть огибающие рёбра, ведущие из \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F839\u002Ff25\u002Fc27\u002F839f25c2746382debd4f08ea25ad5ecf.svg\" alt=\"$p$\" data-tex=\"inline\"\u002F\u003E. Для этого мы определим, какие рёбра перехода выходят из препятствия, вычислив касательные к двум точкам между \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F47e\u002F792\u002F77d\u002F47e79277dc17c254743475ff05980a53.svg\" alt=\"$C$\" data-tex=\"inline\"\u002F\u003E и всеми остальными препятствиями, отбросив все те, которые не находятся на линии видимости. Затем найдём все огибающие рёбра, соединяющие \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F839\u002Ff25\u002Fc27\u002F839f25c2746382debd4f08ea25ad5ecf.svg\" alt=\"$p$\" data-tex=\"inline\"\u002F\u003E с этими рёбрами перехода, отбросив те, которые блокированы другими препятствиями. Возвращаем все эти огибающие рёбра,, сохраняя рёбра перехода для возврата в последующем вызове \u003Ccode\u003Eneighbors()\u003C\u002Fcode\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПоследний случай — когда A* обошёл огибающее ребро вдоль препятствия \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F47e\u002F792\u002F77d\u002F47e79277dc17c254743475ff05980a53.svg\" alt=\"$C$\" data-tex=\"inline\"\u002F\u003E и ему нужно покинуть \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F47e\u002F792\u002F77d\u002F47e79277dc17c254743475ff05980a53.svg\" alt=\"$C$\" data-tex=\"inline\"\u002F\u003E по ребру перехода. Так как предыдущий этап вычислил и сохранил все рёбра перехода, можно просто найти и возвратить правильное множество рёбер.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EОтсекаем заострённые огибающие рёбра\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nОгибающие рёбра соединяют рёбра перехода, касающиеся одного круга, но оказывается, что многие из таких огибающих рёбер не подходят для использования в оптимальном пути. Мы можем ускорить алгоритм, устранив их.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОптимальный путь через лес препятствий всегда состоит из перемежающихся рёбер перехода и огибающих рёбер. Допустим мы входим в узел \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F493\u002Fc1c\u002F008\u002F493c1c008018df9bed4910321f29ff00.svg\" alt=\"$A$\" data-tex=\"inline\"\u002F\u003E и решаем, как из него выйти:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F0d\u002Fvc\u002Fll\u002F0dvcllwpn8xjmmtbzhl9rxmbiwq.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nВход через \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F493\u002Fc1c\u002F008\u002F493c1c008018df9bed4910321f29ff00.svg\" alt=\"$A$\" data-tex=\"inline\"\u002F\u003E означает, что мы движемся \u003Cem\u003Eпо часовой стрелке\u003C\u002Fem\u003E (\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ffad\u002F558\u002Fddd\u002Ffad558ddd37ae450265b5ae9bbffbbd1.svg\" alt=\"$\\circlearrowright$\" data-tex=\"inline\"\u002F\u003E). Мы должны выйти через узел, который позволяет нам продолжать двигаться по часовой стрелке (\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ffad\u002F558\u002Fddd\u002Ffad558ddd37ae450265b5ae9bbffbbd1.svg\" alt=\"$\\circlearrowright$\" data-tex=\"inline\"\u002F\u003E), то есть мы можем выйти только через узел \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F20d\u002F8ca\u002Fec6\u002F20d8caec693d8d8eaf70885e408419f6.svg\" alt=\"$B$\" data-tex=\"inline\"\u002F\u003E или \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fc5e\u002F2ea\u002F3b6\u002Fc5e2ea3b63d255f7a483773fe1d664b2.svg\" alt=\"$D$\" data-tex=\"inline\"\u002F\u003E. Если выйти через \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F47e\u002F792\u002F77d\u002F47e79277dc17c254743475ff05980a53.svg\" alt=\"$C$\" data-tex=\"inline\"\u002F\u003E, то создастся \u003Cem\u003Eперегиб\u003C\u002Fem\u003E (\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F178\u002F29f\u002Ff0f\u002F17829ff0f290513d6c10bc9bc4264048.svg\" alt=\"$\\curlywedge$\" data-tex=\"inline\"\u002F\u003E) пути, что никогда не будет оптимальным. Нам нужно отфильтровывать такие заострённые рёбра.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля начала заметим, что A* и так обрабатывает каждое неориентированное ребро \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F00b\u002F9a0\u002Fb70\u002F00b9a0b705b2b5fc29f24a6c2cb13ec7.svg\" alt=\"$P \\longleftrightarrow Q$\" data-tex=\"inline\"\u002F\u003E как два ориентированных ребра, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd4d\u002F19a\u002Ff21\u002Fd4d19af21ad8cecaaa74aad035504300.svg\" alt=\"$P \\longrightarrow Q$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fa7a\u002Fe35\u002F877\u002Fa7ae35877923ddd6a964f39df84c1a6a.svg\" alt=\"$Q \\longrightarrow P$\" data-tex=\"inline\"\u002F\u003E. Мы можем воспользоваться этим, пометив рёбра и узлы ориентацией.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003EУзлы \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fc3d\u002F2f2\u002Fc44\u002Fc3d2f2c44fc42edea27de7f8f67b4829.svg\" alt=\"$P$\" data-tex=\"inline\"\u002F\u003E становятся узлами с ориентацией — по часовой (\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F384\u002Fea7\u002Fc92\u002F384ea7c929647710d4896892c0568b6d.svg\" alt=\"$P\\circlearrowright$\" data-tex=\"inline\"\u002F\u003E) или против часовой (\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fb33\u002Fd73\u002Fbc0\u002Fb33d73bc005e534dc7b5fc156242f0a6.svg\" alt=\"$P\\circlearrowleft$\" data-tex=\"inline\"\u002F\u003E) стрелки.\u003C\u002Fli\u003E\r\n\u003Cli\u003EНеориентированные рёбра перехода \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F00b\u002F9a0\u002Fb70\u002F00b9a0b705b2b5fc29f24a6c2cb13ec7.svg\" alt=\"$P \\longleftrightarrow Q$\" data-tex=\"inline\"\u002F\u003E становятся ориентированными рёбрами \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F9b8\u002F6ec\u002F15d\u002F9b86ec15d56e63158d17b0481b71ad41.svg\" alt=\"$P,p \\longrightarrow Q,\\hat{q}$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F30f\u002Fd99\u002F018\u002F30fd99018a61f7d1083a661e3b6f24d7.svg\" alt=\"$Q,q \\longrightarrow P,\\hat{p}$\" data-tex=\"inline\"\u002F\u003E, где \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F839\u002Ff25\u002Fc27\u002F839f25c2746382debd4f08ea25ad5ecf.svg\" alt=\"$p$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd68\u002Fcc4\u002F926\u002Fd68cc4926bf74bae8fa3b51ca4a09ec8.svg\" alt=\"$q$\" data-tex=\"inline\"\u002F\u003E — это ориентации, а \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F242\u002F7de\u002Fa25\u002F2427dea25ae9a360123d8c7745544d74.svg\" alt=\"$\\hat{x}$\" data-tex=\"inline\"\u002F\u003E означает направление, противоположное \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F817\u002Fb92\u002F407\u002F817b92407f764f57af9226e50cc788fd.svg\" alt=\"$x$\" data-tex=\"inline\"\u002F\u003E.\u003C\u002Fli\u003E\r\n\u003Cli\u003EНеориентированные огибающие рёбра \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F00b\u002F9a0\u002Fb70\u002F00b9a0b705b2b5fc29f24a6c2cb13ec7.svg\" alt=\"$P \\longleftrightarrow Q$\" data-tex=\"inline\"\u002F\u003E становятся ориентированными рёбрами \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F75d\u002Fb06\u002Fa3f\u002F75db06a3f01eb559d6f4804eadce01da.svg\" alt=\"$P\\circlearrowright \\longrightarrow Q\\circlearrowright$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fd41\u002F8a8\u002Fd69\u002Fd418a8d69ec73ebc960c549a15b1a4c8.svg\" alt=\"$P\\circlearrowleft \\longrightarrow Q\\circlearrowleft$\" data-tex=\"inline\"\u002F\u003E. Именно здесь происходит фильтрация: мы \u003Cem\u003Eне\u003C\u002Fem\u003E включаем \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fc3b\u002Fccc\u002F7de\u002Fc3bccc7de0f34064b2a89798a4e4c2ff.svg\" alt=\"$P\\circlearrowright \\longrightarrow Q\\circlearrowleft$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F25d\u002F534\u002F1cb\u002F25d5341cb2af330b3d0433fa55f5f537.svg\" alt=\"$P\\circlearrowleft \\longrightarrow Q\\circlearrowright$\" data-tex=\"inline\"\u002F\u003E, потому что смена направления создаёт перегибы (\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F178\u002F29f\u002Ff0f\u002F17829ff0f290513d6c10bc9bc4264048.svg\" alt=\"$\\curlywedge$\" data-tex=\"inline\"\u002F\u003E).\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\r\nВ нашей схеме узел \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F493\u002Fc1c\u002F008\u002F493c1c008018df9bed4910321f29ff00.svg\" alt=\"$A$\" data-tex=\"inline\"\u002F\u003E превратится в два узла, \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fee7\u002F11a\u002Fb2e\u002Fee711ab2e08375b707190293905f0a8c.svg\" alt=\"$A\\circlearrowright$\" data-tex=\"inline\"\u002F\u003E и \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fe95\u002F9b0\u002F89d\u002Fe959b089d7c8f203b9d057dbe7e59442.svg\" alt=\"$A\\circlearrowleft$\" data-tex=\"inline\"\u002F\u003E, он имеет входящее ребро перехода \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F8f5\u002F8a1\u002F9b0\u002F8f58a19b0f48b80badb33671bc93d52f.svg\" alt=\"$\\longrightarrow A\\circlearrowright$\" data-tex=\"inline\"\u002F\u003E и исходящее ребро перехода \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F86f\u002F333\u002Faa8\u002F86f333aa8adce9344a174b0852e74687.svg\" alt=\"$A\\circlearrowleft \\longrightarrow$\" data-tex=\"inline\"\u002F\u003E. Если мы попали на путь через \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Fee7\u002F11a\u002Fb2e\u002Fee711ab2e08375b707190293905f0a8c.svg\" alt=\"$A\\circlearrowright$\" data-tex=\"inline\"\u002F\u003E, то должны выйти через узел \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ffad\u002F558\u002Fddd\u002Ffad558ddd37ae450265b5ae9bbffbbd1.svg\" alt=\"$\\circlearrowright$\" data-tex=\"inline\"\u002F\u003E, который будет или ребром перехода \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002Ffea\u002F427\u002F1ef\u002Ffea4271efaf450786ceaceb190785c84.svg\" alt=\"$B\\circlearrowright \\longrightarrow$\" data-tex=\"inline\"\u002F\u003E (через огибающее ребро \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F617\u002Ff4d\u002F8e5\u002F617f4d8e5cb74774f454a54403a4333f.svg\" alt=\"$A\\circlearrowright \\longrightarrow B\\circlearrowright$\" data-tex=\"inline\"\u002F\u003E), или ребро перехода \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F718\u002Ff55\u002F434\u002F718f5543424088b94c9dbd7d6fab9e0d.svg\" alt=\"$D\\circlearrowright \\longrightarrow$\" data-tex=\"inline\"\u002F\u003E (через огибающее ребро \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F518\u002F6a4\u002F2af\u002F5186a42af5de151d1f3952787c86cc87.svg\" alt=\"$A\\circlearrowright \\longrightarrow D\\circlearrowright$\" data-tex=\"inline\"\u002F\u003E). Мы не можем выйти через \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F7f8\u002F71e\u002F837\u002F7f871e8373a281c188165dc02dabb3c9.svg\" alt=\"$C\\circlearrowleft \\longrightarrow$\" data-tex=\"inline\"\u002F\u003E, потому что так изменится направление поворота, и мы отфильтровали огибающее ребро \u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fformulas\u002F797\u002F282\u002F797\u002F797282797e7773d4a16d91d165e95820.svg\" alt=\"$A\\circlearrowright \\longrightarrow C\\circlearrowleft$\" data-tex=\"inline\"\u002F\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОтфильтровав из графа эти заострённые огибающие рёбра, мы повысили эффективность алгоритма.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EОтсечение пересекающих рёбер\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nМожно отсекать частичные пути, последние рёбра перехода которых пересекают предпоследнее ребро перехода.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EМногоугольные препятствия\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nСм. \u003Ca href=\"https:\u002F\u002Fdl.acm.org\u002Fcitation.cfm?id=516343\"\u003EGame Programming Gems 2\u003C\u002Fa\u003E, Chapter 3.10, Optimizing Points-of-Visibility Pathfinding, написанную Томасом Янгом. В этой главе рассматривается отсечение узлов, но не для кругов, а для многоугольников.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EСправочные материалы\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FBelt_problem\"\u003EЗадача ремней\u003C\u002Fa\u003E\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FBelt_problem#Pulley_problem\"\u003EЗадача шкивов\u003C\u002Fa\u003E\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ca href=\"http:\u002F\u002Fpaulbourke.net\u002Fgeometry\u002Fpointlineplane\u002F\"\u003EРасстояние между точкой и прямой\u003C\u002Fa\u003E\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ca href=\"http:\u002F\u002Fpaulbourke.net\u002Fgeometry\u002Fcirclesphere\u002F\"\u003EПересечение двух окружностей\u003C\u002Fa\u003E\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"поиск пути"},{"titleHtml":"графы"},{"titleHtml":"алгоритм a*"},{"titleHtml":"алгоритмы поиска пути"},{"titleHtml":"ориентированный граф"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F451642\u002Ff638dc75225b9794b0d4e252ae38938f\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F451642\u002Ff638dc75225b9794b0d4e252ae38938f\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F451642\\\u002F\"},\"headline\":\"Поиск пути среди круглых препятствий\",\"datePublished\":\"2019-05-15T12:05:28+03:00\",\"dateModified\":\"2019-05-15T19:32:50+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"PatientZero\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Навигация по лесу Алгоритм поиска пути A* &mdash; это мощный инструмент для быстрой генерации оптимальных путей. Обычно A* демонстрируют при навигации по картам из сет...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F451642\\\u002F#post-content-body\",\"about\":[\"h_programming\",\"h_gamedev\",\"h_algorithms\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F56\\\u002Fel\\\u002Fcv\\\u002F56elcvzdfv_ggmypuirpqwr3k1u.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fo4\\\u002Fol\\\u002Fle\\\u002Fo4ollekxzlr3gchklwsb9qc-yfc.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fy9\\\u002Fbg\\\u002Fhp\\\u002Fy9bghpeee4olqqeduhnxhx_9ii8.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fff2\\\u002Fc64\\\u002F99d\\\u002Fff2c6499d038a61a41d7ce75cd78788f.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fer\\\u002F_n\\\u002Fc3\\\u002Fer_nc3arspfrz_r70ofttmjgekk.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F493\\\u002Fc1c\\\u002F008\\\u002F493c1c008018df9bed4910321f29ff00.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F20d\\\u002F8ca\\\u002Fec6\\\u002F20d8caec693d8d8eaf70885e408419f6.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F5fa\\\u002Fa21\\\u002Fbad\\\u002F5faa21badaafeb989d7de242c31a04e3.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F87e\\\u002F544\\\u002F4f6\\\u002F87e5444f6bd7417684066f4c28a56c96.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F35e\\\u002Fa85\\\u002F36b\\\u002F35ea8536b3e6152e60442ccecbc46812.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F872\\\u002F703\\\u002Fd45\\\u002F872703d458fc8787c1a2ce98adc0c7a3.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F47e\\\u002F792\\\u002F77d\\\u002F47e79277dc17c254743475ff05980a53.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fc5e\\\u002F2ea\\\u002F3b6\\\u002Fc5e2ea3b63d255f7a483773fe1d664b2.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fd4f\\\u002F55a\\\u002F37f\\\u002Fd4f55a37fb733b176d0ef014591e1b35.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fb8b\\\u002F97c\\\u002F656\\\u002Fb8b97c6567171cc2b6a7f303a0fa8b0a.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fbc\\\u002Ffd\\\u002Fs-\\\u002Fbcfds-ush6unllsd497vq6fng6u.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F2be\\\u002F33a\\\u002Fe72\\\u002F2be33ae72ada1a05087952910c245c75.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fku\\\u002Fbk\\\u002Fhu\\\u002Fkubkhu2akmvzn4vizydsmvtqw0o.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fb38\\\u002F43a\\\u002F0f0\\\u002Fb3843a0f0dcb58cf3bbf8cfe181ec2a7.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F784\\\u002Ff98\\\u002Fdb3\\\u002F784f98db37a499162c1479600e8465ed.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F25d\\\u002F071\\\u002Fce2\\\u002F25d071ce22ed3b92b9f5bfe00d5507ad.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F613\\\u002Fd14\\\u002F937\\\u002F613d14937fc122b080b8d12441d07ec4.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fk5\\\u002Fl0\\\u002Fvh\\\u002Fk5l0vh-rxwfiqpbpxcnkh0jwlqg.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F623\\\u002F832\\\u002Fa63\\\u002F623832a63c4065bba480eef52eae4471.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F392\\\u002Fc15\\\u002F903\\\u002F392c159030125c43515d6956bf64bb1c.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fde0\\\u002F558\\\u002F47d\\\u002Fde055847d429a6d927facd7df61cda54.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fun\\\u002F-n\\\u002Fex\\\u002Fun-nex5m1a6aeityrwuxt9sn67o.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F4cc\\\u002Fa97\\\u002F67d\\\u002F4cca9767d874299cb925a78352b33d15.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F18f\\\u002F000\\\u002F34f\\\u002F18f00034fa5ce903aae2db2027678177.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F168\\\u002F2a7\\\u002Fd9e\\\u002F1682a7d9e2b192aa4a2be016f0aab5eb.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fq1\\\u002Fkz\\\u002Frx\\\u002Fq1kzrxg28rfz5nc8yswq_wdearw.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fa5d\\\u002F538\\\u002Ff83\\\u002Fa5d538f83bd73f9d1c9e8338db9a398a.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F421\\\u002F5c7\\\u002F426\\\u002F4215c74264b00200388b671f27b3e9f2.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fl8\\\u002Fyv\\\u002F3t\\\u002Fl8yv3twteszlpv1roazci40eudu.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F82a\\\u002F305\\\u002F487\\\u002F82a3054873212ae0ef5fb1dd30f8e576.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F566\\\u002Ff7b\\\u002F22b\\\u002F566f7b22b705b7f86b4ae6d215c558e1.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fb50\\\u002Fbd4\\\u002F38e\\\u002Fb50bd438e42f8085c366eb99ad827be5.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F780\\\u002F752\\\u002Ff5b\\\u002F780752f5bf44c00f046560ffb9ff5f09.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F372\\\u002Fe18\\\u002F546\\\u002F372e18546a3b7abb94c2672708bc5dfe.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F525\\\u002F957\\\u002F036\\\u002F5259570365f01072a369b7c52e2d9906.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F0d8\\\u002F99b\\\u002F570\\\u002F0d899b570f49a403825587f1a0424e85.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fsn\\\u002Fga\\\u002F5s\\\u002Fsnga5s0m8tyg1sl9j4ndyvk3-o8.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F08d\\\u002F9fa\\\u002Fefb\\\u002F08d9faefbe272bdf8fbb80773542e343.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fbfc\\\u002F4d5\\\u002F67c\\\u002Fbfc4d567c7180cccd2d41ac8602d45ef.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F858\\\u002Fdcc\\\u002Ffd7\\\u002F858dccfd77b08dc1bc376953c63cbc90.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F839\\\u002Ff25\\\u002Fc27\\\u002F839f25c2746382debd4f08ea25ad5ecf.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F0d\\\u002Fvc\\\u002Fll\\\u002F0dvcllwpn8xjmmtbzhl9rxmbiwq.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Ffad\\\u002F558\\\u002Fddd\\\u002Ffad558ddd37ae450265b5ae9bbffbbd1.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F178\\\u002F29f\\\u002Ff0f\\\u002F17829ff0f290513d6c10bc9bc4264048.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F00b\\\u002F9a0\\\u002Fb70\\\u002F00b9a0b705b2b5fc29f24a6c2cb13ec7.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fd4d\\\u002F19a\\\u002Ff21\\\u002Fd4d19af21ad8cecaaa74aad035504300.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fa7a\\\u002Fe35\\\u002F877\\\u002Fa7ae35877923ddd6a964f39df84c1a6a.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fc3d\\\u002F2f2\\\u002Fc44\\\u002Fc3d2f2c44fc42edea27de7f8f67b4829.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F384\\\u002Fea7\\\u002Fc92\\\u002F384ea7c929647710d4896892c0568b6d.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fb33\\\u002Fd73\\\u002Fbc0\\\u002Fb33d73bc005e534dc7b5fc156242f0a6.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F9b8\\\u002F6ec\\\u002F15d\\\u002F9b86ec15d56e63158d17b0481b71ad41.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F30f\\\u002Fd99\\\u002F018\\\u002F30fd99018a61f7d1083a661e3b6f24d7.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fd68\\\u002Fcc4\\\u002F926\\\u002Fd68cc4926bf74bae8fa3b51ca4a09ec8.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F242\\\u002F7de\\\u002Fa25\\\u002F2427dea25ae9a360123d8c7745544d74.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F817\\\u002Fb92\\\u002F407\\\u002F817b92407f764f57af9226e50cc788fd.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F75d\\\u002Fb06\\\u002Fa3f\\\u002F75db06a3f01eb559d6f4804eadce01da.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fd41\\\u002F8a8\\\u002Fd69\\\u002Fd418a8d69ec73ebc960c549a15b1a4c8.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fc3b\\\u002Fccc\\\u002F7de\\\u002Fc3bccc7de0f34064b2a89798a4e4c2ff.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F25d\\\u002F534\\\u002F1cb\\\u002F25d5341cb2af330b3d0433fa55f5f537.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fee7\\\u002F11a\\\u002Fb2e\\\u002Fee711ab2e08375b707190293905f0a8c.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Fe95\\\u002F9b0\\\u002F89d\\\u002Fe959b089d7c8f203b9d057dbe7e59442.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F8f5\\\u002F8a1\\\u002F9b0\\\u002F8f58a19b0f48b80badb33671bc93d52f.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F86f\\\u002F333\\\u002Faa8\\\u002F86f333aa8adce9344a174b0852e74687.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002Ffea\\\u002F427\\\u002F1ef\\\u002Ffea4271efaf450786ceaceb190785c84.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F617\\\u002Ff4d\\\u002F8e5\\\u002F617f4d8e5cb74774f454a54403a4333f.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F718\\\u002Ff55\\\u002F434\\\u002F718f5543424088b94c9dbd7d6fab9e0d.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F518\\\u002F6a4\\\u002F2af\\\u002F5186a42af5de151d1f3952787c86cc87.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F7f8\\\u002F71e\\\u002F837\\\u002F7f871e8373a281c188165dc02dabb3c9.svg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fformulas\\\u002F797\\\u002F282\\\u002F797\\\u002F797282797e7773d4a16d91d165e95820.svg\"]}","metaDescription":"Навигация по лесу\r\nАлгоритм поиска пути A* — это мощный инструмент для быстрой генерации оптимальных путей. Обычно A* демонстрируют при навигации по картам из сеток, но он может использоваться не...","mainImageUrl":null,"amp":false},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":true}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":"programming,gamedev,algorithms"},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
