<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>How to make possible micro-payments in your app / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/en\/post\/452666\/"},"headline":"How to make possible micro-payments in your app","datePublished":"2019-05-20T18:16:51+03:00","dateModified":"2019-05-21T14:22:21+03:00","author":{"@type":"Person","name":"reablaz"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"This week I spent coding my very first public pet-app based on Telegram chat bot which acts as a Bitcoin wallet and allows to send and receive tips between...","url":"https:\/\/habr.com\/en\/post\/452666\/#post-content-body","about":["h_p2p","h_open_source","h_pay_system","h_programming","h_cryptocurrency","f_develop","f_admin","f_popsci"],"image":["https:\/\/habrastorage.org\/getpro\/habr\/post_images\/097\/02b\/175\/09702b1750c94616a10fc66c1275c00f.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/3ef\/1ff\/85f\/3ef1ff85f1e7b77662c63a9d4d838666.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/883\/661\/461\/883661461bdc686aec7d084d5d581236.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/779\/716\/5d9\/7797165d93d292700d9a41a171d882a6.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/8fe\/33b\/84b\/8fe33b84bb127132304634363bb4af42.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/4a3\/da5\/f76\/4a3da5f76574ac9ebb2161d56bceff62.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/54d\/a43\/0be\/54da430be68237193dee82ade50bab37.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/3c6\/636\/b8c\/3c6636b8c98d52aab9bd09ff9c52afcb.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/518\/3dc\/c81\/5183dcc817817f1aa676ff74d17d08bb.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/f09\/c3a\/ef9\/f09c3aef995f7a82560987646b0d8ee0.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/1e2\/344\/82c\/1e234482c56aa0df1d4b341ecfe3beb8.png"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="How to make possible micro-payments in your app" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="How to make possible micro-payments in your app" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="How to make possible micro-payments in your app" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="This week I spent coding my very first public pet-app based on Telegram chat bot which acts as a Bitcoin wallet and allows to send and receive tips between Telegram users and other so-called..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="This week I spent coding my very first public pet-app based on Telegram chat bot which acts as a Bitcoin wallet and allows to send and receive tips between Telegram users and other so-called..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="This week I spent coding my very first public pet-app based on Telegram chat bot which acts as a Bitcoin wallet and allows to send and receive tips between Telegram users and other so-called..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="This week I spent coding my very first public pet-app based on Telegram chat bot which acts as a Bitcoin wallet and allows to send and receive tips between Telegram users and other so-called..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="This week I spent coding my very first public pet-app based on Telegram chat bot which acts as a Bitcoin wallet and allows to send and receive tips between Telegram users and other so-called..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/452666/389ea9270855050ae329d541d16f991e/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/452666/389ea9270855050ae329d541d16f991e/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/452666/389ea9270855050ae329d541d16f991e/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/452666/389ea9270855050ae329d541d16f991e/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/452666/389ea9270855050ae329d541d16f991e/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="452666" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2019-05-20T15:16:51.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="en_US" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/452666/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/en/post/452666/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/452666/389ea9270855050ae329d541d16f991e/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/reablaz/" title="reablaz" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_pink"><!----> <use xlink:href="/img/megazord-v24.ce74655c.svg#placeholder-user"></use></svg></div></a> <span class="tm-user-info__user"><a href="/ru/users/reablaz/" class="tm-user-info__username">
      reablaz
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2019-05-20T15:16:51.000Z" title="2019-05-20, 18:16">20  мая  2019 в 18:16</time></span></div> <!----></div> <h1 lang="en" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>How to make possible micro-payments in your app</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/p2p/" class="tm-article-snippet__hubs-item-link"><span>Децентрализованные сети</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/open_source/" class="tm-article-snippet__hubs-item-link"><span>Open source</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/pay_system/" class="tm-article-snippet__hubs-item-link"><span>Платежные системы</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/programming/" class="tm-article-snippet__hubs-item-link"><span>Программирование</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/cryptocurrency/" class="tm-article-snippet__hubs-item-link"><span>Криптовалюты</span> <!----></a></span></div> <div class="tm-article-snippet__labels"><div class="tm-article-snippet__label"><span>
        Из песочницы
      </span></div><div class="tm-article-snippet__label"><span>
        Tutorial
      </span></div></div> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="en" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml"><p>This week I spent coding my very first public pet-app based on Telegram chat bot which acts as a Bitcoin wallet and allows to send and receive tips between Telegram users and other so-called “Lightning Apps”. I assume that you are familiar with Bitcoin &amp; Telegram in general, i’ll try to post short and without deep jump into details. More <a href="https://www.lopp.net/bitcoin-information.html">resources about Bitcoin can be found here</a> and Telegram is simply an instant messenger that allows you to create your custom apps (chat-bots) using their platform.</p><br/>
<h3>What are the key points of such app?</h3><br/>
<ul>
<li>Allows to rate other users ideas and answers with real value instead of<br/>
 ‘virtual likes’. This brings online conversation to completely new level</li>
<li>Real example of working micro-payment app which can act with other entities<br/>
 over internet using open protocol</li>
<li>All the modules are open-source projects and can be easy re-used and adjusted<br/>
 for your own project. App does not relay on third-party commercial services.<br/>
 Even it falls under e-commerce field, which is currently almost closed, the app<br/>
 is based on open solutions.</li>
</ul><br/>
<h3>What are the use-cases?</h3><br/>
<p>something like this…<br/>
</p><div style="text-align:center;"><img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/097/02b/175/09702b1750c94616a10fc66c1275c00f.png"/></div><a name="habracut"></a><br/>
or like that..<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/3ef/1ff/85f/3ef1ff85f1e7b77662c63a9d4d838666.png"/></div><br/>
<p>What do numbers mean? These are <b>bitcoin units — satoshis</b>. As for mid-2019 1000 satoshis has value of $0.06. You can spend it online or exchange to your local currency using many available services. So this is not just another <i>"number in a database"</i> or a<i> "coupons you can spend in our partner store"</i>, but a <b>real internet money</b>.</p><br/>
<p>You may ask what to do, if you don’t have any bitcoin to use in the app. You simply can receive a tip from existing app user or buy small amount of bitcoin on various exchanges or bitcoin wallets for mobile phone or pc.</p><br/>
<p><img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/883/661/461/883661461bdc686aec7d084d5d581236.png"/><img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/779/716/5d9/7797165d93d292700d9a41a171d882a6.png"/><img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/8fe/33b/84b/8fe33b84bb127132304634363bb4af42.png"/></p><br/>
<p>When you got bitcoin, you can start <a href="https://t.me/atomic_tipbot">@atomic_tipbot</a> and make a /deposit.</p><br/>
<p>You'll see an invoice, you can select preferred payment method and send money just scanning the QR code or with button press (<i>"open in wallet"</i>) on invoice. </p><br/>
<p><img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/8fe/33b/84b/8fe33b84bb127132304634363bb4af42.png"/><img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/4a3/da5/f76/4a3da5f76574ac9ebb2161d56bceff62.png"/><img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/54d/a43/0be/54da430be68237193dee82ade50bab37.png"/></p><br/>
<p>Confirm payment in your mobile wallet, and you will see a confirmation screen almost instantly in Telegram.</p><br/>
<p>So far we touched two separate parts of the app: telegram bot back-end and payment processing system (actually more like it's front-end).</p><br/>
<p>To create this Telegram bot i’ve used <a href="http://python-telegram-bot.readthedocs.io/">Python Telegram Bot</a>. And of course, the <a href="https://github.com/reablaz/atomic_tipbot">bot is open-source</a>.</p><br/>
<p>As a payment processing system to generate invoices, check status, send notification and take care of UX is used <a href="https://www.youtube.com/watch?v=nr0UNbz3AoQ">BTCPayServer</a> which <a href="https://docs.btcpayserver.org/">documentation can be found here</a>.</p><br/>
<p>If you are looking on how to process payment events directly, you can look at <a href="http://docs.electrum.org/en/latest/cmdline.html">Electrum CLI manual pages</a> for on-chain payments and check out solutions for off-chain (Lightning) payments like <a href="https://github.com/ElementsProject/lightning-charge">Lightning-charge</a> or <a href="https://github.com/fiatjaf/sparko">Sparko</a>.</p><br/>
<h3>You said ‘no 3rd party’ and ‘no cloud services’!?</h3><br/>
<p>Yes, that’s true. In my app i am using free shared hosting of BTCPayServer instance — <a href="https://btcpayjungle.com">BTCPayJungle</a>, but it is possible to spin up even on your own dedicated server. Just remember that you need then about ~500GB of space to store Bitcoin and Litecoin blockchain. BTCPayServer does not hold any private keys or sensitive information that can allow hackers to control funds on you wallet. For on-chain (standart) payments you need to provide xpub key from you wallet to BTCPayServer so it will be able to generate public addresses. In this way, BTCPay architecture makes possible to process payments in trustless manner even on shared environment. It is very simple to configure if you use proven wallets such as <a href="http://electrum.org/">Electrum</a>.</p><br/>
<h3>What is Lightning Network?</h3><br/>
<p>It is something like an add-on to Bitcoin which adds additional abstraction layer and allows to make instant and almost free bitcoin transactions. All this stuff is possible thanks to cryptographic multi-signature magic, which is often called <em>smart-contract</em>. There are multiple implementations of LN protocol. I am using <a href="https://github.com/ElementsProject/lightning">c-lightning</a> C implementation. </p><br/>
<p>The major difference between on-chain and off-chain (Lightning) payments are in how transactions are stored. All <b>on-chain</b> transactions are broadcasted to the whole network so each running bitcoin node will record this transaction into blockchain, if block containing this transaction will be <a href="https://en.bitcoin.it/wiki/Mining">mined</a>. Hey, <a href="https://habr.com/ru/users/bitfury/" class="user_link">BitFury</a>, am i right? ;) That's why we call such transactions <b>on-chain</b>. Such transactions will be stored in blockchain till the end of its existence. It is possible publicly to track, analyse and monitor any such transaction over the network.</p><br/>
<p>In case of <b>off-chain</b> (Lightning) transaction things happens in other way. Each lightning node has <i>(may be many)</i> on-chain address, from which one all starts. When funds are received on such address, using cryptography techniques node may open so-called <i>lightning channel</i> to another node, what means that these two nodes made agreement about funds availability between them. Later, all the transactions that are made trough channel (own transactions, or it may be routed transaction from another node) are stored only on those two nodes (and intermediate node if there was such). The only transactions which are stored in networks blockchain are channel opening and closing transactions. This is why Lightning transactions we call <b>off-chain</b>. Mostly they exist only in node database-file.</p><br/>
<h3>The whole thing is visualized on diagram</h3><br/>
<img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/3c6/636/b8c/3c6636b8c98d52aab9bd09ff9c52afcb.png"/><br/>
<p>Short story:</p><br/>
<p>1) User sends message and requests deposit to bot on <b>Telegram</b></p><br/>
<p>2) Telegram triggers bot's <b>python app</b></p><br/>
<p>3) <b>python app</b> sends request to <b>BTCPayServer</b></p><br/>
<p>4) BTCPayServer generates incoming addresses for BTC and LTC, as well contacting <b>lightning-charge</b>, which one is getting data from <b>c-lightning</b> daemon. In a result we get well-handled HTML frame for payment processing</p><br/>
<p>5) User pays invoice and will see confirmation</p><br/>
<p>6) <b>BTCPayServer</b> sends<i> invoice payment notification</i> (IPN) to specified callback url, in our case it<br/>
will go to <b>callbacks.py</b> (another python app to listen for callbacks)</p><br/>
<p>7) According to complete payment detail user balance is changed and user gets notification</p><br/>
<p><i>… if user decides to withdraw funds (tips he received) …</i></p><br/>
<p>8) <b>Bot's python app</b> listens to text or image of QR, when it gets invoice data (long string of characters) then it sends request to pay that invoice to another python app <b>paylightning.py*</b>, which initializes pay-outs using c-lightning RPC.</p><br/>
<img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/518/3dc/c81/5183dcc817817f1aa676ff74d17d08bb.png"/><br/>
<p><i>*To be fair, I need to mention that my pay-wrapper paylightning.py is incomplete and may return false-negative in some specific cases. You should use <a href="https://github.com/fiatjaf/lightningd-gjson-rpc/tree/master/cmd/waitpay">well-tested payment wrapper for c-lightning</a> in case of production-like use.</i></p><br/>
<p>Users are able to send tips to each other on group chats and send/receive <b>value</b> without any limits. But that’s not all. Thanks to Lightning Network protocol, which is in some kind of unified and simplified payment network you are able to send same balance coins to completely different apps. There is another bitcoin tip-bot on telegram — @lntxbot. User can request a deposit to this bot</p><br/>
<p><img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/f09/c3a/ef9/f09c3aef995f7a82560987646b0d8ee0.png"/> <img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/1e2/344/82c/1e234482c56aa0df1d4b341ecfe3beb8.png"/></p><br/>
<p>Simply forward data from @lntxbot to @atomic_tipbot and voul’a!</p><br/>
<p>This is not anymore ‘number swap in database’ but payment between two separate, non-related ‘databases’. Bot already has few 'LApps' integrated: <a href="https://sat2.io">sat2.io</a> and <a href="https://lnsms.world">lnsms.world</a>.</p><br/>
<p><b>You may ask, what exactly means <i>LApp integration</i>?</b></p><br/>
<p>Each <i>Lightning Network</i> node acts as a bitcoin wallet. It has both on-chain and off-chain balance. The on-chain balance usually is used to open channels and store funds from closed channels, in short — nodes maintenance tasks. The off-chain balance is what exactly is used to exchange funds between nodes. The core functions of each node is ability to send or receive funds, so node as a software provides <i><b>pay</b></i> and <i><b>invoice</b></i> methods. I'll show in short how it happens:</p><br/>
<pre><code class="bash">user@ln-node:/ % lightning-cli invoice 1000000000 internal_description external_description
{
   "payment_hash" : "64c0c8f5f8f708b08487ad1376f3d256f92ccb9606987ba395c2b4193efde5a0",
   "expires_at" : 1558709834,
   "bolt11" : "lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6"
}</code></pre><br/>
<p>The <a href="https://github.com/lightningnetwork/lightning-rfc/blob/master/11-payment-encoding.md">BOLT11</a> invoice is generated in this case, which is unified format for payment requests in Bitcoin (as well as Litecoin) network. This string includes data about invoice recipient, amount, timestamp, expiration etc. To decode this string c-lightning provides decodepay method:</p><br/>
<pre><code class="bash">user@ln-node:/ % lightning-cli decodepay lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6
{
   "currency" : "bc",
   "created_at" : 1558105034,
   "expiry" : 604800,
   "payee" : "025a14b8ed40583d67aec92da19453e0b2d1fbbf75f96f85d3dd0ff61a51ee0490",
   "msatoshi" : 1000000000,
   "amount_msat" : "1000000000msat",
   "description" : "external_description",
   "min_final_cltv_expiry" : 10,
   "routes" : [
      [
         {
            "pubkey" : "03a20c0c2ae4508b669a70e5f82f08f69a3da5da3bf0c973673c3fe977db0f61e3",
            "short_channel_id" : "574012x1255x1",
            "fee_base_msat" : 1000,
            "fee_proportional_millionths" : 1,
            "cltv_expiry_delta" : 144
         }
      ]
   ],
   "payment_hash" : "64c0c8f5f8f708b08487ad1376f3d256f92ccb9606987ba395c2b4193efde5a0",
   "signature" : "304502210099f31dffd18b6db8296637db3e3a1ffbaf7b7db087a2ad1eedb7639f25e78b25022079038370073681aa1e1a7a05de6588e98ead078896d0a37a15b755c212dc3d37"
}</code></pre><br/>
<p>In case we need to pay some invoice, we should use pay method of c-lightning:</p><br/>
<pre><code class="bash">user@ln-node:/ % lightning-cli pay lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j
{
   "id" : 163,
   "payment_hash" : "c3e644a005f56e33df89facbce2c9dfcabbef5d105285a98272cacc77ab2de63",
   "destination" : "03021c5f5f57322740e4ee6936452add19dc7ea7ccf90635f95119ab82a62ae268",
   "msatoshi" : 200000,
   "amount_msat" : "200000msat",
   "msatoshi_sent" : 200003,
   "amount_sent_msat" : "200003msat",
   "created_at" : 1558106072,
   "status" : "complete",
   "payment_preimage" : "1a9552b9f4e9199e26839353f870b12cc85b7674a2fb134e78aa370032611019",
   "bolt11" : "lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j"
}</code></pre><br/>
<p>All the statuses of payments are handled by the whole network and your own node. You don't have a need (but have a possibility to do so) to communicate at all with receiving-side app developers or their API, some card processing provider or any bank to get confirmation about your payment or to release funds from your own account. There are no charge-backs or any other kind of external influence on you accounts balance. All you need is a software which acts by decentralized network rules. This is a solution to exchange a value over internet, without a need of any kind of arbiter in the middle who decides about your payment compatibility with some rules, sometimes even previously unknown to all parties. There are no "internal" rules in bitcoin, all the rules your app needs to complete with are open and known. </p><br/>
<p>This makes possible <b>direct</b>, <b>almost free</b> and <b>instant</b> value exchange over internet between people or even software itself in truly autonomous way.</p><br/>
<p>If there is a way to get payment data from other app then you are able to act with it in financial sense. As in our example, lnsms.world is a web-app that allows you to send sms to any number and pay for it with bitcoin. To integrate such option in our app we simply need to pass required data from web-form to lnsms.world:</p><br/>
<pre><code class="python">payload = {                                                                                                                           
        'number': phone_number,
        'text': text,
        'force_unicode': 0
    }

    send_req = requests.post('https://lnsms.world/invoice', data=payload)
    if send_req.status_code == 201:
        plain_invoice = str(send_req.text)</code></pre><br/>
<p>I don't know for what reason, but lnsms responds with 201 HTTP status code and returns BOLT11 invoice. Well, that's enough to pay this invoice and our users will send sms shortly after payment is received. We can charge some fee on top or not, that is our free choice.</p><br/>
<p>Now, imagine, that your bot is actually some more useful app and pays not another bot, but some other entity, connected to the Internet. Or, those may be payments between software, machines, stores, service providers on regular basis repeating each few seconds? Do you feel the power of micro-payments? That is how the Internet of Things will look like. Already now there are such projects as <a href="https://althea.org/">https://althea.org/</a> and in near future we will face great changes in field what we call e-commerce.</p><br/>
<p>If you like this post and would try bitcoin payments yourself you can <a href="https://tip.ysx.in">leave me a tip on my tipping page</a>.</p></div></div> <!----> <div class="tm-article-poll"><div class="tm-notice tm-article-poll__notice tm-notice_positive"><!----> <div class="tm-notice__inner"><!----> <div class="tm-notice__content"><span>Только зарегистрированные пользователи могут участвовать в опросе. <a rel="nofollow" href="/kek/v1/auth/habrahabr/?back=/ru/post/452666/&hl=ru">Войдите</a>, пожалуйста.</span></div></div></div> <div class="tm-article-poll__header">Are you interested in pure-technical posts about Bitcoin and related software?</div> <div class="tm-article-poll__answers"><div class="tm-article-poll__answer"><div class="tm-article-poll__answer-data"><span class="tm-article-poll__answer-percent">
            0%
          </span> <span class="tm-article-poll__answer-label">Yes</span> <span class="tm-article-poll__answer-votes">
            0
          </span></div> <div class="tm-article-poll__answer-bar"><div class="tm-article-poll__answer-progress" style="width:0%;"></div></div></div><div class="tm-article-poll__answer"><div class="tm-article-poll__answer-data"><span class="tm-article-poll__answer-percent">
            0%
          </span> <span class="tm-article-poll__answer-label">No</span> <span class="tm-article-poll__answer-votes">
            0
          </span></div> <div class="tm-article-poll__answer-bar"><div class="tm-article-poll__answer-progress" style="width:0%;"></div></div></div><div class="tm-article-poll__answer"><div class="tm-article-poll__answer-data"><span class="tm-article-poll__answer-percent tm-article-poll__answer-percent_winning">
            0%
          </span> <span class="tm-article-poll__answer-label">I prefer market-related posts more</span> <span class="tm-article-poll__answer-votes">
            0
          </span></div> <div class="tm-article-poll__answer-bar"><div class="tm-article-poll__answer-progress tm-article-poll__answer-progress_winning" style="width:0%;"></div></div></div></div> <div class="tm-article-poll__stats">
       Никто еще не голосовал. 

       Воздержался 1 пользователь. 
    </div></div></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Binstant%20messaging%5D" class="tm-tags-list__link">instant messaging</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bbitcoin%5D" class="tm-tags-list__link">bitcoin</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bcryptocurrency%5D" class="tm-tags-list__link">cryptocurrency</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bpayments%5D" class="tm-tags-list__link">payments</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Be-commerce%5D" class="tm-tags-list__link">e-commerce</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bopen-source%5D" class="tm-tags-list__link">open-source</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bp2p%5D" class="tm-tags-list__link">p2p</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bdecentralized%20platforms%5D" class="tm-tags-list__link">decentralized platforms</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hub/p2p/" class="tm-hubs-list__link">
    Децентрализованные сети
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/open_source/" class="tm-hubs-list__link">
    Open source
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/pay_system/" class="tm-hubs-list__link">
    Платежные системы
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/programming/" class="tm-hubs-list__link">
    Программирование
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/cryptocurrency/" class="tm-hubs-list__link">
    Криптовалюты
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 12: ↑11 и ↓1</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 12: ↑11 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+10</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">3.5K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    1
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/reablaz/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><svg class="tm-svg-img tm-image-placeholder tm-image-placeholder_pink"><!----> <use xlink:href="/img/megazord-v24.ce74655c.svg#placeholder-user"></use></svg></div></a> <div class="tm-user-card__meta"><div title=" 28 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    14
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><!----> <a href="/ru/users/reablaz/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @reablaz
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">User</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/452666/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментировать 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <!----> <!----> <!----> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/452666/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/452666/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"452666":{"id":"452666","timePublished":"2019-05-20T15:16:51+00:00","isCorporative":false,"lang":"en","titleHtml":"How to make possible micro-payments in your app","leadData":{"textHtml":"\u003Cp\u003EThis week I spent coding my very first public pet-app based on Telegram chat bot which acts as a Bitcoin wallet and allows to send and receive tips between Telegram users and other so-called “Lightning Apps”. I assume that you are familiar with Bitcoin &amp; Telegram in general, i’ll try to post short and without deep jump into details. More \u003Ca href=\"https:\u002F\u002Fwww.lopp.net\u002Fbitcoin-information.html\"\u003Eresources about Bitcoin can be found here\u003C\u002Fa\u003E and Telegram is simply an instant messenger that allows you to create your custom apps (chat-bots) using their platform.\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Ch3\u003EWhat are the key points of such app?\u003C\u002Fh3\u003E\u003Cbr\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003EAllows to rate other users ideas and answers with real value instead of\u003Cbr\u003E\r\n ‘virtual likes’. This brings online conversation to completely new level\u003C\u002Fli\u003E\r\n\u003Cli\u003EReal example of working micro-payment app which can act with other entities\u003Cbr\u003E\r\n over internet using open protocol\u003C\u002Fli\u003E\r\n\u003Cli\u003EAll the modules are open-source projects and can be easy re-used and adjusted\u003Cbr\u003E\r\n for your own project. App does not relay on third-party commercial services.\u003Cbr\u003E\r\n Even it falls under e-commerce field, which is currently almost closed, the app\u003Cbr\u003E\r\n is based on open solutions.\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u003E\r\n\u003Ch3\u003EWhat are the use-cases?\u003C\u002Fh3\u003E\u003Cbr\u003E\r\n\u003Cp\u003Esomething like this…\u003Cbr\u003E\r\n\u003C\u002Fp\u003E\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F097\u002F02b\u002F175\u002F09702b1750c94616a10fc66c1275c00f.png\" alt=\"image\"\u003E\u003C\u002Fdiv\u003E","imageUrl":null,"buttonTextHtml":"Read more →","image":null},"editorVersion":"1.0","postType":"article","postLabels":[{"type":"sandbox","data":null},{"type":"tutorial","data":null}],"author":{"scoreStats":{"score":14,"votesCount":28},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"757683","alias":"reablaz","fullname":null,"avatarUrl":null,"speciality":"User"},"statistics":{"commentsCount":0,"favoritesCount":1,"readingCount":3539,"score":10,"votesCount":12},"hubs":[{"relatedData":null,"id":"33","alias":"p2p","type":"collective","title":"Децентрализованные сети","titleHtml":"Децентрализованные сети","isProfiled":false},{"relatedData":null,"id":"144","alias":"open_source","type":"collective","title":"Open source","titleHtml":"Open source","isProfiled":true},{"relatedData":null,"id":"233","alias":"pay_system","type":"collective","title":"Платежные системы","titleHtml":"Платежные системы","isProfiled":true},{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"21986","alias":"cryptocurrency","type":"collective","title":"Криптовалюты","titleHtml":"Криптовалюты","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"6","alias":"admin","title":"Администрирование"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cp\u003EThis week I spent coding my very first public pet-app based on Telegram chat bot which acts as a Bitcoin wallet and allows to send and receive tips between Telegram users and other so-called “Lightning Apps”. I assume that you are familiar with Bitcoin &amp; Telegram in general, i’ll try to post short and without deep jump into details. More \u003Ca href=\"https:\u002F\u002Fwww.lopp.net\u002Fbitcoin-information.html\"\u003Eresources about Bitcoin can be found here\u003C\u002Fa\u003E and Telegram is simply an instant messenger that allows you to create your custom apps (chat-bots) using their platform.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EWhat are the key points of such app?\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003EAllows to rate other users ideas and answers with real value instead of\u003Cbr\u002F\u003E\r\n ‘virtual likes’. This brings online conversation to completely new level\u003C\u002Fli\u003E\r\n\u003Cli\u003EReal example of working micro-payment app which can act with other entities\u003Cbr\u002F\u003E\r\n over internet using open protocol\u003C\u002Fli\u003E\r\n\u003Cli\u003EAll the modules are open-source projects and can be easy re-used and adjusted\u003Cbr\u002F\u003E\r\n for your own project. App does not relay on third-party commercial services.\u003Cbr\u002F\u003E\r\n Even it falls under e-commerce field, which is currently almost closed, the app\u003Cbr\u002F\u003E\r\n is based on open solutions.\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EWhat are the use-cases?\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003Esomething like this…\u003Cbr\u002F\u003E\r\n\u003C\u002Fp\u003E\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F097\u002F02b\u002F175\u002F09702b1750c94616a10fc66c1275c00f.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\nor like that..\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F3ef\u002F1ff\u002F85f\u002F3ef1ff85f1e7b77662c63a9d4d838666.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EWhat do numbers mean? These are \u003Cb\u003Ebitcoin units — satoshis\u003C\u002Fb\u003E. As for mid-2019 1000 satoshis has value of $0.06. You can spend it online or exchange to your local currency using many available services. So this is not just another \u003Ci\u003E\"number in a database\"\u003C\u002Fi\u003E or a\u003Ci\u003E \"coupons you can spend in our partner store\"\u003C\u002Fi\u003E, but a \u003Cb\u003Ereal internet money\u003C\u002Fb\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EYou may ask what to do, if you don’t have any bitcoin to use in the app. You simply can receive a tip from existing app user or buy small amount of bitcoin on various exchanges or bitcoin wallets for mobile phone or pc.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F883\u002F661\u002F461\u002F883661461bdc686aec7d084d5d581236.png\"\u002F\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F779\u002F716\u002F5d9\u002F7797165d93d292700d9a41a171d882a6.png\"\u002F\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F8fe\u002F33b\u002F84b\u002F8fe33b84bb127132304634363bb4af42.png\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EWhen you got bitcoin, you can start \u003Ca href=\"https:\u002F\u002Ft.me\u002Fatomic_tipbot\"\u003E@atomic_tipbot\u003C\u002Fa\u003E and make a \u002Fdeposit.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EYou'll see an invoice, you can select preferred payment method and send money just scanning the QR code or with button press (\u003Ci\u003E\"open in wallet\"\u003C\u002Fi\u003E) on invoice. \u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F8fe\u002F33b\u002F84b\u002F8fe33b84bb127132304634363bb4af42.png\"\u002F\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F4a3\u002Fda5\u002Ff76\u002F4a3da5f76574ac9ebb2161d56bceff62.png\"\u002F\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F54d\u002Fa43\u002F0be\u002F54da430be68237193dee82ade50bab37.png\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EConfirm payment in your mobile wallet, and you will see a confirmation screen almost instantly in Telegram.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003ESo far we touched two separate parts of the app: telegram bot back-end and payment processing system (actually more like it's front-end).\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003ETo create this Telegram bot i’ve used \u003Ca href=\"http:\u002F\u002Fpython-telegram-bot.readthedocs.io\u002F\"\u003EPython Telegram Bot\u003C\u002Fa\u003E. And of course, the \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Freablaz\u002Fatomic_tipbot\"\u003Ebot is open-source\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EAs a payment processing system to generate invoices, check status, send notification and take care of UX is used \u003Ca href=\"https:\u002F\u002Fwww.youtube.com\u002Fwatch?v=nr0UNbz3AoQ\"\u003EBTCPayServer\u003C\u002Fa\u003E which \u003Ca href=\"https:\u002F\u002Fdocs.btcpayserver.org\u002F\"\u003Edocumentation can be found here\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EIf you are looking on how to process payment events directly, you can look at \u003Ca href=\"http:\u002F\u002Fdocs.electrum.org\u002Fen\u002Flatest\u002Fcmdline.html\"\u003EElectrum CLI manual pages\u003C\u002Fa\u003E for on-chain payments and check out solutions for off-chain (Lightning) payments like \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FElementsProject\u002Flightning-charge\"\u003ELightning-charge\u003C\u002Fa\u003E or \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ffiatjaf\u002Fsparko\"\u003ESparko\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EYou said ‘no 3rd party’ and ‘no cloud services’!?\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EYes, that’s true. In my app i am using free shared hosting of BTCPayServer instance — \u003Ca href=\"https:\u002F\u002Fbtcpayjungle.com\"\u003EBTCPayJungle\u003C\u002Fa\u003E, but it is possible to spin up even on your own dedicated server. Just remember that you need then about ~500GB of space to store Bitcoin and Litecoin blockchain. BTCPayServer does not hold any private keys or sensitive information that can allow hackers to control funds on you wallet. For on-chain (standart) payments you need to provide xpub key from you wallet to BTCPayServer so it will be able to generate public addresses. In this way, BTCPay architecture makes possible to process payments in trustless manner even on shared environment. It is very simple to configure if you use proven wallets such as \u003Ca href=\"http:\u002F\u002Felectrum.org\u002F\"\u003EElectrum\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EWhat is Lightning Network?\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EIt is something like an add-on to Bitcoin which adds additional abstraction layer and allows to make instant and almost free bitcoin transactions. All this stuff is possible thanks to cryptographic multi-signature magic, which is often called \u003Cem\u003Esmart-contract\u003C\u002Fem\u003E. There are multiple implementations of LN protocol. I am using \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FElementsProject\u002Flightning\"\u003Ec-lightning\u003C\u002Fa\u003E C implementation. \u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EThe major difference between on-chain and off-chain (Lightning) payments are in how transactions are stored. All \u003Cb\u003Eon-chain\u003C\u002Fb\u003E transactions are broadcasted to the whole network so each running bitcoin node will record this transaction into blockchain, if block containing this transaction will be \u003Ca href=\"https:\u002F\u002Fen.bitcoin.it\u002Fwiki\u002FMining\"\u003Emined\u003C\u002Fa\u003E. Hey, \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fusers\u002Fbitfury\u002F\" class=\"user_link\"\u003EBitFury\u003C\u002Fa\u003E, am i right? ;) That's why we call such transactions \u003Cb\u003Eon-chain\u003C\u002Fb\u003E. Such transactions will be stored in blockchain till the end of its existence. It is possible publicly to track, analyse and monitor any such transaction over the network.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EIn case of \u003Cb\u003Eoff-chain\u003C\u002Fb\u003E (Lightning) transaction things happens in other way. Each lightning node has \u003Ci\u003E(may be many)\u003C\u002Fi\u003E on-chain address, from which one all starts. When funds are received on such address, using cryptography techniques node may open so-called \u003Ci\u003Elightning channel\u003C\u002Fi\u003E to another node, what means that these two nodes made agreement about funds availability between them. Later, all the transactions that are made trough channel (own transactions, or it may be routed transaction from another node) are stored only on those two nodes (and intermediate node if there was such). The only transactions which are stored in networks blockchain are channel opening and closing transactions. This is why Lightning transactions we call \u003Cb\u003Eoff-chain\u003C\u002Fb\u003E. Mostly they exist only in node database-file.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EThe whole thing is visualized on diagram\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F3c6\u002F636\u002Fb8c\u002F3c6636b8c98d52aab9bd09ff9c52afcb.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EShort story:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E1) User sends message and requests deposit to bot on \u003Cb\u003ETelegram\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E2) Telegram triggers bot's \u003Cb\u003Epython app\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E3) \u003Cb\u003Epython app\u003C\u002Fb\u003E sends request to \u003Cb\u003EBTCPayServer\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E4) BTCPayServer generates incoming addresses for BTC and LTC, as well contacting \u003Cb\u003Elightning-charge\u003C\u002Fb\u003E, which one is getting data from \u003Cb\u003Ec-lightning\u003C\u002Fb\u003E daemon. In a result we get well-handled HTML frame for payment processing\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E5) User pays invoice and will see confirmation\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E6) \u003Cb\u003EBTCPayServer\u003C\u002Fb\u003E sends\u003Ci\u003E invoice payment notification\u003C\u002Fi\u003E (IPN) to specified callback url, in our case it\u003Cbr\u002F\u003E\r\nwill go to \u003Cb\u003Ecallbacks.py\u003C\u002Fb\u003E (another python app to listen for callbacks)\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E7) According to complete payment detail user balance is changed and user gets notification\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003Ci\u003E… if user decides to withdraw funds (tips he received) …\u003C\u002Fi\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E8) \u003Cb\u003EBot's python app\u003C\u002Fb\u003E listens to text or image of QR, when it gets invoice data (long string of characters) then it sends request to pay that invoice to another python app \u003Cb\u003Epaylightning.py*\u003C\u002Fb\u003E, which initializes pay-outs using c-lightning RPC.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F518\u002F3dc\u002Fc81\u002F5183dcc817817f1aa676ff74d17d08bb.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003Ci\u003E*To be fair, I need to mention that my pay-wrapper paylightning.py is incomplete and may return false-negative in some specific cases. You should use \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ffiatjaf\u002Flightningd-gjson-rpc\u002Ftree\u002Fmaster\u002Fcmd\u002Fwaitpay\"\u003Ewell-tested payment wrapper for c-lightning\u003C\u002Fa\u003E in case of production-like use.\u003C\u002Fi\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EUsers are able to send tips to each other on group chats and send\u002Freceive \u003Cb\u003Evalue\u003C\u002Fb\u003E without any limits. But that’s not all. Thanks to Lightning Network protocol, which is in some kind of unified and simplified payment network you are able to send same balance coins to completely different apps. There is another bitcoin tip-bot on telegram — @lntxbot. User can request a deposit to this bot\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Ff09\u002Fc3a\u002Fef9\u002Ff09c3aef995f7a82560987646b0d8ee0.png\"\u002F\u003E \u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F1e2\u002F344\u002F82c\u002F1e234482c56aa0df1d4b341ecfe3beb8.png\"\u002F\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003ESimply forward data from @lntxbot to @atomic_tipbot and voul’a!\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EThis is not anymore ‘number swap in database’ but payment between two separate, non-related ‘databases’. Bot already has few 'LApps' integrated: \u003Ca href=\"https:\u002F\u002Fsat2.io\"\u003Esat2.io\u003C\u002Fa\u003E and \u003Ca href=\"https:\u002F\u002Flnsms.world\"\u003Elnsms.world\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003Cb\u003EYou may ask, what exactly means \u003Ci\u003ELApp integration\u003C\u002Fi\u003E?\u003C\u002Fb\u003E\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EEach \u003Ci\u003ELightning Network\u003C\u002Fi\u003E node acts as a bitcoin wallet. It has both on-chain and off-chain balance. The on-chain balance usually is used to open channels and store funds from closed channels, in short — nodes maintenance tasks. The off-chain balance is what exactly is used to exchange funds between nodes. The core functions of each node is ability to send or receive funds, so node as a software provides \u003Ci\u003E\u003Cb\u003Epay\u003C\u002Fb\u003E\u003C\u002Fi\u003E and \u003Ci\u003E\u003Cb\u003Einvoice\u003C\u002Fb\u003E\u003C\u002Fi\u003E methods. I'll show in short how it happens:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"bash\"\u003Euser@ln-node:\u002F % lightning-cli invoice 1000000000 internal_description external_description\n{\n   \"payment_hash\" : \"64c0c8f5f8f708b08487ad1376f3d256f92ccb9606987ba395c2b4193efde5a0\",\n   \"expires_at\" : 1558709834,\n   \"bolt11\" : \"lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6\"\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EThe \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Flightningnetwork\u002Flightning-rfc\u002Fblob\u002Fmaster\u002F11-payment-encoding.md\"\u003EBOLT11\u003C\u002Fa\u003E invoice is generated in this case, which is unified format for payment requests in Bitcoin (as well as Litecoin) network. This string includes data about invoice recipient, amount, timestamp, expiration etc. To decode this string c-lightning provides decodepay method:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"bash\"\u003Euser@ln-node:\u002F % lightning-cli decodepay lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6\n{\n   \"currency\" : \"bc\",\n   \"created_at\" : 1558105034,\n   \"expiry\" : 604800,\n   \"payee\" : \"025a14b8ed40583d67aec92da19453e0b2d1fbbf75f96f85d3dd0ff61a51ee0490\",\n   \"msatoshi\" : 1000000000,\n   \"amount_msat\" : \"1000000000msat\",\n   \"description\" : \"external_description\",\n   \"min_final_cltv_expiry\" : 10,\n   \"routes\" : [\n      [\n         {\n            \"pubkey\" : \"03a20c0c2ae4508b669a70e5f82f08f69a3da5da3bf0c973673c3fe977db0f61e3\",\n            \"short_channel_id\" : \"574012x1255x1\",\n            \"fee_base_msat\" : 1000,\n            \"fee_proportional_millionths\" : 1,\n            \"cltv_expiry_delta\" : 144\n         }\n      ]\n   ],\n   \"payment_hash\" : \"64c0c8f5f8f708b08487ad1376f3d256f92ccb9606987ba395c2b4193efde5a0\",\n   \"signature\" : \"304502210099f31dffd18b6db8296637db3e3a1ffbaf7b7db087a2ad1eedb7639f25e78b25022079038370073681aa1e1a7a05de6588e98ead078896d0a37a15b755c212dc3d37\"\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EIn case we need to pay some invoice, we should use pay method of c-lightning:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"bash\"\u003Euser@ln-node:\u002F % lightning-cli pay lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j\n{\n   \"id\" : 163,\n   \"payment_hash\" : \"c3e644a005f56e33df89facbce2c9dfcabbef5d105285a98272cacc77ab2de63\",\n   \"destination\" : \"03021c5f5f57322740e4ee6936452add19dc7ea7ccf90635f95119ab82a62ae268\",\n   \"msatoshi\" : 200000,\n   \"amount_msat\" : \"200000msat\",\n   \"msatoshi_sent\" : 200003,\n   \"amount_sent_msat\" : \"200003msat\",\n   \"created_at\" : 1558106072,\n   \"status\" : \"complete\",\n   \"payment_preimage\" : \"1a9552b9f4e9199e26839353f870b12cc85b7674a2fb134e78aa370032611019\",\n   \"bolt11\" : \"lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j\"\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EAll the statuses of payments are handled by the whole network and your own node. You don't have a need (but have a possibility to do so) to communicate at all with receiving-side app developers or their API, some card processing provider or any bank to get confirmation about your payment or to release funds from your own account. There are no charge-backs or any other kind of external influence on you accounts balance. All you need is a software which acts by decentralized network rules. This is a solution to exchange a value over internet, without a need of any kind of arbiter in the middle who decides about your payment compatibility with some rules, sometimes even previously unknown to all parties. There are no \"internal\" rules in bitcoin, all the rules your app needs to complete with are open and known. \u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EThis makes possible \u003Cb\u003Edirect\u003C\u002Fb\u003E, \u003Cb\u003Ealmost free\u003C\u002Fb\u003E and \u003Cb\u003Einstant\u003C\u002Fb\u003E value exchange over internet between people or even software itself in truly autonomous way.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EIf there is a way to get payment data from other app then you are able to act with it in financial sense. As in our example, lnsms.world is a web-app that allows you to send sms to any number and pay for it with bitcoin. To integrate such option in our app we simply need to pass required data from web-form to lnsms.world:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"python\"\u003Epayload = {                                                                                                                           \n        'number': phone_number,\n        'text': text,\n        'force_unicode': 0\n    }\n\n    send_req = requests.post('https:\u002F\u002Flnsms.world\u002Finvoice', data=payload)\n    if send_req.status_code == 201:\n        plain_invoice = str(send_req.text)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EI don't know for what reason, but lnsms responds with 201 HTTP status code and returns BOLT11 invoice. Well, that's enough to pay this invoice and our users will send sms shortly after payment is received. We can charge some fee on top or not, that is our free choice.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003ENow, imagine, that your bot is actually some more useful app and pays not another bot, but some other entity, connected to the Internet. Or, those may be payments between software, machines, stores, service providers on regular basis repeating each few seconds? Do you feel the power of micro-payments? That is how the Internet of Things will look like. Already now there are such projects as \u003Ca href=\"https:\u002F\u002Falthea.org\u002F\"\u003Ehttps:\u002F\u002Falthea.org\u002F\u003C\u002Fa\u003E and in near future we will face great changes in field what we call e-commerce.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EIf you like this post and would try bitcoin payments yourself you can \u003Ca href=\"https:\u002F\u002Ftip.ysx.in\"\u003Eleave me a tip on my tipping page\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"instant messaging"},{"titleHtml":"bitcoin"},{"titleHtml":"cryptocurrency"},{"titleHtml":"payments"},{"titleHtml":"e-commerce"},{"titleHtml":"open-source"},{"titleHtml":"p2p"},{"titleHtml":"decentralized platforms"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F452666\u002F389ea9270855050ae329d541d16f991e\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F452666\u002F389ea9270855050ae329d541d16f991e\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fen\\\u002Fpost\\\u002F452666\\\u002F\"},\"headline\":\"How to make possible micro-payments in your app\",\"datePublished\":\"2019-05-20T18:16:51+03:00\",\"dateModified\":\"2019-05-21T14:22:21+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"reablaz\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"This week I spent coding my very first public pet-app based on Telegram chat bot which acts as a Bitcoin wallet and allows to send and receive tips between...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fen\\\u002Fpost\\\u002F452666\\\u002F#post-content-body\",\"about\":[\"h_p2p\",\"h_open_source\",\"h_pay_system\",\"h_programming\",\"h_cryptocurrency\",\"f_develop\",\"f_admin\",\"f_popsci\"],\"image\":[\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F097\\\u002F02b\\\u002F175\\\u002F09702b1750c94616a10fc66c1275c00f.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F3ef\\\u002F1ff\\\u002F85f\\\u002F3ef1ff85f1e7b77662c63a9d4d838666.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F883\\\u002F661\\\u002F461\\\u002F883661461bdc686aec7d084d5d581236.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F779\\\u002F716\\\u002F5d9\\\u002F7797165d93d292700d9a41a171d882a6.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F8fe\\\u002F33b\\\u002F84b\\\u002F8fe33b84bb127132304634363bb4af42.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F4a3\\\u002Fda5\\\u002Ff76\\\u002F4a3da5f76574ac9ebb2161d56bceff62.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F54d\\\u002Fa43\\\u002F0be\\\u002F54da430be68237193dee82ade50bab37.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F3c6\\\u002F636\\\u002Fb8c\\\u002F3c6636b8c98d52aab9bd09ff9c52afcb.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F518\\\u002F3dc\\\u002Fc81\\\u002F5183dcc817817f1aa676ff74d17d08bb.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Ff09\\\u002Fc3a\\\u002Fef9\\\u002Ff09c3aef995f7a82560987646b0d8ee0.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F1e2\\\u002F344\\\u002F82c\\\u002F1e234482c56aa0df1d4b341ecfe3beb8.png\"]}","metaDescription":"This week I spent coding my very first public pet-app based on Telegram chat bot which acts as a Bitcoin wallet and allows to send and receive tips between Telegram users and other so-called...","mainImageUrl":null,"amp":false},"polls":[{"id":"30362","timeElapsed":null,"answersType":"radio","votesCount":0,"passCount":1,"textHtml":"Are you interested in pure-technical posts about Bitcoin and related software?","relatedData":null,"variants":[{"id":"145428","textHtml":"Yes","votesCount":0,"percent":0,"selected":false},{"id":"145430","textHtml":"No","votesCount":0,"percent":0,"selected":false},{"id":"145432","textHtml":"I prefer market-related posts more","votesCount":0,"percent":0,"selected":false}]}],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":"p2p,open_source,pay_system,programming,cryptocurrency"},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
