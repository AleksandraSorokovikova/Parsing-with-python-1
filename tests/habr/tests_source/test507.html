<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Локальная автономная система сбора данных (продолжение) / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/451154\/"},"headline":"Локальная автономная система сбора данных (продолжение)","datePublished":"2019-05-09T20:43:24+03:00","dateModified":"2019-05-11T21:25:19+03:00","author":{"@type":"Person","name":"viktoin"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Начало на данном сайте по ссылке.  Самым удобным для использования вариантом съёма информации о включении пускателя оказался вариант с оптопарой PC817.   Принцип...","url":"https:\/\/habr.com\/ru\/post\/451154\/#post-content-body","about":["h_controllers","h_electronics","h_engineering_systems","f_develop","f_admin"],"image":["https:\/\/habrastorage.org\/webt\/wd\/b4\/bp\/wdb4bp10a_fcsqmqvi5bxbkedgq.jpeg","https:\/\/habrastorage.org\/webt\/ww\/au\/qh\/wwauqhutnnp2vez5-dtjlow9a-c.jpeg","https:\/\/habrastorage.org\/webt\/lh\/gi\/xw\/lhgixwo48c-gcbyxvogroko5osw.jpeg","https:\/\/habrastorage.org\/webt\/x5\/-c\/g1\/x5-cg1zzm4bwpsheiw2zhs2jg4q.jpeg","https:\/\/habrastorage.org\/webt\/tt\/o5\/un\/tto5unc0dk2yyqlk9z5xykbqryk.jpeg","https:\/\/habrastorage.org\/webt\/wa\/fy\/dq\/wafydqpdmui3d9sa0v4odl7csiy.jpeg","https:\/\/habrastorage.org\/webt\/v7\/h1\/hw\/v7h1hwt9dna8br023xqpfzcn0vk.jpeg","https:\/\/habrastorage.org\/webt\/pw\/ks\/ic\/pwksicc1dsu56ohlkei3gx8xgse.jpeg"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Локальная автономная система сбора данных (продолжение)" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Локальная автономная система сбора данных (продолжение)" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Локальная автономная система сбора данных (продолжение)" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Начало на данном сайте по ссылке.

Самым удобным для использования вариантом съёма информации о включении пускателя оказался вариант с оптопарой PC817. 

Принципиальная схема
Платы содержат по..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Начало на данном сайте по ссылке.

Самым удобным для использования вариантом съёма информации о включении пускателя оказался вариант с оптопарой PC817. 

Принципиальная схема
Платы содержат по..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Начало на данном сайте по ссылке.

Самым удобным для использования вариантом съёма информации о включении пускателя оказался вариант с оптопарой PC817. 

Принципиальная схема
Платы содержат по..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Начало на данном сайте по ссылке.

Самым удобным для использования вариантом съёма информации о включении пускателя оказался вариант с оптопарой PC817. 

Принципиальная схема
Платы содержат по..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Начало на данном сайте по ссылке.

Самым удобным для использования вариантом съёма информации о включении пускателя оказался вариант с оптопарой PC817. 

Принципиальная схема
Платы содержат по..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/451154/45d4aae2e3faf7e90f15a5e541d3552b/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/451154/45d4aae2e3faf7e90f15a5e541d3552b/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/451154/45d4aae2e3faf7e90f15a5e541d3552b/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/451154/45d4aae2e3faf7e90f15a5e541d3552b/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/451154/45d4aae2e3faf7e90f15a5e541d3552b/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="451154" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2019-05-09T17:43:24.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/451154/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/451154/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/451154/45d4aae2e3faf7e90f15a5e541d3552b/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/viktoin/" title="viktoin" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" loading="lazy" src="//habrastorage.org/r/w32/getpro/habr/avatars/f02/607/ff0/f02607ff01c33acfd46fe4107e88c611.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/viktoin/" class="tm-user-info__username">
      viktoin
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2019-05-09T17:43:24.000Z" title="2019-05-09, 20:43">9  мая  2019 в 20:43</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Локальная автономная система сбора данных (продолжение)</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/controllers/" class="tm-article-snippet__hubs-item-link"><span>Программирование микроконтроллеров</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/electronics/" class="tm-article-snippet__hubs-item-link"><span>Производство и разработка электроники</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/engineering_systems/" class="tm-article-snippet__hubs-item-link"><span>Инженерные системы</span> <!----></a></span></div> <!----> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml">Начало на данном сайте <a href="https://habr.com/ru/post/447168/">по ссылке</a>.<br/>
<br/>
Самым удобным для использования вариантом съёма информации о включении пускателя оказался вариант с оптопарой PC817. <br/>
<br/>
<div class="spoiler"><b class="spoiler_title">Принципиальная схема</b><div class="spoiler_text"><img src="https://habrastorage.org/r/w780q1/webt/wd/b4/bp/wdb4bp10a_fcsqmqvi5bxbkedgq.jpeg" alt="image alt" align="left" data-src="https://habrastorage.org/webt/wd/b4/bp/wdb4bp10a_fcsqmqvi5bxbkedgq.jpeg" data-blurred="true"/></div></div><br/>
Платы содержат по три одинаковых схемы, всё помещено в коробки из ABS пластика, размер 100х100 мм. <br/>
<br/>
<div class="spoiler"><b class="spoiler_title">Фото оптопар</b><div class="spoiler_text"><img src="https://habrastorage.org/r/w780q1/webt/ww/au/qh/wwauqhutnnp2vez5-dtjlow9a-c.jpeg" alt="image alt" align="left" data-src="https://habrastorage.org/webt/ww/au/qh/wwauqhutnnp2vez5-dtjlow9a-c.jpeg" data-blurred="true"/></div></div> <br/>
При подключении к пусковым аппаратам с полупроводниковыми вентилями их ток утечки достаточен для открытия РС817 и будет ложное срабатывание счётчика. Для исключения такой ситуации <a name="habracut"></a> последовательно в цепь светодиода оптопары и светодиода индикации работы добавляется ещё один. Для этого размыкается перемычка J1 и впаивается дополнительный светодиод LED1. <br/>
<br/>
Приёмная часть выполнена на <br/>
<br/>
<div class="spoiler"><b class="spoiler_title">сторона 1</b><div class="spoiler_text"><img src="https://habrastorage.org/r/w780q1/webt/lh/gi/xw/lhgixwo48c-gcbyxvogroko5osw.jpeg" alt="image alt" align="left" data-src="https://habrastorage.org/webt/lh/gi/xw/lhgixwo48c-gcbyxvogroko5osw.jpeg" data-blurred="true"/></div></div><br/>
<div class="spoiler"><b class="spoiler_title">сторона 2</b><div class="spoiler_text"><img src="https://habrastorage.org/r/w780q1/webt/x5/-c/g1/x5-cg1zzm4bwpsheiw2zhs2jg4q.jpeg" alt="image alt" align="left" data-src="https://habrastorage.org/webt/x5/-c/g1/x5-cg1zzm4bwpsheiw2zhs2jg4q.jpeg" data-blurred="true"/><br/>
</div></div><br/>
макетной плате подключаемой к ARDUINO MEGA 2560. Для этого используется двухрядный разъём на торце. В качестве устройства отображения информации используется имеющий резистивный тач и датчик температуры экран с разрешением 240х400 <br/>
<br/>
<div class="spoiler"><b class="spoiler_title">HX8352B.</b><div class="spoiler_text"><img src="https://habrastorage.org/r/w780q1/webt/tt/o5/un/tto5unc0dk2yyqlk9z5xykbqryk.jpeg" alt="image alt" align="left" data-src="https://habrastorage.org/webt/tt/o5/un/tto5unc0dk2yyqlk9z5xykbqryk.jpeg" data-blurred="true"/></div></div> <br/>
Причём разъём к ICSP на плате экрана демонтирован и не используется гнездо для микро- SD. Дело в том, что «родное» гнездо SD нельзя применить по причине конфликта на шине SPI. Для флеш- карты был применен отдельный кардридер имеющий в составе стабилизатор 3,3В и буферную микросхему с тремя состояниями выходов 74LVS125A. Вот тут ждали меня грабли. Буфер с тремя состояниями, но работал или E01-ML01DP5 или кардридер. В комментариях библиотеки SdFat разглядел предупреждение о несовместимости с другими устройствами. Был удалён конвертер уровней на TXS0108E и заменён перемычками, т.к. E01-ML01DP5 толерантен к 5В сигналам- не помогло. С помощью осциллографа выявлено пропадание сигнала на линии MISO при подключении кардридера. При внимательном рассмотрении было установлено, что входы разрешающих сигналов ОЕ 4-х каналов 74LVS125A были просто припаяны к общему проводу и ни о каком третьем состоянии речи быть не могло. Буферная микросхема использовалась как примитивный преобразователь уровней от 5В к 3.3В с использованием резисторов 3,3 КОм включенных последовательно с сигнальными линиями. Кроме линии MISO. Её выходной нижний ключ вероятно притягивал сигналы к уровню «земли». Определив что разрешающий сигнал линии MISO- это вывод 13, он был оторван от дорожки и<br/>
<br/>
<div class="spoiler"><b class="spoiler_title">припаян</b><div class="spoiler_text"><img src="https://habrastorage.org/r/w780q1/webt/wa/fy/dq/wafydqpdmui3d9sa0v4odl7csiy.jpeg" alt="image alt" align="left" data-src="https://habrastorage.org/webt/wa/fy/dq/wafydqpdmui3d9sa0v4odl7csiy.jpeg" data-blurred="true"/></div></div><br/>
между выводом входа (9) 74LVS125A выбора устройства CS и резистором согласования. Теперь если нет обращения к карте памяти, MISO- буфер отключается и не мешает работе другого устройства.<br/>
<br/>
<div class="spoiler"><b class="spoiler_title">Схема макетной платы</b><div class="spoiler_text"><img src="https://habrastorage.org/r/w780q1/webt/v7/h1/hw/v7h1hwt9dna8br023xqpfzcn0vk.jpeg" alt="image alt" align="left" data-src="https://habrastorage.org/webt/v7/h1/hw/v7h1hwt9dna8br023xqpfzcn0vk.jpeg" data-blurred="true"/></div></div><br/>
<div class="spoiler"><b class="spoiler_title">Приёмник в работе</b><div class="spoiler_text"><img src="https://habrastorage.org/r/w780q1/webt/pw/ks/ic/pwksicc1dsu56ohlkei3gx8xgse.jpeg" alt="image alt" align="left" data-src="https://habrastorage.org/webt/pw/ks/ic/pwksicc1dsu56ohlkei3gx8xgse.jpeg" data-blurred="true"/></div></div><br/>
Для подключения часов на DS3231 используется программная шина I2C (TWI).<br/>
<br/>
<div class="spoiler"><b class="spoiler_title">Программа Arduino IDE</b><div class="spoiler_text"><pre><code class="plaintext">// IMPORTANT: Adafruit_TFTLCD LIBRARY MUST BE SPECIFICALLY
// CONFIGURED FOR EITHER THE TFT SHIELD OR THE BREAKOUT BOARD.
// SEE RELEVANT COMMENTS IN Adafruit_TFTLCD.h FOR SETUP.
//by Open-Smart Team and Catalex Team
//catalex_inc@163.com
//Store:   http://dx.com
//           https://open-smart.aliexpress.com/store/1199788
//Demo Function: Display graphics, characters
//Arduino IDE: 1.6.5
// Board: Arduino UNO R3, Arduino Mega2560,Arduino Leonardo

// Board:OPEN-SMART UNO R3 5V / 3.3V, Arduino UNO R3, Arduino Mega2560
//3.2INCH TFT:
// https://www.aliexpress.com/store/product/3-2-TFT-LCD-Display-module-Touch-Screen-Shield-board-onboard-temperature-sensor-w-Touch-Pen/1199788_32755473754.html?spm=2114.12010615.0.0.bXDdc3
//OPEN-SMART UNO R3 5V / 3.3V:
// https://www.aliexpress.com/store/product/OPEN-SMART-5V-3-3V-Compatible-UNO-R3-CH340G-ATMEGA328P-Development-Board-with-USB-Cable-for/1199788_32758607490.html?spm=2114.12010615.0.0.ckMTaN

#include &lt;Adafruit_GFX.h>    // Core graphics library
//#include &lt;Adafruit_TFTLCD.h> // Hardware-specific library
#include &lt;MCUFRIEND_kbv.h>
MCUFRIEND_kbv tft;
#include "SdFat.h"           // Use the SdFat library
SdFat SD;
SdFile file;
File myFile;
#define SD_CS_PIN SS

#include &lt;SPI.h>                                               // Подключаем библиотеку для работы с шиной SPI
#include &lt;nRF24L01.h>                                          // Подключаем файл настроек из библиотеки RF24
#include &lt;RF24.h>                                              // Подключаем библиотеку для работы с nRF24L01+
RF24           radio(47, 49);

#include &lt;DS3231.h>

DS3231  rtc(27, 25);
Time  t;

uint16_t   r = 6000;
uint32_t    k = 0;

volatile unsigned long data;
float leb_1;
float leb_2;
float leb_3;
float leb_4;

uint8_t        pipe;
int rc = 0;

uint8_t time_sec_prev;
uint8_t time_day_prev;

//***********************************************//
// If you use OPEN-SMART TFT breakout board                 //
// Reconmmend you to add 5V-3.3V level converting circuit.
// Of course you can use OPEN-SMART UNO Black version with 5V/3.3V power switch,
// you just need switch to 3.3V.
// The control pins for the LCD can be assigned to any digital or
// analog pins...but we'll use the analog pins as this allows us to
//----------------------------------------|
// TFT Breakout  -- Arduino UNO / Mega2560 / OPEN-SMART UNO Black
// GND              -- GND
// 3V3               -- 3.3V
// CS                 -- A3
// RS                 -- A2
// WR                -- A1
// RD                 -- A0
// RST                -- RESET
// LED                -- GND
// DB0                -- 8
// DB1                -- 9
// DB2                -- 10
// DB3                -- 11
// DB4                -- 4
// DB5                -- 13
// DB6                -- 6
// DB7                -- 7

// Assign human-readable names to some common 16-bit color values:
#define	BLACK   0x0000
#define	BLUE    0x001F
#define	RED     0xF800
#define	GREEN   0x07E0
#define CYAN    0x07FF
#define MAGENTA 0xF81F
#define YELLOW  0xFFE0
#define WHITE   0xFFFF
#define GRAY    0x8C51
#define GRAYD   0x39E7

//Adafruit_TFTLCD tft(LCD_CS, LCD_CD, LCD_WR, LCD_RD, LCD_RESET);
// If using the shield, all control and data lines are fixed, and
// a simpler declaration can optionally be used:
// Adafruit_TFTLCD tft;
uint16_t g_identifier;

String dataString;
//String numfileMonth ="1.txt";
char perv [] = {"2.txt"};
//String *numfileMonth="1.txt" (sizeof (numfileMonth));
///////////////////////////////////////////////////////////////////

void setup(void) {

  rtc.begin();

  // Для установки времени- раскомментировать нужные строки
  // rtc.setDOW(6);               // День недели
  // rtc.setTime(22, 04, 0);      // Время, в формате 24 часа.
  // rtc.setDate(4, 5, 2019);   // Дата, 29 октября 2018г.

  Serial.begin(2000000);
//////// Инициализация экрана
  tft.begin(0x65);
  tft.reset();
  tft.setRotation(0);
  tft.cp437(true);
//////////////////Вывод имен, принадлежности оборудования, название организации
  tft.fillScreen(BLACK);
  tft.setTextColor(WHITE);
  tft.setTextSize(2);
  tft.setCursor (8, 0);
  tft.println ("DEVELOPERS &amp; BUILD" );
  tft.setCursor (30, 20);
  tft.print (utf8rus("Конструктор В.В." ));
  tft.setCursor (40, 40);
  tft.print (utf8rus("Токарь И.И." ));
  delay (2000);

  radio.begin();                             // Инициируем работу nRF24L01+
  radio.setChannel(120);                     // Указываем канал приёма данных (от 0 до 127)
  radio.setDataRate     (RF24_250KBPS);      // Указываем скорость передачи данных (RF24_250KBPS, RF24_1MBPS, RF24_2MBPS), RF24_1MBPS - 1Мбит/сек
  radio.setPALevel      (RF24_PA_MAX);       // Указываем мощность передатчика (RF24_PA_MIN=-18dBm, RF24_PA_LOW=-12dBm, RF24_PA_HIGH=-6dBm, RF24_PA_MAX=0dBm)
  radio.openReadingPipe (1, 0xAABBCCDD11LL); // Открываем 1 трубу с идентификатором 1 передатчика 0xAABBCCDD11, для приема данных
                                             // Открываем 2 трубу с идентификатором 2 передатчика 0xAABBCCDD22, для приема данных
  radio.startListening  ();                  // Включаем приемник, начинаем прослушивать открытые трубы
  //  radio.stopListening   ();
////////Вывод служебной информации
  tft.fillScreen(BLACK);
  tft.setCursor (8, 0);
  tft.setTextSize(1);
////////Начало инициализации SD карты
  Serial.println("Initial SD card");
  tft.println("Initial SD card");
  tft.setCursor (8, 10);
////////Инициализация карты
  if (!SD.begin(SD_CS_PIN)) {
    Serial.println("initial failed!");
    tft.fillRect ( 8 , 10 , 85 , 7 , RED);
    tft.setTextColor(BLACK);
    tft.println("Initial failed!");
    return;
  }
  tft.setTextColor(WHITE);
  Serial.println("initialization done");
  tft.println("Initialization done");
  delay (2000);
////////Считывание времени- даты и присвоение их переменным
  t = rtc.getTime();
  time_sec_prev = t.sec;
  time_day_prev = t.date;
////////Вывод даты принудительно, что б не ждать смены даты для индикации
  tft.setCursor (  180 , 0 );              // установка позиции курсора
  tft.fillRect ( 178 , 0 , 65 , 7 , GRAY); // очистка области вывода времени
  tft.setTextSize(1);
  tft.print(rtc.getDateStr());
////////Вывод названия объектов контроля
  tft.setTextSize(2);
  tft.setCursor (60, 25);
  tft.println (utf8rus("Лебёдки I"));
////////Создание файла лога и вывод результата попытки создания
  tft.setTextSize(1);
  tft.setCursor(130, 10); // если файл лога 2.txt создан, то будет продолжена запись в файл
  if (SD.exists (perv)) {
    //tft.setCursor(0, 90);
    tft.println(perv);
    Serial.println(perv);
  } else {
    myFile = SD.open(perv, FILE_WRITE);  // если файла  2.txt нет, то он будет создан
    myFile.close();
    tft.println(perv);
    Serial.println(perv);
  }  
}

void loop(void) {
////////Проверка существования запроса вывода лога в монитор СОМ- порта
  if (Serial.available() > 0) {
   
////////И если принят любой символ, то вывод лога в монитор порта
    File myFile = SD.open(perv);
    // if the file is available, write to it:
    if (myFile) {
      while (myFile.available()) {
        Serial.write(myFile.read());
      }
      myFile.close();
    }
    else {
      Serial.println("error opening .txt");
    }
  }
////////Считывание времени
  t = rtc.getTime();
  tft.setTextColor(WHITE);
////////Если время изменилось, то вывод новых показаний часов
  if ( time_sec_prev != t.sec) {
    tft.setCursor (  120 , 0 );     // установка позиции курсора
    tft.fillRect ( 118 , 0 , 50 , 7 , GRAY); // очистка области вывода времени
    tft.setTextSize(1);
    tft.print(rtc.getTimeStr());    // вывод показаний часов
    time_sec_prev = t.sec;
  }
////////Если дата изменилась, то вывод новой даты
  if ( time_day_prev != t.date) {
    tft.setCursor (  180 , 0 );     // установка позиции курсора
    tft.fillRect ( 178 , 0 , 65 , 7 , GRAY); // очистка области вывода даты
    tft.setTextSize(1);
    tft.print(rtc.getDateStr());    // вывод показаний даты
    time_day_prev = t.date;
  }
////////Если доступен радиоприём, то
  if (radio.available(&amp;pipe)) {
////////проверка заполнения буфера приёма,
    radio.read(&amp;data, sizeof(data));
////////если доступен нужный адрес передатчика, то
    if (pipe == 1) {
////////ждём синхронизирующую последовательность нулей для определения
//начала блока данных
      if ( data == 0000 ) {
        rc = 0;
      } else {
        rc ++;
      }
////////Запись значений счётчиков и расчёт их в 10 и 100-х долях часа
      if ( rc == 1 ) {
        leb_1 = data / 3600.0;
      }

      if ( rc == 2 ) {
        leb_2 = data / 3600.0;
      }

      if ( rc == 3 ) {
        leb_3 = data / 3600.0;
      }

      if ( rc == 4 ) {
        leb_4 = data / 3600.0;
      }
    }
  }
  r ++;
  k ++; // просто счётчик 
  //////// С определённой условием периодичностью обновление данных
  if ( r >= 6500) {
    tft.setTextSize(2);
    tft.fillRect ( 0 , 41 , 180 , 64 , GRAYD);
    Serial.println ("Lebedki I");
    tft.setCursor (0, 41);
    tft.println (leb_1);
    Serial.println (leb_1);
    tft.println (leb_2);
    Serial.println (leb_2);
    tft.println (leb_3);
    Serial.println (leb_3);
    tft.println (leb_4);
    Serial.println (leb_4);
    Serial.println (k);
    r = 0;
  }
////////Запись данных в лог на SD каждые 10 мин.
  if ((t.min % 10 == 0) &amp;&amp; ( t.sec == 0)) {
    tft.setTextSize(1);
    tft.setCursor(200, 10);
    tft.setTextColor(BLACK);
////////Создание строки в формате .csv
    String dataString = String (rtc.getDateStr()) + ", "+(rtc.getTimeStr()) + ", " + (leb_1) + ", " + (leb_2)
                        + ", " + (leb_3) + ", " + (leb_4) + ", ";
////////Запись в файл и вывод результатов процесса записи
    myFile = SD.open(perv, FILE_WRITE); // если файла с именем "2.txt" - нет, то он будет создан.
    if (myFile) {
      myFile.println(dataString);
      myFile.close();
      tft.fillRect ( 198 , 8 , 42 , 10 , GREEN);
      tft.println("SD OK");
      Serial.println("SD OK");
      delay (900); // задержка, иначе записывает 13 одинаковых показаний, пока секунда не пройдёт
    } else {
      tft.fillRect ( 198 , 8 , 42 , 10 , RED);
      tft.println("SD ERR");
      Serial.println("SD ERR");
    }
  }
}</code></pre></div></div><br/>
<div class="spoiler"><b class="spoiler_title">Программа перекодировки символов</b><div class="spoiler_text"><pre><code class="plaintext">/* Recode russian fonts from UTF-8 to Windows-1251 */

String utf8rus(String source)
{
  int i,k;
  String target;
  unsigned char n;
  char m[2] = { '0', '\0' };

  k = source.length(); i = 0;

  while (i &lt; k) {
    n = source[i]; i++;

    if (n >= 0xC0) {
      switch (n) {
        case 0xD0: {
          n = source[i]; i++;
          if (n == 0x81) { n = 0xA8; break; }
          if (n >= 0x90 &amp;&amp; n &lt;= 0xBF) n = n + 0x30;//0x2F
          break;
        }
        case 0xD1: {
          n = source[i]; i++;
          if (n == 0x91) { n = 0xB8; break; }
          if (n >= 0x80 &amp;&amp; n &lt;= 0x8F) n = n + 0x70;//0x6F
          break;
        }
      }
    }
    m[0] = n; target = target + String(m);
  }
return target;
}</code></pre></div></div><br/>
Программа перекодировки символов для вывода кириллицы библиотекой Adafruit_GFX помещается в одну папку с основной программой. Еще надо в Adafruit_GFX заменить файл glcdfont.с с другим шрифтом. <a href="https://yadi.sk/d/ouoPbMtVVEFzUQ">Здесь</a> библиотека с требуемой заменой. Подробнее о русификации легко ищется в интернете.<br/>
<br/>
Подводя итог скажу что система оправдала надежды, стало проще следить за наработкой оборудования. Хоть всё собрано на макетных платах, и в срочном порядке нареканий в работе нет. <br/>
<br/>
Первые элементы работают уже более полугода и пережили зиму. <a href="https://habrastorage.org/webt/vt/iz/bv/vtizbv-lzstibtfpblau91uxp6k.jpeg">Последняя конструкция</a> на 9 контролируемых агрегатов работает с 5 марта и по ней идет регистрация времени наработки уже официально.</div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BF%D1%80%D0%BE%D0%BC%D1%8B%D1%88%D0%BB%D0%B5%D0%BD%D0%BD%D0%B0%D1%8F%20%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%5D" class="tm-tags-list__link">промышленная автоматизация</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B0%D0%B2%D1%82%D0%BE%D0%BD%D0%BE%D0%BC%D0%BD%D0%B0%D1%8F%20%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%B0%5D" class="tm-tags-list__link">автономная система</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%81%D0%B1%D0%BE%D1%80%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85%5D" class="tm-tags-list__link">сбор данных</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hub/controllers/" class="tm-hubs-list__link">
    Программирование микроконтроллеров
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/electronics/" class="tm-hubs-list__link">
    Производство и разработка электроники
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/engineering_systems/" class="tm-hubs-list__link">
    Инженерные системы
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 19: ↑17 и ↓2</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 19: ↑17 и ↓2" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+15</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">4.5K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    37
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/viktoin/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/f02/607/ff0/f02607ff01c33acfd46fe4107e88c611.jpg" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 35 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    21
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><!----> <a href="/ru/users/viktoin/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @viktoin
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">Пользователь</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/451154/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 14 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <!----> <!----> <!----> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/451154/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/451154/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"451154":{"id":"451154","timePublished":"2019-05-09T17:43:24+00:00","isCorporative":false,"lang":"ru","titleHtml":"Локальная автономная система сбора данных (продолжение)","leadData":{"textHtml":"Начало на данном сайте \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F447168\u002F\"\u003Eпо ссылке\u003C\u002Fa\u003E.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nСамым удобным для использования вариантом съёма информации о включении пускателя оказался вариант с оптопарой PC817. \u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EПринципиальная схема\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fwd\u002Fb4\u002Fbp\u002Fwdb4bp10a_fcsqmqvi5bxbkedgq.jpeg\" alt=\"image alt\" align=\"left\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u003E\r\nПлаты содержат по три одинаковых схемы, всё помещено в коробки из ABS пластика, размер 100х100 мм. \u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EФото оптопар\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fww\u002Fau\u002Fqh\u002Fwwauqhutnnp2vez5-dtjlow9a-c.jpeg\" alt=\"image alt\" align=\"left\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E \u003Cbr\u003E\r\nПри подключении к пусковым аппаратам с полупроводниковыми вентилями их ток утечки достаточен для открытия РС817 и будет ложное срабатывание счётчика. Для исключения такой ситуации","imageUrl":null,"buttonTextHtml":"Читать дальше →","image":null},"editorVersion":"1.0","postType":"article","postLabels":[],"author":{"scoreStats":{"score":21,"votesCount":35},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"1861605","alias":"viktoin","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002Ff02\u002F607\u002Fff0\u002Ff02607ff01c33acfd46fe4107e88c611.jpg","speciality":"Пользователь"},"statistics":{"commentsCount":14,"favoritesCount":37,"readingCount":4476,"score":15,"votesCount":19},"hubs":[{"relatedData":null,"id":"19737","alias":"controllers","type":"collective","title":"Программирование микроконтроллеров","titleHtml":"Программирование микроконтроллеров","isProfiled":true},{"relatedData":null,"id":"21484","alias":"electronics","type":"collective","title":"Производство и разработка электроники","titleHtml":"Производство и разработка электроники","isProfiled":true},{"relatedData":null,"id":"22113","alias":"engineering_systems","type":"collective","title":"Инженерные системы","titleHtml":"Инженерные системы","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EНачало на данном сайте \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F447168\u002F\"\u003Eпо ссылке\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСамым удобным для использования вариантом съёма информации о включении пускателя оказался вариант с оптопарой PC817. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EПринципиальная схема\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fwd\u002Fb4\u002Fbp\u002Fwdb4bp10a_fcsqmqvi5bxbkedgq.jpeg\" alt=\"image alt\" align=\"left\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fwd\u002Fb4\u002Fbp\u002Fwdb4bp10a_fcsqmqvi5bxbkedgq.jpeg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nПлаты содержат по три одинаковых схемы, всё помещено в коробки из ABS пластика, размер 100х100 мм. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EФото оптопар\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fww\u002Fau\u002Fqh\u002Fwwauqhutnnp2vez5-dtjlow9a-c.jpeg\" alt=\"image alt\" align=\"left\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fww\u002Fau\u002Fqh\u002Fwwauqhutnnp2vez5-dtjlow9a-c.jpeg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E \u003Cbr\u002F\u003E\r\nПри подключении к пусковым аппаратам с полупроводниковыми вентилями их ток утечки достаточен для открытия РС817 и будет ложное срабатывание счётчика. Для исключения такой ситуации \u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E последовательно в цепь светодиода оптопары и светодиода индикации работы добавляется ещё один. Для этого размыкается перемычка J1 и впаивается дополнительный светодиод LED1. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПриёмная часть выполнена на \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Eсторона 1\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Flh\u002Fgi\u002Fxw\u002Flhgixwo48c-gcbyxvogroko5osw.jpeg\" alt=\"image alt\" align=\"left\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Flh\u002Fgi\u002Fxw\u002Flhgixwo48c-gcbyxvogroko5osw.jpeg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Eсторона 2\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fx5\u002F-c\u002Fg1\u002Fx5-cg1zzm4bwpsheiw2zhs2jg4q.jpeg\" alt=\"image alt\" align=\"left\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fx5\u002F-c\u002Fg1\u002Fx5-cg1zzm4bwpsheiw2zhs2jg4q.jpeg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nмакетной плате подключаемой к ARDUINO MEGA 2560. Для этого используется двухрядный разъём на торце. В качестве устройства отображения информации используется имеющий резистивный тач и датчик температуры экран с разрешением 240х400 \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EHX8352B.\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Ftt\u002Fo5\u002Fun\u002Ftto5unc0dk2yyqlk9z5xykbqryk.jpeg\" alt=\"image alt\" align=\"left\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Ftt\u002Fo5\u002Fun\u002Ftto5unc0dk2yyqlk9z5xykbqryk.jpeg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E \u003Cbr\u002F\u003E\r\nПричём разъём к ICSP на плате экрана демонтирован и не используется гнездо для микро- SD. Дело в том, что «родное» гнездо SD нельзя применить по причине конфликта на шине SPI. Для флеш- карты был применен отдельный кардридер имеющий в составе стабилизатор 3,3В и буферную микросхему с тремя состояниями выходов 74LVS125A. Вот тут ждали меня грабли. Буфер с тремя состояниями, но работал или E01-ML01DP5 или кардридер. В комментариях библиотеки SdFat разглядел предупреждение о несовместимости с другими устройствами. Был удалён конвертер уровней на TXS0108E и заменён перемычками, т.к. E01-ML01DP5 толерантен к 5В сигналам- не помогло. С помощью осциллографа выявлено пропадание сигнала на линии MISO при подключении кардридера. При внимательном рассмотрении было установлено, что входы разрешающих сигналов ОЕ 4-х каналов 74LVS125A были просто припаяны к общему проводу и ни о каком третьем состоянии речи быть не могло. Буферная микросхема использовалась как примитивный преобразователь уровней от 5В к 3.3В с использованием резисторов 3,3 КОм включенных последовательно с сигнальными линиями. Кроме линии MISO. Её выходной нижний ключ вероятно притягивал сигналы к уровню «земли». Определив что разрешающий сигнал линии MISO- это вывод 13, он был оторван от дорожки и\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003Eприпаян\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fwa\u002Ffy\u002Fdq\u002Fwafydqpdmui3d9sa0v4odl7csiy.jpeg\" alt=\"image alt\" align=\"left\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fwa\u002Ffy\u002Fdq\u002Fwafydqpdmui3d9sa0v4odl7csiy.jpeg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nмежду выводом входа (9) 74LVS125A выбора устройства CS и резистором согласования. Теперь если нет обращения к карте памяти, MISO- буфер отключается и не мешает работе другого устройства.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EСхема макетной платы\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fv7\u002Fh1\u002Fhw\u002Fv7h1hwt9dna8br023xqpfzcn0vk.jpeg\" alt=\"image alt\" align=\"left\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fv7\u002Fh1\u002Fhw\u002Fv7h1hwt9dna8br023xqpfzcn0vk.jpeg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EПриёмник в работе\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fwebt\u002Fpw\u002Fks\u002Fic\u002Fpwksicc1dsu56ohlkei3gx8xgse.jpeg\" alt=\"image alt\" align=\"left\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fpw\u002Fks\u002Fic\u002Fpwksicc1dsu56ohlkei3gx8xgse.jpeg\" data-blurred=\"true\"\u002F\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nДля подключения часов на DS3231 используется программная шина I2C (TWI).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EПрограмма Arduino IDE\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"plaintext\"\u003E\u002F\u002F IMPORTANT: Adafruit_TFTLCD LIBRARY MUST BE SPECIFICALLY\n\u002F\u002F CONFIGURED FOR EITHER THE TFT SHIELD OR THE BREAKOUT BOARD.\n\u002F\u002F SEE RELEVANT COMMENTS IN Adafruit_TFTLCD.h FOR SETUP.\n\u002F\u002Fby Open-Smart Team and Catalex Team\n\u002F\u002Fcatalex_inc@163.com\n\u002F\u002FStore:   http:\u002F\u002Fdx.com\n\u002F\u002F           https:\u002F\u002Fopen-smart.aliexpress.com\u002Fstore\u002F1199788\n\u002F\u002FDemo Function: Display graphics, characters\n\u002F\u002FArduino IDE: 1.6.5\n\u002F\u002F Board: Arduino UNO R3, Arduino Mega2560,Arduino Leonardo\n\n\u002F\u002F Board:OPEN-SMART UNO R3 5V \u002F 3.3V, Arduino UNO R3, Arduino Mega2560\n\u002F\u002F3.2INCH TFT:\n\u002F\u002F https:\u002F\u002Fwww.aliexpress.com\u002Fstore\u002Fproduct\u002F3-2-TFT-LCD-Display-module-Touch-Screen-Shield-board-onboard-temperature-sensor-w-Touch-Pen\u002F1199788_32755473754.html?spm=2114.12010615.0.0.bXDdc3\n\u002F\u002FOPEN-SMART UNO R3 5V \u002F 3.3V:\n\u002F\u002F https:\u002F\u002Fwww.aliexpress.com\u002Fstore\u002Fproduct\u002FOPEN-SMART-5V-3-3V-Compatible-UNO-R3-CH340G-ATMEGA328P-Development-Board-with-USB-Cable-for\u002F1199788_32758607490.html?spm=2114.12010615.0.0.ckMTaN\n\n#include &lt;Adafruit_GFX.h\u003E    \u002F\u002F Core graphics library\n\u002F\u002F#include &lt;Adafruit_TFTLCD.h\u003E \u002F\u002F Hardware-specific library\n#include &lt;MCUFRIEND_kbv.h\u003E\nMCUFRIEND_kbv tft;\n#include \"SdFat.h\"           \u002F\u002F Use the SdFat library\nSdFat SD;\nSdFile file;\nFile myFile;\n#define SD_CS_PIN SS\n\n#include &lt;SPI.h\u003E                                               \u002F\u002F Подключаем библиотеку для работы с шиной SPI\n#include &lt;nRF24L01.h\u003E                                          \u002F\u002F Подключаем файл настроек из библиотеки RF24\n#include &lt;RF24.h\u003E                                              \u002F\u002F Подключаем библиотеку для работы с nRF24L01+\nRF24           radio(47, 49);\n\n#include &lt;DS3231.h\u003E\n\nDS3231  rtc(27, 25);\nTime  t;\n\nuint16_t   r = 6000;\nuint32_t    k = 0;\n\nvolatile unsigned long data;\nfloat leb_1;\nfloat leb_2;\nfloat leb_3;\nfloat leb_4;\n\nuint8_t        pipe;\nint rc = 0;\n\nuint8_t time_sec_prev;\nuint8_t time_day_prev;\n\n\u002F\u002F***********************************************\u002F\u002F\n\u002F\u002F If you use OPEN-SMART TFT breakout board                 \u002F\u002F\n\u002F\u002F Reconmmend you to add 5V-3.3V level converting circuit.\n\u002F\u002F Of course you can use OPEN-SMART UNO Black version with 5V\u002F3.3V power switch,\n\u002F\u002F you just need switch to 3.3V.\n\u002F\u002F The control pins for the LCD can be assigned to any digital or\n\u002F\u002F analog pins...but we'll use the analog pins as this allows us to\n\u002F\u002F----------------------------------------|\n\u002F\u002F TFT Breakout  -- Arduino UNO \u002F Mega2560 \u002F OPEN-SMART UNO Black\n\u002F\u002F GND              -- GND\n\u002F\u002F 3V3               -- 3.3V\n\u002F\u002F CS                 -- A3\n\u002F\u002F RS                 -- A2\n\u002F\u002F WR                -- A1\n\u002F\u002F RD                 -- A0\n\u002F\u002F RST                -- RESET\n\u002F\u002F LED                -- GND\n\u002F\u002F DB0                -- 8\n\u002F\u002F DB1                -- 9\n\u002F\u002F DB2                -- 10\n\u002F\u002F DB3                -- 11\n\u002F\u002F DB4                -- 4\n\u002F\u002F DB5                -- 13\n\u002F\u002F DB6                -- 6\n\u002F\u002F DB7                -- 7\n\n\u002F\u002F Assign human-readable names to some common 16-bit color values:\n#define\tBLACK   0x0000\n#define\tBLUE    0x001F\n#define\tRED     0xF800\n#define\tGREEN   0x07E0\n#define CYAN    0x07FF\n#define MAGENTA 0xF81F\n#define YELLOW  0xFFE0\n#define WHITE   0xFFFF\n#define GRAY    0x8C51\n#define GRAYD   0x39E7\n\n\u002F\u002FAdafruit_TFTLCD tft(LCD_CS, LCD_CD, LCD_WR, LCD_RD, LCD_RESET);\n\u002F\u002F If using the shield, all control and data lines are fixed, and\n\u002F\u002F a simpler declaration can optionally be used:\n\u002F\u002F Adafruit_TFTLCD tft;\nuint16_t g_identifier;\n\nString dataString;\n\u002F\u002FString numfileMonth =\"1.txt\";\nchar perv [] = {\"2.txt\"};\n\u002F\u002FString *numfileMonth=\"1.txt\" (sizeof (numfileMonth));\n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\n\nvoid setup(void) {\n\n  rtc.begin();\n\n  \u002F\u002F Для установки времени- раскомментировать нужные строки\n  \u002F\u002F rtc.setDOW(6);               \u002F\u002F День недели\n  \u002F\u002F rtc.setTime(22, 04, 0);      \u002F\u002F Время, в формате 24 часа.\n  \u002F\u002F rtc.setDate(4, 5, 2019);   \u002F\u002F Дата, 29 октября 2018г.\n\n  Serial.begin(2000000);\n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F Инициализация экрана\n  tft.begin(0x65);\n  tft.reset();\n  tft.setRotation(0);\n  tft.cp437(true);\n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002FВывод имен, принадлежности оборудования, название организации\n  tft.fillScreen(BLACK);\n  tft.setTextColor(WHITE);\n  tft.setTextSize(2);\n  tft.setCursor (8, 0);\n  tft.println (\"DEVELOPERS &amp; BUILD\" );\n  tft.setCursor (30, 20);\n  tft.print (utf8rus(\"Конструктор В.В.\" ));\n  tft.setCursor (40, 40);\n  tft.print (utf8rus(\"Токарь И.И.\" ));\n  delay (2000);\n\n  radio.begin();                             \u002F\u002F Инициируем работу nRF24L01+\n  radio.setChannel(120);                     \u002F\u002F Указываем канал приёма данных (от 0 до 127)\n  radio.setDataRate     (RF24_250KBPS);      \u002F\u002F Указываем скорость передачи данных (RF24_250KBPS, RF24_1MBPS, RF24_2MBPS), RF24_1MBPS - 1Мбит\u002Fсек\n  radio.setPALevel      (RF24_PA_MAX);       \u002F\u002F Указываем мощность передатчика (RF24_PA_MIN=-18dBm, RF24_PA_LOW=-12dBm, RF24_PA_HIGH=-6dBm, RF24_PA_MAX=0dBm)\n  radio.openReadingPipe (1, 0xAABBCCDD11LL); \u002F\u002F Открываем 1 трубу с идентификатором 1 передатчика 0xAABBCCDD11, для приема данных\n                                             \u002F\u002F Открываем 2 трубу с идентификатором 2 передатчика 0xAABBCCDD22, для приема данных\n  radio.startListening  ();                  \u002F\u002F Включаем приемник, начинаем прослушивать открытые трубы\n  \u002F\u002F  radio.stopListening   ();\n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002FВывод служебной информации\n  tft.fillScreen(BLACK);\n  tft.setCursor (8, 0);\n  tft.setTextSize(1);\n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002FНачало инициализации SD карты\n  Serial.println(\"Initial SD card\");\n  tft.println(\"Initial SD card\");\n  tft.setCursor (8, 10);\n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002FИнициализация карты\n  if (!SD.begin(SD_CS_PIN)) {\n    Serial.println(\"initial failed!\");\n    tft.fillRect ( 8 , 10 , 85 , 7 , RED);\n    tft.setTextColor(BLACK);\n    tft.println(\"Initial failed!\");\n    return;\n  }\n  tft.setTextColor(WHITE);\n  Serial.println(\"initialization done\");\n  tft.println(\"Initialization done\");\n  delay (2000);\n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002FСчитывание времени- даты и присвоение их переменным\n  t = rtc.getTime();\n  time_sec_prev = t.sec;\n  time_day_prev = t.date;\n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002FВывод даты принудительно, что б не ждать смены даты для индикации\n  tft.setCursor (  180 , 0 );              \u002F\u002F установка позиции курсора\n  tft.fillRect ( 178 , 0 , 65 , 7 , GRAY); \u002F\u002F очистка области вывода времени\n  tft.setTextSize(1);\n  tft.print(rtc.getDateStr());\n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002FВывод названия объектов контроля\n  tft.setTextSize(2);\n  tft.setCursor (60, 25);\n  tft.println (utf8rus(\"Лебёдки I\"));\n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002FСоздание файла лога и вывод результата попытки создания\n  tft.setTextSize(1);\n  tft.setCursor(130, 10); \u002F\u002F если файл лога 2.txt создан, то будет продолжена запись в файл\n  if (SD.exists (perv)) {\n    \u002F\u002Ftft.setCursor(0, 90);\n    tft.println(perv);\n    Serial.println(perv);\n  } else {\n    myFile = SD.open(perv, FILE_WRITE);  \u002F\u002F если файла  2.txt нет, то он будет создан\n    myFile.close();\n    tft.println(perv);\n    Serial.println(perv);\n  }  \n}\n\nvoid loop(void) {\n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002FПроверка существования запроса вывода лога в монитор СОМ- порта\n  if (Serial.available() \u003E 0) {\n   \n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002FИ если принят любой символ, то вывод лога в монитор порта\n    File myFile = SD.open(perv);\n    \u002F\u002F if the file is available, write to it:\n    if (myFile) {\n      while (myFile.available()) {\n        Serial.write(myFile.read());\n      }\n      myFile.close();\n    }\n    else {\n      Serial.println(\"error opening .txt\");\n    }\n  }\n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002FСчитывание времени\n  t = rtc.getTime();\n  tft.setTextColor(WHITE);\n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002FЕсли время изменилось, то вывод новых показаний часов\n  if ( time_sec_prev != t.sec) {\n    tft.setCursor (  120 , 0 );     \u002F\u002F установка позиции курсора\n    tft.fillRect ( 118 , 0 , 50 , 7 , GRAY); \u002F\u002F очистка области вывода времени\n    tft.setTextSize(1);\n    tft.print(rtc.getTimeStr());    \u002F\u002F вывод показаний часов\n    time_sec_prev = t.sec;\n  }\n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002FЕсли дата изменилась, то вывод новой даты\n  if ( time_day_prev != t.date) {\n    tft.setCursor (  180 , 0 );     \u002F\u002F установка позиции курсора\n    tft.fillRect ( 178 , 0 , 65 , 7 , GRAY); \u002F\u002F очистка области вывода даты\n    tft.setTextSize(1);\n    tft.print(rtc.getDateStr());    \u002F\u002F вывод показаний даты\n    time_day_prev = t.date;\n  }\n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002FЕсли доступен радиоприём, то\n  if (radio.available(&amp;pipe)) {\n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002Fпроверка заполнения буфера приёма,\n    radio.read(&amp;data, sizeof(data));\n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002Fесли доступен нужный адрес передатчика, то\n    if (pipe == 1) {\n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002Fждём синхронизирующую последовательность нулей для определения\n\u002F\u002Fначала блока данных\n      if ( data == 0000 ) {\n        rc = 0;\n      } else {\n        rc ++;\n      }\n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002FЗапись значений счётчиков и расчёт их в 10 и 100-х долях часа\n      if ( rc == 1 ) {\n        leb_1 = data \u002F 3600.0;\n      }\n\n      if ( rc == 2 ) {\n        leb_2 = data \u002F 3600.0;\n      }\n\n      if ( rc == 3 ) {\n        leb_3 = data \u002F 3600.0;\n      }\n\n      if ( rc == 4 ) {\n        leb_4 = data \u002F 3600.0;\n      }\n    }\n  }\n  r ++;\n  k ++; \u002F\u002F просто счётчик \n  \u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002F С определённой условием периодичностью обновление данных\n  if ( r \u003E= 6500) {\n    tft.setTextSize(2);\n    tft.fillRect ( 0 , 41 , 180 , 64 , GRAYD);\n    Serial.println (\"Lebedki I\");\n    tft.setCursor (0, 41);\n    tft.println (leb_1);\n    Serial.println (leb_1);\n    tft.println (leb_2);\n    Serial.println (leb_2);\n    tft.println (leb_3);\n    Serial.println (leb_3);\n    tft.println (leb_4);\n    Serial.println (leb_4);\n    Serial.println (k);\n    r = 0;\n  }\n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002FЗапись данных в лог на SD каждые 10 мин.\n  if ((t.min % 10 == 0) &amp;&amp; ( t.sec == 0)) {\n    tft.setTextSize(1);\n    tft.setCursor(200, 10);\n    tft.setTextColor(BLACK);\n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002FСоздание строки в формате .csv\n    String dataString = String (rtc.getDateStr()) + \", \"+(rtc.getTimeStr()) + \", \" + (leb_1) + \", \" + (leb_2)\n                        + \", \" + (leb_3) + \", \" + (leb_4) + \", \";\n\u002F\u002F\u002F\u002F\u002F\u002F\u002F\u002FЗапись в файл и вывод результатов процесса записи\n    myFile = SD.open(perv, FILE_WRITE); \u002F\u002F если файла с именем \"2.txt\" - нет, то он будет создан.\n    if (myFile) {\n      myFile.println(dataString);\n      myFile.close();\n      tft.fillRect ( 198 , 8 , 42 , 10 , GREEN);\n      tft.println(\"SD OK\");\n      Serial.println(\"SD OK\");\n      delay (900); \u002F\u002F задержка, иначе записывает 13 одинаковых показаний, пока секунда не пройдёт\n    } else {\n      tft.fillRect ( 198 , 8 , 42 , 10 , RED);\n      tft.println(\"SD ERR\");\n      Serial.println(\"SD ERR\");\n    }\n  }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Cdiv class=\"spoiler\"\u003E\u003Cb class=\"spoiler_title\"\u003EПрограмма перекодировки символов\u003C\u002Fb\u003E\u003Cdiv class=\"spoiler_text\"\u003E\u003Cpre\u003E\u003Ccode class=\"plaintext\"\u003E\u002F* Recode russian fonts from UTF-8 to Windows-1251 *\u002F\n\nString utf8rus(String source)\n{\n  int i,k;\n  String target;\n  unsigned char n;\n  char m[2] = { '0', '\\0' };\n\n  k = source.length(); i = 0;\n\n  while (i &lt; k) {\n    n = source[i]; i++;\n\n    if (n \u003E= 0xC0) {\n      switch (n) {\n        case 0xD0: {\n          n = source[i]; i++;\n          if (n == 0x81) { n = 0xA8; break; }\n          if (n \u003E= 0x90 &amp;&amp; n &lt;= 0xBF) n = n + 0x30;\u002F\u002F0x2F\n          break;\n        }\n        case 0xD1: {\n          n = source[i]; i++;\n          if (n == 0x91) { n = 0xB8; break; }\n          if (n \u003E= 0x80 &amp;&amp; n &lt;= 0x8F) n = n + 0x70;\u002F\u002F0x6F\n          break;\n        }\n      }\n    }\n    m[0] = n; target = target + String(m);\n  }\nreturn target;\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nПрограмма перекодировки символов для вывода кириллицы библиотекой Adafruit_GFX помещается в одну папку с основной программой. Еще надо в Adafruit_GFX заменить файл glcdfont.с с другим шрифтом. \u003Ca href=\"https:\u002F\u002Fyadi.sk\u002Fd\u002FouoPbMtVVEFzUQ\"\u003EЗдесь\u003C\u002Fa\u003E библиотека с требуемой заменой. Подробнее о русификации легко ищется в интернете.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПодводя итог скажу что система оправдала надежды, стало проще следить за наработкой оборудования. Хоть всё собрано на макетных платах, и в срочном порядке нареканий в работе нет. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПервые элементы работают уже более полугода и пережили зиму. \u003Ca href=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fvt\u002Fiz\u002Fbv\u002Fvtizbv-lzstibtfpblau91uxp6k.jpeg\"\u003EПоследняя конструкция\u003C\u002Fa\u003E на 9 контролируемых агрегатов работает с 5 марта и по ней идет регистрация времени наработки уже официально.\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"промышленная автоматизация"},{"titleHtml":"автономная система"},{"titleHtml":"сбор данных"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F451154\u002F45d4aae2e3faf7e90f15a5e541d3552b\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F451154\u002F45d4aae2e3faf7e90f15a5e541d3552b\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F451154\\\u002F\"},\"headline\":\"Локальная автономная система сбора данных (продолжение)\",\"datePublished\":\"2019-05-09T20:43:24+03:00\",\"dateModified\":\"2019-05-11T21:25:19+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"viktoin\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Начало на данном сайте по ссылке.  Самым удобным для использования вариантом съёма информации о включении пускателя оказался вариант с оптопарой PC817.   Принцип...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F451154\\\u002F#post-content-body\",\"about\":[\"h_controllers\",\"h_electronics\",\"h_engineering_systems\",\"f_develop\",\"f_admin\"],\"image\":[\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fwd\\\u002Fb4\\\u002Fbp\\\u002Fwdb4bp10a_fcsqmqvi5bxbkedgq.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fww\\\u002Fau\\\u002Fqh\\\u002Fwwauqhutnnp2vez5-dtjlow9a-c.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Flh\\\u002Fgi\\\u002Fxw\\\u002Flhgixwo48c-gcbyxvogroko5osw.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fx5\\\u002F-c\\\u002Fg1\\\u002Fx5-cg1zzm4bwpsheiw2zhs2jg4q.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Ftt\\\u002Fo5\\\u002Fun\\\u002Ftto5unc0dk2yyqlk9z5xykbqryk.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fwa\\\u002Ffy\\\u002Fdq\\\u002Fwafydqpdmui3d9sa0v4odl7csiy.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fv7\\\u002Fh1\\\u002Fhw\\\u002Fv7h1hwt9dna8br023xqpfzcn0vk.jpeg\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fpw\\\u002Fks\\\u002Fic\\\u002Fpwksicc1dsu56ohlkei3gx8xgse.jpeg\"]}","metaDescription":"Начало на данном сайте по ссылке.\r\n\r\nСамым удобным для использования вариантом съёма информации о включении пускателя оказался вариант с оптопарой PC817. \r\n\r\nПринципиальная схема\r\nПлаты содержат по...","mainImageUrl":null,"amp":false},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":"controllers,electronics,engineering_systems"},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
