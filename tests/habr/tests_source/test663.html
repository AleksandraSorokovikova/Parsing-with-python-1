<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>VDI: Дешево и сердито / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/451520\/"},"headline":"VDI: Дешево и сердито","datePublished":"2019-05-29T13:05:46+03:00","dateModified":"2019-06-05T20:19:53+03:00","author":{"@type":"Person","name":"Андрей Пономарёв"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Добрый день уважаемы Хабровчане, друзья и знакомые. В качестве предисловия хочу рассказать о реализации одного интересного проекта или как сейчас модно выражат...","url":"https:\/\/habr.com\/ru\/post\/451520\/#post-content-body","about":["h_sys_admin","h_virtualization","h_s_admin","f_admin"],"image":["https:\/\/habrastorage.org\/webt\/wi\/kx\/fo\/wikxfomu1gaefx-0flncqjauk5o.png","https:\/\/habrastorage.org\/webt\/mh\/0x\/2e\/mh0x2e7i7tobz-us6jmjyxgyw3e.png","https:\/\/habrastorage.org\/webt\/5f\/bo\/4k\/5fbo4kvywhqjqd-f3ytkdggr2ny.png","https:\/\/habrastorage.org\/webt\/f8\/gv\/ey\/f8gveyi4ffhvkva0au_3liatglw.png"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="VDI: Дешево и сердито" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="VDI: Дешево и сердито" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="VDI: Дешево и сердито" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Добрый день уважаемы Хабровчане, друзья и знакомые. В качестве предисловия хочу рассказать о реализации одного интересного проекта или как сейчас модно выражаться, одного интересного кейса касаемо..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Добрый день уважаемы Хабровчане, друзья и знакомые. В качестве предисловия хочу рассказать о реализации одного интересного проекта или как сейчас модно выражаться, одного интересного кейса касаемо..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Добрый день уважаемы Хабровчане, друзья и знакомые. В качестве предисловия хочу рассказать о реализации одного интересного проекта или как сейчас модно выражаться, одного интересного кейса касаемо..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Добрый день уважаемы Хабровчане, друзья и знакомые. В качестве предисловия хочу рассказать о реализации одного интересного проекта или как сейчас модно выражаться, одного интересного кейса касаемо..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Добрый день уважаемы Хабровчане, друзья и знакомые. В качестве предисловия хочу рассказать о реализации одного интересного проекта или как сейчас модно выражаться, одного интересного кейса касаемо..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/451520/668d3a6d0f86e50bb2a37248f6932cc5/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/451520/668d3a6d0f86e50bb2a37248f6932cc5/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/451520/668d3a6d0f86e50bb2a37248f6932cc5/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/451520/668d3a6d0f86e50bb2a37248f6932cc5/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/451520/668d3a6d0f86e50bb2a37248f6932cc5/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="451520" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2019-05-29T10:05:46.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/451520/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/451520/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/451520/668d3a6d0f86e50bb2a37248f6932cc5/" data-vmid="image:href"><link data-vue-meta="ssr" rel="amphtml" href="https://habr.com/ru/amp/post/451520/">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/0000168/" title="0000168" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_green"><!----> <use xlink:href="/img/megazord-v24.ce74655c.svg#placeholder-user"></use></svg></div></a> <span class="tm-user-info__user"><a href="/ru/users/0000168/" class="tm-user-info__username">
      0000168
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2019-05-29T10:05:46.000Z" title="2019-05-29, 13:05">29  мая  2019 в 13:05</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>VDI: Дешево и сердито</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/sys_admin/" class="tm-article-snippet__hubs-item-link"><span>Системное администрирование</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/virtualization/" class="tm-article-snippet__hubs-item-link"><span>Виртуализация</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/s_admin/" class="tm-article-snippet__hubs-item-link"><span>Серверное администрирование</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <!----> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/wi/kx/fo/wikxfomu1gaefx-0flncqjauk5o.png"/><br/>
<br/>
Добрый день уважаемы Хабровчане, друзья и знакомые. В качестве предисловия хочу рассказать о реализации одного интересного проекта или как сейчас модно выражаться, одного интересного кейса касаемо развертывания VDI инфраструктуры. Казалось, статей по VDI много, тут есть и step-by-step, и сравнение прямых конкурентов и опять step-by-step и опять сравнение конкурентных решений. Казалось, что можно предложить нового? <br/>
 <br/>
 А нового, чего нету у многих статей, это описание экономического эффекта от внедрения, расчета стоимости владения выбранного решения и что ещё интереснее — сравнение стоимости владения с аналогичными решениями. В данном случае исходя из названия статьи ключевое слово <b>дёшево</b>: что это значит? У одного моего коллеги, знакомо и друга в начале года была задача реализовать VDI с минимальным количеством “окон”, а именно бесплатный гипервизор, Linux рабочий стол, бесплатная БД и прочие способы минимизации затрат с нашим «любимым» Microsoft.<br/>
<a name="habracut"></a><br/>
 А почему с “минимальными окнами”? Тут я отступлю от дальнейшего повествования и опишу диспозицию почему меня заинтересовало раскрытие именно этой темы. Мой знакомый, которому я помогал в развертывании проекта работает в средней компания со штатом больше около 500 человек, не весь софт легальный, но работы по его оптимизации шли, большинство Front-end информационных систем адаптированы под WEB, было хорошее настроение пока в один прекрасный день не пришел <s>коллектор </s>“персональный менеджер” Microsoft закрепленный за компанией и начал нет, не предлагать, не просить, а требовать срочно все принудительно легализовать, делая многие заключения о используемых решениях на основе открытых источников и пресс-релизов. Казалось, в компании не против, но эта назойливость и навязчивость, граничащие с угрозами, подстегнули к давним планам <s>импортозамещения </s>минимизации использования продуктов MS и максимального ухода в OpenSource. Человек со стороны может не особо поверить в описанную ситуацию с представителем софтверного гиганта, но в свое время аналогичная ситуация повторилась 1 в 1 с указанным давлением со стороны сотрудника Microsoft лично со мной. <br/>
 <br/>
 С другой стороны, это дополнительный триггер для пересмотра стратеги развития IT подразделения с целью диверсификации использования платных программных продуктов. Опять-же, тенденция проникновения OpenSource решений для бизнеса набирает все большие масштабы, на эту тему было обсуждение на конференции ИТ-ОСЬ 0219 и слайд ниже полное тому подтверждение.<br/>
<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/webt/mh/0x/2e/mh0x2e7i7tobz-us6jmjyxgyw3e.png"/></div><br/>
 Так вот, в указанной выше организации была поставлена цель: форсировать завершение лицензирования MS продуктов, при этом максимально внедрять и использовать OpenSource решения. Для доступа пользователей было решено перейти с “терминалок” и Windows VDI полностью на Linux VDI. Выбор Citrix VDI был обусловлен ввиду небольшого штата администрирования, большого количества филиалов и простоты развёртывания масштабирования и уже приобретенном продукте.<br/>
 <br/>
 И в первой части статьи я хочу остановиться на расчете TCO владения инфраструктуры Linux VDI и выборе решения на базе решения Citrix Virtual Apps and Desktops в простонародье XenDesktop и старого доброго XenServer хотя сейчас он называется Citrix Hypervisor (ох уж этот ребрендинг, разом изменить название почти всей продуктовой линейки) и соответственно Linux рабочих столов. Казалось все прекрасно знают, что синергия VDI/APP это совокупность использования Vmware в качестве гипервизора, Citrix в качестве контроллера доставки приложений и Microsoft как гостевой ОС. Но как быть если нужно та-же технология, но с минимальными затратами? Что-ж, давайте посчитаем:<br/>
<br/>
В начале я расскажу о диспозиции ДО, а после что “стоило” перейти на новую платформу.<br/>
Для простоты и целостности картины давайте рассматривать только программную часть, так, как оборудование уже имелось и выполняло свою задачу. <br/>
<br/>
Итак, в начале было… была прекрасная СХД EMC, Blade корзина HP c7000 и 7 G8 серверов в роли виртуализации VDI. На серверах был установлен Windows Server 2012R2 с ролью Hyper-V и использовался SCVMM. Была развернута приобретенная платформа VDI на базе XenDesktop 7.18, были развернуты несколько терминальных ферм. Зная диспозицию и необходимость лицензирования большого количества ПО давайте сравним стоимость развертывания Linux VDI и полного решения на базе Microsoft “под ключ”. Перевод было решено реализовывать поступательно, на первоначальном этапе затрагивались филиалы компании, вторым этапом предполагалось перевод оставшихся рабочих мест в ГО.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/5f/bo/4k/5fbo4kvywhqjqd-f3ytkdggr2ny.png"/><br/>
<br/>
На терминальной ферме в основном работала 1С, на VDI рабочих столах работал стандартный офисный пакет, почта, файлы, интернет (основная их функция была исключительно чтение и печать). <br/>
<br/>
Зная перечень требуемого ПО давайте посчитаем полную стоимость владение решения от Microsoft. <br/>
<br/>
<b>Windows Server:</b><br/>
<br/>
Согласно требованиям лицензирования Microsoft, должны быть выполнены следующие условия:<br/>
 <br/>
<ol>
<li>Лицензировать нужно все физические ядра в сервере.</li>
<li>Минимальный пакет 2-ядерных лицензий на сервер — 8 шт. (или одна 16-ядерная лицензия).</li>
<li>Минимальный пакет 2-ядерных лицензий на процессор — 4 шт. (это правило включается, если число процессоров больше двух).</li>
<li>Пакет лицензий Standard предоставляет право использования одного физического и двух виртуальных экземпляров Windows Server на одном сервере.</li>
<li>Пакет лицензий Datacenter предоставляет право использования одного физического и любого числа виртуальных экземпляров Windows Server на одном сервере.</li>
</ol><br/>
Получается, что если на сервере требуется установить более 13 виртуальных экземпляров Windows Server и Windows рабочих станций, то экономически целесообразно приобрести редакцию Datacenter, которую мы и будем рассматривать. <br/>
<br/>
<b>Windows 10 VDI:</b><br/>
<br/>
Согласно лицензионной политике Microsoft, доступ к виртуальным десктопам с клиентской ОС должен осуществляться с устройства, имеющего действующую подписку Microsoft VDA (Virtual Desktop Access), за исключением ПК охваченных действием Software Assurance. В нашем случае фактически нужно приобретать и ежегодно продлять подписку на 300 DVA лицензий.<br/>
<br/>
“I’m buying VDI software from VMware / Citrix / another vendor.<br/>
<br/>
Do I still need Windows VDA? Yes. If you are accessing a Windows client OS as your guest operating system in the datacenter from any non-SA device (including thin clients, iPads, etc), Windows VDA is the appropriate licensing vehicle regardless of the VDI software vendor you choose. The only scenario where you would not need Windows VDA is if you were using PCs covered under Software Assurance as the access devices, since virtual desktop access rights are included as a benefit of SA.”<br/>
<br/>
<b> SCVMM:</b><br/>
<br/>
Система управления виртуальной инфраструктурой system center virtual machine manager входит в комплект Microsoft System Center и как отдельный продукт не поставляется. Касаемо такого подхода дискутировать не приходится, что имеем, то имеем. <br/>
<br/>
Учитывая требования лицензирования:<br/>
<br/>
<ol>
<li>“Лицензировать нужно все физические ядра в сервере.</li>
<li>Минимальный пакет 2-ядерных лицензий на сервер — 8 шт. (или одна 16-ядерная лицензия).</li>
<li>Минимальный пакет 2-ядерных лицензий на процессор — 4 шт. (это правило включается, если число процессоров больше двух).</li>
<li>Пакет лицензий Standard предоставляет право управления одной физической и двумя виртуальными ОС на одном сервере.</li>
<li>Пакет лицензий Datacenter предоставляет право управления одной физической и любым количеством виртуальных ОС на одном сервере.”</li>
</ol><br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/f8/gv/ey/f8gveyi4ffhvkva0au_3liatglw.png"/><br/>
 <br/>
 Указанные цены прайсовые, безусловно при таком объеме возможно скидка, но в отличии от GLP прайсов Cisco или Lenovo, забудьте о скидке в 50 или 70%. По опыту взаимодействия с MS свыше 5% увидеть сложно. Получается только за первый год стоимость владения составит больше 5 миллионов рублей, в рамках 3 лет стоимость владения составит ~ 9 млн. руб. Цифра не малая, а для компании среднего размера скажу, что огромная. Получается, что с экономической точки зрения решение уже е кажется таким уж не простым. <br/>
<br/>
Забегая вперед скажу, что после калькуляции решения указанного проекта руководство приняло положительное решение при его утверждении. <br/>
<br/>
<h3>Итог:</h3><br/>
 В итоге связка ПО оказалась следующая: Гирепвизор Citrix Hypervisor, гостевые ОС Linux, всем управляет Citrix Virtual Desktops. Экономия 3 млн. руб. в год существенна. Легко ли было реализовать этот проект? Нет! Панацея ли это для такого решения? Нет! Но однозначно имеет место быть для детального рассмотрения возможности внедрения на базе Citrix VDI с Linux гостевыми системами. Минусы конечно есть и не малые, более детально о них я расскажу во второй части, которая будет полный step-by-step описанного решения.<br/>
<br/>
В заключении хочу сказать, я не претендую на заключение в конечной инстанции, но сам по себе кейс, задача были очень интересный. <br/>
<br/>
<i>Спасибо за уделенное внимание, до скорой встречи)</i></div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bcitrix%5D" class="tm-tags-list__link">citrix</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bxenserver%5D" class="tm-tags-list__link">xenserver</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bxendesktop%5D" class="tm-tags-list__link">xendesktop</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hub/sys_admin/" class="tm-hubs-list__link">
    Системное администрирование
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/virtualization/" class="tm-hubs-list__link">
    Виртуализация
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/s_admin/" class="tm-hubs-list__link">
    Серверное администрирование
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 8: ↑7 и ↓1</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 8: ↑7 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+6</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">19K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    31
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/0000168/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><svg class="tm-svg-img tm-image-placeholder tm-image-placeholder_green"><!----> <use xlink:href="/img/megazord-v24.ce74655c.svg#placeholder-user"></use></svg></div></a> <div class="tm-user-card__meta"><div title=" 54 голоса " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    10
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><span class="tm-user-card__name tm-user-card__name_variant-article">Андрей Пономарёв</span> <a href="/ru/users/0000168/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @0000168
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">Архитектор ИТ-инфраструктуры</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <div class="tm-article-author__user-contacts"><a href="https://telegram.me/andrey_cloud" rel="noopener" target="_blank" class="tm-article-author__contact">
      Telegram
    </a></div></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/451520/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 9 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <!----> <!----> <!----> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/451520/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/451520/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"451520":{"id":"451520","timePublished":"2019-05-29T10:05:46+00:00","isCorporative":false,"lang":"ru","titleHtml":"VDI: Дешево и сердито","leadData":{"textHtml":"\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fwi\u002Fkx\u002Ffo\u002Fwikxfomu1gaefx-0flncqjauk5o.png\"\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nДобрый день уважаемы Хабровчане, друзья и знакомые. В качестве предисловия хочу рассказать о реализации одного интересного проекта или как сейчас модно выражаться, одного интересного кейса касаемо развертывания VDI инфраструктуры. Казалось, статей по VDI много, тут есть и step-by-step, и сравнение прямых конкурентов и опять step-by-step и опять сравнение конкурентных решений. Казалось, что можно предложить нового? \u003Cbr\u003E\r\n \u003Cbr\u003E\r\n А нового, чего нету у многих статей, это описание экономического эффекта от внедрения, расчета стоимости владения выбранного решения и что ещё интереснее — сравнение стоимости владения с аналогичными решениями. В данном случае исходя из названия статьи ключевое слово \u003Cb\u003Eдёшево\u003C\u002Fb\u003E: что это значит? У одного моего коллеги, знакомо и друга в начале года была задача реализовать VDI с минимальным количеством “окон”, а именно бесплатный гипервизор, Linux рабочий стол, бесплатная БД и прочие способы минимизации затрат с нашим «любимым» Microsoft.\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше →","image":null},"editorVersion":"1.0","postType":"article","postLabels":[],"author":{"scoreStats":{"score":10,"votesCount":54},"rating":0,"relatedData":null,"contacts":[{"title":"Telegram","url":"https:\u002F\u002Ftelegram.me\u002Fandrey_cloud","value":"andrey_cloud"}],"authorContacts":[{"title":"Telegram","url":"https:\u002F\u002Ftelegram.me\u002Fandrey_cloud","value":"andrey_cloud"}],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"268843","alias":"0000168","fullname":"Андрей Пономарёв","avatarUrl":null,"speciality":"Архитектор ИТ-инфраструктуры"},"statistics":{"commentsCount":9,"favoritesCount":31,"readingCount":19296,"score":6,"votesCount":8},"hubs":[{"relatedData":null,"id":"221","alias":"sys_admin","type":"collective","title":"Системное администрирование","titleHtml":"Системное администрирование","isProfiled":true},{"relatedData":null,"id":"7312","alias":"virtualization","type":"collective","title":"Виртуализация","titleHtml":"Виртуализация","isProfiled":true},{"relatedData":null,"id":"17350","alias":"s_admin","type":"collective","title":"Серверное администрирование","titleHtml":"Серверное администрирование","isProfiled":true}],"flows":[{"id":"6","alias":"admin","title":"Администрирование"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fwi\u002Fkx\u002Ffo\u002Fwikxfomu1gaefx-0flncqjauk5o.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДобрый день уважаемы Хабровчане, друзья и знакомые. В качестве предисловия хочу рассказать о реализации одного интересного проекта или как сейчас модно выражаться, одного интересного кейса касаемо развертывания VDI инфраструктуры. Казалось, статей по VDI много, тут есть и step-by-step, и сравнение прямых конкурентов и опять step-by-step и опять сравнение конкурентных решений. Казалось, что можно предложить нового? \u003Cbr\u002F\u003E\r\n \u003Cbr\u002F\u003E\r\n А нового, чего нету у многих статей, это описание экономического эффекта от внедрения, расчета стоимости владения выбранного решения и что ещё интереснее — сравнение стоимости владения с аналогичными решениями. В данном случае исходя из названия статьи ключевое слово \u003Cb\u003Eдёшево\u003C\u002Fb\u003E: что это значит? У одного моего коллеги, знакомо и друга в начале года была задача реализовать VDI с минимальным количеством “окон”, а именно бесплатный гипервизор, Linux рабочий стол, бесплатная БД и прочие способы минимизации затрат с нашим «любимым» Microsoft.\u003Cbr\u002F\u003E\r\n\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n А почему с “минимальными окнами”? Тут я отступлю от дальнейшего повествования и опишу диспозицию почему меня заинтересовало раскрытие именно этой темы. Мой знакомый, которому я помогал в развертывании проекта работает в средней компания со штатом больше около 500 человек, не весь софт легальный, но работы по его оптимизации шли, большинство Front-end информационных систем адаптированы под WEB, было хорошее настроение пока в один прекрасный день не пришел \u003Cs\u003Eколлектор \u003C\u002Fs\u003E“персональный менеджер” Microsoft закрепленный за компанией и начал нет, не предлагать, не просить, а требовать срочно все принудительно легализовать, делая многие заключения о используемых решениях на основе открытых источников и пресс-релизов. Казалось, в компании не против, но эта назойливость и навязчивость, граничащие с угрозами, подстегнули к давним планам \u003Cs\u003Eимпортозамещения \u003C\u002Fs\u003Eминимизации использования продуктов MS и максимального ухода в OpenSource. Человек со стороны может не особо поверить в описанную ситуацию с представителем софтверного гиганта, но в свое время аналогичная ситуация повторилась 1 в 1 с указанным давлением со стороны сотрудника Microsoft лично со мной. \u003Cbr\u002F\u003E\r\n \u003Cbr\u002F\u003E\r\n С другой стороны, это дополнительный триггер для пересмотра стратеги развития IT подразделения с целью диверсификации использования платных программных продуктов. Опять-же, тенденция проникновения OpenSource решений для бизнеса набирает все большие масштабы, на эту тему было обсуждение на конференции ИТ-ОСЬ 0219 и слайд ниже полное тому подтверждение.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fmh\u002F0x\u002F2e\u002Fmh0x2e7i7tobz-us6jmjyxgyw3e.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n Так вот, в указанной выше организации была поставлена цель: форсировать завершение лицензирования MS продуктов, при этом максимально внедрять и использовать OpenSource решения. Для доступа пользователей было решено перейти с “терминалок” и Windows VDI полностью на Linux VDI. Выбор Citrix VDI был обусловлен ввиду небольшого штата администрирования, большого количества филиалов и простоты развёртывания масштабирования и уже приобретенном продукте.\u003Cbr\u002F\u003E\r\n \u003Cbr\u002F\u003E\r\n И в первой части статьи я хочу остановиться на расчете TCO владения инфраструктуры Linux VDI и выборе решения на базе решения Citrix Virtual Apps and Desktops в простонародье XenDesktop и старого доброго XenServer хотя сейчас он называется Citrix Hypervisor (ох уж этот ребрендинг, разом изменить название почти всей продуктовой линейки) и соответственно Linux рабочих столов. Казалось все прекрасно знают, что синергия VDI\u002FAPP это совокупность использования Vmware в качестве гипервизора, Citrix в качестве контроллера доставки приложений и Microsoft как гостевой ОС. Но как быть если нужно та-же технология, но с минимальными затратами? Что-ж, давайте посчитаем:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ начале я расскажу о диспозиции ДО, а после что “стоило” перейти на новую платформу.\u003Cbr\u002F\u003E\r\nДля простоты и целостности картины давайте рассматривать только программную часть, так, как оборудование уже имелось и выполняло свою задачу. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nИтак, в начале было… была прекрасная СХД EMC, Blade корзина HP c7000 и 7 G8 серверов в роли виртуализации VDI. На серверах был установлен Windows Server 2012R2 с ролью Hyper-V и использовался SCVMM. Была развернута приобретенная платформа VDI на базе XenDesktop 7.18, были развернуты несколько терминальных ферм. Зная диспозицию и необходимость лицензирования большого количества ПО давайте сравним стоимость развертывания Linux VDI и полного решения на базе Microsoft “под ключ”. Перевод было решено реализовывать поступательно, на первоначальном этапе затрагивались филиалы компании, вторым этапом предполагалось перевод оставшихся рабочих мест в ГО.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F5f\u002Fbo\u002F4k\u002F5fbo4kvywhqjqd-f3ytkdggr2ny.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа терминальной ферме в основном работала 1С, на VDI рабочих столах работал стандартный офисный пакет, почта, файлы, интернет (основная их функция была исключительно чтение и печать). \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЗная перечень требуемого ПО давайте посчитаем полную стоимость владение решения от Microsoft. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EWindows Server:\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСогласно требованиям лицензирования Microsoft, должны быть выполнены следующие условия:\u003Cbr\u002F\u003E\r\n \u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003EЛицензировать нужно все физические ядра в сервере.\u003C\u002Fli\u003E\r\n\u003Cli\u003EМинимальный пакет 2-ядерных лицензий на сервер — 8 шт. (или одна 16-ядерная лицензия).\u003C\u002Fli\u003E\r\n\u003Cli\u003EМинимальный пакет 2-ядерных лицензий на процессор — 4 шт. (это правило включается, если число процессоров больше двух).\u003C\u002Fli\u003E\r\n\u003Cli\u003EПакет лицензий Standard предоставляет право использования одного физического и двух виртуальных экземпляров Windows Server на одном сервере.\u003C\u002Fli\u003E\r\n\u003Cli\u003EПакет лицензий Datacenter предоставляет право использования одного физического и любого числа виртуальных экземпляров Windows Server на одном сервере.\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\r\nПолучается, что если на сервере требуется установить более 13 виртуальных экземпляров Windows Server и Windows рабочих станций, то экономически целесообразно приобрести редакцию Datacenter, которую мы и будем рассматривать. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EWindows 10 VDI:\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСогласно лицензионной политике Microsoft, доступ к виртуальным десктопам с клиентской ОС должен осуществляться с устройства, имеющего действующую подписку Microsoft VDA (Virtual Desktop Access), за исключением ПК охваченных действием Software Assurance. В нашем случае фактически нужно приобретать и ежегодно продлять подписку на 300 DVA лицензий.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n“I’m buying VDI software from VMware \u002F Citrix \u002F another vendor.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nDo I still need Windows VDA? Yes. If you are accessing a Windows client OS as your guest operating system in the datacenter from any non-SA device (including thin clients, iPads, etc), Windows VDA is the appropriate licensing vehicle regardless of the VDI software vendor you choose. The only scenario where you would not need Windows VDA is if you were using PCs covered under Software Assurance as the access devices, since virtual desktop access rights are included as a benefit of SA.”\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003E SCVMM:\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСистема управления виртуальной инфраструктурой system center virtual machine manager входит в комплект Microsoft System Center и как отдельный продукт не поставляется. Касаемо такого подхода дискутировать не приходится, что имеем, то имеем. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nУчитывая требования лицензирования:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003E“Лицензировать нужно все физические ядра в сервере.\u003C\u002Fli\u003E\r\n\u003Cli\u003EМинимальный пакет 2-ядерных лицензий на сервер — 8 шт. (или одна 16-ядерная лицензия).\u003C\u002Fli\u003E\r\n\u003Cli\u003EМинимальный пакет 2-ядерных лицензий на процессор — 4 шт. (это правило включается, если число процессоров больше двух).\u003C\u002Fli\u003E\r\n\u003Cli\u003EПакет лицензий Standard предоставляет право управления одной физической и двумя виртуальными ОС на одном сервере.\u003C\u002Fli\u003E\r\n\u003Cli\u003EПакет лицензий Datacenter предоставляет право управления одной физической и любым количеством виртуальных ОС на одном сервере.”\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Ff8\u002Fgv\u002Fey\u002Ff8gveyi4ffhvkva0au_3liatglw.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n \u003Cbr\u002F\u003E\r\n Указанные цены прайсовые, безусловно при таком объеме возможно скидка, но в отличии от GLP прайсов Cisco или Lenovo, забудьте о скидке в 50 или 70%. По опыту взаимодействия с MS свыше 5% увидеть сложно. Получается только за первый год стоимость владения составит больше 5 миллионов рублей, в рамках 3 лет стоимость владения составит ~ 9 млн. руб. Цифра не малая, а для компании среднего размера скажу, что огромная. Получается, что с экономической точки зрения решение уже е кажется таким уж не простым. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЗабегая вперед скажу, что после калькуляции решения указанного проекта руководство приняло положительное решение при его утверждении. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EИтог:\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n В итоге связка ПО оказалась следующая: Гирепвизор Citrix Hypervisor, гостевые ОС Linux, всем управляет Citrix Virtual Desktops. Экономия 3 млн. руб. в год существенна. Легко ли было реализовать этот проект? Нет! Панацея ли это для такого решения? Нет! Но однозначно имеет место быть для детального рассмотрения возможности внедрения на базе Citrix VDI с Linux гостевыми системами. Минусы конечно есть и не малые, более детально о них я расскажу во второй части, которая будет полный step-by-step описанного решения.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ заключении хочу сказать, я не претендую на заключение в конечной инстанции, но сам по себе кейс, задача были очень интересный. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ci\u003EСпасибо за уделенное внимание, до скорой встречи)\u003C\u002Fi\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"citrix"},{"titleHtml":"xenserver"},{"titleHtml":"xendesktop"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F451520\u002F668d3a6d0f86e50bb2a37248f6932cc5\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F451520\u002F668d3a6d0f86e50bb2a37248f6932cc5\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F451520\\\u002F\"},\"headline\":\"VDI: Дешево и сердито\",\"datePublished\":\"2019-05-29T13:05:46+03:00\",\"dateModified\":\"2019-06-05T20:19:53+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Андрей Пономарёв\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Добрый день уважаемы Хабровчане, друзья и знакомые. В качестве предисловия хочу рассказать о реализации одного интересного проекта или как сейчас модно выражат...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F451520\\\u002F#post-content-body\",\"about\":[\"h_sys_admin\",\"h_virtualization\",\"h_s_admin\",\"f_admin\"],\"image\":[\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fwi\\\u002Fkx\\\u002Ffo\\\u002Fwikxfomu1gaefx-0flncqjauk5o.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fmh\\\u002F0x\\\u002F2e\\\u002Fmh0x2e7i7tobz-us6jmjyxgyw3e.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F5f\\\u002Fbo\\\u002F4k\\\u002F5fbo4kvywhqjqd-f3ytkdggr2ny.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Ff8\\\u002Fgv\\\u002Fey\\\u002Ff8gveyi4ffhvkva0au_3liatglw.png\"]}","metaDescription":"Добрый день уважаемы Хабровчане, друзья и знакомые. В качестве предисловия хочу рассказать о реализации одного интересного проекта или как сейчас модно выражаться, одного интересного кейса касаемо...","mainImageUrl":null,"amp":true},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":"sys_admin,virtualization,s_admin"},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
