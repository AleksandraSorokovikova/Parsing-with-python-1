<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>In-App Updates Flexible Flow: Speed Up the App Update Process on Android / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/en\/company\/vk\/blog\/452082\/"},"headline":"In-App Updates Flexible Flow: Speed Up the App Update Process on Android","datePublished":"2019-05-16T12:53:11+03:00","dateModified":"2019-05-19T16:10:32+03:00","author":{"@type":"Person","name":"Sergey Smetanin"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"With a variety of new tools and features announced at Android Dev Summit, special attention should be given to the In-App Updates (IAUs) API allowing...","url":"https:\/\/habr.com\/en\/company\/vk\/blog\/452082\/#post-content-body","about":["c_vk","h_programming","h_mobile_dev","h_android_dev","f_develop"],"image":["https:\/\/habrastorage.org\/webt\/eh\/m3\/uh\/ehm3uhc2o6emd7lwzh3hu1e76ck.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/1f8\/067\/c9f\/1f8067c9ffa01e7a0a9b9a6631beabe3.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/026\/409\/ac2\/026409ac2b2b1c7df62614ee1576ff64.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/3e6\/281\/d67\/3e6281d67cb24f8f9018861697c62230.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/535\/1cb\/3a9\/5351cb3a9b15cd49e59d543463cbb283.jpg"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="In-App Updates Flexible Flow: Speed Up the App Update Process on Android" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="In-App Updates Flexible Flow: Speed Up the App Update Process on Android" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="In-App Updates Flexible Flow: Speed Up the App Update Process on Android" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="With a variety of new tools and features announced at Android Dev Summit, special attention should be given to the In-App Updates (IAUs) API allowing developers to increase the speed of delivering..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="With a variety of new tools and features announced at Android Dev Summit, special attention should be given to the In-App Updates (IAUs) API allowing developers to increase the speed of delivering..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="With a variety of new tools and features announced at Android Dev Summit, special attention should be given to the In-App Updates (IAUs) API allowing developers to increase the speed of delivering..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="With a variety of new tools and features announced at Android Dev Summit, special attention should be given to the In-App Updates (IAUs) API allowing developers to increase the speed of delivering..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="With a variety of new tools and features announced at Android Dev Summit, special attention should be given to the In-App Updates (IAUs) API allowing developers to increase the speed of delivering..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/452082/eb938b63a4e55c782bb0dfbf40e5f35b/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/452082/eb938b63a4e55c782bb0dfbf40e5f35b/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/452082/eb938b63a4e55c782bb0dfbf40e5f35b/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/452082/eb938b63a4e55c782bb0dfbf40e5f35b/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/452082/eb938b63a4e55c782bb0dfbf40e5f35b/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="452082" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2019-05-16T09:53:11.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="en_US" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/452082/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/en/company/vk/blog/452082/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/452082/eb938b63a4e55c782bb0dfbf40e5f35b/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" companyName="vk" data-async-called="true" class="tm-page"><div class="tm-page-width"><div class="tm-page__header"><div class="tm-company-card__branding tm-company-article__branding tm-company-card__branding_loading"><div class="tm-company-card__branding-placeholder"><!----></div> <a href="https://vk.com/vkteam"><img src="//habrastorage.org/getpro/habr/branding/174/2c4/3a5/1742c43a5b504987a0fadf577a0bd4de.png" width="100%" class="tm-company-card__branding-image"></a></div></div> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"><div class="tm-company-card tm-company-article__company-card"><div class="tm-company-card__info"><div class="tm-company-card__header"><a href="/ru/company/vk/profile/" class="tm-company-card__avatar"><div class="tm-entity-image"><img alt="" height="48" src="//habrastorage.org/getpro/habr/company/9ed/c74/6b4/9edc746b484c805ecad1f941b5f7068a.png" width="48" class="tm-entity-image__pic"></div></a> <a href="https://career.habr.com/companies/vk" rel="noopener" target="_blank" class="tm-grade tm-company-card__rating"><div class="tm-rating"><div class="tm-rating__header"><svg height="24" width="24" class="tm-svg-img tm-svg-grade__icon"><title>Оценка компании на Хабр Карьере</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#grade"></use></svg> <div class="tm-rating__counter tm-rating__counter_variant-grade">4.37</div></div> <div class="tm-rating__text tm-rating__text_variant-grade">
    Оценка
  </div></div></a> <div class="tm-rating tm-company-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">331.85</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div> <div class="tm-company-card__info"><a href="/ru/company/vk/profile/" class="tm-company-card__name">
        VK
      </a> <div class="tm-company-card__description">Технологии, которые объединяют</div></div></div> <div class="tm-company-card__buttons"><!----> <!----></div></div> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/sismetanin/" title="sismetanin" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" loading="lazy" src="//habrastorage.org/r/w32/getpro/habr/avatars/5b5/840/ccc/5b5840ccc0a1ba311d1346b8173b5507.jpg" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/sismetanin/" class="tm-user-info__username">
      sismetanin
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2019-05-16T09:53:11.000Z" title="2019-05-16, 12:53">16  мая  2019 в 12:53</time></span></div> <!----></div> <h1 lang="en" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>In-App Updates Flexible Flow: Speed Up the App Update Process on Android</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/company/vk/blog/" class="tm-article-snippet__hubs-item-link router-link-active"><span>Блог компании VK</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/programming/" class="tm-article-snippet__hubs-item-link"><span>Программирование</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/mobile_dev/" class="tm-article-snippet__hubs-item-link"><span>Разработка мобильных приложений</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/android_dev/" class="tm-article-snippet__hubs-item-link"><span>Разработка под Android</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <!----> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="en" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml"><img src="/img/image-loader.svg" data-src="https://habrastorage.org/webt/eh/m3/uh/ehm3uhc2o6emd7lwzh3hu1e76ck.png"/><br/>
<br/>
With a variety of new tools and features announced at <a href="https://android-developers.googleblog.com/2018/11/unfolding-right-now-at-androiddevsummit.html">Android Dev Summit</a>, special attention should be given to the In-App Updates (IAUs) API allowing developers to increase the speed of delivering features, bug-fixes and performance improvements to active users. Since this feature was finally <a href="https://android-developers.googleblog.com/2019/05/whats-new-in-play.html">released</a> after Google I/O 2019, in this article I’ll deep dive on IAUs API, describe in details recommended user flows and provide with some code samples. Moreover, I'll share some experience of IAUs integration in the <a href="https://play.google.com/store/apps/details?id=store.panda.client&amp;hl=en">Pandao</a> app, a marketplace platform for Chinese goods.<br/>
<a name="habracut"></a><br/>
The new API allows developers to initiate a new in-app update request flow in order to push active users to update the app. IAUs complements the existing Google Play auto-update mechanism, but, unfortunately, does not have any impact on intentions of some users to disable any kind of updates. IAUs request can be implemented in two ways, which provide the completely different user experience.<br/>
<br/>
<ol>
<li>The <b>flexible flow</b> prompts users to download an update in the background and install it at a convenient moment. It is supposed to be used in cases while it is still appropriate for a user to use the older version of the app while the new one was released.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/1f8/067/c9f/1f8067c9ffa01e7a0a9b9a6631beabe3.png"/><br/>
</li>
<li>The <b>immediate flow</b> requires users to download and install an update before continue using the app. It is supposed to be used in cases while it is crucial for developers to prevent usage of the app before the update is applied.<br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/026/409/ac2/026409ac2b2b1c7df62614ee1576ff64.png"/><br/>
</li>
</ol><br/>
Since the latter use case is less important and appropriate for the Pandao app, we will discuss in detail the former. <br/>
<br/>
<h1>IAUs Flexible Flow Integration</h1><br/>
<h3>Use Case</h3><br/>
The flexible IAUs flow consists of the following steps.<br/>
<br/>
<ol>
<li>The app requests Google Play to check for available updates using Play Core Library.<br/>
</li>
<li>If there is an available update, the app requests Google Play to show the IAUs dialogue. Google Play shows the update request dialogue to the user.<br/>
</li>
<li>If the user accepts update request, Google Play downloads an update in the background, providing the user with graceful state monitoring at the status bar.<br/>
</li>
<li>If the process of downloading completes while the app is in the background, Google Play automatically completes the installation. For cases when the download completes while the app is in the foreground, we have to define custom logic for the update completion. Consider several best-practices for the implementation.<br/>
<br/>
<ol>
<li>The app launches the installation process while displaying a Google Play screen with the installation progress to the user. After the installation is complete, the app restarts and an updated version opens. In this case, it is recommended to display an additional dialogue to allow the user to confirm explicitly that he or she is ready to relaunch app right now. <b>This is a highly-recommended flow</b>.<br/>
</li>
<li>The app waits until it goes to the background and then completes the update silently. One the one hand, this option is less invasive in terms of user experience. But on the other hand, it requires the developer to implement a tricky feature for detecting whenever the app goes to the background.<br/>
</li>
</ol></li>
</ol><br/>
In exceptional situations, the completion of the update will be deferred automatically to the Google Play background task. This option is not recommended for the explicit use because it doesn’t provide any guarantees about the installation of an update.<br/>
<br/>
<h3>Basic Requirements for Manual Testing</h3><br/>
In order to manually perform the full update flow on the test device, you should have at least two versions of the app with the different version number: a source version and a target version. <br/>
<br/>
<ul>
<li>The source version with the higher version number should be published at Google Play, this is the version which will be identified by Google Play as an available update. The target version with the lower version number and integrated IAUs feature should be installed on your device, this is the version which will be updated. The thing is, when the app requests Google Play to check for available updates, it compares the version number of the installed app with the version number of the last available build in Google Play. So the IAUs feature will be triggered only in case if the version number in Google Play is higher than actual version of the app on the device.<br/>
</li>
<li>Both the source and the target versions need to have the <b>same package name</b> and should be signed with the <b>same release certificate</b>. <br/>
</li>
<li>Android 5.0 (API level 21) or higher.<br/>
</li>
<li><a href="https://developer.android.com/guide/app-bundle/playcore#include_playcore">Play Core</a> library 1.5.0 or higher.<br/>
</li>
</ul><br/>
<h2>Sample Code </h2><br/>
This section contains some sample code for IAUs usage, which is also can be found in <a href="https://developer.android.com/guide/app-bundle/in-app-updates">the official documentation</a>. To begin with, it’s necessary to add Play Core library to the module-level gradle file.<br/>
<br/>
<pre><code class="plaintext">dependencies {
   ...
   implementation "com.google.android.play:core:1.5.0"
}</code></pre><br/>
Next, let’s create an instance of the IAUs manager and add callbacks to <code>AppUpdateInfo</code> task. The result of this task contains information about an update availability, an intent to start an update if it is available, and the current progress of the update download if it has already started.<br/>
<br/>
<pre><code class="cpp">// Create instance of the IAUs manager.
val appUpdateManager = AppUpdateManagerFactory.create(context)

// Add state listener to app update info task.
appUpdateManager.appUpdateInfo.addOnSuccessListener { appUpdateInfo ->
    // If there is an update available, prepare to promote it.
    if (appUpdateInfo.updateAvailability() == UpdateAvailability.UPDATE_AVAILABLE) {
        // ...
    }

    // If the process of downloading is finished, start the completion flow.
    if (appUpdateInfo.installStatus() == InstallStatus.DOWNLOADED) {
        // ...
    }
}
    .addOnFailureListener { e ->
        // Handle the error.
    }</code></pre><br/>
In terms of how to trigger the update request dialogue from Google Play in code, you receive a <code>PendingIntent</code> in the <code>AppUpdateInfo</code> object, which you can start with <code>startIntentSenderForResult</code>. This dialogue requests the user to start the update.<br/>
 <br/>
<pre><code class="kotlin">   appUpdateManager.startUpdateFlowForResult(
          // Pass the intent that is returned by 'getAppUpdateInfo()'.
           appUpdateInfo,
           // Or 'AppUpdateType.IMMEDIATE for immediate updates.
           AppUpdateType.FLEXIBLE,
          // The current activity.
           activity,
           REQUEST_CODE
   )</code></pre><br/>
To monitor the update state, you can add <code>InstallStateUpdatedListener </code>to the IAUs manager. Please make sure your <code>InstallStateUpdatedListener</code> is lifecycle-aware.<br/>
<br/>
<pre><code class="kotlin">// Create a listener to track downloading state updates.
val listener = InstallStateUpdatedListener { state -> 
    // Update progress indicator, request user to approve app reload, etc.
}

// At some point before starting an update, register a listener for updates.
appUpdateManager.registerListener(listener)

// ...

// At some point when status updates are no longer needed, unregister the listener.
appUpdateManager.unregisterListener(listener)</code></pre><br/>
As soon as the update is downloaded (<code>DOWNLOADED</code> status), the app should be restarted in order to complete the update. It can be easily initiated by calling <code>appUpdateManager.completeUpdate()</code>, but it’s recommended to display a snackbar to allow the user to confirm explicitly that he or she is ready to relaunch app right now. <br/>
<br/>
<pre><code class="kotlin">Snackbar.make(
    rootView,
    "An update has just been downloaded from Google Play",
    Snackbar.LENGTH_INDEFINITE
).apply {
    setAction("RELOAD") { appUpdateManager.completeUpdate() }
    show()
}</code></pre><br/>
<h3>«Update is Not Available» Error</h3><br/>
First of all, please double check requirements mentioned in «Basic Implementation Requirements» section. If you successfully complete above listed steps in compliance with all requirements, though the update, according to the <code>onSuccess</code> callback, still is not available, please pay attention to the following trick. The most likely reason is that the Google Play app does not know about the update yet due to the internal caching mechanism. To make sure you have the cache fresh when testing manually you can refresh the cached version by going to the «My Apps &amp; Games» screen in the Google Play app. As an alternative, you can simply clear the cache of the Google Play app in the settings. Note that this is just an issue for testing and does not affect end users since the cache is updated daily anyway.<br/>
<br/>
<h1>IAUs Flexible Flow in Pandao</h1><br/>
As a part of early access program, we integrated IAUs flexible flow (recommended implemetation) in Pandao app, that is, a marketplace app offering products from Chinese manufacturers and vendors. The IAUs dialogue was shown at the main screen, so the maximum number of users were able to interact with it. Initially, we decided to show IAUs dialogue not more than once a day in order to avoid risk users being annoyed.<br/>
<br/>
Since A/B testing is a pivotal step in every new feature lifecycle, we decided to evaluate the effect of IAUs on the Pandao app. We randomly divided our users into two non-overlapping groups. The first one is a control group without IAUs functional representing the ‘no-change’ baseline, and the second one is a test group with IAUs dialogue. <br/>
<br/>
<img src="/img/image-loader.svg" data-src="https://habrastorage.org/getpro/habr/post_images/3e6/281/d67/3e6281d67cb24f8f9018861697c62230.png"/><br/>
<i>Fig. 1. A/B testing for IAUs (flexible flow) in Pandao App.</i><br/>
<br/>
Over the past few releases, we measured the percentage of active users for each app version. It was found that among active users with the last available at a time version the major part was from group B, i.e. users with IAUS feature. As you can see from purple lines at fig. 1, in the first days after the publication of 1.29.1 app version, the number of active users with IAUs feature exceeded the number of users without this feature. The opposite situation can be observed for the previous versions of the app, see blue and red lines after the publication of 1.29.1 app version. Therefore, it can be stated that users with IAUs tend to update the app version more quickly. <br/>
<br/>
<img src="https://habrastorage.org/r/w780q1/getpro/habr/post_images/535/1cb/3a9/5351cb3a9b15cd49e59d543463cbb283.jpg" data-src="https://habrastorage.org/getpro/habr/post_images/535/1cb/3a9/5351cb3a9b15cd49e59d543463cbb283.jpg" data-blurred="true"/><br/>
<i>Fig. 2. Confirmation rate at IAUs dialogue (flexible flow) in Pandao App</i>.<br/>
<br/>
According to Pandao analytics data (see fig. 2), conversion to click on the confirmation button at IAUs dialogue reaches peak values at the first days of the release and then constantly decreases until the next app update. The same pattern can be observed in conversion to click on the install button at a snackbar, which initiates installation of the downloaded update. Consequently, it seems like the average conversion rate in both cases directly proportional to the frequency of releases. In Pandao, the average conversion rate measured during one month exceeds 35% for click on the confirmation button and 7% for click on the install button.<br/>
<br/>
We suggested that reducing of confirmation rate over time is just a user experience problem, because people that are interested in the new app version are going to update pretty quickly, and those that are not interested in updating will continue to not be interested. Based on this information we decided backing off some users if they are not interested in updating, rather than asking them every day. It seems to be a good practice trying different request logic based on 'staleness', i.e. how old the version they are on is, how many times a user has already asked them for an update and so on, rather than risk users being annoyed.<br/>
<br/>
As a result, IAUs demonstrated valuable results during A/B test, so we rolled out this feature for all users.<br/>
<br/>
<h1>Acknowledgments</h1><br/>
I want to thank various colleagues for their contribution to this article. Thanks to Maryna Pliashkova <a href="https://habr.com/ru/users/maryna_pliashkova/" class="user_link">Maryna_Pliashkova</a>, Alexander Chernyy <a href="https://habr.com/ru/users/alexchernyy/" class="user_link">alexchernyy</a>, Ilia Nazarov <a href="https://habr.com/ru/users/rolarko/" class="user_link">RolaRko</a>, Gleb Bodyachevskiy, Daniil Polozov <a href="https://habr.com/ru/users/jokerdab/" class="user_link">jokerdab</a>, Anastasia Kulik, Vladislav Breus and Vladislav Goldin <a href="https://habr.com/ru/users/vladiskus/" class="user_link">Vladiskus</a>.</div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bandroid%20development%5D" class="tm-tags-list__link">android development</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bgoogle%20play%5D" class="tm-tags-list__link">google play</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bmobile%20development%5D" class="tm-tags-list__link">mobile development</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/company/vk/blog/" class="tm-hubs-list__link router-link-active">
    Блог компании VK
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/programming/" class="tm-hubs-list__link">
    Программирование
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/mobile_dev/" class="tm-hubs-list__link">
    Разработка мобильных приложений
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/android_dev/" class="tm-hubs-list__link">
    Разработка под Android
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 25: ↑25 и ↓0</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 25: ↑25 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+25</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">5.5K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    1
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"><div class="tm-article-author__company"><div class="tm-article-author__company-card"><div class="tm-company-snippet"><a href="/ru/company/vk/profile/" class="tm-company-snippet__logo-link"><div class="tm-entity-image"><img alt="" height="40" src="//habrastorage.org/getpro/habr/company/9ed/c74/6b4/9edc746b484c805ecad1f941b5f7068a.png" width="40" class="tm-entity-image__pic"></div></a> <div class="tm-company-snippet__info"><a href="/ru/company/vk/profile/" class="tm-company-snippet__title">VK</a> <div class="tm-company-snippet__description">Технологии, которые объединяют</div></div></div> <div class="tm-article-author__buttons"><!----> <!----></div></div> <div class="tm-article-author__company-contacts"><a href="https://facebook.com/insidevk" rel="noopener" target="_blank" class="tm-article-author__contact">
      Facebook
    </a><a href="https://twitter.com/inside_vk" rel="noopener" target="_blank" class="tm-article-author__contact">
      Twitter
    </a><a href="https://vk.com/insidevk" rel="noopener" target="_blank" class="tm-article-author__contact">
      ВКонтакте
    </a><a href="https://instagram.com/inside.vk" rel="noopener" target="_blank" class="tm-article-author__contact">
      Instagram
    </a><a href="https://telegram.me/inside_vk" rel="noopener" target="_blank" class="tm-article-author__contact">
      Telegram
    </a></div> <div class="tm-article-author__separator"></div></div> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/sismetanin/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/5b5/840/ccc/5b5840ccc0a1ba311d1346b8173b5507.jpg" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 39 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    37
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><span class="tm-user-card__name tm-user-card__name_variant-article">Sergey Smetanin</span> <a href="/ru/users/sismetanin/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @sismetanin
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">Software Engineer</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <div class="tm-article-author__user-contacts"><a href="https://facebook.com/sismetanin" rel="noopener" target="_blank" class="tm-article-author__contact">
      Facebook
    </a><a href="https://medium.com/@sismetanin" rel="noopener" target="_blank" class="tm-article-author__contact">
      Medium
    </a><a href="https://telegram.me/sismetanin" rel="noopener" target="_blank" class="tm-article-author__contact">
      Telegram
    </a></div></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/company/vk/blog/452082/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 2 
    </span></a> <!----></div></div></div>  <!---->  <!----> <!----></div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__placeholder_initial"></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <section class="tm-block tm-block_spacing-bottom"><header class="tm-block__header"><h2 class="tm-block__title">Информация</h2> <!----></header> <div class="tm-block__body"><div class="tm-company-basic-info"><dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Дата основания</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><time datetime="1998-10-14T20:00:00.000Z" title="1998-10-15, 00:00">15  октября  1998</time></dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Местоположение</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap">
    Россия
  </dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Сайт</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><a href="https://vk.com/vkteam" target="_blank" class="tm-company-basic-info__link">
      vk.com
    </a></dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Численность</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap">
    5 001–10 000 человек
  </dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Дата регистрации</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><time datetime="2008-08-09T07:42:32.000Z" title="2008-08-09, 11:42">9  августа  2008</time></dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Представитель</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><a href="/ru/users/somuchmich/" class="tm-company-basic-info__link">
      Миша Буданов
    </a></dd></dl></div></div> <!----></section> <div class="tm-company-widgets"></div> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/company/vk/blog/452082/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/company/vk/blog/452082/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"452082":{"id":"452082","timePublished":"2019-05-16T09:53:11+00:00","isCorporative":true,"lang":"en","titleHtml":"In-App Updates Flexible Flow: Speed Up the App Update Process on Android","leadData":{"textHtml":"\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Feh\u002Fm3\u002Fuh\u002Fehm3uhc2o6emd7lwzh3hu1e76ck.png\"\u003E\u003Cbr\u003E\r\n\u003Cbr\u003E\r\nWith a variety of new tools and features announced at \u003Ca href=\"https:\u002F\u002Fandroid-developers.googleblog.com\u002F2018\u002F11\u002Funfolding-right-now-at-androiddevsummit.html\"\u003EAndroid Dev Summit\u003C\u002Fa\u003E, special attention should be given to the In-App Updates (IAUs) API allowing developers to increase the speed of delivering features, bug-fixes and performance improvements to active users. Since this feature was finally \u003Ca href=\"https:\u002F\u002Fandroid-developers.googleblog.com\u002F2019\u002F05\u002Fwhats-new-in-play.html\"\u003Ereleased\u003C\u002Fa\u003E after Google I\u002FO 2019, in this article I’ll deep dive on IAUs API, describe in details recommended user flows and provide with some code samples. Moreover, I'll share some experience of IAUs integration in the \u003Ca href=\"https:\u002F\u002Fplay.google.com\u002Fstore\u002Fapps\u002Fdetails?id=store.panda.client&amp;hl=en\"\u003EPandao\u003C\u002Fa\u003E app, a marketplace platform for Chinese goods.\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Read more →","image":null},"editorVersion":"1.0","postType":"article","postLabels":[],"author":{"scoreStats":{"score":37,"votesCount":39},"rating":0,"relatedData":null,"contacts":[{"title":"Facebook","url":"https:\u002F\u002Ffacebook.com\u002Fsismetanin","value":"sismetanin"},{"title":"Medium","url":"https:\u002F\u002Fmedium.com\u002F@sismetanin","value":"sismetanin"},{"title":"Telegram","url":"https:\u002F\u002Ftelegram.me\u002Fsismetanin","value":"sismetanin"}],"authorContacts":[{"title":"Facebook","url":"https:\u002F\u002Ffacebook.com\u002Fsismetanin","value":"sismetanin"},{"title":"Medium","url":"https:\u002F\u002Fmedium.com\u002F@sismetanin","value":"sismetanin"},{"title":"Telegram","url":"https:\u002F\u002Ftelegram.me\u002Fsismetanin","value":"sismetanin"}],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"1306886","alias":"sismetanin","fullname":"Sergey Smetanin","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F5b5\u002F840\u002Fccc\u002F5b5840ccc0a1ba311d1346b8173b5507.jpg","speciality":"Software Engineer"},"statistics":{"commentsCount":2,"favoritesCount":1,"readingCount":5493,"score":25,"votesCount":25},"hubs":[{"relatedData":null,"id":"4992","alias":"vk","type":"corporative","title":"Блог компании VK","titleHtml":"Блог компании VK","isProfiled":false},{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"6345","alias":"mobile_dev","type":"collective","title":"Разработка мобильных приложений","titleHtml":"Разработка мобильных приложений","isProfiled":true},{"relatedData":null,"id":"17107","alias":"android_dev","type":"collective","title":"Разработка под Android","titleHtml":"Разработка под Android","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Feh\u002Fm3\u002Fuh\u002Fehm3uhc2o6emd7lwzh3hu1e76ck.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nWith a variety of new tools and features announced at \u003Ca href=\"https:\u002F\u002Fandroid-developers.googleblog.com\u002F2018\u002F11\u002Funfolding-right-now-at-androiddevsummit.html\"\u003EAndroid Dev Summit\u003C\u002Fa\u003E, special attention should be given to the In-App Updates (IAUs) API allowing developers to increase the speed of delivering features, bug-fixes and performance improvements to active users. Since this feature was finally \u003Ca href=\"https:\u002F\u002Fandroid-developers.googleblog.com\u002F2019\u002F05\u002Fwhats-new-in-play.html\"\u003Ereleased\u003C\u002Fa\u003E after Google I\u002FO 2019, in this article I’ll deep dive on IAUs API, describe in details recommended user flows and provide with some code samples. Moreover, I'll share some experience of IAUs integration in the \u003Ca href=\"https:\u002F\u002Fplay.google.com\u002Fstore\u002Fapps\u002Fdetails?id=store.panda.client&amp;hl=en\"\u003EPandao\u003C\u002Fa\u003E app, a marketplace platform for Chinese goods.\u003Cbr\u002F\u003E\r\n\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\nThe new API allows developers to initiate a new in-app update request flow in order to push active users to update the app. IAUs complements the existing Google Play auto-update mechanism, but, unfortunately, does not have any impact on intentions of some users to disable any kind of updates. IAUs request can be implemented in two ways, which provide the completely different user experience.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003EThe \u003Cb\u003Eflexible flow\u003C\u002Fb\u003E prompts users to download an update in the background and install it at a convenient moment. It is supposed to be used in cases while it is still appropriate for a user to use the older version of the app while the new one was released.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F1f8\u002F067\u002Fc9f\u002F1f8067c9ffa01e7a0a9b9a6631beabe3.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003Cli\u003EThe \u003Cb\u003Eimmediate flow\u003C\u002Fb\u003E requires users to download and install an update before continue using the app. It is supposed to be used in cases while it is crucial for developers to prevent usage of the app before the update is applied.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F026\u002F409\u002Fac2\u002F026409ac2b2b1c7df62614ee1576ff64.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\r\nSince the latter use case is less important and appropriate for the Pandao app, we will discuss in detail the former. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch1\u003EIAUs Flexible Flow Integration\u003C\u002Fh1\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EUse Case\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nThe flexible IAUs flow consists of the following steps.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003EThe app requests Google Play to check for available updates using Play Core Library.\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003Cli\u003EIf there is an available update, the app requests Google Play to show the IAUs dialogue. Google Play shows the update request dialogue to the user.\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003Cli\u003EIf the user accepts update request, Google Play downloads an update in the background, providing the user with graceful state monitoring at the status bar.\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003Cli\u003EIf the process of downloading completes while the app is in the background, Google Play automatically completes the installation. For cases when the download completes while the app is in the foreground, we have to define custom logic for the update completion. Consider several best-practices for the implementation.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003EThe app launches the installation process while displaying a Google Play screen with the installation progress to the user. After the installation is complete, the app restarts and an updated version opens. In this case, it is recommended to display an additional dialogue to allow the user to confirm explicitly that he or she is ready to relaunch app right now. \u003Cb\u003EThis is a highly-recommended flow\u003C\u002Fb\u003E.\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003Cli\u003EThe app waits until it goes to the background and then completes the update silently. One the one hand, this option is less invasive in terms of user experience. But on the other hand, it requires the developer to implement a tricky feature for detecting whenever the app goes to the background.\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\r\nIn exceptional situations, the completion of the update will be deferred automatically to the Google Play background task. This option is not recommended for the explicit use because it doesn’t provide any guarantees about the installation of an update.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EBasic Requirements for Manual Testing\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nIn order to manually perform the full update flow on the test device, you should have at least two versions of the app with the different version number: a source version and a target version. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003EThe source version with the higher version number should be published at Google Play, this is the version which will be identified by Google Play as an available update. The target version with the lower version number and integrated IAUs feature should be installed on your device, this is the version which will be updated. The thing is, when the app requests Google Play to check for available updates, it compares the version number of the installed app with the version number of the last available build in Google Play. So the IAUs feature will be triggered only in case if the version number in Google Play is higher than actual version of the app on the device.\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003Cli\u003EBoth the source and the target versions need to have the \u003Cb\u003Esame package name\u003C\u002Fb\u003E and should be signed with the \u003Cb\u003Esame release certificate\u003C\u002Fb\u003E. \u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003Cli\u003EAndroid 5.0 (API level 21) or higher.\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fdeveloper.android.com\u002Fguide\u002Fapp-bundle\u002Fplaycore#include_playcore\"\u003EPlay Core\u003C\u002Fa\u003E library 1.5.0 or higher.\u003Cbr\u002F\u003E\r\n\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2\u003ESample Code \u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nThis section contains some sample code for IAUs usage, which is also can be found in \u003Ca href=\"https:\u002F\u002Fdeveloper.android.com\u002Fguide\u002Fapp-bundle\u002Fin-app-updates\"\u003Ethe official documentation\u003C\u002Fa\u003E. To begin with, it’s necessary to add Play Core library to the module-level gradle file.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"plaintext\"\u003Edependencies {\n   ...\n   implementation \"com.google.android.play:core:1.5.0\"\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nNext, let’s create an instance of the IAUs manager and add callbacks to \u003Ccode\u003EAppUpdateInfo\u003C\u002Fcode\u003E task. The result of this task contains information about an update availability, an intent to start an update if it is available, and the current progress of the update download if it has already started.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"cpp\"\u003E\u002F\u002F Create instance of the IAUs manager.\nval appUpdateManager = AppUpdateManagerFactory.create(context)\n\n\u002F\u002F Add state listener to app update info task.\nappUpdateManager.appUpdateInfo.addOnSuccessListener { appUpdateInfo -\u003E\n    \u002F\u002F If there is an update available, prepare to promote it.\n    if (appUpdateInfo.updateAvailability() == UpdateAvailability.UPDATE_AVAILABLE) {\n        \u002F\u002F ...\n    }\n\n    \u002F\u002F If the process of downloading is finished, start the completion flow.\n    if (appUpdateInfo.installStatus() == InstallStatus.DOWNLOADED) {\n        \u002F\u002F ...\n    }\n}\n    .addOnFailureListener { e -\u003E\n        \u002F\u002F Handle the error.\n    }\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nIn terms of how to trigger the update request dialogue from Google Play in code, you receive a \u003Ccode\u003EPendingIntent\u003C\u002Fcode\u003E in the \u003Ccode\u003EAppUpdateInfo\u003C\u002Fcode\u003E object, which you can start with \u003Ccode\u003EstartIntentSenderForResult\u003C\u002Fcode\u003E. This dialogue requests the user to start the update.\u003Cbr\u002F\u003E\r\n \u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003E   appUpdateManager.startUpdateFlowForResult(\n          \u002F\u002F Pass the intent that is returned by 'getAppUpdateInfo()'.\n           appUpdateInfo,\n           \u002F\u002F Or 'AppUpdateType.IMMEDIATE for immediate updates.\n           AppUpdateType.FLEXIBLE,\n          \u002F\u002F The current activity.\n           activity,\n           REQUEST_CODE\n   )\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nTo monitor the update state, you can add \u003Ccode\u003EInstallStateUpdatedListener \u003C\u002Fcode\u003Eto the IAUs manager. Please make sure your \u003Ccode\u003EInstallStateUpdatedListener\u003C\u002Fcode\u003E is lifecycle-aware.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003E\u002F\u002F Create a listener to track downloading state updates.\nval listener = InstallStateUpdatedListener { state -\u003E \n    \u002F\u002F Update progress indicator, request user to approve app reload, etc.\n}\n\n\u002F\u002F At some point before starting an update, register a listener for updates.\nappUpdateManager.registerListener(listener)\n\n\u002F\u002F ...\n\n\u002F\u002F At some point when status updates are no longer needed, unregister the listener.\nappUpdateManager.unregisterListener(listener)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nAs soon as the update is downloaded (\u003Ccode\u003EDOWNLOADED\u003C\u002Fcode\u003E status), the app should be restarted in order to complete the update. It can be easily initiated by calling \u003Ccode\u003EappUpdateManager.completeUpdate()\u003C\u002Fcode\u003E, but it’s recommended to display a snackbar to allow the user to confirm explicitly that he or she is ready to relaunch app right now. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003ESnackbar.make(\n    rootView,\n    \"An update has just been downloaded from Google Play\",\n    Snackbar.LENGTH_INDEFINITE\n).apply {\n    setAction(\"RELOAD\") { appUpdateManager.completeUpdate() }\n    show()\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3\u003E«Update is Not Available» Error\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nFirst of all, please double check requirements mentioned in «Basic Implementation Requirements» section. If you successfully complete above listed steps in compliance with all requirements, though the update, according to the \u003Ccode\u003EonSuccess\u003C\u002Fcode\u003E callback, still is not available, please pay attention to the following trick. The most likely reason is that the Google Play app does not know about the update yet due to the internal caching mechanism. To make sure you have the cache fresh when testing manually you can refresh the cached version by going to the «My Apps &amp; Games» screen in the Google Play app. As an alternative, you can simply clear the cache of the Google Play app in the settings. Note that this is just an issue for testing and does not affect end users since the cache is updated daily anyway.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch1\u003EIAUs Flexible Flow in Pandao\u003C\u002Fh1\u003E\u003Cbr\u002F\u003E\r\nAs a part of early access program, we integrated IAUs flexible flow (recommended implemetation) in Pandao app, that is, a marketplace app offering products from Chinese manufacturers and vendors. The IAUs dialogue was shown at the main screen, so the maximum number of users were able to interact with it. Initially, we decided to show IAUs dialogue not more than once a day in order to avoid risk users being annoyed.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nSince A\u002FB testing is a pivotal step in every new feature lifecycle, we decided to evaluate the effect of IAUs on the Pandao app. We randomly divided our users into two non-overlapping groups. The first one is a control group without IAUs functional representing the ‘no-change’ baseline, and the second one is a test group with IAUs dialogue. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F3e6\u002F281\u002Fd67\u002F3e6281d67cb24f8f9018861697c62230.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Ci\u003EFig. 1. A\u002FB testing for IAUs (flexible flow) in Pandao App.\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nOver the past few releases, we measured the percentage of active users for each app version. It was found that among active users with the last available at a time version the major part was from group B, i.e. users with IAUS feature. As you can see from purple lines at fig. 1, in the first days after the publication of 1.29.1 app version, the number of active users with IAUs feature exceeded the number of users without this feature. The opposite situation can be observed for the previous versions of the app, see blue and red lines after the publication of 1.29.1 app version. Therefore, it can be stated that users with IAUs tend to update the app version more quickly. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fr\u002Fw780q1\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F535\u002F1cb\u002F3a9\u002F5351cb3a9b15cd49e59d543463cbb283.jpg\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F535\u002F1cb\u002F3a9\u002F5351cb3a9b15cd49e59d543463cbb283.jpg\" data-blurred=\"true\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Ci\u003EFig. 2. Confirmation rate at IAUs dialogue (flexible flow) in Pandao App\u003C\u002Fi\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nAccording to Pandao analytics data (see fig. 2), conversion to click on the confirmation button at IAUs dialogue reaches peak values at the first days of the release and then constantly decreases until the next app update. The same pattern can be observed in conversion to click on the install button at a snackbar, which initiates installation of the downloaded update. Consequently, it seems like the average conversion rate in both cases directly proportional to the frequency of releases. In Pandao, the average conversion rate measured during one month exceeds 35% for click on the confirmation button and 7% for click on the install button.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nWe suggested that reducing of confirmation rate over time is just a user experience problem, because people that are interested in the new app version are going to update pretty quickly, and those that are not interested in updating will continue to not be interested. Based on this information we decided backing off some users if they are not interested in updating, rather than asking them every day. It seems to be a good practice trying different request logic based on 'staleness', i.e. how old the version they are on is, how many times a user has already asked them for an update and so on, rather than risk users being annoyed.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nAs a result, IAUs demonstrated valuable results during A\u002FB test, so we rolled out this feature for all users.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch1\u003EAcknowledgments\u003C\u002Fh1\u003E\u003Cbr\u002F\u003E\r\nI want to thank various colleagues for their contribution to this article. Thanks to Maryna Pliashkova \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fusers\u002Fmaryna_pliashkova\u002F\" class=\"user_link\"\u003EMaryna_Pliashkova\u003C\u002Fa\u003E, Alexander Chernyy \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fusers\u002Falexchernyy\u002F\" class=\"user_link\"\u003Ealexchernyy\u003C\u002Fa\u003E, Ilia Nazarov \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fusers\u002Frolarko\u002F\" class=\"user_link\"\u003ERolaRko\u003C\u002Fa\u003E, Gleb Bodyachevskiy, Daniil Polozov \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fusers\u002Fjokerdab\u002F\" class=\"user_link\"\u003Ejokerdab\u003C\u002Fa\u003E, Anastasia Kulik, Vladislav Breus and Vladislav Goldin \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fusers\u002Fvladiskus\u002F\" class=\"user_link\"\u003EVladiskus\u003C\u002Fa\u003E.\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"android development"},{"titleHtml":"google play"},{"titleHtml":"mobile development"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F452082\u002Feb938b63a4e55c782bb0dfbf40e5f35b\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F452082\u002Feb938b63a4e55c782bb0dfbf40e5f35b\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fen\\\u002Fcompany\\\u002Fvk\\\u002Fblog\\\u002F452082\\\u002F\"},\"headline\":\"In-App Updates Flexible Flow: Speed Up the App Update Process on Android\",\"datePublished\":\"2019-05-16T12:53:11+03:00\",\"dateModified\":\"2019-05-19T16:10:32+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Sergey Smetanin\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"With a variety of new tools and features announced at Android Dev Summit, special attention should be given to the In-App Updates (IAUs) API allowing...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fen\\\u002Fcompany\\\u002Fvk\\\u002Fblog\\\u002F452082\\\u002F#post-content-body\",\"about\":[\"c_vk\",\"h_programming\",\"h_mobile_dev\",\"h_android_dev\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Feh\\\u002Fm3\\\u002Fuh\\\u002Fehm3uhc2o6emd7lwzh3hu1e76ck.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F1f8\\\u002F067\\\u002Fc9f\\\u002F1f8067c9ffa01e7a0a9b9a6631beabe3.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F026\\\u002F409\\\u002Fac2\\\u002F026409ac2b2b1c7df62614ee1576ff64.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F3e6\\\u002F281\\\u002Fd67\\\u002F3e6281d67cb24f8f9018861697c62230.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F535\\\u002F1cb\\\u002F3a9\\\u002F5351cb3a9b15cd49e59d543463cbb283.jpg\"]}","metaDescription":"With a variety of new tools and features announced at Android Dev Summit, special attention should be given to the In-App Updates (IAUs) API allowing developers to increase the speed of delivering...","mainImageUrl":null,"amp":false},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":""},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{"vk":{"alias":"vk","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002F9ed\u002Fc74\u002F6b4\u002F9edc746b484c805ecad1f941b5f7068a.png","titleHtml":"VK","descriptionHtml":"Технологии, которые объединяют","relatedData":null,"statistics":{"postsCount":2250,"newsCount":142,"vacanciesCount":24,"employeesCount":693,"careerRating":4.37,"subscribersCount":124428,"rating":331.85,"invest":null},"foundationDate":{"year":"1998","month":"10","day":"15"},"location":{"city":{"id":"447159","title":"Москва"},"region":{"id":"1885","title":"Москва и Московская обл."},"country":{"id":"168","title":"Россия"}},"siteUrl":"https:\u002F\u002Fvk.com\u002Fvkteam","staffNumber":"5 001–10 000 человек","registrationDate":"2008-08-09T07:42:32+00:00","representativeUser":{"alias":"somuchmich","fullname":"Миша Буданов"},"contacts":[{"title":"Facebook","url":"https:\u002F\u002Ffacebook.com\u002Finsidevk"},{"title":"Twitter","url":"https:\u002F\u002Ftwitter.com\u002Finside_vk"},{"title":"ВКонтакте","url":"https:\u002F\u002Fvk.com\u002Finsidevk"},{"title":"Instagram","url":"https:\u002F\u002Finstagram.com\u002Finside.vk"},{"title":"Telegram","url":"https:\u002F\u002Ftelegram.me\u002Finside_vk"}],"settings":{"analyticsSettings":[{"type":"ga","trackingId":"UA-16546458-6"}],"branding":{"imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fbranding\u002F174\u002F2c4\u002F3a5\u002F1742c43a5b504987a0fadf577a0bd4de.png","linkUrl":"https:\u002F\u002Fvk.com\u002Fvkteam","pixelUrl":""},"status":"active"},"metadata":{"titleHtml":"VK, Москва - Технологии, которые объединяют с 15 октября 1998 г.","title":"VK, Москва - Технологии, которые объединяют с 15 октября 1998 г.","keywords":["Программирование","DevOps","Kubernetes","Облачные вычисления","Tarantool"],"descriptionHtml":"2 250 статей от авторов компании VK","description":"2 250 статей от авторов компании VK"},"aDeskSettings":null,"careerAlias":"vk","maxCustomTrackerLinks":3}},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
