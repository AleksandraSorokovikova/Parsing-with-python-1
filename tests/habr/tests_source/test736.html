<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Глубины SIEM: экспертиза. Чьи правила корреляции лучше / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/company\/pt\/blog\/451680\/"},"headline":"Глубины SIEM: экспертиза. Чьи правила корреляции лучше","datePublished":"2019-05-14T10:07:08+03:00","dateModified":"2019-05-14T10:43:43+03:00","author":{"@type":"Person","name":"Николай Арефьев"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Многие из тех, кто сталкивался с SIEM, знакомы с разработкой правил корреляции. Производители SIEM-решений, коммерческие SOC, интеграторы &mdash; все предлагают свои п...","url":"https:\/\/habr.com\/ru\/company\/pt\/blog\/451680\/#post-content-body","about":["c_pt","h_infosecurity","h_analysis_design","f_develop"],"image":["https:\/\/habrastorage.org\/webt\/zt\/jn\/iu\/ztjniusqp16pega_pvwx1i2ohsq.png","https:\/\/habrastorage.org\/webt\/6f\/yi\/sa\/6fyisahpl8w4eeuy3eejoi2r7du.png"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Глубины SIEM: экспертиза. Чьи правила корреляции лучше" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Глубины SIEM: экспертиза. Чьи правила корреляции лучше" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Глубины SIEM: экспертиза. Чьи правила корреляции лучше" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Многие из тех, кто сталкивался с SIEM, знакомы с разработкой правил корреляции. Производители SIEM-решений, коммерческие SOC, интеграторы — все предлагают свои правила и утверждают, что они лучше..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Многие из тех, кто сталкивался с SIEM, знакомы с разработкой правил корреляции. Производители SIEM-решений, коммерческие SOC, интеграторы — все предлагают свои правила и утверждают, что они лучше..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Многие из тех, кто сталкивался с SIEM, знакомы с разработкой правил корреляции. Производители SIEM-решений, коммерческие SOC, интеграторы — все предлагают свои правила и утверждают, что они лучше..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Многие из тех, кто сталкивался с SIEM, знакомы с разработкой правил корреляции. Производители SIEM-решений, коммерческие SOC, интеграторы — все предлагают свои правила и утверждают, что они лучше..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Многие из тех, кто сталкивался с SIEM, знакомы с разработкой правил корреляции. Производители SIEM-решений, коммерческие SOC, интеграторы — все предлагают свои правила и утверждают, что они лучше..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/451680/ee029c6fa20ed0810c0767d30a18af6b/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/451680/ee029c6fa20ed0810c0767d30a18af6b/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/451680/ee029c6fa20ed0810c0767d30a18af6b/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/451680/ee029c6fa20ed0810c0767d30a18af6b/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/451680/ee029c6fa20ed0810c0767d30a18af6b/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="451680" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2019-05-14T07:07:08.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/451680/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/company/pt/blog/451680/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/451680/ee029c6fa20ed0810c0767d30a18af6b/" data-vmid="image:href"><link data-vue-meta="ssr" rel="amphtml" href="https://habr.com/ru/amp/post/451680/">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" companyName="pt" data-async-called="true" class="tm-page"><div class="tm-page-width"><div class="tm-page__header"><!----></div> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"><div class="tm-company-card tm-company-article__company-card"><div class="tm-company-card__info"><div class="tm-company-card__header"><a href="/ru/company/pt/profile/" class="tm-company-card__avatar"><div class="tm-entity-image"><img alt="" height="48" src="//habrastorage.org/getpro/habr/company/00b/f9c/27a/00bf9c27a7e0ab9d98f5f973a18d62fd.png" width="48" class="tm-entity-image__pic"></div></a> <!----> <div class="tm-rating tm-company-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">130.21</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div> <div class="tm-company-card__info"><a href="/ru/company/pt/profile/" class="tm-company-card__name">
        Positive Technologies
      </a> <div class="tm-company-card__description"></div></div></div> <div class="tm-company-card__buttons"><!----> <!----></div></div> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/nvnikolai/" title="nvnikolai" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt="" height="24" loading="lazy" src="//habrastorage.org/r/w32/getpro/habr/avatars/8c1/79e/5ab/8c179e5ab8040e102b839a62a1c83120.png" width="24" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user"><a href="/ru/users/nvnikolai/" class="tm-user-info__username">
      nvnikolai
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2019-05-14T07:07:08.000Z" title="2019-05-14, 10:07">14  мая  2019 в 10:07</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Глубины SIEM: экспертиза. Чьи правила корреляции лучше</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/company/pt/blog/" class="tm-article-snippet__hubs-item-link router-link-active"><span>Блог компании Positive Technologies</span> <!----></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/infosecurity/" class="tm-article-snippet__hubs-item-link"><span>Информационная безопасность</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/analysis_design/" class="tm-article-snippet__hubs-item-link"><span>Анализ и проектирование систем</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div> <!----> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml">Многие из тех, кто сталкивался с SIEM, знакомы с разработкой правил корреляции. Производители SIEM-решений, коммерческие SOC, интеграторы — все предлагают свои правила и утверждают, что они лучше других. Так ли это на самом деле? Как выбрать поставщика правил? Что такое экспертиза в SIEM? Поразмышляем на эти темы под катом.<br/>
<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" alt="Чьи правила корреляции лучше" data-src="https://habrastorage.org/webt/zt/jn/iu/ztjniusqp16pega_pvwx1i2ohsq.png"/></div><br/>
<a name="habracut"></a><br/>
Как всегда, в <a href="#Conclusions">выводе</a> собраны все ключевые тезисы статьи.<br/>
<br/>
Любой специалист по информационной безопасности рано или поздно начинает использовать SIEM-системы или какие-то отдельные элементы систем данного класса.<br/>
<br/>
Важной частью SIEM являются правила корреляции — знания, которые позволяют решить задачу выявления инцидентов информационной безопасности. Их можно разрабатывать самим, делегировать эти работы интегратору или, в случае подключения к коммерческому SOC, использовать знания их специалистов. Как видите, источников правил корреляций в SIEM много, поэтому закономерно встает вопрос выбора. Эта задача особенно актуальна, если в вашей компании нет выделенных специалистов под задачи SIEM. В таком случае вам или вашим коллегам приходится заниматься администрированием сразу нескольких средств защиты и дополнительно SIEM. <br/>
<br/>
Примерно через месяц после внедрения SIEM приходит понимание, что этот класс решений требует значительных трудозатрат. Искусство атак на информационные системы постоянно развивается. Нужно время на отслеживание современных трендов, их анализ, оценку применимости к своей инфраструктуре, а также на написание правил корреляции для выявления атак. Как правило, времени у специалистов на это не хватает. <br/>
<br/>
Столкнувшись с подобными проблемами, компании решают либо строить свой SOC и привлекать выделенных специалистов, либо найти внешних поставщиков правил корреляции. Дальше мы разберем, как выбрать поставщика и достаточно ли конечному заказчику только правил корреляции.<br/>
<a name="Expertise"></a><br/>
<h1>Экспертиза и ее свойства</h1><br/>
Под экспертизой мы будем понимать набор правил корреляции, знаний экспертов и данных, минимально необходимых для выявления и реагирования на инциденты. Экспертизу предоставляет поставщик (производитель SIEM-решения или SOC), а заказчик — ее потребитель. <br/>
<br/>
Правила корреляции могут поставлять разработчики SIEM-решений, MSSP-провайдеры/SOC, интеграторы и сообщество. Каждый постулирует, что их правила корреляции качественные. Правда, зачастую понятие качества подменяется просто количеством доступных правил. Является ли количество показателем качества? В общем случае — это спорное утверждение. Качественная экспертиза обладает следующими свойствами:<br/>
<br/>
<ol>
<li>Точно выявляет нарушения в конкретной инфраструктуре заказчика.</li>
<li>Выявляет актуальные угрозы мирового уровня. Выявляет угрозы, характерные для конкретной страны и отрасли заказчика.</li>
<li>Имеет как реактивную, так и проактивную составляющую.</li>
<li>Поясняет заказчику результаты своего логического вывода.</li>
<li>Предоставляет пояснения по дальнейшим шагам реагирования на выявленный инцидент.</li>
</ol><br/>
Часть из этих свойств налагает требования на разработчика экспертизы, а часть — на результат его работы — правила корреляции и сопутствующие материалы. <br/>
<a name="Developer"></a><br/>
<h2>Разработчик экспертизы и его компетенции</h2><br/>
На основании каких критериев выбрать поставщика? Мы сформулировали шесть основных свойств, которые характеризуют качественную экспертизу. Для их обеспечения поставщик правил должен:<br/>
<br/>
<ul>
<li><b>Выявлять актуальные угрозы мирового уровня</b>. Это могут быть поставщики, у которых есть собственные аналитические центры, специализирующиеся на выявлении и анализе атак. В них должен проводиться регулярный мониторинг новейших типов атак и подходов к нарушению информационной безопасности систем.</li>
<li><b>Выявлять угрозы, характерные для конкретной страны и отрасли заказчика</b>. В каждой стране ландшафт угроз и перечень типов атак может иметь свою специфику. Поэтому при выборе поставщика, важно, чтобы его аналитический центр имел четкий фокус на отслеживание угроз, присущих именно той стране, в которой располагается инфраструктура вашей компании. Специалисты центра должны не только понимать особенности угроз в определенной стране, но и уметь быстро реагировать на них. Не должно быть так, что поставщик реагирует на новую региональную угрозу через неделю после ее появления, только из-за того, что ваш регион не является для него приоритетным с точки зрения ведения бизнеса.</li>
<li><b>Иметь как реактивную, так и проактивную составляющую</b>. Недостаточно набрать в центр аналитиков из числа пентестеров. Важно, чтобы эти эксперты не только понимали и умели взламывать системы, но и знали, как можно выявить попытки взлома и предотвратить, или остановить их на ранних стадиях. Практика показывает, что этому аспекту мало уделяют внимания: часто аналитические центры строятся из экспертов либо только в области нападения, либо только в сфере защиты, что непременно сказывается на уровне выпускаемой ими экспертизы.</li>
<li><b>Точно выявлять нарушения в конкретной инфраструктуре заказчика</b>. Поставщик должен иметь методологию разработки правил корреляции, способных адаптироваться к конкретной инфраструктуре заказчика. Это нужно для того, чтобы минимизировать количество ложных срабатываний правил. Этому вопросу был посвящен большой цикл статей <a href="https://habr.com/ru/company/pt/blog/446212">«Правила корреляции, работающие из коробки»</a>. Важно помнить, что у поставщика должен быть выстроен процесс именно «промышленной разработки» правил корреляции. Из этого следует, что:<br/>
 <ul>
<li>правила должны тестироваться на «живых», а не синтетических системах;</li>
<li>в процессе тестирования должны вживую воспроизводиться те типы атак, на выявление которых направлено тестируемое правило корреляции;</li>
<li>должны проводиться нагрузочные и регрессионные тесты, подтверждающие совместимость правил с SIEM;</li>
<li>поставщик должен выпускать обновления для ранее выпущенных правил, если выясняется, что правила имеют большое число ложных срабатываний;</li>
<li>сам SIEM и поставщик должны иметь каналы оперативной доставки обновлений и новых правил корреляции до конечных заказчиков.</li>
</ul></li>
</ul><br/>
Набор требований достаточно широкий. К сожалению, если выделить для разработки правил корреляции одного специалиста, который будет тратить на эту активность 2 часа в день, это не позволит добиться той самой качественной экспертизы. <br/>
<br/>
<h2>Правила корреляции и их окружение</h2><br/>
Посмотрим теперь на сами правила корреляции глазами заказчика. Он хочет получить от поставщика качественные правила и без проблем активировать их в своем SIEM. На деле не все так просто. <br/>
<br/>
Для работы правил нужно подключить к SIEM требуемые источники. Они должны быть настроены так, чтобы генерировать необходимые для правил события. Смотря на само правило, важно, чтобы из него была понятна логика его работы. Помимо этого, заказчику необходимо понимать, как реагировать в случае, если правило срабатывает.<br/>
<br/>
Одних лишь правил корреляций недостаточно, чтобы называться экспертизой. Экспертиза — это правила корреляции вместе с дополнительным окружением, все элементы которого связаны между собой и могут быть выстроены в замкнутую цепь — так называемую экспертизу замкнутого цикла.<br/>
<br/>
<img src="/img/image-loader.svg" alt="Экспертиза замкнутого цикла" data-src="https://habrastorage.org/webt/6f/yi/sa/6fyisahpl8w4eeuy3eejoi2r7du.png"/><br/>
<i>Экспертиза замкнутого цикла</i><br/>
<br/>
Рассмотрим каждое звено этой цепи:<br/>
<br/>
<ol>
<li><b>Поставщик/производитель SIEM</b>. Экспертиза начинается с того, что поставщик, обладающий соответствующими <a href="#Developer">компетенциями</a>, разрабатывает правила корреляции, согласно технологическому процессу.</li>
<li><b>Список и настройки источников</b>. Разработанные правила корреляции снабжаются описанием тех источников, на основе которых работает правило корреляции. Также поставщик подробно описывает, каким образом должен быть настроен источник, чтобы он обеспечивал генерацию требуемых типов событий. Хорошим тоном будет, если поставщик представит экземпляр самих событий.</li>
<li><b>Описание логики правила</b>. Для того чтобы заказчик понимал, какие принципы срабатывания заложены в правила корреляции, поставщик описывает логику каждого правила в виде блок-схем или текстового описания.</li>
<li><b>Правила корреляции</b>. Непосредственно сами правила корреляции и методика приоритизации порожденных ими инцидентов.</li>
<li><b>Планы реагирования</b>. Срабатывания правила корреляции может являться инцидентом информационной безопасности. Заказчику важно понимать, как нужно реагировать на данный инцидент с целью минимизации его влияния на инфраструктуру. Также в план должны быть включены пояснения, какие данные необходимо дополнительно собрать, в случае появления инцидента. Бесспорно, заказчик должен адаптировать правила реагирования под специфику своей компании. Однако в рамках планов реагирования поставщик должен отразить обобщенные рекомендации по действиям пользователя при инциденте, вызванном конкретным правилом. Так заказчику будет от чего оттолкнуться, адаптируя под себя общий процесс реагирования.</li>
<li><b>Телеметрия</b>. Правила корреляции работают не в сферическом вакууме, а в конкретных условиях компании заказчика. Поставщик отвечает за качество предоставляемых правил и должен понимать, как они работают. Таким образом в SIEM должна собираться статистика по работе правил.</li>
<li><b>Поставщик/производитель SIEM</b>. Собранная телеметрия в обезличенном виде должна поступать обратно поставщику. Статистика помогает ему оперативно вносить изменения в правила, в случае их ложных срабатываний. Также она позволяет выявлять новые техники и тактики атак и оперативно выпускать новые правила корреляции для их детектирования.</li>
</ol><br/>
Набор требований к поставщику, а также все вышеописанные звенья цепи, по совокупности называются экспертизой. Как можно заметить, цепочка замкнута, поэтому данный подход обозначен как «экспертиза замкнутого цикла».<br/>
<br/>
На данный момент этот подход используют основные зарубежные лидеры SIEM-рынка: IBM QRadar, Micro focus ArcSight. В России он применяется в нашей компании Positive Technologies в продукте MaxPatrol SIEM. В рамках сообщества развивается интересный вендоронезависимый проект — <a href="https://github.com/krakow2600/atomic-threat-coverage">Atomic Threat Coverage</a>, продвигающий схожую идеологию. Далее приведу его описание, взятое со страницы проекта.<br/>
<br/>
<blockquote>Atomic Threat Coverage позволяет автоматически сгенерировать базу аналитических данных, предназначенную для противодействия угрозам, описанным в <a href="https://attack.mitre.org/">MITRE ATT&amp;CK</a> с позиций Обнаружения, Реагирования, Предотвращения и Имитации угроз. Он включает в себя:<br/>
<br/>
<ol>
<li><b>Detection Rules</b> — Правила Обнаружения (корреляции), основанные на <a href="https://github.com/Neo23x0/sigma">Sigma</a> — общем формате описания правил корреляции для SIEM систем.</li>
<li><b>Data Needed</b> — данные, которые необходимо собирать для обнаружения конкретной угрозы.</li>
<li><b>Logging Policies</b> — настройки логирования, которые необходимо произвести на устройстве для сбора данных, необходимых для обнаружения конкретной угрозы.</li>
<li><b>Enrichments</b> — настройки обогащения данных (Data Needed), необходимые для реализации некоторых Правил Обнаружения (Detection Rules).</li>
<li><b>Triggers</b> — сценарии имитации атак, основанные на <a href="https://atomicredteam.io">Atomic Red Team</a> — атомарных тестах/сценариях реализации угроз из MITRE ATT&amp;CK.</li>
<li><b>Response Actions</b> — атомарные шаги реагирования на инциденты.</li>
<li><b>Response Playbooks</b> — сценарии реагирования на инциденты, сгенерированные в ходе обнаружения конкретной угрозы, составленные на основе Response Actions.</li>
<li><b>Hardening Policies</b> — настройки систем, которые позволяют нивелировать конкретную угрозу.</li>
<li><b>Mitigation Systems</b> — системы и технологии, которые позволяют нивелировать конкретную угрозу.</li>
</ol><br/>
</blockquote> <br/>
Отдельно отмечу момент, который часто выпадает из поля зрения заказчиков и поставщиков. Иногда случаются сложные инциденты, которые невозможно распутать силами специалистов заказчика. Поставщик не должен оставлять заказчика один на один с его проблемой: «Мы поставляем вам правила, они работают, остальное — не наши проблемы». На мой взгляд, серьезные поставщики экспертизы должны иметь в своем портфеле услуги расследования инцидентов, которыми заказчик может воспользоваться в любое время 24/7 в случае возникновения критической ситуации.<br/>
<a name="Conclusions"></a><br/>
<h1>Выводы</h1><br/>
Подытожим:<br/>
<br/>
<ol>
<li>Заказчик, купивший SIEM, часто не имеет возможности выделить отдельных специалистов для работы с решением 100% рабочего времени. В таком случае SIEM через некоторое время перестает использоваться.</li>
<li>Одних правил корреляции недостаточно для того, чтобы обеспечивать выявление актуальных угроз безопасности. В связи с этим одни лишь правила корреляции не могут называться экспертизой. Экспертиза — набор правил корреляции, знаний экспертов и данных, минимально необходимых для выявления и реагирования на инциденты.</li>
<li>Экспертиза должна обладать следующими <a href="#Expertise">свойствами</a>:<br/>
 <ul>
<li>точно выявляет нарушения в конкретной инфраструктуре заказчика;</li>
<li>выявляет актуальные угрозы мирового уровня, а также характерные для конкретной страны и отрасли заказчика;</li>
<li>имеет как реактивную, так и проактивную составляющую;</li>
<li>поясняет заказчику результаты своего логического вывода;</li>
<li>предоставляет пояснения по дальнейшим шагам реагирования на выявленный инцидент.</li>
</ul></li>
<li>Недостаточно поставлять готовые Sigma-правила, чтобы считаться поставщиком экспертизы. Поставщик экспертизы должен удовлетворять ряду <a href="#Developer">требований</a>.</li>
<li>Поставляемая экспертиза состоит из следующих взаимосвязанных элементов:<br/>
 <ul>
<li>списка и настройки источников;</li>
<li>описания логики правила;</li>
<li>правила корреляции;</li>
<li>планов реагирования;</li>
<li>телеметрии по срабатыванию правил.</li>
</ul></li>
<li>Поставщики экспертизы должны иметь в своем портфеле услуги расследования, которыми заказчик может воспользоваться в случае, если у него не хватает собственных компетенций для анализа сложного инцидента.</li>
</ol></div></div> <!----> <!----></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bsiem%5D" class="tm-tags-list__link">siem</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BA%D0%BE%D1%80%D1%80%D0%B5%D0%BB%D1%8F%D1%86%D0%B8%D1%8F%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85%5D" class="tm-tags-list__link">корреляция данных</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BD%D0%BE%D1%80%D0%BC%D0%B0%D0%BB%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85%5D" class="tm-tags-list__link">нормализация данных</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%BD%D0%B0%D1%8F%20%D0%B1%D0%B5%D0%B7%D0%BE%D0%BF%D0%B0%D1%81%D0%BD%D0%BE%D1%81%D1%82%D1%8C%5D" class="tm-tags-list__link">информационная безопасность</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B8%D0%B1%5D" class="tm-tags-list__link">иб</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bsigma%5D" class="tm-tags-list__link">sigma</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Battck%5D" class="tm-tags-list__link">attck</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/company/pt/blog/" class="tm-hubs-list__link router-link-active">
    Блог компании Positive Technologies
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/infosecurity/" class="tm-hubs-list__link">
    Информационная безопасность
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/analysis_design/" class="tm-hubs-list__link">
    Анализ и проектирование систем
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 4: ↑4 и ↓0</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 4: ↑4 и ↓0" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+4</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">3K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    12
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"><div class="tm-article-author__company"><div class="tm-article-author__company-card"><div class="tm-company-snippet"><a href="/ru/company/pt/profile/" class="tm-company-snippet__logo-link"><div class="tm-entity-image"><img alt="" height="40" src="//habrastorage.org/getpro/habr/company/00b/f9c/27a/00bf9c27a7e0ab9d98f5f973a18d62fd.png" width="40" class="tm-entity-image__pic"></div></a> <div class="tm-company-snippet__info"><a href="/ru/company/pt/profile/" class="tm-company-snippet__title">Positive Technologies</a> <div class="tm-company-snippet__description">Компания</div></div></div> <div class="tm-article-author__buttons"><!----> <!----></div></div> <!----> <div class="tm-article-author__separator"></div></div> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/nvnikolai/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt="" src="//habrastorage.org/getpro/habr/avatars/8c1/79e/5ab/8c179e5ab8040e102b839a62a1c83120.png" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 13 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    13
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><span class="tm-user-card__name tm-user-card__name_variant-article">Николай Арефьев</span> <a href="/ru/users/nvnikolai/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @nvnikolai
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">IT-Security</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/company/pt/blog/451680/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментировать 
    </span></a> <!----></div></div></div>  <!---->  <!----> <!----></div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__placeholder_initial"></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <section class="tm-block tm-block_spacing-bottom"><header class="tm-block__header"><h2 class="tm-block__title">Информация</h2> <!----></header> <div class="tm-block__body"><div class="tm-company-basic-info"><dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Дата основания</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><span>
      2002
    </span></dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Местоположение</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap">
    Россия
  </dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Сайт</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><a href="https://www.ptsecurity.com/" target="_blank" class="tm-company-basic-info__link">
      www.ptsecurity.com
    </a></dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Численность</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap">
    1 001–5 000 человек
  </dd></dl> <dl class="tm-description-list tm-description-list_variant-columns-nowrap"><dt class="tm-description-list__title tm-description-list__title_variant-columns-nowrap">Дата регистрации</dt> <dd class="tm-description-list__body tm-description-list__body_variant-columns-nowrap"><time datetime="2011-03-28T14:26:58.000Z" title="2011-03-28, 18:26">28  марта  2011</time></dd></dl> <!----></div></div> <!----></section> <div class="tm-company-widgets"></div> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/company/pt/blog/451680/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/company/pt/blog/451680/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"451680":{"id":"451680","timePublished":"2019-05-14T07:07:08+00:00","isCorporative":true,"lang":"ru","titleHtml":"Глубины SIEM: экспертиза. Чьи правила корреляции лучше","leadData":{"textHtml":"Многие из тех, кто сталкивался с SIEM, знакомы с разработкой правил корреляции. Производители SIEM-решений, коммерческие SOC, интеграторы — все предлагают свои правила и утверждают, что они лучше других. Так ли это на самом деле? Как выбрать поставщика правил? Что такое экспертиза в SIEM? Поразмышляем на эти темы под катом.\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fzt\u002Fjn\u002Fiu\u002Fztjniusqp16pega_pvwx1i2ohsq.png\" alt=\"Чьи правила корреляции лучше\"\u003E\u003C\u002Fdiv\u003E\u003Cbr\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше →","image":null},"editorVersion":"1.0","postType":"article","postLabels":[],"author":{"scoreStats":{"score":13,"votesCount":13},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"1822643","alias":"nvnikolai","fullname":"Николай Арефьев","avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F8c1\u002F79e\u002F5ab\u002F8c179e5ab8040e102b839a62a1c83120.png","speciality":"IT-Security"},"statistics":{"commentsCount":0,"favoritesCount":12,"readingCount":3037,"score":4,"votesCount":4},"hubs":[{"relatedData":null,"id":"17217","alias":"pt","type":"corporative","title":"Блог компании Positive Technologies","titleHtml":"Блог компании Positive Technologies","isProfiled":false},{"relatedData":null,"id":"50","alias":"infosecurity","type":"collective","title":"Информационная безопасность","titleHtml":"Информационная безопасность","isProfiled":true},{"relatedData":null,"id":"397","alias":"analysis_design","type":"collective","title":"Анализ и проектирование систем","titleHtml":"Анализ и проектирование систем","isProfiled":true}],"flows":[{"id":"1","alias":"develop","title":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EМногие из тех, кто сталкивался с SIEM, знакомы с разработкой правил корреляции. Производители SIEM-решений, коммерческие SOC, интеграторы — все предлагают свои правила и утверждают, что они лучше других. Так ли это на самом деле? Как выбрать поставщика правил? Что такое экспертиза в SIEM? Поразмышляем на эти темы под катом.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Чьи правила корреляции лучше\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fzt\u002Fjn\u002Fiu\u002Fztjniusqp16pega_pvwx1i2ohsq.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\n\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\nКак всегда, в \u003Ca href=\"#Conclusions\"\u003Eвыводе\u003C\u002Fa\u003E собраны все ключевые тезисы статьи.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЛюбой специалист по информационной безопасности рано или поздно начинает использовать SIEM-системы или какие-то отдельные элементы систем данного класса.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВажной частью SIEM являются правила корреляции — знания, которые позволяют решить задачу выявления инцидентов информационной безопасности. Их можно разрабатывать самим, делегировать эти работы интегратору или, в случае подключения к коммерческому SOC, использовать знания их специалистов. Как видите, источников правил корреляций в SIEM много, поэтому закономерно встает вопрос выбора. Эта задача особенно актуальна, если в вашей компании нет выделенных специалистов под задачи SIEM. В таком случае вам или вашим коллегам приходится заниматься администрированием сразу нескольких средств защиты и дополнительно SIEM. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПримерно через месяц после внедрения SIEM приходит понимание, что этот класс решений требует значительных трудозатрат. Искусство атак на информационные системы постоянно развивается. Нужно время на отслеживание современных трендов, их анализ, оценку применимости к своей инфраструктуре, а также на написание правил корреляции для выявления атак. Как правило, времени у специалистов на это не хватает. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nСтолкнувшись с подобными проблемами, компании решают либо строить свой SOC и привлекать выделенных специалистов, либо найти внешних поставщиков правил корреляции. Дальше мы разберем, как выбрать поставщика и достаточно ли конечному заказчику только правил корреляции.\u003Cbr\u002F\u003E\r\n\u003Ca name=\"Expertise\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ch1\u003EЭкспертиза и ее свойства\u003C\u002Fh1\u003E\u003Cbr\u002F\u003E\r\nПод экспертизой мы будем понимать набор правил корреляции, знаний экспертов и данных, минимально необходимых для выявления и реагирования на инциденты. Экспертизу предоставляет поставщик (производитель SIEM-решения или SOC), а заказчик — ее потребитель. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПравила корреляции могут поставлять разработчики SIEM-решений, MSSP-провайдеры\u002FSOC, интеграторы и сообщество. Каждый постулирует, что их правила корреляции качественные. Правда, зачастую понятие качества подменяется просто количеством доступных правил. Является ли количество показателем качества? В общем случае — это спорное утверждение. Качественная экспертиза обладает следующими свойствами:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003EТочно выявляет нарушения в конкретной инфраструктуре заказчика.\u003C\u002Fli\u003E\r\n\u003Cli\u003EВыявляет актуальные угрозы мирового уровня. Выявляет угрозы, характерные для конкретной страны и отрасли заказчика.\u003C\u002Fli\u003E\r\n\u003Cli\u003EИмеет как реактивную, так и проактивную составляющую.\u003C\u002Fli\u003E\r\n\u003Cli\u003EПоясняет заказчику результаты своего логического вывода.\u003C\u002Fli\u003E\r\n\u003Cli\u003EПредоставляет пояснения по дальнейшим шагам реагирования на выявленный инцидент.\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\r\nЧасть из этих свойств налагает требования на разработчика экспертизы, а часть — на результат его работы — правила корреляции и сопутствующие материалы. \u003Cbr\u002F\u003E\r\n\u003Ca name=\"Developer\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EРазработчик экспертизы и его компетенции\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nНа основании каких критериев выбрать поставщика? Мы сформулировали шесть основных свойств, которые характеризуют качественную экспертизу. Для их обеспечения поставщик правил должен:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003E\u003Cb\u003EВыявлять актуальные угрозы мирового уровня\u003C\u002Fb\u003E. Это могут быть поставщики, у которых есть собственные аналитические центры, специализирующиеся на выявлении и анализе атак. В них должен проводиться регулярный мониторинг новейших типов атак и подходов к нарушению информационной безопасности систем.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cb\u003EВыявлять угрозы, характерные для конкретной страны и отрасли заказчика\u003C\u002Fb\u003E. В каждой стране ландшафт угроз и перечень типов атак может иметь свою специфику. Поэтому при выборе поставщика, важно, чтобы его аналитический центр имел четкий фокус на отслеживание угроз, присущих именно той стране, в которой располагается инфраструктура вашей компании. Специалисты центра должны не только понимать особенности угроз в определенной стране, но и уметь быстро реагировать на них. Не должно быть так, что поставщик реагирует на новую региональную угрозу через неделю после ее появления, только из-за того, что ваш регион не является для него приоритетным с точки зрения ведения бизнеса.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cb\u003EИметь как реактивную, так и проактивную составляющую\u003C\u002Fb\u003E. Недостаточно набрать в центр аналитиков из числа пентестеров. Важно, чтобы эти эксперты не только понимали и умели взламывать системы, но и знали, как можно выявить попытки взлома и предотвратить, или остановить их на ранних стадиях. Практика показывает, что этому аспекту мало уделяют внимания: часто аналитические центры строятся из экспертов либо только в области нападения, либо только в сфере защиты, что непременно сказывается на уровне выпускаемой ими экспертизы.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cb\u003EТочно выявлять нарушения в конкретной инфраструктуре заказчика\u003C\u002Fb\u003E. Поставщик должен иметь методологию разработки правил корреляции, способных адаптироваться к конкретной инфраструктуре заказчика. Это нужно для того, чтобы минимизировать количество ложных срабатываний правил. Этому вопросу был посвящен большой цикл статей \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fpt\u002Fblog\u002F446212\"\u003E«Правила корреляции, работающие из коробки»\u003C\u002Fa\u003E. Важно помнить, что у поставщика должен быть выстроен процесс именно «промышленной разработки» правил корреляции. Из этого следует, что:\u003Cbr\u002F\u003E\r\n \u003Cul\u003E\r\n\u003Cli\u003Eправила должны тестироваться на «живых», а не синтетических системах;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eв процессе тестирования должны вживую воспроизводиться те типы атак, на выявление которых направлено тестируемое правило корреляции;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eдолжны проводиться нагрузочные и регрессионные тесты, подтверждающие совместимость правил с SIEM;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eпоставщик должен выпускать обновления для ранее выпущенных правил, если выясняется, что правила имеют большое число ложных срабатываний;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eсам SIEM и поставщик должны иметь каналы оперативной доставки обновлений и новых правил корреляции до конечных заказчиков.\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\nНабор требований достаточно широкий. К сожалению, если выделить для разработки правил корреляции одного специалиста, который будет тратить на эту активность 2 часа в день, это не позволит добиться той самой качественной экспертизы. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch2\u003EПравила корреляции и их окружение\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\nПосмотрим теперь на сами правила корреляции глазами заказчика. Он хочет получить от поставщика качественные правила и без проблем активировать их в своем SIEM. На деле не все так просто. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля работы правил нужно подключить к SIEM требуемые источники. Они должны быть настроены так, чтобы генерировать необходимые для правил события. Смотря на само правило, важно, чтобы из него была понятна логика его работы. Помимо этого, заказчику необходимо понимать, как реагировать в случае, если правило срабатывает.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОдних лишь правил корреляций недостаточно, чтобы называться экспертизой. Экспертиза — это правила корреляции вместе с дополнительным окружением, все элементы которого связаны между собой и могут быть выстроены в замкнутую цепь — так называемую экспертизу замкнутого цикла.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"Экспертиза замкнутого цикла\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F6f\u002Fyi\u002Fsa\u002F6fyisahpl8w4eeuy3eejoi2r7du.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Ci\u003EЭкспертиза замкнутого цикла\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nРассмотрим каждое звено этой цепи:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003E\u003Cb\u003EПоставщик\u002Fпроизводитель SIEM\u003C\u002Fb\u003E. Экспертиза начинается с того, что поставщик, обладающий соответствующими \u003Ca href=\"#Developer\"\u003Eкомпетенциями\u003C\u002Fa\u003E, разрабатывает правила корреляции, согласно технологическому процессу.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cb\u003EСписок и настройки источников\u003C\u002Fb\u003E. Разработанные правила корреляции снабжаются описанием тех источников, на основе которых работает правило корреляции. Также поставщик подробно описывает, каким образом должен быть настроен источник, чтобы он обеспечивал генерацию требуемых типов событий. Хорошим тоном будет, если поставщик представит экземпляр самих событий.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cb\u003EОписание логики правила\u003C\u002Fb\u003E. Для того чтобы заказчик понимал, какие принципы срабатывания заложены в правила корреляции, поставщик описывает логику каждого правила в виде блок-схем или текстового описания.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cb\u003EПравила корреляции\u003C\u002Fb\u003E. Непосредственно сами правила корреляции и методика приоритизации порожденных ими инцидентов.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cb\u003EПланы реагирования\u003C\u002Fb\u003E. Срабатывания правила корреляции может являться инцидентом информационной безопасности. Заказчику важно понимать, как нужно реагировать на данный инцидент с целью минимизации его влияния на инфраструктуру. Также в план должны быть включены пояснения, какие данные необходимо дополнительно собрать, в случае появления инцидента. Бесспорно, заказчик должен адаптировать правила реагирования под специфику своей компании. Однако в рамках планов реагирования поставщик должен отразить обобщенные рекомендации по действиям пользователя при инциденте, вызванном конкретным правилом. Так заказчику будет от чего оттолкнуться, адаптируя под себя общий процесс реагирования.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cb\u003EТелеметрия\u003C\u002Fb\u003E. Правила корреляции работают не в сферическом вакууме, а в конкретных условиях компании заказчика. Поставщик отвечает за качество предоставляемых правил и должен понимать, как они работают. Таким образом в SIEM должна собираться статистика по работе правил.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cb\u003EПоставщик\u002Fпроизводитель SIEM\u003C\u002Fb\u003E. Собранная телеметрия в обезличенном виде должна поступать обратно поставщику. Статистика помогает ему оперативно вносить изменения в правила, в случае их ложных срабатываний. Также она позволяет выявлять новые техники и тактики атак и оперативно выпускать новые правила корреляции для их детектирования.\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\r\nНабор требований к поставщику, а также все вышеописанные звенья цепи, по совокупности называются экспертизой. Как можно заметить, цепочка замкнута, поэтому данный подход обозначен как «экспертиза замкнутого цикла».\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nНа данный момент этот подход используют основные зарубежные лидеры SIEM-рынка: IBM QRadar, Micro focus ArcSight. В России он применяется в нашей компании Positive Technologies в продукте MaxPatrol SIEM. В рамках сообщества развивается интересный вендоронезависимый проект — \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fkrakow2600\u002Fatomic-threat-coverage\"\u003EAtomic Threat Coverage\u003C\u002Fa\u003E, продвигающий схожую идеологию. Далее приведу его описание, взятое со страницы проекта.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cblockquote\u003EAtomic Threat Coverage позволяет автоматически сгенерировать базу аналитических данных, предназначенную для противодействия угрозам, описанным в \u003Ca href=\"https:\u002F\u002Fattack.mitre.org\u002F\"\u003EMITRE ATT&amp;CK\u003C\u002Fa\u003E с позиций Обнаружения, Реагирования, Предотвращения и Имитации угроз. Он включает в себя:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003E\u003Cb\u003EDetection Rules\u003C\u002Fb\u003E — Правила Обнаружения (корреляции), основанные на \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FNeo23x0\u002Fsigma\"\u003ESigma\u003C\u002Fa\u003E — общем формате описания правил корреляции для SIEM систем.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cb\u003EData Needed\u003C\u002Fb\u003E — данные, которые необходимо собирать для обнаружения конкретной угрозы.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cb\u003ELogging Policies\u003C\u002Fb\u003E — настройки логирования, которые необходимо произвести на устройстве для сбора данных, необходимых для обнаружения конкретной угрозы.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cb\u003EEnrichments\u003C\u002Fb\u003E — настройки обогащения данных (Data Needed), необходимые для реализации некоторых Правил Обнаружения (Detection Rules).\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cb\u003ETriggers\u003C\u002Fb\u003E — сценарии имитации атак, основанные на \u003Ca href=\"https:\u002F\u002Fatomicredteam.io\"\u003EAtomic Red Team\u003C\u002Fa\u003E — атомарных тестах\u002Fсценариях реализации угроз из MITRE ATT&amp;CK.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cb\u003EResponse Actions\u003C\u002Fb\u003E — атомарные шаги реагирования на инциденты.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cb\u003EResponse Playbooks\u003C\u002Fb\u003E — сценарии реагирования на инциденты, сгенерированные в ходе обнаружения конкретной угрозы, составленные на основе Response Actions.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cb\u003EHardening Policies\u003C\u002Fb\u003E — настройки систем, которые позволяют нивелировать конкретную угрозу.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cb\u003EMitigation Systems\u003C\u002Fb\u003E — системы и технологии, которые позволяют нивелировать конкретную угрозу.\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\r\n\u003C\u002Fblockquote\u003E \u003Cbr\u002F\u003E\r\nОтдельно отмечу момент, который часто выпадает из поля зрения заказчиков и поставщиков. Иногда случаются сложные инциденты, которые невозможно распутать силами специалистов заказчика. Поставщик не должен оставлять заказчика один на один с его проблемой: «Мы поставляем вам правила, они работают, остальное — не наши проблемы». На мой взгляд, серьезные поставщики экспертизы должны иметь в своем портфеле услуги расследования инцидентов, которыми заказчик может воспользоваться в любое время 24\u002F7 в случае возникновения критической ситуации.\u003Cbr\u002F\u003E\r\n\u003Ca name=\"Conclusions\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ch1\u003EВыводы\u003C\u002Fh1\u003E\u003Cbr\u002F\u003E\r\nПодытожим:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003EЗаказчик, купивший SIEM, часто не имеет возможности выделить отдельных специалистов для работы с решением 100% рабочего времени. В таком случае SIEM через некоторое время перестает использоваться.\u003C\u002Fli\u003E\r\n\u003Cli\u003EОдних правил корреляции недостаточно для того, чтобы обеспечивать выявление актуальных угроз безопасности. В связи с этим одни лишь правила корреляции не могут называться экспертизой. Экспертиза — набор правил корреляции, знаний экспертов и данных, минимально необходимых для выявления и реагирования на инциденты.\u003C\u002Fli\u003E\r\n\u003Cli\u003EЭкспертиза должна обладать следующими \u003Ca href=\"#Expertise\"\u003Eсвойствами\u003C\u002Fa\u003E:\u003Cbr\u002F\u003E\r\n \u003Cul\u003E\r\n\u003Cli\u003Eточно выявляет нарушения в конкретной инфраструктуре заказчика;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eвыявляет актуальные угрозы мирового уровня, а также характерные для конкретной страны и отрасли заказчика;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eимеет как реактивную, так и проактивную составляющую;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eпоясняет заказчику результаты своего логического вывода;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eпредоставляет пояснения по дальнейшим шагам реагирования на выявленный инцидент.\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003C\u002Fli\u003E\r\n\u003Cli\u003EНедостаточно поставлять готовые Sigma-правила, чтобы считаться поставщиком экспертизы. Поставщик экспертизы должен удовлетворять ряду \u003Ca href=\"#Developer\"\u003Eтребований\u003C\u002Fa\u003E.\u003C\u002Fli\u003E\r\n\u003Cli\u003EПоставляемая экспертиза состоит из следующих взаимосвязанных элементов:\u003Cbr\u002F\u003E\r\n \u003Cul\u003E\r\n\u003Cli\u003Eсписка и настройки источников;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eописания логики правила;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eправила корреляции;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eпланов реагирования;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eтелеметрии по срабатыванию правил.\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003C\u002Fli\u003E\r\n\u003Cli\u003EПоставщики экспертизы должны иметь в своем портфеле услуги расследования, которыми заказчик может воспользоваться в случае, если у него не хватает собственных компетенций для анализа сложного инцидента.\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"siem"},{"titleHtml":"корреляция данных"},{"titleHtml":"нормализация данных"},{"titleHtml":"информационная безопасность"},{"titleHtml":"иб"},{"titleHtml":"sigma"},{"titleHtml":"attck"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F451680\u002Fee029c6fa20ed0810c0767d30a18af6b\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F451680\u002Fee029c6fa20ed0810c0767d30a18af6b\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompany\\\u002Fpt\\\u002Fblog\\\u002F451680\\\u002F\"},\"headline\":\"Глубины SIEM: экспертиза. Чьи правила корреляции лучше\",\"datePublished\":\"2019-05-14T10:07:08+03:00\",\"dateModified\":\"2019-05-14T10:43:43+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Николай Арефьев\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Многие из тех, кто сталкивался с SIEM, знакомы с разработкой правил корреляции. Производители SIEM-решений, коммерческие SOC, интеграторы &mdash; все предлагают свои п...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fcompany\\\u002Fpt\\\u002Fblog\\\u002F451680\\\u002F#post-content-body\",\"about\":[\"c_pt\",\"h_infosecurity\",\"h_analysis_design\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fzt\\\u002Fjn\\\u002Fiu\\\u002Fztjniusqp16pega_pvwx1i2ohsq.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002F6f\\\u002Fyi\\\u002Fsa\\\u002F6fyisahpl8w4eeuy3eejoi2r7du.png\"]}","metaDescription":"Многие из тех, кто сталкивался с SIEM, знакомы с разработкой правил корреляции. Производители SIEM-решений, коммерческие SOC, интеграторы — все предлагают свои правила и утверждают, что они лучше...","mainImageUrl":null,"amp":true},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":""},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{"pt":{"alias":"pt","imageUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fcompany\u002F00b\u002Ff9c\u002F27a\u002F00bf9c27a7e0ab9d98f5f973a18d62fd.png","titleHtml":"Positive Technologies","descriptionHtml":null,"relatedData":null,"statistics":{"postsCount":679,"newsCount":2,"vacanciesCount":0,"employeesCount":59,"careerRating":null,"subscribersCount":45734,"rating":130.21,"invest":null},"foundationDate":{"year":"2002","month":null,"day":null},"location":{"city":{"id":"447159","title":"Москва"},"region":{"id":"1885","title":"Москва и Московская обл."},"country":{"id":"168","title":"Россия"}},"siteUrl":"https:\u002F\u002Fwww.ptsecurity.com\u002F","staffNumber":"1 001–5 000 человек","registrationDate":"2011-03-28T14:26:58+00:00","representativeUser":null,"contacts":[],"settings":{"analyticsSettings":[],"branding":null,"status":"active"},"metadata":{"titleHtml":"Positive Technologies, Москва -  с 2002 год","title":"Positive Technologies, Москва -  с 2002 год","keywords":["Информационная безопасность","Реверс-инжиниринг","Спортивное программирование","IT-инфраструктура","Конференции"],"descriptionHtml":"679 статей от авторов компании Positive Technologies","description":"679 статей от авторов компании Positive Technologies"},"aDeskSettings":null,"careerAlias":"ptsecurity","maxCustomTrackerLinks":0}},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
