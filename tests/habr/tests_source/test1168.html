<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover">
  <title>Как запустить микро-платежи в своем приложении / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.c0af73e7.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.e7843cc0.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.02ee25a4.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.85eb77f0b17c8235e7b64b9f81ea5ec2.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true" data-vmid="checkad"></script><script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/452696\/"},"headline":"Как запустить микро-платежи в своем приложении","datePublished":"2019-05-20T22:52:01+03:00","dateModified":"2019-05-21T14:18:09+03:00","author":{"@type":"Person","name":"reablaz"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Прошлую неделю я провёл разрабатывая свою первую публичную программку &mdash; Telegram-бота который работает в качестве Bitcoin-кошелька и позволяет &laquo;бросать монетки&raquo;...","url":"https:\/\/habr.com\/ru\/post\/452696\/#post-content-body","about":["h_open_source","h_pay_system","h_programming","h_distributed_systems","h_cryptocurrency","f_develop","f_admin","f_popsci"],"image":["https:\/\/habrastorage.org\/getpro\/habr\/post_images\/097\/02b\/175\/09702b1750c94616a10fc66c1275c00f.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/3ef\/1ff\/85f\/3ef1ff85f1e7b77662c63a9d4d838666.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/883\/661\/461\/883661461bdc686aec7d084d5d581236.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/779\/716\/5d9\/7797165d93d292700d9a41a171d882a6.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/8fe\/33b\/84b\/8fe33b84bb127132304634363bb4af42.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/4a3\/da5\/f76\/4a3da5f76574ac9ebb2161d56bceff62.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/54d\/a43\/0be\/54da430be68237193dee82ade50bab37.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/3c6\/636\/b8c\/3c6636b8c98d52aab9bd09ff9c52afcb.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/518\/3dc\/c81\/5183dcc817817f1aa676ff74d17d08bb.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/f09\/c3a\/ef9\/f09c3aef995f7a82560987646b0d8ee0.png","https:\/\/habrastorage.org\/getpro\/habr\/post_images\/1e2\/344\/82c\/1e234482c56aa0df1d4b341ecfe3beb8.png"]}</script>
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.49.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_eng"><meta data-vue-meta="ssr" property="og:title" content="Как запустить микро-платежи в своем приложении" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Как запустить микро-платежи в своем приложении" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Как запустить микро-платежи в своем приложении" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Прошлую неделю я провёл разрабатывая свою первую публичную программку — Telegram-бота который работает в качестве Bitcoin-кошелька и позволяет «бросать монетки» другим участникам групповых чатов а так..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Прошлую неделю я провёл разрабатывая свою первую публичную программку — Telegram-бота который работает в качестве Bitcoin-кошелька и позволяет «бросать монетки» другим участникам групповых чатов а так..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Прошлую неделю я провёл разрабатывая свою первую публичную программку — Telegram-бота который работает в качестве Bitcoin-кошелька и позволяет «бросать монетки» другим участникам групповых чатов а так..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Прошлую неделю я провёл разрабатывая свою первую публичную программку — Telegram-бота который работает в качестве Bitcoin-кошелька и позволяет «бросать монетки» другим участникам групповых чатов а так..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Прошлую неделю я провёл разрабатывая свою первую публичную программку — Telegram-бота который работает в качестве Bitcoin-кошелька и позволяет «бросать монетки» другим участникам групповых чатов а так..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/452696/613820bbf59688a473ed73eae28829a3/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/452696/613820bbf59688a473ed73eae28829a3/" data-vmid="og:image"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/452696/613820bbf59688a473ed73eae28829a3/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/452696/613820bbf59688a473ed73eae28829a3/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/452696/613820bbf59688a473ed73eae28829a3/" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="452696" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2019-05-20T19:52:01.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/452696/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/post/452696/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" data-vmid="hreflang"><link data-vue-meta="ssr" image_src="image" href="https://habr.com/share/publication/452696/613820bbf59688a473ed73eae28829a3/" data-vmid="image:href">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <!----> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <div class="tm-dropdown tm-header__projects"><div class="tm-dropdown__head"><button class="tm-header__dropdown-toggle"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown"><title>Открыть список</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#arrow-down"></use></svg></button></div> <!----></div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn">
            Как стать автором
          </a> <div class="tm-feature tm-header__feature tm-feature_variant-inline"><!----></div> <!----> <!----></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky"><div class="tm-page-width"><div class="tm-base-layout__header-wrapper"><div class="tm-main-menu"><div class="tm-main-menu__section"><nav class="tm-main-menu__section-content"><!----> <a href="/ru/all/" class="tm-main-menu__item">
        Все потоки
      </a> <a href="/ru/flows/develop/" class="tm-main-menu__item">
          Разработка
        </a><a href="/ru/flows/admin/" class="tm-main-menu__item">
          Администрирование
        </a><a href="/ru/flows/design/" class="tm-main-menu__item">
          Дизайн
        </a><a href="/ru/flows/management/" class="tm-main-menu__item">
          Менеджмент
        </a><a href="/ru/flows/marketing/" class="tm-main-menu__item">
          Маркетинг
        </a><a href="/ru/flows/popsci/" class="tm-main-menu__item">
          Научпоп
        </a></nav></div></div> <div class="tm-header-user-menu tm-base-layout__user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark"><title>Поиск</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop"><div class="tm-dropdown"><div class="tm-dropdown__head"><svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon"><title>Профиль</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#header-user"></use></svg> <!----></div> <!----></div> <!----></div> <!----></div></div></div></div> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#pull-arrow"></use></svg></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet"><div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/reablaz/" title="reablaz" class="tm-user-info__userpic"><div class="tm-entity-image"><svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_pink"><!----> <use xlink:href="/img/megazord-v24.ce74655c.svg#placeholder-user"></use></svg></div></a> <span class="tm-user-info__user"><a href="/ru/users/reablaz/" class="tm-user-info__username">
      reablaz
    </a> </span></span> <span class="tm-article-snippet__datetime-published"><time datetime="2019-05-20T19:52:01.000Z" title="2019-05-20, 22:52">20  мая  2019 в 22:52</time></span></div> <!----></div> <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Как запустить микро-платежи в своем приложении</span></h1> <div class="tm-article-snippet__hubs"><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/open_source/" class="tm-article-snippet__hubs-item-link"><span>Open source</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/pay_system/" class="tm-article-snippet__hubs-item-link"><span>Платежные системы</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/programming/" class="tm-article-snippet__hubs-item-link"><span>Программирование</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/distributed_systems/" class="tm-article-snippet__hubs-item-link"><span>Распределённые системы</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/cryptocurrency/" class="tm-article-snippet__hubs-item-link"><span>Криптовалюты</span> <!----></a></span></div> <div class="tm-article-snippet__labels"><div class="tm-article-snippet__label"><span>
        Tutorial
      </span></div></div> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div id="post-content-body" class="article-formatted-body article-formatted-body_version-1"><div xmlns="http://www.w3.org/1999/xhtml">Прошлую неделю я провёл разрабатывая свою первую публичную программку — Telegram-бота который работает в качестве Bitcoin-кошелька и позволяет «бросать монетки» другим участникам групповых чатов а так же совершать внешние Bitcoin-платежи себе или другим т.н. “Lightning Apps”. Подразумеваю, что в целом читатель знаком c Bitcoin и Telegram, т.к. буду стараться писать кратко, не вникая в детали. <a href="https://www.lopp.net/bitcoin-information.html">Выборка ресурсов о Bitcoin доступна по этой ссылке</a>, ну а Телеграм это средство мгновенного обмена сообщениями на мобильных устройства и пк, позволяющее на их платформе создавать свои небольшие приложения (чат-ботов).<br/>
<br/>
<h3>Какие ключевые функции этого приложения?</h3><br/>
<ul>
<li>Позволяет отблагодарить или поощрить собеседника действительно материальной ценностью, а не просто <i>«виртуальным лайком»</i>, это выводит электронное общение на совершенно новый уровень</li>
<li>Реальный пример приложения, которое может финансово взаимодействовать с другими приложениями используя открытый платёжный протокол</li>
<li>Все компоненты приложения являются проектами с открытым исходным кодом и их возможно изменять и применять для своих задач. Приложение не использует закрытых и\или коммерческих решений, несмотря на то, что подходит под сферу электронной коммерции, которую на сегодняшний день назвать открытой довольно сложно.</li>
</ul><br/>
<h3>И как это применить в деле?</h3><br/>
как-то так…<br/>
<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/097/02b/175/09702b1750c94616a10fc66c1275c00f.png"/></div><a name="habracut"></a><br/>
или так…<br/>
<br/>
<div style="text-align:center;"><img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/3ef/1ff/85f/3ef1ff85f1e7b77662c63a9d4d838666.png"/></div><br/>
Что значат эти числа? Это <b>единицы биткойна — сатоши</b>. По биржевым ценам на середину 2019 года 1000 сатоши это приблизительно $0.06. Сатоши можно потратить онлайн или легко обменять на национальную валюту. Именно по этой причине (ликвидность) это не просто очередная <i>«запись в БД»</i> или <i>«баллы, которые вы можете потратить в магазинах наших партнёров»</i>, а <b>самые настоящие интернет деньги</b>.<br/>
<i>*сразу хочу отметить, что некоторые слова или словосочетания заведомо не пытаюсь писать на русском — либо не знаю сам контекстного перевода в некоторых случаях, либо такой перевод на мой взгляд звучит скорее заблуждающим, чем корректным </i><br/>
<br/>
Может возникнуть вопрос, как пользоваться таким приложением если биткойнов нет. Их легко можно приобрести в небольшом количестве на одной из многих бирж или обменнике, а можно у друга-биткойнера или даже получить монеток от текущих пользователей бота. Многие кошельки на телефон предлагают купить биткойны прямо «не отходя от кассы».<br/>
<br/>
<img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/883/661/461/883661461bdc686aec7d084d5d581236.png"/><img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/779/716/5d9/7797165d93d292700d9a41a171d882a6.png"/><img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/8fe/33b/84b/8fe33b84bb127132304634363bb4af42.png"/><br/>
<br/>
Когда разжились биткойнами (а скорее сатош<i>-ами</i>(?)) — запускаем <a href="https://t.me/atomic_tipbot">@atomic_tipbot</a> и делаем /deposit.<br/>
<br/>
Бот в ответ спросит сколько сатоши внести на баланс и пришлет к оплате счёт, который можно оплатить мобильным кошельком отсканировав QR-код или нажав кнопку (<i>«открыть в кошельке»</i>) на странице инвойса. <br/>
<br/>
<img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/8fe/33b/84b/8fe33b84bb127132304634363bb4af42.png"/><img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/4a3/da5/f76/4a3da5f76574ac9ebb2161d56bceff62.png"/><img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/54d/a43/0be/54da430be68237193dee82ade50bab37.png"/><br/>
<br/>
Подтвердив платёж на своем кошельке, практически сразу подтверждение об оплате вышлет бот и это будет визуально отображено во фрейме счёта.<br/>
<br/>
До этого момента мы затронули две компоненты приложения — back-end telegram-бота и систему процессинга платежей криптовалютой (скорее ее front-end).<br/>
<br/>
Для создания Telegram-бота я использовал <a href="http://python-telegram-bot.readthedocs.io/">Python Telegram Bot</a>. Ну и конечно, сам бот <a href="https://github.com/reablaz/atomic_tipbot">с открытым исходным кодом</a>.<br/>
<br/>
В качестве системы процессинга платежей и решения UX-задач выбор пал (на самом деле, выбора почти нет) на <a href="https://www.youtube.com/watch?v=nr0UNbz3AoQ">BTCPayServer</a>, на который <a href="https://docs.btcpayserver.org/">документация по этой ссылке</a>.<br/>
<br/>
Если искать решения обработки событий платежей напрямую, то стоит обратить внимание на <a href="http://docs.electrum.org/en/latest/cmdline.html">Electrum CLI manual pages</a> для т.н. on-chain платажей, а для мгновенных микро-платежей (Lightning) решения вроде <a href="https://github.com/ElementsProject/lightning-charge">Lightning-charge</a> или <a href="https://github.com/fiatjaf/sparko">Sparko</a>.<br/>
 <br/>
<h3>Так оно self-hosted или нет!?</h3><br/>
Да, это так. В своем приложении я использую бесплатный хостинг BTCPayServer — <a href="https://btcpayjungle.com">BTCPayJungle</a>, но это абсолютно возможно и не требует много времени что бы запустить собственный процессинговый центр. Однако стоит помнить, что Вам будут необходимы ~500GB доступные на ЖД для хранения блокчейнов Bitcoin (и Litecoin). Так же потребуются вычислительные и сетевые ресурсы на время синхронизации и в зависимости от ваших нужд необходимые «обёртки» для блокчейнов, что бы было с ними удобно взаимодействовать. BTCPayServer не содержит <i>by-design</i> приватных ключей или любой другой информации, позволяющей контролировать ваш кошелек. <br/>
<br/>
Для on-chain (обычных) платежей необходимо добавить т.н. xpub-ключ кошелька в BTCPayServer для генерации адресов на получение (публичных ключей). Это делает возможным и безопасным использовать BTCPayServer даже в «расшареном» виде. Все эти xpub-ключи и адреса можно легко получить в хороших кошельках вроде <a href="http://electrum.org/">Electrum</a>, для дальнейшей настройки процессинга.<br/>
<br/>
Все кто сталкивался с Bitcoin слышали про то, что биткойн медленный и тразакции дорогие, особенно когда хайп, поэтому для мгновенных микро-платежей стоит использовать (off-chain) транзакции Lightning Network.<br/>
<br/>
<h3>Что это за Lightning Network?</h3><br/>
Это что-то вроде плагина к биткойну, который надстраивает дополнительный слой абстракции и позволяет совершать мгновенные и практически бесплатные транзакции в сети Bitcoin. Всё это возможно благодаря криптографической магии с мульти-подписями, чаще называемой <i>смарт-контракт</i>. Есть несколько реализаций протокола Lightning Network, я использую <a href="https://github.com/ElementsProject/lightning">c-lightning</a> реализацию на C. <br/>
<br/>
Основное различие между on-chain и off-chain (Lightning) платежами в том, как они хранятся. Все <b>on-chain</b> транзакции ретранслируются по всем узлам сети, пока одна из нод биткойна нод не анонсирует <a href="https://en.bitcoin.it/wiki/Mining">новый намайненый блок</a> с включенными в него транзакциями. (На хабре даже есть <a href="https://habr.com/ru/users/bitfury/" class="user_link">BitFury</a>, они как раз производят железо для майнинга). Именно по этой причине мы называем такие транзакции <b>on-chain</b>. Такие транзакции буду записаны в общий блокчейн и сохранятся в нём до конца его существования. Так же такие транзакции находятся в общем доступе и их возможно мониторить, отслеживать и анализировать.<br/>
<br/>
В случае <b>off-chain</b> (Lightning) транзакций все происходит иначе. Каждая нода Lightning-сети имее один <i>(или более)</i> on-chain адресов — это те самые обычные адреса биткойна, с которых все и начинается. Когда появляются биткойны на таком адресе возможно открыть т.н. <i>lightning канал</i> к другой ноде, что значит, что при помощи криптографических техник эти две ноды договорились о доступности средств между собой. Позже, все транзакции (как свои, так и транзакции посторонних нод) что проходят через такой канал сохраняются только на нодах участников транзакции (и нодах-посредниках). Единственные транзакции, которые записываются в блокчейн — это транзакции об открытии или закрытии канала. В более полном масштабе получается такая сеть взаимо-подключенных нод которая строит между участниками тысячи различных путей для «переливания» средств из одной ноды в другую по определенным жестким правилам. Практически все такие транзакции хранятся только в файле БД самих нод. Именно по этой причине мы их называем <b>off-chain</b>. <br/>
<br/>
<h3>На диаграме видна визуализация всех компонент приложения</h3><br/>
<img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/3c6/636/b8c/3c6636b8c98d52aab9bd09ff9c52afcb.png"/><br/>
<br/>
Вкратце:<br/>
<br/>
1) Пользователь отправляет комунду боту в <b>Telegram</b><br/>
<br/>
2) Telegram отправляет сообщение о событии <b>python приложению</b> бота<br/>
<br/>
3) <b>python-приложение</b> отправляет запрос на <b>BTCPayServer</b><br/>
<br/>
4) BTCPayServer генерирует входящие адреса BTC и LTC, а так же отправляет запрос на инвойс к <b>lightning-charge</b>, который в свою очередь общается с демоном <b>c-lightning</b>. На выходе мы получаем красивую HTML-форму обработки платежа<br/>
<br/>
5) Пользователь оплачивает инвойс и видит подтверждение<br/>
<br/>
6) <b>BTCPayServer</b> отправляет<i> уведомление оплаты инвойса</i> (IPN) на указанный callback_url, в нашем случае <b>callbacks.py</b> (еще одно python приложении для получения уведомлений)<br/>
<br/>
7) Согласно полученным данным баланс пользователя изменяется<br/>
<br/>
<i>… и если пользователь захотел вывести средства (монетки что получил от других) …</i><br/>
<br/>
8) <b>Python-приложение</b> бота ждет текста или картинки QR-кода, и когда валидные данные получены то совершается платёж утилитой<b>paylightning.py*</b>, которая инициализирует транзакцию посредством c-lightning RPC.<br/>
<br/>
<img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/518/3dc/c81/5183dcc817817f1aa676ff74d17d08bb.png"/><br/>
<br/>
<i>*Справедливости ради, стоит отметить что моя обертка paylightning.py не совсем закончена и может вернуть ложно-отрицательный результат в специфических сценариях. Рекомендую <a href="https://github.com/fiatjaf/lightningd-gjson-rpc/tree/master/cmd/waitpay">к использованию хорошо отлаженную обертку</a> в случаях приближенных к продакшену</i><br/>
<br/>
Что мы имеем? Пользователи нашего бота могут внутри группового чата или напрямую могут передавать <b>материальную ценность</b> без ограничений. И это еще не все — благодаря протоколу Lightning Network, который в некотором смысле является унифицированной и упрощенной платежной сетью, появляется возможность отправлять те же деньги что получены в чате совершенно сторонним приложениям. Например, в Telegram уже был первый бот для биткойн-платежей — @lntxbot. «Единый баланс» позволяет использовать любого из ботов в зависимости от предпочтений конкретного группового чата (да, проблема абсолютно надуманна и решение весьма бесполезно, но дело в сути). Перекинуть баланс с одного бота на другой ничего не стоит и занимает секунды! Важно заметить, что создатели этих ботов вообще никогда не связывались между собой.<br/>
<br/>
<img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/f09/c3a/ef9/f09c3aef995f7a82560987646b0d8ee0.png"/> <img src="/img/image-loader.svg" alt="image" data-src="https://habrastorage.org/getpro/habr/post_images/1e2/344/82c/1e234482c56aa0df1d4b341ecfe3beb8.png"/><br/>
<br/>
Достаточно просто переправить сообщение с запросом на депозит от @lntxbot к @atomic_tipbot и voul’a!<br/>
<br/>
Это уже не просто «перебрасывание чисел в БД» а платёж между двумя разными, не связанными между собой БД. Таким образом в бот интегрировано уже несколько «LApps», среди них: <a href="https://sat2.io">sat2.io</a> и <a href="https://lnsms.world">lnsms.world</a>.<br/>
<br/>
<b>Что значит <i>интеграция LApp</i>?</b><br/>
<br/>
Каждая <i>Lightning Network</i> нода это по своей сути биткойн-кошелек. У нее два баланса: on-chain и off-chain. On-chain баланс необходим для открытия новых каналов и хранения средств с закрытых каналов. А вот off-chain баланс как раз то, что ходит между нодами. Основные требования к ноде это получение и отправка платежей, поэтому каждая нода как ПО имеет функции <i><b>pay</b></i> и <i><b>invoice</b></i>. Я продемонстрирую как это происходит:<br/>
<br/>
<pre><code class="bash">user@ln-node:/ % lightning-cli invoice 1000000000 internal_description external_description
{
   "payment_hash" : "64c0c8f5f8f708b08487ad1376f3d256f92ccb9606987ba395c2b4193efde5a0",
   "expires_at" : 1558709834,
   "bolt11" : "lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6"
}
</code></pre><br/>
Мы получаем «инвойс» спецификации <a href="https://github.com/lightningnetwork/lightning-rfc/blob/master/11-payment-encoding.md">BOLT11</a> в этом случае, которая является форматом платёжек в сети Bitcoin (и Litecoin, к слову, тоже). Это строка, содержащая в себе информацию о получателе, сумме транзакции, время истечения запроса итп., подробную информацию можно получить запустив decodepay в отношении данной строки:<br/>
<br/>
<pre><code class="bash">user@ln-node:/ % lightning-cli decodepay lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6
{
   "currency" : "bc",
   "created_at" : 1558105034,
   "expiry" : 604800,
   "payee" : "025a14b8ed40583d67aec92da19453e0b2d1fbbf75f96f85d3dd0ff61a51ee0490",
   "msatoshi" : 1000000000,
   "amount_msat" : "1000000000msat",
   "description" : "external_description",
   "min_final_cltv_expiry" : 10,
   "routes" : [
      [
         {
            "pubkey" : "03a20c0c2ae4508b669a70e5f82f08f69a3da5da3bf0c973673c3fe977db0f61e3",
            "short_channel_id" : "574012x1255x1",
            "fee_base_msat" : 1000,
            "fee_proportional_millionths" : 1,
            "cltv_expiry_delta" : 144
         }
      ]
   ],
   "payment_hash" : "64c0c8f5f8f708b08487ad1376f3d256f92ccb9606987ba395c2b4193efde5a0",
   "signature" : "304502210099f31dffd18b6db8296637db3e3a1ffbaf7b7db087a2ad1eedb7639f25e78b25022079038370073681aa1e1a7a05de6588e98ead078896d0a37a15b755c212dc3d37"
}
</code></pre><br/>
А вот для оплаты такого «инвойса» нам необходима функция pay от c-lightning:<br/>
<br/>
<pre><code class="bash">user@ln-node:/ % lightning-cli pay lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j
{
   "id" : 163,
   "payment_hash" : "c3e644a005f56e33df89facbce2c9dfcabbef5d105285a98272cacc77ab2de63",
   "destination" : "03021c5f5f57322740e4ee6936452add19dc7ea7ccf90635f95119ab82a62ae268",
   "msatoshi" : 200000,
   "amount_msat" : "200000msat",
   "msatoshi_sent" : 200003,
   "amount_sent_msat" : "200003msat",
   "created_at" : 1558106072,
   "status" : "complete",
   "payment_preimage" : "1a9552b9f4e9199e26839353f870b12cc85b7674a2fb134e78aa370032611019",
   "bolt11" : "lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j"
}
</code></pre><br/>
Все состояния транзакций обрабатывает вся сеть и ваша собственная нода в частности. Нет необходимости (но есть такая возможность) взаимодействовать с авторами приложения-получателя платежа или каким либо их API для получения информации о состоянии платежа. Нет нужды проверять состояние платежа в системе процессинга-посредника. Не нужно ожидать одобрения вашей транзакции со стороны банка или государственного учреждения. В конце концов тут нет чардж-бэков и других внешних факторов, которые могут повлиять на остаток на вашем счету. Это решение для перемещения ценности посредством сети Интернет, без необходимости стороннего арбитра, который решает соответсвует транзакция правилам (порой даже внутренним правилам, о которых не все участники проинформированы заранее) или нет. В биткойне нет «внутренних правил». Единственные правила которым нужно следовать это правила сети — открытые и всем известные. <br/>
<br/>
Это делает реальными <b>прямые</b>, <b>практически бесплатные</b> и <b>мгновенные</b> денежные транзакции между людьми или программами в полностью автономном режиме.<br/>
<br/>
Если у вас есть возможность получить данные оплаты от стороннего приложения, то появляется возможность взаимодействовать в финансовом смысле с этим приложением. В качестве примера можно рассмотреть сервис lnsms.world, который позволяет отправить SMS-сообщение на произвольный номер, оплатив его биткойнами. Для интеграции этого приложения нам нужно всего лишь передать данные из веб-формы напрямую скрипту отправки смс — эмулировать действия пользователя на веб-сайте:<br/>
<br/>
<pre><code class="python">payload = {                                                                                                                           
        'number': phone_number,
        'text': text,
        'force_unicode': 0
    }

    send_req = requests.post('https://lnsms.world/invoice', data=payload)
    if send_req.status_code == 201:
        plain_invoice = str(send_req.text)
</code></pre><br/>
Не знаю по какой причине, но lnsms отвечает 201 HTTP status-кодом и возвращает инвойс формата BOLT11. Что ж, этого достаточно что бы пользователи бота могли произвести оплату за отправку смс со своего баланса, полученного в чатиках. Пользователь даже не знает что там происходит, он просто заплатил пару центов за отправку смс. И я, как разработчки не вдаюсь в подробности работы смс-сервисов. Просто переправил платеж и получил услугу. Можно сверху наценку сделать, а можно и не делать — это мой свободный выбор. Никаких аккаунтов, соглашений и очередного API для пустяковых задач вроде отправки смс. <br/>
<br/>
А теперь давайте на момент представим, что наше приложении является чем-то более полезным чем чат-бот и совершает платеж не другому боту, а другому приложению или устройству, подключенному к Интернет. Или же это десятки или даже сотни ничтожных платежей каждую секунду между устройствами, сервисами, магазинами или какими то поставщиками услуг. Это и есть мощь микро-платежей, так должен выглядеть Интернет вещей. Уже существуют проекты вроде <a href="https://althea.org/">Althea</a> которые воплащают эти идеи в жизнь и в скором будущем мы увидим большие, на мой взгляд, перемены в области, которую мы сейчас называет электронная коммерция.<br/>
<br/>
Если Вам понравился пост и Вы хотите попробовать биткойны в действии — <a href="https://tip.ysx.in">зашлите мне на кружку пива, да мягких французских булочек</a>.</div></div> <!----> <div class="tm-article-poll"><div class="tm-notice tm-article-poll__notice tm-notice_positive"><!----> <div class="tm-notice__inner"><!----> <div class="tm-notice__content"><span>Только зарегистрированные пользователи могут участвовать в опросе. <a rel="nofollow" href="/kek/v1/auth/habrahabr/?back=/ru/post/452696/&hl=ru">Войдите</a>, пожалуйста.</span></div></div></div> <div class="tm-article-poll__header">Интерестны ли Вам сугубо-технические статьи про биткойн и смежное ПО?</div> <div class="tm-article-poll__answers"><div class="tm-article-poll__answer"><div class="tm-article-poll__answer-data"><span class="tm-article-poll__answer-percent tm-article-poll__answer-percent_winning">
            84.85%
          </span> <span class="tm-article-poll__answer-label">Да</span> <span class="tm-article-poll__answer-votes">
            28
          </span></div> <div class="tm-article-poll__answer-bar"><div class="tm-article-poll__answer-progress tm-article-poll__answer-progress_winning" style="width:84.85%;"></div></div></div><div class="tm-article-poll__answer"><div class="tm-article-poll__answer-data"><span class="tm-article-poll__answer-percent">
            12.12%
          </span> <span class="tm-article-poll__answer-label">Нет</span> <span class="tm-article-poll__answer-votes">
            4
          </span></div> <div class="tm-article-poll__answer-bar"><div class="tm-article-poll__answer-progress" style="width:12.12%;"></div></div></div><div class="tm-article-poll__answer"><div class="tm-article-poll__answer-data"><span class="tm-article-poll__answer-percent">
            3.03%
          </span> <span class="tm-article-poll__answer-label">Мне больше интерестны рыночные аспекты криптовалюты</span> <span class="tm-article-poll__answer-votes">
            1
          </span></div> <div class="tm-article-poll__answer-bar"><div class="tm-article-poll__answer-progress" style="width:3.03%;"></div></div></div></div> <div class="tm-article-poll__stats">
       Проголосовали 33 пользователя.  

       Воздержались 7 пользователей. 
    </div></div></div> <div class="tm-article-presenter__meta"><div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BC%D0%B3%D0%BD%D0%BE%D0%B2%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5%20%D1%81%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%5D" class="tm-tags-list__link">мгновенные сообщения</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BA%D1%80%D0%B8%D0%BF%D1%82%D0%BE%D0%B2%D0%B0%D0%BB%D1%8E%D1%82%D1%8B%5D" class="tm-tags-list__link">криптовалюты</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B1%D0%B8%D1%82%D0%BA%D0%BE%D0%B9%D0%BD%5D" class="tm-tags-list__link">биткойн</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BF%D0%BB%D0%B0%D1%82%D0%B5%D0%B6%D0%B8%5D" class="tm-tags-list__link">платежи</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%8D%D0%BB%D0%B5%D0%BA%D1%82%D1%80%D0%BE%D0%BD%D0%BD%D0%B0%D1%8F%20%D0%BA%D0%BE%D0%BC%D0%BC%D0%B5%D1%80%D1%86%D0%B8%D1%8F%5D" class="tm-tags-list__link">электронная коммерция</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%B4%D0%B5%D1%86%D0%B5%D0%BD%D1%82%D1%80%D0%B0%D0%BB%D0%B8%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5%20%D1%81%D0%B5%D1%82%D0%B8%5D" class="tm-tags-list__link">децентрализованные сети</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BE%D1%82%D0%BA%D1%80%D1%8B%D1%82%D1%8B%D0%B9%20%D0%B8%D1%81%D1%85%D0%BE%D0%B4%D0%BD%D1%8B%D0%B9%20%D0%BA%D0%BE%D0%B4%5D" class="tm-tags-list__link">открытый исходный код</a></li></ul></div> <div class="tm-separated-list tm-article-presenter__meta-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hub/open_source/" class="tm-hubs-list__link">
    Open source
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/pay_system/" class="tm-hubs-list__link">
    Платежные системы
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/programming/" class="tm-hubs-list__link">
    Программирование
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/distributed_systems/" class="tm-hubs-list__link">
    Распределённые системы
  </a></li><li class="tm-separated-list__item"><a href="/ru/hub/cryptocurrency/" class="tm-hubs-list__link">
    Криптовалюты
  </a></li></ul></div></div></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div class="tm-votes-meter tm-article-rating__votes-switcher"><svg height="16" width="16" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon_medium"><title>Всего голосов 17: ↑16 и ↓1</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-rating"></use></svg> <span title="Всего голосов 17: ↑16 и ↓1" class="tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_medium">+15</span></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----> <span title="Количество просмотров" class="tm-icon-counter tm-data-icons__item"><svg height="16" width="16" class="tm-svg-img tm-icon-counter__icon"><title>Просмотры</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-views"></use></svg> <span class="tm-icon-counter__value">7.5K</span></span> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span title="Добавить в закладки" class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    51
  </span></button> <!----> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="tm-sharing__icon"><path fill="currentColor" d="M10.33.275l9.047 7.572a.2.2 0 010 .306l-9.048 7.572a.2.2 0 01-.328-.153V11c-8 0-9.94 6-9.94 6S-1 5 10 5V.428a.2.2 0 01.328-.153z"></path></svg></button> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> </div></div> <!----> <!----> <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/reablaz/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><svg class="tm-svg-img tm-image-placeholder tm-image-placeholder_pink"><!----> <use xlink:href="/img/megazord-v24.ce74655c.svg#placeholder-user"></use></svg></div></a> <div class="tm-user-card__meta"><div title=" 28 голосов " class="tm-karma tm-user-card__karma"><div class="tm-karma__votes tm-karma__votes_positive">
    14
  </div> <div class="tm-karma__text">
    Карма
  </div></div> <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating"><div class="tm-rating__header"> <div class="tm-rating__counter">0</div></div> <div class="tm-rating__text">
    Рейтинг
  </div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title_variant-article"><!----> <a href="/ru/users/reablaz/" class="tm-user-card__nickname tm-user-card__nickname_variant-article">
          @reablaz
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info_variant-article">User</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----> <!----></div></div> <!----></div> <DIV class="v-portal" style="display:none;"></DIV></div> <!----></section> <div class="tm-article-blocks__comments"><div class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/post/452696/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="16" width="16" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v24.ce74655c.svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 11 
    </span></a> <!----></div></div></div> <div class="tm-ad-banner__container tm-page-article__banner"><!----> <div id="articleBottomBanner" class="tm-ad-banner"></div></div> <!----> <!----> <!----> <!----> </div></div></div></div></div> <div class="tm-page__sidebar"><div class="tm-layout-sidebar"><div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial"><div class="tm-ad-banner__container tm-layout-sidebar__banner"><!----> <div id="sidebarBanner" class="tm-ad-banner"></div></div></div> <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;"><!----> <!----></div></div></div></div></div></div></main> <!----></div> <div class="tm-footer-menu"><div class="tm-page-width"><div class="tm-footer-menu__container"><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Ваш аккаунт
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/452696/&amp;hl=ru" rel="nofollow" target="_self">
                Войти
              </a></li><li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/452696/&amp;hl=ru" rel="nofollow" target="_self">
                Регистрация
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Разделы
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active">
                Публикации
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link">
                Новости
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link">
                Хабы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link">
                Компании
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link">
                Авторы
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link">
                Песочница
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Информация
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link">
                Устройство сайта
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link">
                Для авторов
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link">
                Для компаний
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link">
                Документы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank">
                Соглашение
              </a></li><li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank">
                Конфиденциальность
              </a></li></ul></div></div><div class="tm-footer-menu__block"><h3 class="tm-footer-menu__block-title">
          Услуги
        </h3> <div class="tm-footer-menu__block-content"><ul class="tm-footer-menu__list"><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQLwRfQmXibiUlWaRg-BAc38s7oM3lJiaPju7qmdJsp8ysIvZ_G-Npem0njJLMozE2bPHMpDqiI5hhy/pub?start=false&amp;loop=false&amp;delayms=60000&amp;slide=id.g91a03369cd_4_297" target="_blank">
                Реклама
              </a></li><li class="tm-footer-menu__list-item"><a href="https://habrastorage.org/storage/stuff/habr/service_price.pdf" target="_blank">
                Тарифы
              </a></li><li class="tm-footer-menu__list-item"><a href="https://docs.google.com/presentation/d/e/2PACX-1vQJJds8-Di7BQSP_guHxICN7woVYoN5NP_22ra-BIo4bqnTT9FR6fB-Ku2P0AoRpX0Ds-LRkDeAoD8F/pub?start=false&amp;loop=false&amp;delayms=60000" target="_blank">
                Контент
              </a></li><li class="tm-footer-menu__list-item"><a href="https://tmtm.timepad.ru/" target="_blank">
                Семинары
              </a></li><li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link">
                Мегапроекты
              </a></li></ul></div></div></div></div></div> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><!----> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><!---->
        Настройка языка
      </button> <a href="/ru/about" class="tm-footer__link">
        О сайте
      </a> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <!----> <a href="/berserk-mode-nope" class="tm-footer__link">
        Вернуться на старую версию
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2021 </span> <span class="tm-copyright__name">«<a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a>»</span></span></div></div></div></div> <!----> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"452696":{"id":"452696","timePublished":"2019-05-20T19:52:01+00:00","isCorporative":false,"lang":"ru","titleHtml":"Как запустить микро-платежи в своем приложении","leadData":{"textHtml":"Прошлую неделю я провёл разрабатывая свою первую публичную программку — Telegram-бота который работает в качестве Bitcoin-кошелька и позволяет «бросать монетки» другим участникам групповых чатов а так же совершать внешние Bitcoin-платежи себе или другим т.н. “Lightning Apps”. Подразумеваю, что в целом читатель знаком c Bitcoin и Telegram, т.к. буду стараться писать кратко, не вникая в детали. \u003Ca href=\"https:\u002F\u002Fwww.lopp.net\u002Fbitcoin-information.html\"\u003EВыборка ресурсов о Bitcoin доступна по этой ссылке\u003C\u002Fa\u003E, ну а Телеграм это средство мгновенного обмена сообщениями на мобильных устройства и пк, позволяющее на их платформе создавать свои небольшие приложения (чат-ботов).\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Ch3\u003EКакие ключевые функции этого приложения?\u003C\u002Fh3\u003E\u003Cbr\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003EПозволяет отблагодарить или поощрить собеседника действительно материальной ценностью, а не просто \u003Ci\u003E«виртуальным лайком»\u003C\u002Fi\u003E, это выводит электронное общение на совершенно новый уровень\u003C\u002Fli\u003E\r\n\u003Cli\u003EРеальный пример приложения, которое может финансово взаимодействовать с другими приложениями используя открытый платёжный протокол\u003C\u002Fli\u003E\r\n\u003Cli\u003EВсе компоненты приложения являются проектами с открытым исходным кодом и их возможно изменять и применять для своих задач. Приложение не использует закрытых и\\или коммерческих решений, несмотря на то, что подходит под сферу электронной коммерции, которую на сегодняшний день назвать открытой довольно сложно.\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u003E\r\n\u003Ch3\u003EИ как это применить в деле?\u003C\u002Fh3\u003E\u003Cbr\u003E\r\nкак-то так…\u003Cbr\u003E\r\n\u003Cbr\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F097\u002F02b\u002F175\u002F09702b1750c94616a10fc66c1275c00f.png\" alt=\"image\"\u003E\u003C\u002Fdiv\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше →","image":null},"editorVersion":"1.0","postType":"article","postLabels":[{"type":"tutorial","data":null}],"author":{"scoreStats":{"score":14,"votesCount":28},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"id":"757683","alias":"reablaz","fullname":null,"avatarUrl":null,"speciality":"User"},"statistics":{"commentsCount":11,"favoritesCount":51,"readingCount":7533,"score":15,"votesCount":17},"hubs":[{"relatedData":null,"id":"144","alias":"open_source","type":"collective","title":"Open source","titleHtml":"Open source","isProfiled":true},{"relatedData":null,"id":"233","alias":"pay_system","type":"collective","title":"Платежные системы","titleHtml":"Платежные системы","isProfiled":true},{"relatedData":null,"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true},{"relatedData":null,"id":"21482","alias":"distributed_systems","type":"collective","title":"Распределённые системы","titleHtml":"Распределённые системы","isProfiled":true},{"relatedData":null,"id":"21986","alias":"cryptocurrency","type":"collective","title":"Криптовалюты","titleHtml":"Криптовалюты","isProfiled":false}],"flows":[{"id":"1","alias":"develop","title":"Разработка"},{"id":"6","alias":"admin","title":"Администрирование"},{"id":"7","alias":"popsci","title":"Научпоп"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003EПрошлую неделю я провёл разрабатывая свою первую публичную программку — Telegram-бота который работает в качестве Bitcoin-кошелька и позволяет «бросать монетки» другим участникам групповых чатов а так же совершать внешние Bitcoin-платежи себе или другим т.н. “Lightning Apps”. Подразумеваю, что в целом читатель знаком c Bitcoin и Telegram, т.к. буду стараться писать кратко, не вникая в детали. \u003Ca href=\"https:\u002F\u002Fwww.lopp.net\u002Fbitcoin-information.html\"\u003EВыборка ресурсов о Bitcoin доступна по этой ссылке\u003C\u002Fa\u003E, ну а Телеграм это средство мгновенного обмена сообщениями на мобильных устройства и пк, позволяющее на их платформе создавать свои небольшие приложения (чат-ботов).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EКакие ключевые функции этого приложения?\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003EПозволяет отблагодарить или поощрить собеседника действительно материальной ценностью, а не просто \u003Ci\u003E«виртуальным лайком»\u003C\u002Fi\u003E, это выводит электронное общение на совершенно новый уровень\u003C\u002Fli\u003E\r\n\u003Cli\u003EРеальный пример приложения, которое может финансово взаимодействовать с другими приложениями используя открытый платёжный протокол\u003C\u002Fli\u003E\r\n\u003Cli\u003EВсе компоненты приложения являются проектами с открытым исходным кодом и их возможно изменять и применять для своих задач. Приложение не использует закрытых и\\или коммерческих решений, несмотря на то, что подходит под сферу электронной коммерции, которую на сегодняшний день назвать открытой довольно сложно.\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EИ как это применить в деле?\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nкак-то так…\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F097\u002F02b\u002F175\u002F09702b1750c94616a10fc66c1275c00f.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\nили так…\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cdiv style=\"text-align:center;\"\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F3ef\u002F1ff\u002F85f\u002F3ef1ff85f1e7b77662c63a9d4d838666.png\"\u002F\u003E\u003C\u002Fdiv\u003E\u003Cbr\u002F\u003E\r\nЧто значат эти числа? Это \u003Cb\u003Eединицы биткойна — сатоши\u003C\u002Fb\u003E. По биржевым ценам на середину 2019 года 1000 сатоши это приблизительно $0.06. Сатоши можно потратить онлайн или легко обменять на национальную валюту. Именно по этой причине (ликвидность) это не просто очередная \u003Ci\u003E«запись в БД»\u003C\u002Fi\u003E или \u003Ci\u003E«баллы, которые вы можете потратить в магазинах наших партнёров»\u003C\u002Fi\u003E, а \u003Cb\u003Eсамые настоящие интернет деньги\u003C\u002Fb\u003E.\u003Cbr\u002F\u003E\r\n\u003Ci\u003E*сразу хочу отметить, что некоторые слова или словосочетания заведомо не пытаюсь писать на русском — либо не знаю сам контекстного перевода в некоторых случаях, либо такой перевод на мой взгляд звучит скорее заблуждающим, чем корректным \u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nМожет возникнуть вопрос, как пользоваться таким приложением если биткойнов нет. Их легко можно приобрести в небольшом количестве на одной из многих бирж или обменнике, а можно у друга-биткойнера или даже получить монеток от текущих пользователей бота. Многие кошельки на телефон предлагают купить биткойны прямо «не отходя от кассы».\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F883\u002F661\u002F461\u002F883661461bdc686aec7d084d5d581236.png\"\u002F\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F779\u002F716\u002F5d9\u002F7797165d93d292700d9a41a171d882a6.png\"\u002F\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F8fe\u002F33b\u002F84b\u002F8fe33b84bb127132304634363bb4af42.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nКогда разжились биткойнами (а скорее сатош\u003Ci\u003E-ами\u003C\u002Fi\u003E(?)) — запускаем \u003Ca href=\"https:\u002F\u002Ft.me\u002Fatomic_tipbot\"\u003E@atomic_tipbot\u003C\u002Fa\u003E и делаем \u002Fdeposit.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nБот в ответ спросит сколько сатоши внести на баланс и пришлет к оплате счёт, который можно оплатить мобильным кошельком отсканировав QR-код или нажав кнопку (\u003Ci\u003E«открыть в кошельке»\u003C\u002Fi\u003E) на странице инвойса. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F8fe\u002F33b\u002F84b\u002F8fe33b84bb127132304634363bb4af42.png\"\u002F\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F4a3\u002Fda5\u002Ff76\u002F4a3da5f76574ac9ebb2161d56bceff62.png\"\u002F\u003E\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F54d\u002Fa43\u002F0be\u002F54da430be68237193dee82ade50bab37.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nПодтвердив платёж на своем кошельке, практически сразу подтверждение об оплате вышлет бот и это будет визуально отображено во фрейме счёта.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДо этого момента мы затронули две компоненты приложения — back-end telegram-бота и систему процессинга платежей криптовалютой (скорее ее front-end).\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля создания Telegram-бота я использовал \u003Ca href=\"http:\u002F\u002Fpython-telegram-bot.readthedocs.io\u002F\"\u003EPython Telegram Bot\u003C\u002Fa\u003E. Ну и конечно, сам бот \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Freablaz\u002Fatomic_tipbot\"\u003Eс открытым исходным кодом\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ качестве системы процессинга платежей и решения UX-задач выбор пал (на самом деле, выбора почти нет) на \u003Ca href=\"https:\u002F\u002Fwww.youtube.com\u002Fwatch?v=nr0UNbz3AoQ\"\u003EBTCPayServer\u003C\u002Fa\u003E, на который \u003Ca href=\"https:\u002F\u002Fdocs.btcpayserver.org\u002F\"\u003Eдокументация по этой ссылке\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли искать решения обработки событий платежей напрямую, то стоит обратить внимание на \u003Ca href=\"http:\u002F\u002Fdocs.electrum.org\u002Fen\u002Flatest\u002Fcmdline.html\"\u003EElectrum CLI manual pages\u003C\u002Fa\u003E для т.н. on-chain платажей, а для мгновенных микро-платежей (Lightning) решения вроде \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FElementsProject\u002Flightning-charge\"\u003ELightning-charge\u003C\u002Fa\u003E или \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ffiatjaf\u002Fsparko\"\u003ESparko\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n \u003Cbr\u002F\u003E\r\n\u003Ch3\u003EТак оно self-hosted или нет!?\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nДа, это так. В своем приложении я использую бесплатный хостинг BTCPayServer — \u003Ca href=\"https:\u002F\u002Fbtcpayjungle.com\"\u003EBTCPayJungle\u003C\u002Fa\u003E, но это абсолютно возможно и не требует много времени что бы запустить собственный процессинговый центр. Однако стоит помнить, что Вам будут необходимы ~500GB доступные на ЖД для хранения блокчейнов Bitcoin (и Litecoin). Так же потребуются вычислительные и сетевые ресурсы на время синхронизации и в зависимости от ваших нужд необходимые «обёртки» для блокчейнов, что бы было с ними удобно взаимодействовать. BTCPayServer не содержит \u003Ci\u003Eby-design\u003C\u002Fi\u003E приватных ключей или любой другой информации, позволяющей контролировать ваш кошелек. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДля on-chain (обычных) платежей необходимо добавить т.н. xpub-ключ кошелька в BTCPayServer для генерации адресов на получение (публичных ключей). Это делает возможным и безопасным использовать BTCPayServer даже в «расшареном» виде. Все эти xpub-ключи и адреса можно легко получить в хороших кошельках вроде \u003Ca href=\"http:\u002F\u002Felectrum.org\u002F\"\u003EElectrum\u003C\u002Fa\u003E, для дальнейшей настройки процессинга.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВсе кто сталкивался с Bitcoin слышали про то, что биткойн медленный и тразакции дорогие, особенно когда хайп, поэтому для мгновенных микро-платежей стоит использовать (off-chain) транзакции Lightning Network.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EЧто это за Lightning Network?\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\nЭто что-то вроде плагина к биткойну, который надстраивает дополнительный слой абстракции и позволяет совершать мгновенные и практически бесплатные транзакции в сети Bitcoin. Всё это возможно благодаря криптографической магии с мульти-подписями, чаще называемой \u003Ci\u003Eсмарт-контракт\u003C\u002Fi\u003E. Есть несколько реализаций протокола Lightning Network, я использую \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FElementsProject\u002Flightning\"\u003Ec-lightning\u003C\u002Fa\u003E реализацию на C. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nОсновное различие между on-chain и off-chain (Lightning) платежами в том, как они хранятся. Все \u003Cb\u003Eon-chain\u003C\u002Fb\u003E транзакции ретранслируются по всем узлам сети, пока одна из нод биткойна нод не анонсирует \u003Ca href=\"https:\u002F\u002Fen.bitcoin.it\u002Fwiki\u002FMining\"\u003Eновый намайненый блок\u003C\u002Fa\u003E с включенными в него транзакциями. (На хабре даже есть \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fusers\u002Fbitfury\u002F\" class=\"user_link\"\u003EBitFury\u003C\u002Fa\u003E, они как раз производят железо для майнинга). Именно по этой причине мы называем такие транзакции \u003Cb\u003Eon-chain\u003C\u002Fb\u003E. Такие транзакции буду записаны в общий блокчейн и сохранятся в нём до конца его существования. Так же такие транзакции находятся в общем доступе и их возможно мониторить, отслеживать и анализировать.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВ случае \u003Cb\u003Eoff-chain\u003C\u002Fb\u003E (Lightning) транзакций все происходит иначе. Каждая нода Lightning-сети имее один \u003Ci\u003E(или более)\u003C\u002Fi\u003E on-chain адресов — это те самые обычные адреса биткойна, с которых все и начинается. Когда появляются биткойны на таком адресе возможно открыть т.н. \u003Ci\u003Elightning канал\u003C\u002Fi\u003E к другой ноде, что значит, что при помощи криптографических техник эти две ноды договорились о доступности средств между собой. Позже, все транзакции (как свои, так и транзакции посторонних нод) что проходят через такой канал сохраняются только на нодах участников транзакции (и нодах-посредниках). Единственные транзакции, которые записываются в блокчейн — это транзакции об открытии или закрытии канала. В более полном масштабе получается такая сеть взаимо-подключенных нод которая строит между участниками тысячи различных путей для «переливания» средств из одной ноды в другую по определенным жестким правилам. Практически все такие транзакции хранятся только в файле БД самих нод. Именно по этой причине мы их называем \u003Cb\u003Eoff-chain\u003C\u002Fb\u003E. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ch3\u003EНа диаграме видна визуализация всех компонент приложения\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F3c6\u002F636\u002Fb8c\u002F3c6636b8c98d52aab9bd09ff9c52afcb.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nВкратце:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n1) Пользователь отправляет комунду боту в \u003Cb\u003ETelegram\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n2) Telegram отправляет сообщение о событии \u003Cb\u003Epython приложению\u003C\u002Fb\u003E бота\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n3) \u003Cb\u003Epython-приложение\u003C\u002Fb\u003E отправляет запрос на \u003Cb\u003EBTCPayServer\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n4) BTCPayServer генерирует входящие адреса BTC и LTC, а так же отправляет запрос на инвойс к \u003Cb\u003Elightning-charge\u003C\u002Fb\u003E, который в свою очередь общается с демоном \u003Cb\u003Ec-lightning\u003C\u002Fb\u003E. На выходе мы получаем красивую HTML-форму обработки платежа\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n5) Пользователь оплачивает инвойс и видит подтверждение\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n6) \u003Cb\u003EBTCPayServer\u003C\u002Fb\u003E отправляет\u003Ci\u003E уведомление оплаты инвойса\u003C\u002Fi\u003E (IPN) на указанный callback_url, в нашем случае \u003Cb\u003Ecallbacks.py\u003C\u002Fb\u003E (еще одно python приложении для получения уведомлений)\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n7) Согласно полученным данным баланс пользователя изменяется\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ci\u003E… и если пользователь захотел вывести средства (монетки что получил от других) …\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n8) \u003Cb\u003EPython-приложение\u003C\u002Fb\u003E бота ждет текста или картинки QR-кода, и когда валидные данные получены то совершается платёж утилитой\u003Cb\u003Epaylightning.py*\u003C\u002Fb\u003E, которая инициализирует транзакцию посредством c-lightning RPC.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F518\u002F3dc\u002Fc81\u002F5183dcc817817f1aa676ff74d17d08bb.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Ci\u003E*Справедливости ради, стоит отметить что моя обертка paylightning.py не совсем закончена и может вернуть ложно-отрицательный результат в специфических сценариях. Рекомендую \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Ffiatjaf\u002Flightningd-gjson-rpc\u002Ftree\u002Fmaster\u002Fcmd\u002Fwaitpay\"\u003Eк использованию хорошо отлаженную обертку\u003C\u002Fa\u003E в случаях приближенных к продакшену\u003C\u002Fi\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЧто мы имеем? Пользователи нашего бота могут внутри группового чата или напрямую могут передавать \u003Cb\u003Eматериальную ценность\u003C\u002Fb\u003E без ограничений. И это еще не все — благодаря протоколу Lightning Network, который в некотором смысле является унифицированной и упрощенной платежной сетью, появляется возможность отправлять те же деньги что получены в чате совершенно сторонним приложениям. Например, в Telegram уже был первый бот для биткойн-платежей — @lntxbot. «Единый баланс» позволяет использовать любого из ботов в зависимости от предпочтений конкретного группового чата (да, проблема абсолютно надуманна и решение весьма бесполезно, но дело в сути). Перекинуть баланс с одного бота на другой ничего не стоит и занимает секунды! Важно заметить, что создатели этих ботов вообще никогда не связывались между собой.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002Ff09\u002Fc3a\u002Fef9\u002Ff09c3aef995f7a82560987646b0d8ee0.png\"\u002F\u003E \u003Cimg src=\"\u002Fimg\u002Fimage-loader.svg\" alt=\"image\" data-src=\"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fpost_images\u002F1e2\u002F344\u002F82c\u002F1e234482c56aa0df1d4b341ecfe3beb8.png\"\u002F\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nДостаточно просто переправить сообщение с запросом на депозит от @lntxbot к @atomic_tipbot и voul’a!\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЭто уже не просто «перебрасывание чисел в БД» а платёж между двумя разными, не связанными между собой БД. Таким образом в бот интегрировано уже несколько «LApps», среди них: \u003Ca href=\"https:\u002F\u002Fsat2.io\"\u003Esat2.io\u003C\u002Fa\u003E и \u003Ca href=\"https:\u002F\u002Flnsms.world\"\u003Elnsms.world\u003C\u002Fa\u003E.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cb\u003EЧто значит \u003Ci\u003Eинтеграция LApp\u003C\u002Fi\u003E?\u003C\u002Fb\u003E\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nКаждая \u003Ci\u003ELightning Network\u003C\u002Fi\u003E нода это по своей сути биткойн-кошелек. У нее два баланса: on-chain и off-chain. On-chain баланс необходим для открытия новых каналов и хранения средств с закрытых каналов. А вот off-chain баланс как раз то, что ходит между нодами. Основные требования к ноде это получение и отправка платежей, поэтому каждая нода как ПО имеет функции \u003Ci\u003E\u003Cb\u003Epay\u003C\u002Fb\u003E\u003C\u002Fi\u003E и \u003Ci\u003E\u003Cb\u003Einvoice\u003C\u002Fb\u003E\u003C\u002Fi\u003E. Я продемонстрирую как это происходит:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"bash\"\u003Euser@ln-node:\u002F % lightning-cli invoice 1000000000 internal_description external_description\n{\n   \"payment_hash\" : \"64c0c8f5f8f708b08487ad1376f3d256f92ccb9606987ba395c2b4193efde5a0\",\n   \"expires_at\" : 1558709834,\n   \"bolt11\" : \"lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6\"\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nМы получаем «инвойс» спецификации \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Flightningnetwork\u002Flightning-rfc\u002Fblob\u002Fmaster\u002F11-payment-encoding.md\"\u003EBOLT11\u003C\u002Fa\u003E в этом случае, которая является форматом платёжек в сети Bitcoin (и Litecoin, к слову, тоже). Это строка, содержащая в себе информацию о получателе, сумме транзакции, время истечения запроса итп., подробную информацию можно получить запустив decodepay в отношении данной строки:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"bash\"\u003Euser@ln-node:\u002F % lightning-cli decodepay lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6\n{\n   \"currency\" : \"bc\",\n   \"created_at\" : 1558105034,\n   \"expiry\" : 604800,\n   \"payee\" : \"025a14b8ed40583d67aec92da19453e0b2d1fbbf75f96f85d3dd0ff61a51ee0490\",\n   \"msatoshi\" : 1000000000,\n   \"amount_msat\" : \"1000000000msat\",\n   \"description\" : \"external_description\",\n   \"min_final_cltv_expiry\" : 10,\n   \"routes\" : [\n      [\n         {\n            \"pubkey\" : \"03a20c0c2ae4508b669a70e5f82f08f69a3da5da3bf0c973673c3fe977db0f61e3\",\n            \"short_channel_id\" : \"574012x1255x1\",\n            \"fee_base_msat\" : 1000,\n            \"fee_proportional_millionths\" : 1,\n            \"cltv_expiry_delta\" : 144\n         }\n      ]\n   ],\n   \"payment_hash\" : \"64c0c8f5f8f708b08487ad1376f3d256f92ccb9606987ba395c2b4193efde5a0\",\n   \"signature\" : \"304502210099f31dffd18b6db8296637db3e3a1ffbaf7b7db087a2ad1eedb7639f25e78b25022079038370073681aa1e1a7a05de6588e98ead078896d0a37a15b755c212dc3d37\"\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nА вот для оплаты такого «инвойса» нам необходима функция pay от c-lightning:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"bash\"\u003Euser@ln-node:\u002F % lightning-cli pay lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j\n{\n   \"id\" : 163,\n   \"payment_hash\" : \"c3e644a005f56e33df89facbce2c9dfcabbef5d105285a98272cacc77ab2de63\",\n   \"destination\" : \"03021c5f5f57322740e4ee6936452add19dc7ea7ccf90635f95119ab82a62ae268\",\n   \"msatoshi\" : 200000,\n   \"amount_msat\" : \"200000msat\",\n   \"msatoshi_sent\" : 200003,\n   \"amount_sent_msat\" : \"200003msat\",\n   \"created_at\" : 1558106072,\n   \"status\" : \"complete\",\n   \"payment_preimage\" : \"1a9552b9f4e9199e26839353f870b12cc85b7674a2fb134e78aa370032611019\",\n   \"bolt11\" : \"lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j\"\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nВсе состояния транзакций обрабатывает вся сеть и ваша собственная нода в частности. Нет необходимости (но есть такая возможность) взаимодействовать с авторами приложения-получателя платежа или каким либо их API для получения информации о состоянии платежа. Нет нужды проверять состояние платежа в системе процессинга-посредника. Не нужно ожидать одобрения вашей транзакции со стороны банка или государственного учреждения. В конце концов тут нет чардж-бэков и других внешних факторов, которые могут повлиять на остаток на вашем счету. Это решение для перемещения ценности посредством сети Интернет, без необходимости стороннего арбитра, который решает соответсвует транзакция правилам (порой даже внутренним правилам, о которых не все участники проинформированы заранее) или нет. В биткойне нет «внутренних правил». Единственные правила которым нужно следовать это правила сети — открытые и всем известные. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЭто делает реальными \u003Cb\u003Eпрямые\u003C\u002Fb\u003E, \u003Cb\u003Eпрактически бесплатные\u003C\u002Fb\u003E и \u003Cb\u003Eмгновенные\u003C\u002Fb\u003E денежные транзакции между людьми или программами в полностью автономном режиме.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли у вас есть возможность получить данные оплаты от стороннего приложения, то появляется возможность взаимодействовать в финансовом смысле с этим приложением. В качестве примера можно рассмотреть сервис lnsms.world, который позволяет отправить SMS-сообщение на произвольный номер, оплатив его биткойнами. Для интеграции этого приложения нам нужно всего лишь передать данные из веб-формы напрямую скрипту отправки смс — эмулировать действия пользователя на веб-сайте:\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"python\"\u003Epayload = {                                                                                                                           \n        'number': phone_number,\n        'text': text,\n        'force_unicode': 0\n    }\n\n    send_req = requests.post('https:\u002F\u002Flnsms.world\u002Finvoice', data=payload)\n    if send_req.status_code == 201:\n        plain_invoice = str(send_req.text)\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\nНе знаю по какой причине, но lnsms отвечает 201 HTTP status-кодом и возвращает инвойс формата BOLT11. Что ж, этого достаточно что бы пользователи бота могли произвести оплату за отправку смс со своего баланса, полученного в чатиках. Пользователь даже не знает что там происходит, он просто заплатил пару центов за отправку смс. И я, как разработчки не вдаюсь в подробности работы смс-сервисов. Просто переправил платеж и получил услугу. Можно сверху наценку сделать, а можно и не делать — это мой свободный выбор. Никаких аккаунтов, соглашений и очередного API для пустяковых задач вроде отправки смс. \u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nА теперь давайте на момент представим, что наше приложении является чем-то более полезным чем чат-бот и совершает платеж не другому боту, а другому приложению или устройству, подключенному к Интернет. Или же это десятки или даже сотни ничтожных платежей каждую секунду между устройствами, сервисами, магазинами или какими то поставщиками услуг. Это и есть мощь микро-платежей, так должен выглядеть Интернет вещей. Уже существуют проекты вроде \u003Ca href=\"https:\u002F\u002Falthea.org\u002F\"\u003EAlthea\u003C\u002Fa\u003E которые воплащают эти идеи в жизнь и в скором будущем мы увидим большие, на мой взгляд, перемены в области, которую мы сейчас называет электронная коммерция.\u003Cbr\u002F\u003E\r\n\u003Cbr\u002F\u003E\r\nЕсли Вам понравился пост и Вы хотите попробовать биткойны в действии — \u003Ca href=\"https:\u002F\u002Ftip.ysx.in\"\u003Eзашлите мне на кружку пива, да мягких французских булочек\u003C\u002Fa\u003E.\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"мгновенные сообщения"},{"titleHtml":"криптовалюты"},{"titleHtml":"биткойн"},{"titleHtml":"платежи"},{"titleHtml":"электронная коммерция"},{"titleHtml":"децентрализованные сети"},{"titleHtml":"открытый исходный код"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F452696\u002F613820bbf59688a473ed73eae28829a3\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F452696\u002F613820bbf59688a473ed73eae28829a3\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F452696\\\u002F\"},\"headline\":\"Как запустить микро-платежи в своем приложении\",\"datePublished\":\"2019-05-20T22:52:01+03:00\",\"dateModified\":\"2019-05-21T14:18:09+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"reablaz\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Прошлую неделю я провёл разрабатывая свою первую публичную программку &mdash; Telegram-бота который работает в качестве Bitcoin-кошелька и позволяет &laquo;бросать монетки&raquo;...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F452696\\\u002F#post-content-body\",\"about\":[\"h_open_source\",\"h_pay_system\",\"h_programming\",\"h_distributed_systems\",\"h_cryptocurrency\",\"f_develop\",\"f_admin\",\"f_popsci\"],\"image\":[\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F097\\\u002F02b\\\u002F175\\\u002F09702b1750c94616a10fc66c1275c00f.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F3ef\\\u002F1ff\\\u002F85f\\\u002F3ef1ff85f1e7b77662c63a9d4d838666.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F883\\\u002F661\\\u002F461\\\u002F883661461bdc686aec7d084d5d581236.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F779\\\u002F716\\\u002F5d9\\\u002F7797165d93d292700d9a41a171d882a6.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F8fe\\\u002F33b\\\u002F84b\\\u002F8fe33b84bb127132304634363bb4af42.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F4a3\\\u002Fda5\\\u002Ff76\\\u002F4a3da5f76574ac9ebb2161d56bceff62.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F54d\\\u002Fa43\\\u002F0be\\\u002F54da430be68237193dee82ade50bab37.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F3c6\\\u002F636\\\u002Fb8c\\\u002F3c6636b8c98d52aab9bd09ff9c52afcb.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F518\\\u002F3dc\\\u002Fc81\\\u002F5183dcc817817f1aa676ff74d17d08bb.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002Ff09\\\u002Fc3a\\\u002Fef9\\\u002Ff09c3aef995f7a82560987646b0d8ee0.png\",\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fgetpro\\\u002Fhabr\\\u002Fpost_images\\\u002F1e2\\\u002F344\\\u002F82c\\\u002F1e234482c56aa0df1d4b341ecfe3beb8.png\"]}","metaDescription":"Прошлую неделю я провёл разрабатывая свою первую публичную программку — Telegram-бота который работает в качестве Bitcoin-кошелька и позволяет «бросать монетки» другим участникам групповых чатов а так...","mainImageUrl":null,"amp":false},"polls":[{"id":"30364","timeElapsed":null,"answersType":"radio","votesCount":33,"passCount":7,"textHtml":"Интерестны ли Вам сугубо-технические статьи про биткойн и смежное ПО?","relatedData":null,"variants":[{"id":"145434","textHtml":"Да","votesCount":28,"percent":84.85,"selected":false},{"id":"145436","textHtml":"Нет","votesCount":4,"percent":12.12,"selected":false},{"id":"145438","textHtml":"Мне больше интерестны рыночные аспекты криптовалюты","votesCount":1,"percent":3.03,"selected":false}]}],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[],"hubs":"open_source,pay_system,programming,distributed_systems,cryptocurrency"},"comments":{"articleComments":{},"searchCommentsResults":null,"previewComment":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{}},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0,"isLoadMore":false},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"dfp":{"slotsDict":{}},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":"true"},"flows":{"flows":[{"alias":"develop","id":1,"route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":6,"route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":2,"route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":3,"route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":4,"route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":7,"route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""},"searchQuery":null},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"pinnedPost":{"pinnedPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{}},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.c2c3fc9a.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.c0af73e7.js" defer></script>



    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
</body>
</html>
